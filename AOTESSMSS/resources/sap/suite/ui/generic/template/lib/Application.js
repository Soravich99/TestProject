sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/ui/core/routing/HistoryDirection","sap/m/MessageToast","sap/m/ActionSheet","sap/m/Dialog","sap/m/Popover","sap/suite/ui/generic/template/lib/deletionHelper","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/ContextBookkeeping","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,J,H,a,M,A,b,P,d,r,C,t){"use strict";var c=(t.testableStatic(function(T,o){var s="sapUiSizeCozy",h="sapUiSizeCompact";if(o.hasClass(s)||o.hasClass(h)){return"";}else{return T?s:h;}},"Application_determineContentDensityClass")(D.support.touch,q(document.body)));function g(){return c;}function f(o,p){q.sap.syncStyleClass(c,p,o);p.addDependent(o);}var f=t.testableStatic(f,"Application_attachControlToParent");function e(T){var o=new C(T.oAppComponent);var l,E;function h(){return l;}function s(i){l=i;}function k(i){var j=T.oNavigationControllerProxy.getActiveComponents();return j.indexOf(i.getId())>=0;}var I=false;function m(i){T.fnAddSideEffectPromise(i);}function p(i){if(I){return;}var j=q.grep(T.aRunningSideEffectExecutions,function(i1){return!!i1;});if(j.length){I=true;Promise.all(j).then(function(){I=false;p(i);});}else{i();}}function n(i){var j;if(i instanceof b){j="open";}else if(i instanceof P||i instanceof A){j="openBy";}if(j){var i1=i[j];i[j]=function(){var j1=arguments;p(function(){if(!T.oBusyHelper.isBusy()){T.oBusyHelper.getUnbusy().then(function(){i1.apply(i,j1);});}});};}}var F={};function u(i,j,i1,j1,k1){i=i||T.oNavigationHost;var l1=i.getId();var m1=F[l1]||(F[l1]={});var n1=m1[j];if(!n1){n1=sap.ui.xmlfragment(l1,j,i1);f(n1,i);var o1;if(j1){o1=new J();n1.setModel(o1,j1);}(k1||q.noop)(n1,o1);m1[j]=n1;n(n1);}return n1;}function v(){return new Promise(function(i){T.oNavigationObserver.getProcessFinished(true).then(function(){T.oBusyHelper.getUnbusy().then(i);});});}function w(i){T.oShellServicePromise.then(function(j){j.setBackNavigation(i);});}function x(i){if(!T.oFlexibleColumnLayoutHandler){return{handleDataReceived:function(){return false;}};}return T.oFlexibleColumnLayoutHandler.getFclProxyForView(i);}var y=false;function z(i){y=i;}function G(i,j){if(!T.oFlexibleColumnLayoutHandler){return true;}var i1=r.determineNavigationPath(i,j);return T.oFlexibleColumnLayoutHandler.isNewHistoryEntryRequired(i1);}function R(i){T.aStateChangers.push(i);}function K(i){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getTargetAfterCancelPromise(i):Promise.resolve(i);}function L(i,j){j.then(function(){o.adaptAfterObjectDeleted(i);});}function N(i,j,i1){var j1=T.mEntityTree[i];var k1;if(j1.navigationProperty&&j1.parent){k1=j?j1.entitySet:j1.navigationProperty;}else{k1=i;}if(i1.indexOf(k1)<0){i1.unshift(k1);if(j1.navigationProperty&&j1.parent){N(j1.parent,j,i1);}}}function O(i,j){var i1=[];N(i,j,i1);return i1;}function Q(j){var i1=O(j);i1.pop();var j1="";var k1="";var l1=[];for(var i=0;i<i1.length;i++){j1=j1+k1+i1[i];l1.push(j1);k1="/";}return l1;}function S(){var i=T.oNavigationControllerProxy.oHashChanger.getHash();var j=i.split("?")[0];var i1=j.split("/");if(i1[0]===""||i1[0]==="#"){i1.splice(0,1);}return i1;}function U(i,j,i1){if(T.oFlexibleColumnLayoutHandler){return T.oFlexibleColumnLayoutHandler.adaptBreadCrumbUrl(i,j,i1);}return i;}function V(){var j=T.oNavigationControllerProxy.getActiveComponents();var i1=0;var j1;for(var i=0;i<j.length;i++){var k1=T.componentRegistry[j[i]];if(k1.viewLevel>0&&(i1===0||k1.viewLevel<i1)){i1=k1.viewLevel;j1=k1.oComponent;}}var l1=j1?Promise.resolve(j1):T.oNavigationControllerProxy.getRootComponentPromise();return l1.then(function(m1){return m1.getModel("i18n").getResourceBundle();});}function W(){return T.oNavigationControllerProxy.getAppTitle();}function X(i,j){T.oNavigationControllerProxy.subTitleForViewLevelChanged(i,j);}function Y(i){return T.oNavigationControllerProxy.getCurrentKeys(i);}function Z(){for(var i in T.componentRegistry){var j=T.componentRegistry[i];if(j.viewLevel===1){if(k(j.oComponent)){var i1=j.oComponent.getComponentContainer().getElementBinding();return i1&&i1.getPath();}else{return null;}}}return null;}function $(i1,j1,k1,l1,m1){var n1=k1.oComponent.getEntitySet();var o1=T.mEntityTree[n1];var p1=false;var q1;var r1=true;for(var i=0;i<o1.children.length&&!q1;i++){var s1=o1.children[i];var t1=T.mEntityTree[s1];if(t1.navigationProperty===i1){q1=t1.sRouteName;r1=!t1.noKey;}}if(l1&&!q1){var u1=o1.embeddedComponents[l1];if(u1){for(var j=0;j<u1.pages.length&&!p1;j++){var v1=u1.pages[j];if(v1.navigationProperty===i1){p1=true;q1=n1+"/"+l1+"/"+i1;r1=!(v1.routingSpec&&v1.routingSpec.noKey);}}}}if(q1){var w1=p1?l1+r.getPatternDelimiter():"";var x1=r1?"("+j1+")":"";var y1=w1+i1+x1;T.oNavigationControllerProxy.navigateToSuffix(y1,k1.viewLevel+1,q1,m1);}}var _;function a1(i){var j=i.getEntitySet();var i1=T.mEntityTree[j];if(i1&&i1.communicationModel){return i1.communicationModel;}_=_||new J();return _;}var b1;function c1(j,i1){var i=i1||0;if(i>0){return null;}var j1=j.getEntitySet();var k1=T.mEntityTree[j1];var l1=k1&&k1.communicationObject;for(;i<0&&l1;){k1=T.mEntityTree[k1.parent];if(k1.communicationObject!==l1){i++;l1=k1.communicationObject;}}if(i<0||l1){return l1;}b1=b1||{};return b1;}function d1(i){for(var j in T.mEntityTree){if(T.mEntityTree[j].navigationProperty&&(T.mEntityTree[j].level===i+1)){return T.mEntityTree[j].navigationProperty;}}}function e1(){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getMaxColumnCountInFCL():false;}function f1(){var j=T.oNavigationControllerProxy.getActiveComponents();for(var i=0;i<j.length;i++){var i1=j[i];var j1=T.componentRegistry[i1];var k1=j1.methods.currentDraftModified&&j1.methods.currentDraftModified();if(k1){o.markDraftAsModified(k1);}}}function g1(){if(E!==undefined){return E;}var i,j,i1,j1,k1,l1,m1=true;var n1=T.oAppComponent.getModel();var o1=n1.getMetaModel();var p1=n1.mContexts;for(i1 in p1){m1=false;k1=p1[i1].sPath;j1=k1&&k1.substring(1,k1.indexOf('('));l1=j1&&o1.getODataEntitySet(j1);if(l1){i=n1.getProperty(k1);j=i&&n1.getETag(undefined,undefined,i)||null;if(j){E=true;return E;}}}if(m1){return true;}E=false;return E;}function h1(){var i,j,i1;var j1=T.oNavigationControllerProxy.getAllComponents();for(i=0;i<j1.length;i++){j=j1[i];i1=T.componentRegistry[j];i1.utils.refreshBinding();}}T.oApplicationProxy={getDraftSiblingPromise:o.getDraftSiblingPromise,getAlternativeContextPromise:o.getAlternativeContextPromise,getPathOfLastShownDraftRoot:o.getPathOfLastShownDraftRoot,getResourceBundleForEditPromise:V,getHierarchySectionsFromCurrentHash:S,getContentDensityClass:g,setEditableNDC:z,getDialogFragment:u.bind(null,null),destroyView:function(i){delete F[i];},setListReportTable:s,markCurrentDraftAsModified:f1,prepareDeletion:L};return{setEditableNDC:z,getEditableNDC:function(){return y;},getContentDensityClass:g,attachControlToParent:f,getDialogFragmentForView:u,getBusyHelper:function(){return T.oBusyHelper;},addSideEffectPromise:m,performAfterSideEffectExecution:p,isComponentActive:k,showMessageToast:function(){var i=arguments;var j=function(){q.sap.log.info("Show message toast");M.show.apply(M,i);};Promise.all([v(true),T.oBusyHelper.getUnbusy()]).then(j);},setBackNavigation:w,getFclProxyForView:x,isNewHistoryEntryRequired:G,registerStateChanger:R,getDraftSiblingPromise:o.getDraftSiblingPromise,registerContext:o.registerContext,activationStarted:o.activationStarted,cancellationStarted:o.cancellationStarted,editingStarted:o.editingStarted,getTargetAfterCancelPromise:K,getBreadCrumbInfo:Q,adaptBreadCrumbUrl:U,getSections:O,getHierarchySectionsFromCurrentHash:S,getAppTitle:W,subTitleForViewLevelChanged:X,getCurrentKeys:Y,getPathForViewLevelOneIfVisible:Z,getCommunicationModel:a1,getCommunicationObject:c1,navigateRoute:$,getForwardNavigationProperty:d1,getMaxColumnCountInFCL:e1,getListReportTable:h,markCurrentDraftAsModified:f1,checkEtags:g1,unbindAllComponents:h1,getIsDraftModified:o.getIsDraftModified,prepareDeletion:d.prepareDeletion.bind(null,T),prepareDeletionOfCreateDraft:d.prepareDeletionOfCreateDraft.bind(null,T)};}return B.extend("sap.suite.ui.generic.template.lib.Application",{constructor:function(T){q.extend(this,e(T));}});});
