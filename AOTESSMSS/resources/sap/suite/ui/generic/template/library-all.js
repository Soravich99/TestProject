jQuery.sap.declare('sap.suite.ui.generic.template.library-all');if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.SmartFilterBarExt')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.SmartFilterBarExt');jQuery.sap.require('sap.ui.comp.smartfilterbar.SmartFilterBar');jQuery.sap.require('sap.m.SegmentedButton');jQuery.sap.require('sap.m.SegmentedButtonItem');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/SmartFilterBarExt",["sap/ui/comp/smartfilterbar/SmartFilterBar","sap/m/SegmentedButton","sap/m/SegmentedButtonItem"],function(S,a,b){"use strict";var c=S.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.SmartFilterBarExt",{metadata:{events:{switchToVisualFilter:{}}},renderer:{}});c.prototype.checkSearchAllowed=function(s){if(s&&s.oSmartFilterbar){var A=s.oSmartFilterbar.determineMandatoryFilterItems(),f=s.oSmartFilterbar.getFiltersWithValues(),t=s.oController.getView().getModel("_templPriv"),I=true,d=0;if(A.length){if(!f.length||(f.length<A.length)){I=false;}else{for(var i=0;i<A.length;i++){for(var j=0;j<f.length;j++){if(f[j].getName()===A[i].getName()){d++;}}}I=(d===A.length);}}if(I){var o=S.prototype.verifySearchAllowed.apply(this,arguments);if(o.hasOwnProperty("error")||o.hasOwnProperty("mandatory")){I=false;}}t.setProperty("/alp/searchable",I);}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItem')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItem');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.ui.model.Filter');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItem",["sap/ui/core/Control","sap/ui/model/Filter"],function(C){"use strict";var F=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItem",{metadata:{properties:{filterRestriction:{type:"string",group:"Misc",defaultValue:null},entitySet:{type:"string",group:"Misc",defaultValue:null},dimensionField:{type:"string",group:"Misc",defaultValue:null},dimensionFieldIsDateTime:{type:"boolean",group:"Misc",defaultValue:false},dimensionFieldDisplay:{type:"string",group:"Misc",defaultValue:null},dimensionFilter:{type:"any",group:"Misc",defaultValue:null},dimensionFilterExternal:{type:"sap.ui.model.Filter",group:"Misc",defaultValue:null},measureField:{type:"string",group:"Misc",defaultValue:null},unitField:{type:"string",group:"Misc",defaultValue:null},isCurrency:{type:"boolean",group:"Misc",defaultValue:false},isMandatory:{type:"boolean",group:"Misc",defaultValue:false},isDropDown:{type:"boolean",group:"Misc",defaultValue:false},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},title:{type:"string",group:"Misc",defaultValue:""},outParameter:{type:"string",group:"Misc",defaultValue:null},inParameters:{type:"object[]",group:"Misc",defaultValue:null},parentProperty:{type:"string",group:"Misc",defaultValue:null},sortOrder:{type:"object[]",group:"Misc",defaultValue:null},scaleFactor:{type:"string",group:"Misc",defaultValue:null},numberOfFractionalDigits:{type:"string",group:"Misc",defaultValue:null},textArrangement:{type:"string",group:"Misc",defaultValue:sap.ui.comp.smartfilterbar.DisplayBehaviour.descriptionAndId},chartQualifier:{type:"string",group:"Misc",defaultValue:null}},aggregations:{control:{type:"sap.ui.core.Control",multiple:false}},events:{filterChange:{},titleChange:{}}},renderer:{}});return F;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.SmartVisualFilterBar.designtime')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.SmartVisualFilterBar.designtime');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/SmartVisualFilterBar.designtime",[],function(){"use strict";return{properties:{entitySet:{ignore:true},config:{ignore:true},persistencyKey:{ignore:true},displayCurrency:{ignore:true},smartFilterId:{ignore:true},textArrangement:{ignore:true}}};},false);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.ToolbarController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.ToolbarController');jQuery.sap.require('sap.m.SegmentedButtonItem');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.ui.base.EventProvider');jQuery.sap.require('sap.m.SegmentedButton');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/ToolbarController",["sap/m/SegmentedButtonItem","sap/m/Button","sap/m/ButtonType","sap/ui/base/EventProvider","sap/m/SegmentedButton","sap/ui/core/mvc/Controller"],function(S,B,a,E,b,C){"use strict";var c="table",d="chart",e="charttable",f="customview";var t=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.ToolbarController",{setState:function(s){var m=this;m.oState=s;m._uiCompRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");var g=s.oController.getOwnerComponent().getDefaultContentView();m.oState._pendingTableToolbarInit=true;m.oState._pendingChartToolbarInit=true;if(!m.oState.alr_viewSwitchButtonOnChart||!m.oState.alr_viewSwitchButtonOnTable){m.oState.alr_viewSwitchButtonOnChart=m.createViewSwitchButton(true);m.oState.alr_viewSwitchButtonOnTable=m.createViewSwitchButton(false);}var T=m.oState.oController.getOwnerComponent().getModel("_templPriv");g=(!T.getProperty('/alp/visibility/hybridView')&&g==="charttable")?"chart":g;T.setProperty('/alp/contentView',g);},createViewSwitchButton:function(g){var o=this.oState.oController.oView.getModel("alpCustomModel");var h=[];if(sap.ui.Device.system.desktop){h.push(new sap.m.SegmentedButtonItem({tooltip:"{i18n>CONTAINER_VIEW_CHARTTABLE}",key:e,icon:o.getProperty("/icon/hybrid")}));}if(o.getProperty("/required/master")){h.push(new sap.m.SegmentedButtonItem({tooltip:"{i18n>CONTAINER_VIEW_CHART}",key:d,icon:o.getProperty("/icon/master")}));}if(this.oState.bCustomViewExist){h.push(new sap.m.SegmentedButtonItem({tooltip:o.getProperty("/tooltip/customview"),key:f,icon:o.getProperty("/icon/customview")}));}h.push(new sap.m.SegmentedButtonItem({tooltip:"{i18n>CONTAINER_VIEW_TABLE}",key:c,icon:"sap-icon://table-view"}));var i={select:jQuery.proxy(function(){this.oState.oController._templateEventHandlers.onSegmentButtonPressed(!this.oState.oController.getOwnerComponent().getProperty('smartVariantManagement'));},this),layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow}),items:h,selectedKey:"{_templPriv>/alp/contentView}"};if(g){jQuery.extend(i,{visible:"{= (${_templPriv>/alp/contentView} === 'chart' || ${_templPriv>/alp/contentView} === 'charttable') && !${_templPriv>/alp/fullScreen} }"});var s=new b(i);}else{jQuery.extend(i,{visible:"{= (${_templPriv>/alp/contentView} === 'table' ) && !${_templPriv>/alp/fullScreen} }"});var s=new b(i);}return s;}});return t;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterBarController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterBarController');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterBarController",["sap/ui/core/mvc/Controller"],function(C){"use strict";var v=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterBarController",{init:function(s){this.oState=s;var o=this.oState.oController.getOwnerComponent();this._filterBar=this.oState.alr_visualFilterBar;this._filterBar.setEntitySet(o.getEntitySet());}});return v;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.CommonUtil')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.CommonUtil');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/CommonUtil",["sap/ui/base/Object","sap/ui/model/Context","jquery.sap.global"],function(B,C,q){"use strict";var a=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.CommonUtil");a.nullify=function(o){if(o){for(var p in o){o[p]=null;}}};return a;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationHelper');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/KpiAnnotationHelper",["sap/ui/base/Object","sap/ui/model/Context","sap/ui/model/odata/AnnotationHelper"],function(B,C,O){"use strict";var A=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationHelper");sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationHelper.criticalityConstants={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};A.selectionPresentationVariantResolveWithQualifier=function(c){var k=c.getObject();var m=c.getModel();var M=m.getProperty("/metaModel");var e=M.getODataEntitySet(k.entitySet);var E=M.getODataEntityType(e.entityType);var a=E.$path+"/com.sap.vocabularies.UI.v1.SelectionPresentationVariant#"+k.qualifier;return M.createBindingContext(a);};A.resolveParameterizedEntitySet=function(d,e,s){jQuery.sap.require("sap.ui.model.analytics.odata4analytics");var p="";var o=new sap.ui.model.analytics.odata4analytics.Model(sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(d));var q=o.findQueryResultByName(e.name);var a=new sap.ui.model.analytics.odata4analytics.QueryResultRequest(q);var b=q.getParameterization();if(b){var c;a.setParameterizationRequest(new sap.ui.model.analytics.odata4analytics.ParameterizationRequest(b));jQuery.each(s.Parameters,function(){if(this.RecordType==="com.sap.vocabularies.UI.v1.IntervalParameter"){c=this.PropertyValueFrom.PropertyPath.split("/");a.getParameterizationRequest().setParameterValue(c[c.length-1],this.PropertyValueFrom.String,this.PropertyValueTo.String);}else{c=this.PropertyName.PropertyPath.split("/");a.getParameterizationRequest().setParameterValue(c[c.length-1],this.PropertyValue.String);}});}try{p=a.getURIToQueryResultEntitySet();}catch(f){q=a.getQueryResult();p="/"+q.getEntitySet().getQName();jQuery.sap.log.error("getEntitySetPathWithParameters","binding path with parameters failed - "+f||f.message);}return p;};return A;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.OperationCode')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.OperationCode');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/OperationCode",function(){"use strict";jQuery.sap.declare("sap.suite.ui.generic.template.AnalyticalListPage.util.OperationCode");sap.suite.ui.generic.template.AnalyticalListPage.util.OperationCode={"EQ":{"code":"="},"GT":{"code":">"},"GE":{"code":">="},"LT":{"code":"<"},"LE":{"code":"<="},"NE":{"code":"!"},"BT":{"code":"...","position":"mid"},"EndsWith":{"code":"*"},"StartsWith":{"code":"*","position":"last"},"Contains":{"code":"*","position":"mid"}};return sap.suite.ui.generic.template.AnalyticalListPage.util.OperationCode;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.V4Terms')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.V4Terms');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms",function(){"use strict";jQuery.sap.declare("sap.suite.ui.generic.template.AnalyticalListPage.util.V4Terms");sap.suite.ui.generic.template.AnalyticalListPage.util.V4Terms={Label:"com.sap.vocabularies.Common.v1.Label",CalendarYear:"com.sap.vocabularies.Common.v1.IsCalendarYear",CalendarYearMonth:"com.sap.vocabularies.Common.v1.IsCalendarYearMonth",CalendarYearMonthDay:"com.sap.vocabularies.Common.v1.IsCalendarDate",Unit:"Org.OData.Measures.V1.Unit",ISOCurrency:"Org.OData.Measures.V1.ISOCurrency",FilterRestrictions:"Org.OData.Capabilities.V1.FilterRestrictions",SelectionFields:"com.sap.vocabularies.UI.v1.SelectionFields",FieldGroup:"com.sap.vocabularies.UI.v1.FieldGroup",ValueList:"com.sap.vocabularies.Common.v1.ValueList",DataPoint:"com.sap.vocabularies.UI.v1.DataPoint",SelectionRangeSignType:"com.sap.vocabularies.UI.v1.SelectionRangeSignType",ValueListParameterIn:"com.sap.vocabularies.Common.v1.ValueListParameterIn",ValueListParameterOut:"com.sap.vocabularies.Common.v1.ValueListParameterOut",ValueListParameterInOut:"com.sap.vocabularies.Common.v1.ValueListParameterInOut",SelectionPresentationVariant:"com.sap.vocabularies.UI.v1.SelectionPresentationVariant"};return sap.suite.ui.generic.template.AnalyticalListPage.util.V4Terms;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.Config.support')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.suite.ui.generic.template.Config.support');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.support.library');sap.ui.define("sap/suite/ui/generic/template/Config.support",["jquery.sap.global","sap/ui/support/library"],function(q,S){"use strict";var C=S.Categories;var a=S.Severity;var A=S.Audiences;var m={id:"modelPreloadingFioriElements",audiences:[A.Application,A.Internal],categories:[C.Performance],enabled:true,minversion:"1.38",title:"Default Model preloading required for Fiori Elements List Report applications",description:"Preloaded models, which load their data from extern locations, can start to load data earlier. This leads to an application performance improvement. For Fiori Elements List Report the default model (\"\") should be set to true.",resolution:"Adapt your application descriptor: set the default model (\"\") to \"preload\": true. Note: the \"preload\" attribute requires at least app descriptor version 1.4.0.",resolutionurls:[{text:'Manifest Model Preload',href:'https://openui5.hana.ondemand.com/#/topic/26ba6a5c1e5c417f8b21cce1411dba2c'}],check:function(i,c,s){var b=c.getComponents();var r=false;var M=false;var f=false;var F=false;Object.keys(b).forEach(function(d){var o=b[d].getManifest();var e=o['sap.ui5'].models||{};var D=o['sap.app'].dataSources;var g=o&&o['sap.ui.generic.app'];if(g){f=true;if(g.pages&&g.pages instanceof Array){var l=g.pages[0];if(l&&l.component&&l.component.name&&l.component.name==="sap.suite.ui.generic.template.ListReport"){F=true;}}else{for(var p in g.pages){if(p.indexOf("ListReport")==0){var l=g.pages[p];if(l&&l.component&&l.component.name&&l.component.name==="sap.suite.ui.generic.template.ListReport"){F=true;break;}}}}if(e[""]){var h=e[""];var j;if(h.dataSource){j=D[h.dataSource];}if((h.type&&h.type==="sap.ui.model.odata.v2.ODataModel")||j&&j.type==="OData"&&(j.settings===undefined||(j.settings&&(j.settings.odataVersion===undefined||j.settings.odataVersion&&j.settings.odataVersion==="2.0")))){r=true;if(h.preload===true){M=true;}}}}});if(f&&F&&(!r||!M)){i.addIssue({severity:a.Medium,details:"The used V2 ODataModels default model (\"\") doesn't make use of the preloading feature.",context:{id:"WEBPAGE"}});}}};return[m];},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.AnnotationHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.AnnotationHelper');sap.ui.define("sap/suite/ui/generic/template/ListReport/AnnotationHelper",[],function(){"use strict";var A={resolveMetaModelPath:function(c){var p=c.getObject();var m=c.getModel();var M=m.getProperty("/metaModel");return M.createBindingContext(p);},createWorkingContext:function(c){var p=c.getObject(),m=c.getModel(),M=m.getProperty("/metaModel"),e=M.getODataEntitySet(p.entitySet),E=M.getODataEntityType(e.entityType),a="",w={};a=E.$path+"/com.sap.vocabularies.UI.v1.PresentationVariant";w.presentationVariantQualifier="";w.presentationVariant=M.getObject(a);w.presentationVariantPath=a;if(w.presentationVariant&&w.presentationVariant.Visualizations){w.presentationVariant.Visualizations.forEach(function(d){var f="/"+d.AnnotationPath.slice(1);if(f.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1){a=E.$path+f;w.lineItem=M.getObject(a);w.lineItemPath=a;w.lineItemQualifier=a.split("#")[1]||"";}});}if(!w.lineItem){a=E.$path+"/com.sap.vocabularies.UI.v1.LineItem";w.lineItem=M.getObject(a);w.lineItemPath=a;w.lineItemQualifier="";}w.tableChartTabs=[];var s,v,i,I,V;v=p&&p.manifest&&p.manifest["sap.ui.generic.app"]&&p.manifest["sap.ui.generic.app"].pages&&p.manifest["sap.ui.generic.app"].pages[0].component&&p.manifest["sap.ui.generic.app"].pages[0].component.settings&&p.manifest["sap.ui.generic.app"].pages[0].component.settings.quickVariantSelectionX&&p.manifest["sap.ui.generic.app"].pages[0].component.settings.quickVariantSelectionX.variants;for(i in v){V={};s="";I={};I.key=v[i].key;I.variantAnnotationPath=v[i].annotationPath;I.variantQualifier=I.variantAnnotationPath.split("#")[1]||"";V=E[I.variantAnnotationPath];if(V&&V.PresentationVariant){var P;if(V.PresentationVariant.Path){var b=V.PresentationVariant.Path.split("@")[1];P=b&&E[b];I.presentationVariantQualifier=b.split("#")[1]||"";}else{P=V.PresentationVariant;}s=P.Visualizations&&P.Visualizations[0].AnnotationPath;}else if(V&&V.Visualizations){s=V.Visualizations[0].AnnotationPath;}if(s){var r="/"+s.slice(1);if(s.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1){I.smartControl="chart";I.chartAbsolutePath=E.$path+r;}else if(s.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1){I.smartControl="table";a=E.$path+r;I.lineItem=M.getObject(a);I.lineItemPath=a;I.lineItemQualifier=a.split("#")[1]||"";}}if(!(I.chartAbsolutePath||I.lineItemPath)){a=E.$path+"/com.sap.vocabularies.UI.v1.LineItem";I.lineItem=M.getObject(a);I.lineItemPath=a;I.lineItemQualifier="";}I.controlQualifier=s&&s.split("#")[1]||"";w.tableChartTabs.push(I);}m.setProperty("/workingContext",w);return"/workingContext";},checkIfSmartChart:function(e,t){var i=false,a,s,v;s=t.annotationPath;v=!!s&&e[s];if(v&&v.PresentationVariant&&v.PresentationVariant.Visualizations){a=v.PresentationVariant.Visualizations[0].AnnotationPath;}else if(v&&v.Visualizations){a=v.Visualizations[0].AnnotationPath;}if(a&&a.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1){i=true;}return i;},checkIfChartQualifier:function(w,t){return!!(A.getChartQualifier(w,t));},getChartQualifier:function(w,t){var c,i,k;for(i in w.tableChartTabs){k=w.tableChartTabs[i].key;if(k===t.key){c=w.tableChartTabs[i].controlQualifier;break;}}return c;},getPresentationVariantQualifier:function(w,t){var v,i,k;for(i in w.tableChartTabs){k=w.tableChartTabs[i].key;if(k===t.key){v=w.tableChartTabs[i].variantQualifier;break;}}return v;},getChartAnnotationPath:function(t){var c,m,o,i,T,v,c,C,b;m=t.getModel();var M=m.getProperty("/metaModel");o=m.getObject(t.sPath);T=m.getData("workingContext")["workingContext"].tableChartTabs;for(i in T){v=T[i].variantAnnotationPath;if(v===o.annotationPath){c=T[i].chartAbsolutePath;C=c+'/Actions';b=M.createBindingContext(C);return b;}}},checkIfChartNavigationIsEnabled:function(i,s,e){var t=i.showItemNavigationOnChart;if(!t){return false;}if(s&&s[0]&&s[0].entitySet===e&&(!s[0].navigation||s[0].navigation&&!s[0].navigation['display'])){return true;}return false;},setSizeCondensedCssClass:function(c){var C="sapUiSizeCompact",s="sapUiSizeCondensed",b;if(!c){return;}b=jQuery(document.body);if(b.hasClass(C)){return s;}},setLinkWrapping:function(c){var C="sapUiSizeCompact",b;if(!c){return true;}b=jQuery(document.body);if(b.hasClass(C)&&c){return false;}else{return true;}}};return A;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.controller.IappStateHandler')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.controller.IappStateHandler');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.generic.app.navigation.service.NavError');jQuery.sap.require('sap.ui.generic.app.navigation.service.SelectionVariant');jQuery.sap.require('sap.ui.comp.state.UIState');sap.ui.define("sap/suite/ui/generic/template/ListReport/controller/IappStateHandler",["jquery.sap.global","sap/ui/base/Object","sap/ui/generic/app/navigation/service/NavError","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ui/comp/state/UIState"],function(q,B,N,S,U){"use strict";var d="sap.suite.ui.generic.template.customData",a="sap.suite.ui.generic.template.genericData";var I=["INIT","DATA_SUITE","CANCEL","RESET","SET_VM_ID"];function n(o){if(o){for(var p in o){o[p]=null;}}}function f(o,O){var k=Object.keys(o);if(k.length!==Object.keys(O).length){return true;}for(var i=0;i<k.length;i++){var K=k[i];var p=o[K];var P=O[K];if(p.length!==P.length){return true;}for(var j=0;j<p.length;j++){if(p[j]!==P[j]){return true;}}}return false;}function g(s,c,o){var b=c.getOwnerComponent().getSmartVariantManagement();var r={appStateKey:"",urlParams:{},selectionVariant:"",tableVariantId:""};var e=false;var h=null;var A=Promise.resolve();var D=false;var j=false;var E=c.byId("editStateFilter");var k;var l=null;var m=null;s.oSmartFilterbar.setSuppressSelection(true);var p=(function(){var i;return function(){i=i||s.oSmartFilterbar.getNonVisibleCustomFilterNames();return i;};})();function t(){return D;}function u(){var T={};T[d]={};var V=[];var W=p();for(var i=0;i<W.length;i++){var X=W[i];if(s.oSmartFilterbar.isVisibleInFilterBarByName(X)){V.push(X);}}T[a]={suppressDataSelection:!D,visibleCustomFields:V};if(E){T[a].editStateFilter=E.getSelectedKey();}var Y=s.oMultipleViewsHandler.getContentForIappState();if(Y){var Z=Y.mode==="single"?"tableViewData":"tableTabData";T[a][Z]=Y.state;}c.getCustomAppStateDataExtension(T[d]);return T;}function v(){var T=JSON.stringify(s.oSmartFilterbar.getUiState().getSelectionVariant());var V=new S(T);var W=c.getVisibleSelectionsWithDefaults();for(var i=0;i<W.length;i++){if(!V.getValue(W[i])){V.addSelectOption(W[i],"I","EQ","");}}if(c.byId('template::PageVariant')&&c.byId('template::PageVariant').currentVariantGetModified()&&V.getID()){V.setID("");}var X={selectionVariant:V.toJSONString(),tableVariantId:(!b&&s.oSmartTable.getCurrentVariantId())||"",customData:u()};return X;}function w(){if(!j){return;}j=false;try{l=o.storeInnerAppStateWithImmediateReturn(v(),true);}catch(i){q.sap.log.error("ListReport.fnStoreCurrentAppStateAndAdjustURL: "+i);return;}if(l instanceof N){j=true;l=null;return;}l.promise.fail(function(T){q.sap.log.error("ListReport.fnStoreCurrentAppStateAndAdjustURL: Error when persisting appState"+T);});if(m===l.appStateKey){l=null;}else{o.replaceHash(l.appStateKey);}}function R(T,V){if(T&&T.editStateFilter!==undefined){if(E){E.setSelectedKey((T.editStateFilter===null)?0:T.editStateFilter);}}var W=T&&T.visibleCustomFields;if(W&&W.length>0){var X=s.oSmartFilterbar.getAllFilterItems();for(var i=0;i<X.length;i++){var Y=X[i];var Z=Y.getName();if(W.indexOf(Z)!==-1){Y.setVisibleInFilterBar(true);}}}D=V&&!(T&&T.suppressDataSelection);if(D){s.oSmartFilterbar.search();Q(D);}}function x(i){c.restoreCustomAppStateDataExtension(i||{});}function y(i,T){i=i||{};if(i.hasOwnProperty(d)&&i.hasOwnProperty(a)){x(i[d]);R(i[a],T);}else{if(i._editStateFilter!==undefined){R({editStateFilter:i._editStateFilter});delete i._editStateFilter;}x(i);}}function z(){return A.then(function(){if(r.appStateKey){return{"sap-iapp-state":[r.appStateKey]};}return r.urlParams;});}function C(i,T){if(e){return;}if(i||T!==D){D=T;if(!j){j=true;if(!s.oSmartFilterbar.isDialogOpen()){if(h){w();}else{setTimeout(w,0);}}}}}function F(T,V,W){s.oSmartFilterbar.setSuppressSelection(false);var X=T.appStateKey||"";if(e){return;}if(m===null){m=X;}else if(X!==m){return;}e=true;var Y=T.selectionVariant||"";var Z=(!b&&T.tableVariantId)||"";var $=(!X&&V)||{};if(!s.bWorkListEnabled){if((r.appStateKey!==X||r.selectionVariant!==Y||r.tableVariantId!==Z||f(r.urlParams,$))&&W!==sap.ui.generic.app.navigation.service.NavType.initial){if(!l||l.appStateKey!==X){var _=T&&T.bNavSelVarHasDefaultsOnly;if(T.oSelectionVariant&&r.selectionVariant!==Y){var a1=T.oSelectionVariant.getParameterNames().concat(T.oSelectionVariant.getSelectOptionsPropertyNames());for(var i=0;i<a1.length;i++){s.oSmartFilterbar.addFieldToAdvancedArea(a1[i]);}}var b1=new U({selectionVariant:T.oSelectionVariant.toJSONObject()});T.oUiState=b1;if(_&&s.oSmartFilterbar.isCurrentVariantStandard()){s.oSmartFilterbar.setUiState(b1,{bReplace:false,bStrictMode:false});}else if(!_||s.oSmartFilterbar.isCurrentVariantStandard()){s.oSmartFilterbar.clearVariantSelection();s.oSmartFilterbar.clear();s.oSmartFilterbar.setUiState(b1,{bReplace:true,bStrictMode:false});}if(Z!==r.tableVariantId){s.oSmartTable.setCurrentVariantId(Z);}T.customData=T.customData||{};var c1=s.oMultipleViewsHandler.getMode();if(c1){var d1=c1==="single"?"tableViewData":"tableTabData";if(T.customData[a]&&T.customData[a][d1]){s.oMultipleViewsHandler.restoreFromIappState(T.customData[a][d1]);}}y(T.customData,true);}r={appStateKey:X,urlParams:$,selectionVariant:Y,tableVariantId:Z};}}if(h){h();h=null;}if(W!==sap.ui.generic.app.navigation.service.NavType.iAppState&&!D){var e1=(W===sap.ui.generic.app.navigation.service.NavType.xAppState||W===sap.ui.generic.app.navigation.service.NavType.URLParams)&&!T.bNavSelVarHasDefaultsOnly;D=e1||s.bLoadListAndFirstEntryOnStartup||k||s.oSmartFilterbar.isCurrentVariantExecuteOnSelectEnabled()||s.oMultipleViewsHandler.getEnableAutoBinding();if(D){s.oSmartFilterbar.search();Q(D);}}l=null;e=false;}function P(){if(!h){A=new Promise(function(T){h=T;});}var i=new Promise(function(T,V){var W=o.parseNavigation();W.done(function(X,Y,Z){F(X,Y,Z);T();});W.fail(function(X,Y,Z){q.sap.log.warning(X.getErrorCode(),"app state could not be parsed - continuing with empty state","sap.suite.ui.generic.template.ListReport.controller.IappStateHandler");F({},Y,sap.ui.generic.app.navigation.service.NavType.initial);T();});});return i;}function G(){var i=v();s.oSmartFilterbar.setFilterData({_CUSTOM:i.customData});}function H(){C(true,D);}function J(i){var T=i.getParameter("context");var V=s.oSmartFilterbar.getFilterData();if(V._CUSTOM!==undefined){y(V._CUSTOM);}else{var W=u();n(W[d]);n(W[a]);y(W);}if(I.indexOf(T)<0){D=i.getParameter("executeOnSelect");C(true,D);}}function K(){if(!b){C(true,D);}}function L(){if(!b){C(true,D);}}function M(i){var T=i.getParameter("arguments");var V=T&&T["?query"];m=(V&&V["sap-iapp-state"])||"";if(l){if(l.appStateKey!==m){q.sap.log.error("ListReport.fnStoreCurrentAppStateAndAdjustURL: Got AppstateKey "+m+" expected "+l.appStateKey);return false;}P();return true;}return false;}function O(){k=s.oSmartTable.getEnableAutoBinding();s.oSmartFilterbar.attachFiltersDialogClosed(w);}function Q(D){if(c&&c.getOwnerComponent&&c.getOwnerComponent().getModel){var T=c.getOwnerComponent().getModel("_templPriv");if(D){T.setProperty("/listReport/isHeaderExpanded",false);}else{T.setProperty("/listReport/isHeaderExpanded",true);}}}s.getCurrentAppState=v;return{areDataShownInTable:t,parseUrlAndApplyAppState:P,getUrlParameterInfo:z,changeIappState:C,onSmartFilterBarInitialise:O,onBeforeSFBVariantFetch:G,onAfterSFBVariantSave:H,onAfterSFBVariantLoad:J,onAfterTableVariantSave:K,onAfterApplyTableVariant:L,isStateChange:M};}return B.extend("sap.suite.ui.generic.template.ListReport.controller.IappStateHandler",{constructor:function(s,c,o){q.extend(this,g(s,c,o));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.controller.MultipleViewsMultipleTablesModeHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.controller.MultipleViewsMultipleTablesModeHelper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/ListReport/controller/MultipleViewsMultipleTablesModeHelper",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(Q,s,c,t,S,I){var d={};function a(i){return d[i.getId()]||false;}function b(i,D){d[i.getId()]=D;}function e(j){for(var i in d){if(i!==j.getId()){d[i]=true;}}}function f(E,D){var j;var p=D||false;for(var i in I){j=I[i];if(j.implementingControl.getProperty("entitySet")===E||E===undefined){d[j.id]=p;}}}function o(E){var i,j;i=E.getSource();j=E.getParameter("itemContexts")&&E.getParameter("itemContexts")[0];t.oCommonEventHandlers.onListNavigate(i,s,j);}function h(E){var C,i;C=E.getSource();i=C.getParent();s.updateControlOnSelectionChange(i);}function r(E){var C,i;i=E.getSource();C=i.getChart();C.attachSelectData(h);C.attachDeselectData(h);}function k(i){var K,T,v={};for(K in I){T=I[K].implementingControl;v[T.getId()]=T.getCurrentVariantId()||"";}return{selectedTab:i,tableVariantIds:v};}function l(G){var j,T,v;if(G){if(G.tableVariantIds){for(j in I){T=I[j].implementingControl;v=G.tableVariantIds[T.getId()];if(v){T.setCurrentVariantId(v);}}}return G.selectedTab;}}function m(E,i){var C,j,K;C=E.getSource();j=C.getId();for(K in I){if(j===I[K].id){var p=t.oCommonUtils.getSelectionVariantFilters(C);i(K,C,p);}}b(C,false);}function n(N){s.oSmartTable=I[N].implementingControl;}(function(){var i,C,j,T,p,K,u,v;j=c.byId("template::IconTabBar");T=j.getItems();for(i=0;i<T.length;i++){p=T[i];K=p.getKey();if(i===0){S(K);}u=c.byId("listReport-"+K);if(!s.oSmartTable){s.oSmartTable=u;}v={id:u.getId()};I[K]=v;}s.oSmartFilterbar.attachSearch(function(E){C=s.oSmartTable;if(t.oCommonUtils.isSmartChart(C)){C.rebindChart(E);}else if(t.oCommonUtils.isSmartTable(C)){C._reBindTable(E);}e(s.oSmartTable);});})();return{fnRegisterToChartEvents:r,onDetailsActionPress:o,getContentForIappState:k,getSelectedKeyAndRestoreFromIappState:l,onSelectedKeyChanged:n,isTableDirty:a,setTableDirty:b,init:m,setTablesToDirtyByEntitySet:f};}return B.extend("sap.suite.ui.generic.template.ListReport.controller.MultipleViewsMultipleTablesModeHelper",{constructor:function(Q,s,c,t,S,i){q.extend(this,g(Q,s,c,t,S,i));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.controller.MultipleViewsSingleTableModeHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.controller.MultipleViewsSingleTableModeHelper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/ListReport/controller/MultipleViewsSingleTableModeHelper",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(s,c,t,S){function a(d){return{selectedKey:d};}function b(G){if(G){return G.selectedKey;}}function I(e,d){var o=c.byId("template::SegmentedButton")||c.byId("template::VariantSelect");var p=o.getItems();for(var i=0;i<p.length;i++){var f=p[i];var k=f.getKey();var h=t.oCommonUtils.getSelectionVariantFilters(s.oSmartTable,f);d(k,f,h);}S(p[0].getKey());}return{getContentForIappState:a,getSelectedKeyAndRestoreFromIappState:b,init:I};}return B.extend("sap.suite.ui.generic.template.ListReport.controller.MultipleViewsSingleTableModeHelper",{constructor:function(Q,s,c,t,S){q.extend(this,g(s,c,t,S));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.extensionAPI.NonDraftTransactionController')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.extensionAPI.NonDraftTransactionController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/ListReport/extensionAPI/NonDraftTransactionController",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(t,c,s){var e="none";function E(){e="none";}return{edit:function(C){if(!C){throw new Error("Nothing to edit provided");}if(e!=="none"){throw new Error("Attempt to edit multiple contexts ("+C+")");}if(c.getView().getModel().hasPendingChanges()){throw new Error("Attempt to edit while already pending changes exist");}e="editing";},cancel:function(){if(e!=="editing"){throw new Error("Nothing edited");}t.oServices.oTransactionController.resetChanges();E();},save:function(){var f=function(){if(e!=="editing"){throw new Error("Nothing edited");}e="saving";var P=t.oServices.oTransactionController.triggerSubmitChanges();P.then(E,function(){e="editing";});return P;};var p={};p=q.extend(true,{busy:{set:true,check:true},dataloss:{popup:false,navigation:false}},p);return t.oCommonUtils.securedExecution(f,p,s);}};}return B.extend("sap.suite.ui.generic.template.ListReport.extensionAPI.NonDraftTransactionController",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.extensionAPI.DraftTransactionController')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.extensionAPI.DraftTransactionController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/extensionAPI/DraftTransactionController",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(t,c){return{attachAfterActivate:function(f){t.oComponentUtils.attach(c,"AfterActivate",f);},detachAfterActivate:function(f){t.oComponentUtils.detach(c,"AfterActivate",f);},attachAfterCancel:function(f){t.oComponentUtils.attach(c,"AfterCancel",f);},detachAfterCancel:function(f){t.oComponentUtils.detach(c,"AfterCancel",f);},attachAfterDelete:function(f){t.oComponentUtils.attach(c,"AfterDelete",f);},attachAfterLineItemDelete:function(f){t.oComponentUtils.attach(c,"AfterLineItemDelete",f);},detachAfterDelete:function(f){t.oComponentUtils.detach(c,"AfterDelete",f);},saveDraft:function(f){t.oServices.oApplication.markCurrentDraftAsModified();t.oServices.oApplicationController.addOperationToQueue(f,{draftSave:true});},discardDraft:function(){return t.oCommonEventHandlers.discardDraftWithoutDialog();},executeSideEffects:function(s){s=s||{};t.oServices.oApplicationController.executeSideEffects(c.getView().getBindingContext(),s.sourceProperties,s.sourceEntities,false);}};}return B.extend("sap.suite.ui.generic.template.ObjectPage.extensionAPI.DraftTransactionController",{constructor:function(t,c){q.extend(this,g(t,c));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.extensionAPI.NonDraftTransactionController')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.extensionAPI.NonDraftTransactionController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/extensionAPI/NonDraftTransactionController",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(t,c,s){return{attachAfterSave:function(f){t.oComponentUtils.attach(c,"AfterSave",f);},detachAfterSave:function(f){t.oComponentUtils.detach(c,"AfterSave",f);},attachAfterDelete:function(f){t.oComponentUtils.attach(c,"AfterDelete",f);},attachAfterLineItemDelete:function(f){t.oComponentUtils.attach(c,"AfterLineItemDelete",f);},detachAfterDelete:function(f){t.oComponentUtils.detach(c,"AfterDelete",f);},attachAfterCancel:function(f){t.oComponentUtils.attach(c,"AfterCancel",f);},detachAfterCancel:function(f){t.oComponentUtils.detach(c,"AfterCancel",f);},registerUnsavedDataCheckFunction:function(h){s.aUnsavedDataCheckFunctions.push(h);}};}return B.extend("sap.suite.ui.generic.template.ObjectPage.extensionAPI.NonDraftTransactionController",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.view.fragments.DummyBlock')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.view.fragments.DummyBlock');jQuery.sap.require('sap.uxap.BlockBase');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/view/fragments/DummyBlock",['sap/uxap/BlockBase'],function(B){"use strict";var D=B.extend("sap.suite.ui.generic.template.ObjectPage.view.fragments.DummyBlock",{metadata:{views:{Collapsed:{viewName:"sap.suite.ui.generic.template.ObjectPage.view.fragments.DummyBlock",type:"XML"},Expanded:{viewName:"sap.suite.ui.generic.template.ObjectPage.view.fragments.DummyBlock",type:"XML"}}}.fragments});return D;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.app.blankAnalyticalListPage.Component')){jQuery.sap.require('sap.ui.generic.app.AppComponent');jQuery.sap.declare("sap.suite.ui.generic.template.app.blankAnalyticalListPage.Component");sap.ui.generic.app.AppComponent.extend("sap.suite.ui.generic.template.app.blankAnalyticalListPage.Component",{metadata:{manifest:"json"}});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.extensionAPI.NavigationController')){jQuery.sap.declare('sap.suite.ui.generic.template.extensionAPI.NavigationController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/extensionAPI/NavigationController",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(t,c,s){return{navigateExternal:function(o,p){var m=c.getOwnerComponent().getAppComponent().getManifestEntry("sap.app");var O=m.crossNavigation.outbounds[o];if(!O){q.sap.log.error("navigateExternal: mandatory parameter 'Outbound' is missing, or different from manifest entry");return;}if(p){O.parameters=p;}else{}t.oCommonUtils.navigateExternal(O,s);},navigateInternal:function(C,n){t.oCommonUtils.navigateToContext(C,n);},getCurrentKeys:function(){return t.oComponentUtils.getCurrentKeys();}};}return B.extend("sap.suite.ui.generic.template.extensionAPI.NavigationController",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.extensionAPI.UIMode')){jQuery.sap.declare('sap.suite.ui.generic.template.extensionAPI.UIMode');sap.ui.define("sap/suite/ui/generic/template/extensionAPI/UIMode",[],function(){"use strict";var U={Create:"Create",Display:"Display",Edit:"Edit"};return U;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.fragments.MessagePage.controller')){jQuery.sap.declare('sap.suite.ui.generic.template.fragments.MessagePage.controller');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/fragments/MessagePage.controller",["sap/ui/core/mvc/Controller"],function(C){"use strict";return C.extend("sap.suite.ui.generic.template.fragments.MessagePage",{navButtonPress:function(){window.history.back();}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.AnnotationHelper')){(function(){"use strict";jQuery.sap.require('sap.ui.comp.smartfield.SmartField');jQuery.sap.declare("sap.suite.ui.generic.template.js.AnnotationHelper");function E(e,m){var o=m[e];var b=o&&o["sap.ui.generic.app"];return!!(b&&b.enableLazyLoading);}var a={getBindingForHiddenPath:function(p){return"{= !${"+p+"} }";},buildDeleteButtonEnablementExpression:function(f,t){var b=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f)+"::deleteEntry";var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);if(s){b=b.concat(s);}return"{= !!${_templPriv>/generic/controlProperties/"+b+"/enabled}}";},tabItemHasPresentationVariant:function(e,v){var V=e[v];if(V.PresentationVariant||V.Visualizations||V.SortOrder){return true;}},getPresentationVariant:function(v,e){if(v.Visualizations||v.SortOrder){return v;}else if(v.PresentationVariant&&v.PresentationVariant.Path){return e[v.PresentationVariant.Path.replace('@','')];}else if(v.PresentationVariant){return sap.suite.ui.generic.template.js.AnnotationHelper.getPresentationVariant(v.PresentationVariant);}},getPresentationVariantVisualisation:function(e,v){var V=e[v];var p=sap.suite.ui.generic.template.js.AnnotationHelper.getPresentationVariant(V,e);if(p.Visualizations){return p.Visualizations[0].AnnotationPath.split('#')[1];}},getPresentationVariantSortOrder:function(e,v){var V=e[v];var p=sap.suite.ui.generic.template.js.AnnotationHelper.getPresentationVariant(V,e);if(p.SortOrder){return sap.suite.ui.generic.template.js.AnnotationHelper.getSortOrder(p.SortOrder);}},getSmartTableId:function(t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);var r="listReport";if(s){r=r.concat(s);}return r;},getAnalyticalTableId:function(t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);var r="analyticalTable";if(s){r=r.concat(s);}return r;},getGridTableId:function(t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);var r="GridTable";if(s){r=r.concat(s);}return r;},getTreeTableId:function(t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);var r="TreeTable";if(s){r=r.concat(s);}return r;},getRowActionsId:function(t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);var r="rowActions";if(s){r=r.concat(s);}return r;},getResponsiveTableId:function(t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);var r="responsiveTable";if(s){r=r.concat(s);}return r;},getAddEntryId:function(t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);var r="addEntry";if(s){r=r.concat(s);}return r;},getDeleteEntryId:function(t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);var r="deleteEntry";if(s){r=r.concat(s);}return r;},getShowDetailsId:function(t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);var r="showDetails";if(s){r=r.concat(s);}return r;},getDraftObjectMarkerId:function(t){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);var r="DraftObjectMarker";if(s){r=r.concat(s);}return r;},getBreakoutActionButtonId:function(c,t){if(c.id){var s=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);var r=c.id;if(s){r=r.concat(s);}return r;}},getIconTabFilterKey:function(t){if(t){if(t.key){return t.key;}else{return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(t.annotationPath);}}},getSuffixFromIconTabFilterKey:function(t){var k=sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterKey(t);if(k){return"-".concat(k);}else{return"";}},getIconTabFilterText:function(i,m){var M=i.getModel();var e=M.oData.entityType;var o=M.oData.metaModel.getODataEntityType(e);var s=o[m.annotationPath];if(s&&s.Text){return s.Text.String;}},getAltTextForImage:function(d){if(d["com.sap.vocabularies.Common.v1.Text"]){return d["com.sap.vocabularies.Common.v1.Text"].String;}},buildAnnotatedActionButtonEnablementExpression:function(i,d,f,e,I,t,c){var F,b,A,m;A=d&&d.Action&&d.Action.String;if(A){b=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartForDatafieldActionButton(d,f,t,c);if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(!d.RequiresContext||d.RequiresContext.Bool!=="false"){return"{= !!${_templPriv>/generic/controlProperties/"+b+"/enabled}}";}}else if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){m=i.getInterface(0).getModel();F=m.getODataFunctionImport(A);if(!F){jQuery.sap.log.error("The function import "+A+" is not defined in the metadata. Buttons that call this function import will not behave as expected.");}else if(F["sap:action-for"]&&F["sap:action-for"]!==""&&F["sap:action-for"]!==" "){return"{= !!${_templPriv>/generic/controlProperties/"+b+"/enabled}}";}}return true;}},getLabelForDFwithIBN:function(i,d,e,g){var m,t,o,p,r;if(d.Label){return d.Label.String;}else{m=i.getInterface(0).getModel();if(m&&e){if(g&&g.Target&&g.Target.AnnotationPath){t=sap.suite.ui.generic.template.js.AnnotationHelper.getTargetEntitySet(m,e,g.Target.AnnotationPath);o=m.getODataEntityType(t.entityType);}else{o=m.getODataEntityType(e.entityType);}if(d.Value&&d.Value.Path){p=m.getODataProperty(o,d.Value.Path);r=p["sap:label"]||(p["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return r;}}}},getLinkTextForDFwithIBN:function(i,d,e,g){var o,t,p,r;var m=i.getInterface(0).getModel();if(m&&e){if(g&&g.Target&&g.Target.AnnotationPath){t=sap.suite.ui.generic.template.js.AnnotationHelper.getTargetEntitySet(m,e,g.Target.AnnotationPath);o=m.getODataEntityType(t.entityType);}else{o=m.getODataEntityType(e.entityType);}if(d.Value&&d.Value.Path){p=m.getODataProperty(o,d.Value.Path)||{};r=p["sap:text"]||(p["com.sap.vocabularies.Common.v1.Text"]||d.Value).Path||"";return"{"+r+"}";}}},getTargetEntitySet:function(m,s,A){var n,N,e,o;n=A.split('/');if(n.length>1){N=n[0];}if(N){e=m.getODataEntityType(s.entityType);o=m.getODataAssociationSetEnd(e,N);if(o&&o.entitySet){return m.getODataEntitySet(o.entitySet);}}return s;},getApplicablePathForChartToolbarActions:function(I,c,e){var m=I.getInterface(0).getModel();var b=m.getODataEntityType(e);var A=(c&&c.Actions)||[];var f,F,o,d=[],g=[],s;for(var i=0;i<A.length;i++){if(A[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&(!A[i].Inline||A[i].Inline.Bool!=="true")&&(!A[i].Determining||A[i].Determining.Bool!=="true")){f=A[i].Action&&A[i].Action.String;F=m.getODataFunctionImport(f);if(F){d.push(F);}}}for(var i=0;i<d.length;i++){F=d[i];if(F&&F["sap:action-for"]&&F["sap:action-for"]!==""&&F["sap:action-for"]!==" "&&F["sap:applicable-path"]&&F["sap:applicable-path"]!==""&&F["sap:applicable-path"]!==" "){s=F["sap:applicable-path"];o=m.getODataProperty(b,s);if(o&&o["sap:aggregation-role"]==="dimension"){g.push(s);}else{jQuery.sap.log.error("AnnotationHelper.js - method getApplicablePathForChartToolbarActions: the applicable-path "+s+" is either pointing to an entity type property which doesn't exist or does not have 'sap:aggregation-role' set to to 'dimension'.");}}}if(g.length>0){return g.join();}},buildBreadCrumbExpression:function(c,t,T){var b,B=sap.ui.model.odata.AnnotationHelper.format(c,t);if(t&&t.Path&&T&&T.String){var s=T.String.replace(/'/g,"\\'");b="{= $"+B+" ? $"+B+" : '"+s+"' }";return b;}else{if(!B){return T&&T.String||"[[no title]]";}return B;}},buildRatingIndicatorSubtitleExpression:function(s){if(s){return"{parts: [{path: '"+s.Path+"'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatRatingIndicatorSubTitle'}";}},formatRatingIndicatorSubTitle:function(s){if(s){var r=this.getModel("i18n").getResourceBundle();if(this.getCustomData().length>0){return r.getText("RATING_INDICATOR_SUBTITLE",[s,this.data("Subtitle")]);}else{var S=s>1?r.getText("RATING_INDICATOR_SUBTITLE_LABEL_PLURAL"):r.getText("RATING_INDICATOR_SUBTITLE_LABEL");return r.getText("RATING_INDICATOR_SUBTITLE",[s,S]);}}},buildRatingIndicatorFooterExpression:function(v,t){if(t){return"{parts: [{path: '"+v.Path+"'}, {path: '"+t.Path+"'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatRatingIndicatorFooterText'}";}return"{parts: [{path: '"+v.Path+"'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatRatingIndicatorFooterText'}";},formatRatingIndicatorFooterText:function(v,t){if(v){var r=this.getModel("i18n").getResourceBundle();if(t){return r.getText("RATING_INDICATOR_FOOTER",[v,t]);}else if(this.getCustomData().length>0){return r.getText("RATING_INDICATOR_FOOTER",[v,this.data("Footer")]);}else{var R=sap.m.RatingIndicator.getMetadata().getPropertyDefaults().maxValue;return r.getText("RATING_INDICATOR_FOOTER",[v,R]);}}},buildRatingIndicatorAggregateCountExpression:function(v){return"{parts: [{path: '"+v.Path+"'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatRatingIndicatorAggregateCount'}";},formatRatingIndicatorAggregateCount:function(v){var r=this.getModel("i18n").getResourceBundle();var t;if(v){t=r.getText("RATING_INDICATOR_AGGREGATE_COUNT",[v]);}else if(this.getCustomData().length>0){t=r.getText("RATING_INDICATOR_AGGREGATE_COUNT",[this.data("AggregateCount")]);}else{t="";}return t;},getEditActionButtonVisibility:function(i,r,e,p){var m=i.getInterface(0).getModel();if(sap.suite.ui.generic.template.js.AnnotationHelper._areUpdateRestrictionsValid(m,e,r)){var u="!${ui>/editable}";if(r){if(r.Updatable.Path){sap.suite.ui.generic.template.js.AnnotationHelper._actionControlExpand(i,r.Updatable.Path,e);return"{= ${"+r.Updatable.Path+"} ? "+u+" : false}";}else if(r.Updatable.Bool==="false"&&!p){return false;}}return"{="+u+"}";}else{return false;}},getDeleteActionButtonVisibility:function(i,r,e,I){var m=i.getInterface(0).getModel();if(sap.suite.ui.generic.template.js.AnnotationHelper.areDeleteRestrictionsValid(m,e,r)){if(I){var u="!${ui>/editable}";}else{var u="!${ui>/createMode}";}if(r){if(r.Deletable.Path){sap.suite.ui.generic.template.js.AnnotationHelper._actionControlExpand(i,r.Deletable.Path,e);return"{= ${"+r.Deletable.Path+"} ? "+u+" : false}";}else if(r.Deletable.Bool==="false"){return false;}}return"{="+u+"}";}else{return false;}},getSubObjPageDeleteActionButtonVisibility:function(i,r,e,I){var m=i.getInterface(0).getModel();var u;if(sap.suite.ui.generic.template.js.AnnotationHelper.areDeleteRestrictionsValid(m,e,r)){if(I==true){u="${ui>/editable}";}else{u="!${ui>/createMode}";}if(r){if(r.Deletable.Path){sap.suite.ui.generic.template.js.AnnotationHelper._actionControlExpand(i,r.Deletable.Path,e);return"{= ${"+r.Deletable.Path+"} ? "+u+" : false}";}else if(r.Deletable.Bool==="false"){return false;}}return"{="+u+"}";}else{return false;}},getIdForMoreBlockContent:function(f){if(f["com.sap.vocabularies.UI.v1.PartOfPreview"]&&f["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="false"){return"::MoreContent";}},checkMoreBlockContent:function(f){return sap.suite.ui.generic.template.js.AnnotationHelper.checkFacetContent(f,false);},checkBlockContent:function(f){return sap.suite.ui.generic.template.js.AnnotationHelper.checkFacetContent(f,true);},checkFacetContent:function(f,b){var p;var i=f.getInterface(0);var F=f.getModel().getProperty("",f);var c=f.getPath().split("/Facets");var C=i.getModel().getContext(c[0]);if(i.getModel().getProperty('',C).RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){return C.getPath();}else{if(!F){return;}for(var d=0;d<F.length;d++){if(!b){if(F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"]&&F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="false"){p=i.getPath()+"/"+d;break;}}else{if(F[d].RecordType!=="com.sap.vocabularies.UI.v1.ReferenceFacet"||(!F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"]||F[d]["com.sap.vocabularies.UI.v1.PartOfPreview"].Bool==="true")){p=i.getPath()+"/"+d;break;}}}}return p;},isInlineCreate:function(f,s){var S=s[sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f)];return!!(S&&S.createMode&&S.createMode==="inline");},determineTableType:function(f,s){var S;if(s&&s.sections){S=s.sections[sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f)];}return(S&&(((S.tableType||S.treeTable))||(s&&s.tableType)));},isImageUrl:function(p){var s=p["com.sap.vocabularies.UI.v1.IsImageURL"]||p["com.sap.vocabularies.UI.v1.IsImageUrl"];if(s&&s.Bool&&s.Bool==="false"){return false;}else if(s){return true;}return false;},_addFullPathToImageUrlIfNeeded:function(i,A){if(!i){return"";}if((i.substring(0,1)==="/")||(i.substring(0,11)==="sap-icon://")||(i.substring(0,7)==="http://")||(i.substring(0,8)==="https://")){return i;}else{return jQuery.sap.getModulePath(A,"/")+i;}},formatImageUrl:function(i,I,A,e){if(I&&(I.Path||I.Apply)&&e){a.formatWithExpandSimple(i,I);}if(I&&I.Path){return"{parts: [{path: '"+I.Path+"'}, {path: '_templPrivGlobal>/generic/appComponentName'}], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatImageUrlRuntime'}";}else if(I&&I.String){return a._addFullPathToImageUrlIfNeeded(I.String,A);}else if(I&&I.Apply){I.Apply.Parameters[0].Value=a._addFullPathToImageUrlIfNeeded(I.Apply.Parameters[0].Value,A);return sap.ui.model.odata.AnnotationHelper.format(i,I);}else{return"";}},formatImageOrTypeUrl:function(i,I,t,A,e){var o=null;if(I){o=I;}else{o=t;}return a.formatImageUrl(i,o,A,e);},getPathWithExpandFromHeader:function(i,e,n,I,t){var b=[],N;if((I||t)){var i=i.getInterface(0);var m=i.getModel();var o=m.getODataEntityType(e.entityType);var c=null;if(I){c=I;}else{c=t;}if(c&&c.Path&&o){var s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,o,c.Path);if(s){b.push(s);}}}if(b.length>0){if(b.length>1){b=b.filter(function(d,f,g){return f==g.indexOf(d);});}N="{ path : '"+n+"', parameters : { expand : '"+b.join(',')+"'} }";}else{N="{ path : '"+n+"' }";}if(N==="{}"){N="";}return N;},disableSemanticObjectLinksOnPopups:function(q,d){var i="";if(q&&q.ignoredFields&&d&&d.Value&&d.Value.Path){if(q.ignoredFields[d.Value.Path]){i=d.Value.Path;}}return i;},formatImageUrlRuntime:function(i,A){return a._addFullPathToImageUrlIfNeeded(i,A);},formatHeaderImage:function(i,h,A){if(h.ImageUrl){return a.formatImageUrl(i,h.ImageUrl,A,true);}else if(h.TypeImageUrl){return a.formatImageUrl(i,h.TypeImageUrl,A,true);}else{return"";}},matchesBreadCrumb:function(I,c,p){if(p){var s=p.split("/");var e,o,A;if(s.length>0){var m=I.getInterface(0).getModel();var b=s[0];for(var i=0;i<s.length;i++){if(i>0){e=m.getODataEntitySet(b);o=m.getODataEntityType(e.entityType);A=m.getODataAssociationSetEnd(o,s[i]);b=A.entitySet;}if((i+1)===s.length){if(b===c.name){return true;}else{return false;}}}}}},showFullScreenButton:function(r,f){if(r&&f){var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(r.component&&r.component.settings&&r.component.settings.sections&&r.component.settings.sections[F]&&r.component.settings.sections[F].tableMode==="FullScreenTable"){return true;}}return false;},getPersistencyKeyForSmartTable:function(r){return"listReportFloorplanTable";},getPersistencyKeyForDynamicPageTitle:function(r){return"listReportDynamicPageTitle";},getCreateNavigationIntent:function(l,s,A){return sap.suite.ui.generic.template.js.AnnotationHelper.getSubObjectPageIntent(l,s,A,'create');},getDisplayNavigationIntent:function(l,s,A){return sap.suite.ui.generic.template.js.AnnotationHelper.getSubObjectPageIntent(l,s,A,'display');},getSubObjectPageIntent:function(l,s,A,m,h){var n;if(A){n=A.split("/")[0];}if(l&&s&&s.length>0){if(n){for(var i=0;i<s.length;i++){if(l===s[i].entitySet&&n===s[i].navigationProperty&&s[i].navigation&&s[i].navigation[m]){if(h){if(s[i].component&&s[i].component.settings&&s[i].component.settings.hideChevronForUnauthorizedExtNav){return s[i].navigation[m].target;}}else{return s[i].navigation[m].target;}}}}else{for(var i=0;i<s.length;i++){if(l===s[i].entitySet&&s[i].navigation&&s[i].navigation[m]){if(h){if(s[i].component&&s[i].component.settings&&s[i].component.settings.hideChevronForUnauthorizedExtNav){return s[i].navigation[m].target;}}else{return s[i].navigation[m].target;}}}}}},extensionPointFragmentExists:function(f,F){var i=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(i===F){return true;}else{return false;}},containsFormWithBreakoutAction:function(f,i){var c=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(c===i){if(f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&f.Target&&f.Target.AnnotationPath&&f.Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")!=-1){return true;}}return false;},formatWithExpandSimple:function(i,d,e){var b=[],s,o;var m=i&&i.getModel&&i.getModel();if(!m){i=i.getInterface(0);m=i.getModel();}if(e){o=m.getODataEntityType(e.entityType);}else{var M=/^(\/dataServices\/schema\/\d+\/entityType\/\d+)(?:\/|$)/.exec(i.getPath());if(M&&M.length&&M[0]){var c=m.getProperty(M[0]);var n=m.getODataEntityContainer().namespace;o=m.getODataEntityType(n+'.'+c.name);}}if(o){if(d&&d.Path){s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,o,d.Path);if(s){b.push(s);}}else if(d&&d.Apply&&d.Apply.Name==="odata.concat"){d.Apply.Parameters.forEach(function(P){if(P.Type==="Path"){s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,o,P.Value);if(s){if(b.indexOf(s)===-1){b.push(s);}}}});}if(b.length>0){var p=i.getSetting("preprocessorsData");if(p){var r=p.rootContextExpand||[];for(var j=0;j<b.length;j++){if(r.indexOf(b[j])===-1){r.push(b[j]);}}p.rootContextExpand=r;}}}return sap.ui.model.odata.AnnotationHelper.format(i,d);},formatWithExpand:function(i,d,e){sap.suite.ui.generic.template.js.AnnotationHelper.getNavigationPathWithExpand(i,d,e);i=i.getInterface(0);sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpandSimple(i,d,e);return sap.ui.model.odata.AnnotationHelper.format(i,d);},_getNavigationPrefix:function(m,e,p){var s="";var P=p.split("/");if(P.length>1){for(var i=0;i<(P.length-1);i++){var A=m.getODataAssociationEnd(e,P[i]);if(A){e=m.getODataEntityType(A.type);if(s){s=s+"/";}s=s+P[i];}else{return s;}}}return s;},getCurrentPathWithExpand:function(i,c,e,n){i=i.getInterface(0);var b=[],N;var m=i.getModel();var o=m.getODataEntitySet(e.name||'');var r=sap.ui.model.odata.AnnotationHelper.resolvePath(m.getContext(i.getPath()));var d=m.getODataEntityType(e.entityType);b=sap.suite.ui.generic.template.js.AnnotationHelper.getFacetExpand(r,m,d,o);if(b.length>0){N="{ path : '"+n+"', parameters : { expand : '"+b.join(',')+"'} }";}else{N="{ path : '"+n+"' }";}if(N==="{}"){N="";}return N;},getCurrentPathWithExpandForContact:function(i,c,e,n){var b=[],N;i=i.getInterface(0);var m=i.getModel();var r=sap.ui.model.odata.AnnotationHelper.resolvePath(m.getContext(i.getPath()));var o=m.getODataEntityType(e.entityType);b=sap.suite.ui.generic.template.js.AnnotationHelper.getFacetExpandForContact(r,m,o);if(b.length>0){N="{ path : '"+n+"', parameters : { expand : '"+b.join(',')+"'} }";}else{N="{ path : '"+n+"' }";}if(N==="{}"){N="";}return N;},getFacetExpandForContact:function(r,m,e){var b=[],f;var g=function(p){if(p){var s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,p);if(s){if(b.indexOf(s)===-1){b.push(s);}}}};if(r&&r.indexOf("com.sap.vocabularies.Communication.v1.Contact")>-1){f=m.getObject(r)||{};for(var i in f){var p;var F=f[i];if(F&&F.Path){p=F.Path;g(p);}else if(Object.prototype.toString.call(F)==='[object Array]'){for(var j in F){var A=F[j];if(A&&A.uri&&A.uri.Path){p=A.uri.Path;}if(A&&A.address&&A.address.Path){p=A.address.Path;}g(p);}}}}return b;},getNavigationPathWithExpand:function(i,c,e){i=i.getInterface(0);var b=[];var m=i.getModel();var o=m.getODataEntitySet(e.name||'');var r=sap.ui.model.odata.AnnotationHelper.resolvePath(m.getContext(i.getPath()));var n=sap.ui.model.odata.AnnotationHelper.getNavigationPath(i,c);var N=n.replace("{","").replace("}","");if(N){var d=m.getODataEntityType(o.entityType);var A=m.getODataAssociationSetEnd(d,N);if(A&&A.entitySet){o=m.getODataEntitySet(A.entitySet);}}else{var d=m.getODataEntityType(e.entityType);}b=sap.suite.ui.generic.template.js.AnnotationHelper.getFacetExpand(r,m,d,o);if(b.length>0){if(N===""){var p=i.getSetting("preprocessorsData");if(p){var R=p.rootContextExpand||[];for(var j=0;j<b.length;j++){if(R.indexOf(b[j])===-1){R.push(b[j]);}}p.rootContextExpand=R;}}else{n="{ path : '"+N+"', parameters : { expand : '"+b.join(',')+"'} }";}}if(n==="{}"){n="";}return n;},getFacetExpand:function(r,m,o,b){var d=[],c=[],f,F=[];if(r){F=m.getObject(r)||[];}F=F.Data||F;var g=function(p,I){var s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,o,p);if(s){if(c.indexOf(s)===-1){c.push(s);}}if(I){try{d=sap.ui.comp.smartfield.SmartField.getSupportedAnnotationPaths(m,b,p,true)||[];}catch(e){d=[];}for(var i=0;i<d.length;i++){if(c.indexOf(d[i])===-1){c.push(d[i]);}}}};var A=function(p){if(p.Type==="LabeledElement"){g(p.Value.Path);}else if(p.Type==="Path"){g(p.Value);}};for(var i=0;i<F.length;i++){f=F[i];if(f.Value&&f.Value.Path){g(f.Value.Path,true);}if(f.Value&&f.Value.Apply&&f.Value.Apply.Name==="odata.concat"){f.Value.Apply.Parameters.forEach(A);}if(f.Action&&f.Action.Path){g(f.Action.Path);}if(f.Target){if(f.Target.Path){g(f.Target.Path);}if(f.Target.AnnotationPath){g(f.Target.AnnotationPath);}}if(f.SemanticObject&&f.SemanticObject.Path){g(f.SemanticObject.Path);}if(f.Url&&f.Url.Path){g(f.Url.Path);}if(f.Url&&f.Url.Apply&&f.Url.Apply.Parameters){f.Url.Apply.Parameters.forEach(A);}if(f.UrlContentType&&f.UrlContentType.Path){g(f.UrlContentType.Path);}}if(F.name){g(F.name,true);}return c;},isSelf:function(p){if(p===undefined||(p&&p.indexOf('@')===0&&p.indexOf('/')===-1)){return true;}return false;},number:function(v){if(!v){return NaN;}else if(v.Decimal){return+v.Decimal;}else if(v.Path){return'{'+v.Path+'}';}else{return NaN;}},formatColor:(function(){function f(v){if(!v){return NaN;}else if(v.Decimal){return v.Decimal;}else if(v.EnumMember){return'\''+v.EnumMember+'\'';}else if(v.Path){return'${'+v.Path+'}';}else{return NaN;}}function b(d){var e=d.Criticality;return'{= '+f(e)+' === \'UI.CriticalityType/Negative\' ? \'Error\' : '+f(e)+'=== \'UI.CriticalityType/Critical\' ? \'Critical\' : \'Good\'}';}function c(d){var v=f(d.Value);var C=d.CriticalityCalculation;return'{= ('+v+' < '+f(C.DeviationRangeLowValue)+' || '+v+' > '+f(C.DeviationRangeHighValue)+') ? \'Error\' : ('+v+' < '+f(C.ToleranceRangeLowValue)+' || '+v+' > '+f(C.ToleranceRangeHighValue)+') ? \'Critical\' : \'Good\'}';}return function(d){if(d.Criticality){return b(d);}else if(d.CriticalityCalculation){return c(d);}};})(),_determineColumnIndex:function(c){var C=c.getPath();var i=Number(C.slice(C.lastIndexOf("/")+1));var l=C.slice(0,C.lastIndexOf("/"));var L=c.getModel().getObject(l);var b=0;for(var r=0;r<i;r++){if((L[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||L[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&(!L[r].Inline||L[r].Inline.Bool==="false")){continue;}else{b++;}}return b;},createP13NColumnForAction:function(c,d){var C=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(c);var s=a.createP13NColumnKey(d);var p='\\{"columnKey":"'+s+'", "columnIndex":"'+C+'", "actionButton":"true" \\}';return p;},createP13NColumnForContactPopUp:function(i,c,d,D,A){var p="";var n="";var m=i.getInterface(0).getModel();if(m){var e=m.getODataEntityType(c.entityType);if(e){n=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,A);}}var C=a.createP13NColumnKey(d);if(D.fn&&D.fn.Path){if(n){p='\\{"columnKey":"'+C+'", "leadingProperty":"'+n+'/'+D.fn.Path;p+='", "additionalProperty":"'+n;}else{p='\\{"columnKey":"'+C+'", "leadingProperty":"'+D.fn.Path;p+='", "additionalProperty":"'+D.fn.Path;}}p+='", "navigationProperty":"'+n;var o=i.getInterface(1);var b=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(o);if(b){p+='", "columnIndex":"'+b;}p+='" \\}';return p;},createP13NColumnForIndicator:function(i,c,C,d,D,o,A){var p="";var n="";var b=[];var m=i.getInterface(0).getModel();if(m){var e=m.getODataEntityType(c.entityType);if(e){n=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,A);}}var s=a.createP13NColumnKey(d);if(n){p='\\{"columnKey":"'+s+'", "leadingProperty":"'+n;n=n+"/";}else{p='\\{"columnKey":"'+s;}if(D.Value&&D.Value.Path){b.push(n+D.Value.Path);}if(D.TargetValue&&D.TargetValue.Path){b.push(n+D.TargetValue.Path);}if(D.Criticality&&D.Criticality.Path){b.push(n+D.Criticality.Path);}if(b.length>0){var f="";b.forEach(function(P){if(f){f=f+",";}f=f+P;});p+='", "additionalProperty":"'+f;}var g=i.getInterface(2);var h=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(g);if(h){p+='", "columnIndex":"'+h;}p+='" \\}';return p;},createP13NColumnForChart:function(i,c,d,D,A){var p="",b=[],n="";var m=i.getInterface(0).getModel();if(m){var e=m.getODataEntityType(c.entityType);if(e){n=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,A);}}var C=a.createP13NColumnKey(d);if(n){p='\\{"columnKey":"'+C+'", "leadingProperty":"'+n;n=n+"/";}else{p='\\{"columnKey":"'+C;}if(Array.isArray(D.Dimensions)){D.Dimensions.forEach(function(g){b.push(n+g.PropertyPath);});}if(Array.isArray(D.Measures)){D.Measures.forEach(function(M){b.push(n+M.PropertyPath);});}if(b.length>0){p+='", "additionalProperty":"'+b.join();}var o=i.getInterface(1);var f=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(o);if(f){p+='", "columnIndex":"'+f;}p+='" \\}';return p;},createP13NColumnKey:function(d,c){var C="";var f="template";var s="::";if(d.RecordType==="com.sap.vocabularies.UI.v1.DataField"){C=d.Value.Path;}else if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"){C=f+s+"DataFieldWithIntentBasedNavigation"+s+d.SemanticObject.String+s+d.Action.String+s+d.Value.Path;}else if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"){C=f+s+"DataFieldWithNavigationPath"+s+d.Target.String;}else if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){C=f+s+"DataFieldForIntentBasedNavigation"+s+d.SemanticObject.String+s+d.Action.String;}else if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){C=f+s+"DataFieldForAction"+s+d.Action.String;}else if(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){if(d.Target.AnnotationPath.indexOf('@com.sap.vocabularies.Communication.v1.Contact')>=0||d.Target.AnnotationPath.indexOf('@com.sap.vocabularies.UI.v1.DataPoint')>=0||d.Target.AnnotationPath.indexOf('@com.sap.vocabularies.UI.v1.Chart')>=0){C=f+s+"DataFieldForAnnotation"+s+d.Target.AnnotationPath;C=C.replace('@','');}}return C;},createP13N:function(I,c,C,d,D,o){var p="",A=[],n="";if(d.RecordType==="com.sap.vocabularies.UI.v1.DataField"||d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"||d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"){if(d.Value.Path){var s=a.createP13NColumnKey(d,C);p='\\{"columnKey":"'+s+'", "leadingProperty":"'+d.Value.Path;var m=I.getInterface(0).getModel();if(m){var e=m.getODataEntityType(c.entityType);if(e){if(C["com.sap.vocabularies.Common.v1.Text"]&&C["com.sap.vocabularies.Common.v1.Text"].Path){var t=a.getTextArrangement(e,d);if(t){p+='", "description":"'+C["com.sap.vocabularies.Common.v1.Text"].Path+'", "displayBehaviour":"'+t;}}n=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,e,d.Value.Path);if(n){n=n+"/";}}}}else if(d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){d.Value.Apply.Parameters.forEach(function(P){if(P.Type==="Path"){if(!p){p='\\{"columnKey":"'+P.Value+'", "leadingProperty":"'+P.Value;}else{A.push(P.Value);}}});}if((C.type==="Edm.DateTime")&&(C["sap:display-format"]==="Date")){p+='", "type":"date';}if(d.Criticality&&d.Criticality.Path){A.push(d.Criticality.Path);}if(C["com.sap.vocabularies.Common.v1.Text"]&&C["com.sap.vocabularies.Common.v1.Text"].Path){A.push(n+C["com.sap.vocabularies.Common.v1.Text"].Path);}if(C["Org.OData.Measures.V1.ISOCurrency"]&&C["Org.OData.Measures.V1.ISOCurrency"].Path){A.push(n+C["Org.OData.Measures.V1.ISOCurrency"].Path);}if(C["Org.OData.Measures.V1.Unit"]&&C["Org.OData.Measures.V1.Unit"].Path){A.push(n+C["Org.OData.Measures.V1.Unit"].Path);}if(C["com.sap.vocabularies.Common.v1.FieldControl"]&&C["com.sap.vocabularies.Common.v1.FieldControl"].Path){A.push(n+C["com.sap.vocabularies.Common.v1.FieldControl"].Path);}if((d["RecordType"]==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")&&d.Url&&d.Url.Apply&&d.Url.Apply.Parameters){d.Url.Apply.Parameters.forEach(function(P){if(P.Type==="LabeledElement"){A.push(P.Value.Path);}});}if((d["RecordType"]==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")&&d.Url&&d.Url.Path){A.push(d.Url.Path);}if(A.length>0){var b="";A.forEach(function(P){if(b){b=b+",";}b=b+P;});p+='", "additionalProperty":"'+b;}var N=false;if(c["Org.OData.Capabilities.V1.SortRestrictions"]&&c["Org.OData.Capabilities.V1.SortRestrictions"].NonSortableProperties){var f=c["Org.OData.Capabilities.V1.SortRestrictions"].NonSortableProperties;for(var i=f.length-1;i>=0;i--){if(f[i].PropertyPath===d.Value.Path){N=true;break;}}}if(!N){if(n){p+='", "sortProperty":"'+n+C.name;}else{p+='", "sortProperty":"'+C.name;}}var g=false;if(c["Org.OData.Capabilities.V1.FilterRestrictions"]){if(c["Org.OData.Capabilities.V1.FilterRestrictions"].Filterable!=='false'){if(c["Org.OData.Capabilities.V1.FilterRestrictions"].NonFilterableProperties){var h=c["Org.OData.Capabilities.V1.FilterRestrictions"].NonFilterableProperties;for(var j=h.length-1;j>=0;j--){if(h[j].PropertyPath===d.Value.Path){g=true;break;}}}}else{g=true;}}if(!g){p+='", "filterProperty":"'+C.name;}var k=I.getInterface(2);var l=sap.suite.ui.generic.template.js.AnnotationHelper._determineColumnIndex(k);if(l>=0){p+='", "columnIndex":"'+l;}}return p+'" \\}';},hasActions:function(P){for(var i=0;i<P.length;i++){if((!P[i].Inline||P[i].Inline.Bool!=="true")&&(P[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||P[i].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")){return true;}}return false;},hasCustomActions:function(r,e,m,f){if(e&&m){if(f){if(m[e]){var M=m[e];if(M.EntitySet===e){var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(!M.Sections){return false;}var s=M.Sections[F];if(s&&s.id===F&&s.Actions){for(var i in s.Actions){if(s.Actions[i].requiresSelection!==false){return true;}}}}}}else{if(m["sap.suite.ui.generic.template.ListReport.view.ListReport"]){m=m["sap.suite.ui.generic.template.ListReport.view.ListReport"]["sap.ui.generic.app"];}else if(m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]){m=m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]["sap.ui.generic.app"];}if(m&&m[e]){var M=m[e];if(M.EntitySet===e){if(M.Actions){for(var i in M.Actions){if(M.Actions[i].requiresSelection!==false){return true;}}}}}}}return false;},getSelectionModeGridTable:function(e,r,m,f,o,R,i){if((sap.suite.ui.generic.template.js.AnnotationHelper.hasActions(e)||sap.suite.ui.generic.template.js.AnnotationHelper.hasCustomActions(R,r,m,f))){return"Single";}var d=o["Org.OData.Capabilities.V1.DeleteRestrictions"];if(i){if((d&&d.Deletable&&((d.Deletable.Bool&&d.Deletable.Bool!=='false')||d.Deletable.Path))||!d){return"{= ${ui>/editable} ? 'Single' : 'None' }";}}else{if((d&&d.Deletable&&((d.Deletable.Bool&&d.Deletable.Bool!=='false')||d.Deletable.Path))||!d){return"{= !${ui>/editable} ? 'Single' : 'None' }";}}return"None";},getSelectionModeTreeTable:function(e,r,m,f,o,R,i){if((sap.suite.ui.generic.template.js.AnnotationHelper.hasActions(e)||sap.suite.ui.generic.template.js.AnnotationHelper.hasCustomActions(R,r,m,f))){return"Single";}var d=o["Org.OData.Capabilities.V1.DeleteRestrictions"];if(i){if((d&&d.Deletable&&((d.Deletable.Bool&&d.Deletable.Bool!=='false')||d.Deletable.Path))||!d){return"{= ${ui>/editable} ? 'Single' : 'None' }";}}else{if((d&&d.Deletable&&((d.Deletable.Bool&&d.Deletable.Bool!=='false')||d.Deletable.Path))||!d){return"{= !${ui>/editable} ? 'Single' : 'None' }";}}return"None";},getSelectionModeResponsiveTable:function(e,r,m,f,o,R,i){if((sap.suite.ui.generic.template.js.AnnotationHelper.hasActions(e)||sap.suite.ui.generic.template.js.AnnotationHelper.hasCustomActions(R,r,m,f))){return"SingleSelectLeft";}var d=o["Org.OData.Capabilities.V1.DeleteRestrictions"];if(i){if((d&&d.Deletable&&((d.Deletable.Bool&&d.Deletable.Bool!=='false')||d.Deletable.Path))||!d){return"{= ${ui>/editable} ? 'SingleSelectLeft' : 'None' }";}}else{if((d&&d.Deletable&&((d.Deletable.Bool&&d.Deletable.Bool!=='false')||d.Deletable.Path))||!d){return"{= !${ui>/editable} ? 'SingleSelectLeft' : 'None' }";}}return"None";},getSortOrder:function(P){var s='';for(var i=0;i<P.length;i++){if(!s){s=P[i].Property.PropertyPath;}else{s=s+', '+P[i].Property.PropertyPath;}if(P[i].Descending){s=s+' '+P[i].Descending.Bool;}}return s;},replaceSpecialCharsInId:function(i){if(i.indexOf(" ")>=0){jQuery.sap.log.error("Annotation Helper: Spaces are not allowed in ID parts. Please check the annotations, probably something is wrong there.");}return i.replace(/@/g,"").replace(/\//g,"::").replace(/#/g,"::");},getStableIdPartFromDataField:function(d){var p="",I="";if(d.RecordType&&d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.String);}else if(d.RecordType&&(d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation")){if(d.SemanticObject.String){I=sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.SemanticObject.String);}else if(d.SemanticObject.Path){I=sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.SemanticObject.Path);}if(d.Action&&d.Action.String){I=I+"::"+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.String);}else if(d.Action&&d.Action.Path){I=I+"::"+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Action.Path);}return I;}else if(d.RecordType&&d.RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Target.AnnotationPath);}else if(d.Value&&d.Value.Path){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Path);}else if(d.Value&&d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){for(var i=0;i<d.Value.Apply.Parameters.length;i++){if(d.Value.Apply.Parameters[i].Type==="Path"){if(p){p=p+"::";}p=p+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Apply.Parameters[i].Value);}}return p;}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. Please check the annotations.");}},getStableIdPartFromDataPoint:function(d){var p="";if(d.Value&&d.Value.Path){return sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Path);}else if(d.Value&&d.Value.Apply&&d.Value.Apply.Name==="odata.concat"){for(var i=0;i<d.Value.Apply.Parameters.length;i++){if(d.Value.Apply.Parameters[i].Type==="Path"){if(p){p=p+"::";}p=p+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(d.Value.Apply.Parameters[i].Value);}}return p;}else{jQuery.sap.log.error("Annotation Helper: Unable to create stable ID derived from annotations.");}},getStableIdPartFromFacet:function(f){var h="";if(typeof this.getContext==="function"&&this.getContext()&&this.getContext().getPath()&&this.getContext().getPath().indexOf("com.sap.vocabularies.UI.v1.HeaderFacets")>=0){h="headerEditable::";}if(f.RecordType&&f.RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"){if(f.ID&&f.ID.String){return h+f.ID.String;}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. You have to set an ID at all collection facets.");return Math.floor((Math.random()*99999)+1).toString();}}else if(f.RecordType&&f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){if(f.ID&&f.ID.String){return h+f.ID.String;}else{return h+sap.suite.ui.generic.template.js.AnnotationHelper.replaceSpecialCharsInId(f.Target.AnnotationPath);}}else{jQuery.sap.log.error("Annotation Helper: Unable to create a stable ID. Please check the facet annotations.");return Math.floor((Math.random()*99999)+1).toString();}},getVisibilityForExtensionPointReplaceHeader:function(e,m){var s="ReplaceHeaderExtensionFacet|"+e;var o=m[s];if(o&&o['bVisibleOnEdit']===false){return false;}return true;},extensionPointReplaceHeaderExists:function(e,m){if(m){var s="ReplaceHeaderExtensionFacet|"+e;return m[s];}return false;},getVisibilityForExtensionPointNoImage:function(e,m){var s="NoImageExtensionFacet|"+e;var o=m[s];if(o&&o['bVisibleOnEdit']===false){return false;}return true;},extensionPointNoImageExists:function(e,m){if(m){var s="NoImageExtensionFacet|"+e;return m[s];}return false;},getVisibilityForExtensionPointAfterImage:function(e,m){var s="AfterImageExtensionFacet|"+e;var o=m[s];if(o&&o['bVisibleOnEdit']===false){return false;}return true;},extensionPointAfterImageExists:function(e,m){if(m){var s="AfterImageExtensionFacet|"+e;return m[s];}return false;},getVisibilityForExtensionPointBeforeSimpleHeaderFacet:function(e,f,m,d){var s;var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(f.Target.AnnotationPath.indexOf("DataPoint")>0){s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataPoint(d);}else{s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataField(d);}var i=F+"::"+s;var b="BeforeSimpleHeaderFacet|"+e+"|headerEditable::"+i;var o=m[b];if(o&&o['bVisibleOnEdit']===false){return false;}return true;},extensionPointBeforeSimpleHeaderFacetExists:function(e,f,m,d){if(m){var s;var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(f.Target.AnnotationPath.indexOf("DataPoint")>0){s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataPoint(d);}else{s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataField(d);}var i=F+"::"+s;var b="BeforeSimpleHeaderFacet|"+e+"|headerEditable::"+i;return m[b];}return false;},getVisibilityForExtensionPointReplaceSimpleHeaderFacet:function(e,f,m,d){var s;var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(f.Target.AnnotationPath.indexOf("DataPoint")>0){s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataPoint(d);}else{s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataField(d);}var i=F+"::"+s;var b="ReplaceSimpleHeaderFacet|"+e+"|headerEditable::"+i;var o=m[b];if(o&&o['bVisibleOnEdit']===false){return false;}return true;},extensionPointReplaceSimpleHeaderFacetExists:function(e,f,m,d){if(m){var s;var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(f.Target.AnnotationPath.indexOf("DataPoint")>0){s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataPoint(d);}else{s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataField(d);}var i=F+"::"+s;var b="ReplaceSimpleHeaderFacet|"+e+"|headerEditable::"+i;return m[b];}return false;},getVisibilityForExtensionPointAfterSimpleHeaderFacet:function(e,f,m,d){var s;var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(f.Target.AnnotationPath.indexOf("DataPoint")>0){s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataPoint(d);}else{s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataField(d);}var i=F+"::"+s;var b="AfterSimpleHeaderFacet|"+e+"|headerEditable::"+i;var o=m[b];if(o&&o['bVisibleOnEdit']===false){return false;}return true;},extensionPointAfterSimpleHeaderFacetExists:function(e,f,m,d){if(m){var s;var F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);if(f.Target.AnnotationPath.indexOf("DataPoint")>0){s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataPoint(d);}else{s=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataField(d);}var i=F+"::"+s;var b="AfterSimpleHeaderFacet|"+e+"|headerEditable::"+i;return m[b];}return false;},getVisibilityForExtensionPointBeforeHeaderFacet:function(e,f,m){var s="BeforeHeaderFacet|"+e+"|headerEditable::"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m[s];if(o&&o['bVisibleOnEdit']===false){return false;}return true;},extensionPointBeforeHeaderFacetExists:function(e,f,m){if(m){var s="BeforeHeaderFacet|"+e+"|headerEditable::"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);return m[s];}return false;},getVisibilityForExtensionPointReplaceHeaderFacet:function(e,f,m){var s="ReplaceHeaderFacet|"+e+"|headerEditable::"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m[s];if(o&&o['bVisibleOnEdit']===false){return false;}return true;},extensionPointReplaceHeaderFacetExists:function(e,f,m){if(m){var s="ReplaceHeaderFacet|"+e+"|headerEditable::"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);return m[s];}return false;},getVisibilityForExtensionPointAfterHeaderFacet:function(e,f,m){var s="AfterHeaderFacet|"+e+"|headerEditable::"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m[s];if(o&&o['bVisibleOnEdit']===false){return false;}return true;},extensionPointAfterHeaderFacetExists:function(e,f,m){if(m){var s="AfterHeaderFacet|"+e+"|headerEditable::"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);return m[s];}return false;},extensionPointBeforeHeaderDataPointExists:function(e,d,m){if(m){var s="BeforeHeaderDataPoint|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataPoint(d);return m[s];}return false;},extensionPointReplaceHeaderDataPointExists:function(e,d,m){if(m){var s="ReplaceHeaderDataPoint|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataPoint(d);return m[s];}return false;},extensionPointAfterHeaderDataPointExists:function(e,d,m){if(m){var s="AfterHeaderDataPoint|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataPoint(d);return m[s];}return false;},extensionPointBeforeFacetExists:function(e,f,m){if(m){var s="BeforeFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);return m[s];}return false;},extensionPointAfterFacetExists:function(e,f,m){if(m){var s="AfterFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);return m[s];}return false;},getExtensionPointBeforeFacetTitle:function(e,f,m){var s="BeforeFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m[s];if(o&&o['sap.ui.generic.app']&&o['sap.ui.generic.app'].title){return o['sap.ui.generic.app'].title;}},getExtensionPointAfterFacetTitle:function(e,f,m){var s="AfterFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m[s];if(o&&o['sap.ui.generic.app']&&o['sap.ui.generic.app'].title){return o['sap.ui.generic.app'].title;}},isExtensionPointBeforeFacetLazyLoadingEnabled:function(e,f,m){return E("BeforeFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f),m);},isExtensionPointAfterFacetLazyLoadingEnabled:function(e,f,m){return E("AfterFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f),m);},isFacetLazyLoadingEnabled:function(e,f,m){if(m){var s="ReplaceFacet|"+e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);var o=m[s];if(o){return E(s,m);}}return true;},getRepeatIndex:function(v){if(v&&v.getPath()){var p="0000000000";var P=p+((parseInt(v.getPath().substring(v.getPath().lastIndexOf("/")+1),10)+1)*10).toString();return P.substr(P.length-p.length);}else{jQuery.sap.log.error("Annotation Helper: Unable to get index.");}},getColumnListItemTypeForAppropriateDraftScenario:function(i){if(i){return"Navigation";}else{return"{= ${ui>/editable} ? 'Inactive' : 'Navigation' }";}},getColumnListItemType:function(l,s,i){if(sap.suite.ui.generic.template.js.AnnotationHelper.hasSubObjectPage(l,s)){return a.getColumnListItemTypeForAppropriateDraftScenario(i);}else{return"Inactive";}},getColumnListItemTypeForDetailPage:function(l,s,m,M,i,A){var h=true;var r=M&&M.routeConfig&&M.routeConfig.component.name;var o=sap.suite.ui.generic.template.js.AnnotationHelper.getSubObjectPageIntent(l.name,s,A,'display',h);if(o){var c=m["sap.app"].crossNavigation.outbounds[o];var S=c.semanticObject;var b=c.action;var p=!!(A)?l.name+"::"+A.split("/")[0]:l.name;if(i||(!i&&r=="sap.suite.ui.generic.template.ListReport")){return"{= ${_templPriv>/generic/supportedIntents/"+S+"/"+b+"/"+p+"/supported} ? 'Navigation' : 'Inactive'}";}else{return"{= ${_templPriv>/generic/supportedIntents/"+S+"/"+b+"/"+p+"/supported} && !${ui>/editable} ? 'Navigation' : 'Inactive'}";}}else{r=M&&M.routeConfig&&M.routeConfig.component&&M.routeConfig.name;var H=false;s.forEach(function(d){if(d.navigationProperty){H=true;return;}});if(r==="root"&&H){return a.getColumnListItemTypeForAppropriateDraftScenario(i);}else{return a.getColumnListItemType(l,s,i);}}},getRowActionCountForDetailPage:function(l,s,m,A,i){var h=true;var o=sap.suite.ui.generic.template.js.AnnotationHelper.getSubObjectPageIntent(l.name,s,A,'display',h);if(o){var c=m["sap.app"].crossNavigation.outbounds[o];var S=c.semanticObject;var b=c.action;var p=l.name+"::"+A.split("/")[0];if(i){return"{= ${_templPriv>/generic/supportedIntents/"+S+"/"+b+"/"+p+"/supported} ? 1 : 0}";}else{return"{= ${_templPriv>/generic/supportedIntents/"+S+"/"+b+"/"+p+"/supported} && !${ui>/editable} ? 1 : 0}";}}else if(sap.suite.ui.generic.template.js.AnnotationHelper.hasSubObjectPage(l,s)){if(!i){return"{= ${ui>/editable} ? 0 : 1 }";}else{return 1;}}else{return 0;}},getRowActionCountForListReport:function(l,s,m,M){if(M.isLeaf===false){var A="";var h=true;var o=sap.suite.ui.generic.template.js.AnnotationHelper.getSubObjectPageIntent(l.name,s,A,'display',h);if(o){var c=m["sap.app"].crossNavigation.outbounds[o];var S=c.semanticObject;var b=c.action;var p=l.name;return"{= ${_templPriv>/generic/supportedIntents/"+S+"/"+b+"/"+p+"/supported} ? 1 : 0}";}else{return 1;}}else{return 0;}},hasSubObjectPage:function(l,s){var h=false;if(l.name&&s&&s.length>0){s.forEach(function(S){if(l.name===S.entitySet){h=true;return h;}});}return h;},isRelatedEntityCreatable:function(I,s,r,S,f,o,b){var c=false;var m=I.getInterface(0).getModel();var d=s["Org.OData.Capabilities.V1.InsertRestrictions"];var e=m.getODataEntityType(s.entityType);if(a.hasSubObjectPage(r,S)||(o&&a.isInlineCreate(f,o))){if(b){c="{= ${ui>/editable}}";}else{c="{= !${ui>/editable}}";}if(d&&d.NonInsertableNavigationProperties&&d.NonInsertableNavigationProperties.length>0){for(var i=0;i<d.NonInsertableNavigationProperties.length;i++){var n=d.NonInsertableNavigationProperties[i];var N=sap.suite.ui.generic.template.js.AnnotationHelper._getNonInsertableNavigationPropertyPath(n);if(N){var A=m.getODataAssociationSetEnd(e,N);if(A&&A.entitySet===r.name){if(n.If&&n.If.length===2){var g=n.If[0];var F=g.Not?g.Not.Path:g.Path;if(sap.suite.ui.generic.template.js.AnnotationHelper._isPropertyPathBoolean(m,s.entityType,F)){sap.suite.ui.generic.template.js.AnnotationHelper._actionControlExpand(I,F,e.name);if(b){if(g.Not){c="{= ${ui>/editable} ? ${"+F+"} : false}";}else{c="{= ${ui>/editable} ? !${"+F+"} : false}";}}else{if(g.Not){c="{= !${ui>/editable} ? ${"+F+"} : false}";}else{c="{= !${ui>/editable} ? !${"+F+"} : false}";}}}else{c=false;jQuery.sap.log.warning("Creatable-Path is not valid. Creation for "+r.name+" is disabled");}}else{c=false;}break;}}}}}return c;},_getNonInsertableNavigationPropertyPath:function(n){var N;if(n.NavigationPropertyPath){N=n.NavigationPropertyPath;}else if(n.If){N=n.If[1].NavigationPropertyPath;}return N;},areDeleteRestrictionsValid:function(m,e,r){var b=!(r&&r.Deletable&&r.Deletable.Bool&&r.Deletable.Path)&&((!r)||(r.Deletable&&r.Deletable.Bool)||(r.Deletable&&r.Deletable.Path&&sap.suite.ui.generic.template.js.AnnotationHelper._isPropertyPathBoolean(m,e,r.Deletable.Path)));if(!b){jQuery.sap.log.error("Service Broken: Delete Restrictions annotations are invalid. ");}return b;},_areUpdateRestrictionsValid:function(m,e,r){var b=!(r&&r.Updatable&&r.Updatable.Bool&&r.Updatable.Path)&&((!r)||(r.Updatable&&r.Updatable.Bool)||(r.Updatable&&r.Updatable.Path&&sap.suite.ui.generic.template.js.AnnotationHelper._isPropertyPathBoolean(m,e,r.Updatable.Path)));if(!b){jQuery.sap.log.error("Service Broken: Delete Restrictions annotations are invalid. ");}return b;},_isPropertyPathBoolean:function(m,e,p){var P=p;var o=m.getODataEntityType(e);if(P.indexOf("/")>-1){var b=P.split("/");for(var j=0;j<b.length-1;j++){var A=m.getODataAssociationEnd(o,b[j]);o=m.getODataEntityType(A.type);}P=b[b.length-1];}var O=m.getODataProperty(o,P);return(O&&O.type==="Edm.Boolean");},actionControl:function(i,A,e){sap.suite.ui.generic.template.js.AnnotationHelper._actionControlExpand(i,A,e);if(A){return"{path: '"+A+"'}";}else{return"true";}},_actionControlExpand:function(i,p,e){var b=[],s;i=i.getInterface(0);var m=i.getModel();var o=m.getODataEntityType(e);if(p){s=sap.suite.ui.generic.template.js.AnnotationHelper._getNavigationPrefix(m,o,p);if(s){b.push(s);}}if(b.length>0){var P=i.getSetting("preprocessorsData");if(P){var r=P.rootContextExpand||[];for(var j=0;j<b.length;j++){if(r.indexOf(b[j])===-1){r.push(b[j]);}}P.rootContextExpand=r;}}},getEntityTypesForFormPersonalization:function(i,f,e){i=i.getInterface(0);var b=[];var m=i.getModel();var o=m.getODataEntitySet(e.name||'');var F=[];if(f.RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"&&f.Facets){F=f.Facets;}else if(f.RecordType==="com.sap.vocabularies.UI.v1.ReferenceFacet"){F.push(f);}F.forEach(function(f){var n;if(f.Target&&f.Target.AnnotationPath&&f.Target.AnnotationPath.indexOf("/")>0){n=f.Target.AnnotationPath.split("/")[0];var c=m.getODataEntityType(o.entityType);var A=m.getODataAssociationSetEnd(c,n);if(A&&A.entitySet){o=m.getODataEntitySet(A.entitySet);if(b.indexOf(o.entityType.split(".")[1])===-1){b.push(o.entityType.split(".")[1]);}}}else{if(b.indexOf(e.entityType.split(".")[1])===-1){b.push(e.entityType.split(".")[1]);}}});return b.join(", ");},formatHeaderTitle:function(i,d){return"{parts: [{path: 'ui>/createMode'}, {path: '"+d.Title.Value.Path+"'}], formatter: '._templateFormatters.formatDefaultObjectTitle'}";},_mapTextArrangement4smartControl:function(t){var T="descriptionAndId";switch(t){case"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast":T="idAndDescription";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate":T="idOnly";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly":T="descriptionOnly";break;default:break;}return T;},getTextArrangementForSmartControl:function(i,f,r,e){i=i.getInterface(0);var o;var m=i.getModel();if(r.name==undefined){o=m.getODataEntityType(e.entityType);}else{o=m.getODataEntityType(r.entityType);}var t="descriptionAndId";if(m.getODataProperty(o,f.Value.Path)){var p=m.getODataProperty(o,f.Value.Path)["com.sap.vocabularies.Common.v1.Text"];if(p&&p["com.sap.vocabularies.UI.v1.TextArrangement"]&&p["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){t=sap.suite.ui.generic.template.js.AnnotationHelper._mapTextArrangement4smartControl(p["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember);}}if(o["com.sap.vocabularies.UI.v1.TextArrangement"]&&o["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){t=sap.suite.ui.generic.template.js.AnnotationHelper._mapTextArrangement4smartControl(o["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember);}return t;},getTitle:function(s,S,n){var r;var t=a.getTextArrangementObject(s,S,n);if(t){r=a.getTitleTextArrangementBindingPath(t.textArrangement,t.propertyPath,t.textPath);}return r;},getDescription:function(s,S,n){var r;var t=a.getTextArrangementObject(s,S,n);if(t){r=a.getDescriptionTextArrangementBindingPath(t.textArrangement,t.propertyPath,t.textPath);}return r;},getTextArrangementObject:function(s,S,n){var t,p,T;if(S){p=S.name;var P=S["com.sap.vocabularies.Common.v1.Text"];if(P){T=P.Path;}t=a.getTextArrangement(s,S);return{textArrangement:t,propertyPath:p,textPath:T};}},getTextArrangement:function(e,f){var t;if(f["com.sap.vocabularies.UI.v1.TextArrangement"]&&f["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){t=a._mapTextArrangement4smartControl(f["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember);}if(!t){var p=f["com.sap.vocabularies.Common.v1.Text"];if(p&&p["com.sap.vocabularies.UI.v1.TextArrangement"]&&p["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){t=a._mapTextArrangement4smartControl(p["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember);}}if(!t){if(e&&e["com.sap.vocabularies.UI.v1.TextArrangement"]&&e["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember){t=a._mapTextArrangement4smartControl(e["com.sap.vocabularies.UI.v1.TextArrangement"].EnumMember);}}if(!t){t="descriptionAndId";}return t;},getTitleTextArrangementBindingPath:function(t,p,T){var P="{"+p+"}";var s="{"+T+"}";if(!T){return P;}if(t==="descriptionAndId"){return s;}else if(t==="descriptionOnly"){return s;}else if(t==="idAndDescription"){return P;}else if(t==="idOnly"){return P;}},getDescriptionTextArrangementBindingPath:function(t,p,T){var P="{"+p+"}";var s="{"+T+"}";if(!T){return"";}if(t==="descriptionAndId"){return P;}else if(t==="descriptionOnly"){return"";}else if(t==="idAndDescription"){return s;}else if(t==="idOnly"){return"";}},isDeepFacetHierarchy:function(f){if(f.Facets){for(var i=0;i<f.Facets.length;i++){if(f.Facets[i].RecordType==="com.sap.vocabularies.UI.v1.CollectionFacet"){return true;}}}return false;},doesCollectionFacetOnlyContainForms:function(f){var r=true;if(f.Facets){for(var i=0;i<f.Facets.length;i++){if(f.Facets[i].Target&&f.Facets[i].Target.AnnotationPath){if((f.Facets[i].Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")<0)&&(f.Facets[i].Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.Identification")<0)&&(f.Facets[i].Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.DataPoint")<0)){r=false;}}}}else{r=false;}return r;},doesFieldGroupContainOnlyOneMultiLineDataField:function(f,F){if(f.Data.length!==1){return false;}if((F['com.sap.vocabularies.UI.v1.MultiLineText']===undefined)||(f.Data[0].RecordType!=="com.sap.vocabularies.UI.v1.DataField")){return false;}return true;},testFormatter:function(v){return"formatted:"+v;},getFacetID:function(e,f){return e+"|"+sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);},isListReportTemplate:function(r){if(r){return r.template==="sap.suite.ui.generic.template.ListReport";}},isAnalyticalListPageOrListReportTemplate:function(r){if(r){return(r.template==="sap.suite.ui.generic.template.AnalyticalListPage"||r.template==="sap.suite.ui.generic.template.ListReport");}},getStableIdPartForDatafieldActionButton:function(d,f,t,c){var s="";var D="";var F="";if(f){F=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromFacet(f);}if(d){D=sap.suite.ui.generic.template.js.AnnotationHelper.getStableIdPartFromDataField(d);}s=(F!==""?F+"::":"")+"action::"+D;var S=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(t);if(S){s=s.concat(S);}if(c){s=s+"::chart";}return s;},_hasCustomDeterminingActionsInListReport:function(e,m){if(m&&m[e]){var M=m[e];if(M.Actions){for(var b in M.Actions){if(M.Actions[b].determining){return true;}}}}return false;},_hasCustomDeterminingActionsInObjectPage:function(e,m){if(m&&m[e]){var M=m[e];if(M.Header&&M.Header.Actions){for(var b in M.Header.Actions){if(M.Header.Actions[b].determining){return true;}}}}return false;},hasDeterminingActionsRespectingApplicablePath:function(c,t,e,m){var A="";c=c.getInterface(0);if(e&&m&&m["sap.suite.ui.generic.template.ObjectPage.view.Details"]&&sap.suite.ui.generic.template.js.AnnotationHelper._hasCustomDeterminingActionsInObjectPage(e,m["sap.suite.ui.generic.template.ObjectPage.view.Details"]["sap.ui.generic.app"])){return"true";}if(t){for(var r=0;r<t.length;r++){if((t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction")&&t[r].Determining&&t[r].Determining.Bool==="true"){var f=c.getModel().getODataFunctionImport(t[r].Action.String,true);var F=c.getModel().getObject(f);if(F["sap:applicable-path"]){if(A.length>0){A+=" || ";}A+="${path: '"+F["sap:applicable-path"]+"'}";}else{return"true";}}}}if(A.length>0){return"{= "+A+" || ${ui>/editable}}";}else{return"{ui>/editable}";}},hasDeterminingActions:function(t,e,m){if(e&&m&&m["sap.suite.ui.generic.template.ListReport.view.ListReport"]&&sap.suite.ui.generic.template.js.AnnotationHelper._hasCustomDeterminingActionsInListReport(e,m["sap.suite.ui.generic.template.ListReport.view.ListReport"]["sap.ui.generic.app"])){return"true";}else if(e&&m&&m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]&&sap.suite.ui.generic.template.js.AnnotationHelper._hasCustomDeterminingActionsInListReport(e,m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]["sap.ui.generic.app"])){return"true";}for(var r=0;r<t.length;r++){if((t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&t[r].Determining&&t[r].Determining.Bool==="true"){return"true";}}return"false";},actionControlDetermining:function(r,A){if(sap.suite.ui.generic.template.js.AnnotationHelper.isListReportTemplate(r)||!A){return true;}else{return"{path: '"+A+"'}";}},actionControlInline:function(A){if(!A){return true;}else{return"{path: '"+A+"'}";}},actionControlBreakout:function(A){if(!A){return true;}else{return"{path: '"+A+"'}";}},buildExpressionForProgressIndicatorPercentValue:function(i,d,u){var p="0";if(d.Value&&d.Value.Path){var v="$"+sap.ui.model.odata.AnnotationHelper.format(i,d.Value);var t,U;if(d.TargetValue){t=sap.ui.model.odata.AnnotationHelper.format(i,d.TargetValue);t=d.TargetValue.Path?"$"+t:t;}if(u){u=u['Org.OData.Measures.V1.Unit']||u["Org.OData.Measures.V1.ISOCurrency"];if(u){U=sap.ui.model.odata.AnnotationHelper.simplePath(i,u);U=U&&u.Path?"$"+U:"'"+U+"'";}}var e="({0} > 100 ? 100 : {0} < 0 ? 0 : {0} * 1)";var s="(({1} > 0) ? (({0} > {1}) ? 100 : (({0} < 0) ? 0 : ({0} / {1} * 100))) : 0)";var b="'{'= ({2} === ''%'') ? "+e+" : "+s+" '}'";p=jQuery.sap.formatMessage(b,[v,t,U]);}return p;},buildExpressionForProgressIndicatorDisplayValue:function(i,d,u){var p;var b=function(i,P){var s=sap.suite.ui.generic.template.js.AnnotationHelper.trimCurlyBraces(sap.ui.model.odata.AnnotationHelper.format(i,P));var c="{path: '"+s+"'}";return c;};p=b(i,d.Value)+", "+b(i,d.TargetValue)+", "+b(i,u);var D="{ parts: ["+p+"], formatter: 'sap.suite.ui.generic.template.js.AnnotationHelper.formatDisplayValue' }";return D;},formatDisplayValue:function(v,t,u){var d="";if(v!==null&&v!==undefined){v=v.toString();}if(v){var c=this;var r=c.getModel("i18n").getResourceBundle();var C=c.getCustomData();var l=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();t=t||C[0].getValue();v=sap.ui.core.format.NumberFormat.getInstance(l).format(v);u=u||C[1].getValue();if(u){if(u==='%'){d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_PERCENT",[v]);}else{if(t){t=sap.ui.core.format.NumberFormat.getInstance(l).format(t);d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_NOT_PERCENT",[v,t,u]);}else{d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_UOM_IS_NOT_PERCENT_NO_TARGET_VALUE",[v,u]);}}}else{if(t){t=sap.ui.core.format.NumberFormat.getInstance(l).format(t);d=r.getText("PROGRESS_INDICATOR_DISPLAY_VALUE_NO_UOM",[v,t]);}else{d=v;}}}else{jQuery.sap.log.warning("Value property is mandatory, the default (empty string) will be returned");}return d;},buildExpressionForProgressIndicatorCriticality:function(i,d){var f=sap.ui.core.ValueState.None;var e;var c=d.Criticality;if(c){e="'{'= ({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Negative'') || ({0} === ''1'') || ({0} === 1) ? ''"+sap.ui.core.ValueState.Error+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Critical'') || ({0} === ''2'') || ({0} === 2) ? ''"+sap.ui.core.ValueState.Warning+"'' : "+"({0} === ''com.sap.vocabularies.UI.v1.CriticalityType/Positive'') || ({0} === ''3'') || ({0} === 3) ? ''"+sap.ui.core.ValueState.Success+"'' : "+"''"+sap.ui.core.ValueState.None+"'' '}'";if(c.Path){var C='$'+sap.ui.model.odata.AnnotationHelper.simplePath(i,c);f=jQuery.sap.formatMessage(e,C);}else if(c.EnumMember){var s="'"+c.EnumMember+"'";f=jQuery.sap.formatMessage(e,s);}else{jQuery.sap.log.warning("Case not supported, returning the default sap.ui.core.ValueState.None");}}else{jQuery.sap.log.warning("Case not supported, returning the default sap.ui.core.ValueState.None");}return f;},trimCurlyBraces:function(v){return v?v.replace("{","").replace("}",""):undefined;},getEntitySetName:function(r,e){var s="";try{s=r.name||e.name;}catch(o){jQuery.sap.log.warning("At least one of the input parameters is undefined. Returning default value for entity set name.");}return s;},getBreakoutActionEnabledKey:function(A,t){var b=sap.suite.ui.generic.template.js.AnnotationHelper.getBreakoutActionButtonId(A,t);var e="{_templPriv>/generic/listCommons/breakoutActionsEnabled/"+b+"/enabled}";return e;},buildVisibilityExprOfDataFieldForIntentBasedNaviButton:function(d){if(!!d.RequiresContext&&d.RequiresContext.Bool=="false"&&(!d.Inline||d.Inline.Bool==="false")){var s=d.SemanticObject.String;var A=d.Action.String;return"{= !!${_templPriv>/generic/supportedIntents/"+s+"/"+A+"/visible}}";}else{return true;}},searchForFirstSemKey_Title_Description:function(e){var t,d,D,T,o,f,l,h,H,s,L,i;var b=e.getPath();var c=b+'/'+"com.sap.vocabularies.UI.v1.LineItem"+'/';if(e){o=e.getObject();f=o["com.sap.vocabularies.Common.v1.SemanticKey"]&&o["com.sap.vocabularies.Common.v1.SemanticKey"][0]&&o["com.sap.vocabularies.Common.v1.SemanticKey"][0].PropertyPath;l=o["com.sap.vocabularies.UI.v1.LineItem"];h=o["com.sap.vocabularies.UI.v1.HeaderInfo"];H="";s="";if(h){H=h&&h["Title"]&&h["Title"].Value&&h["Title"].Value.Path;s=h&&h["Description"]&&h["Description"].Value&&h["Description"].Value.Path;}L=l&&l.length;for(i=0;i<L;i++){if(l[i].RecordType==="com.sap.vocabularies.UI.v1.DataField"&&l[i].Value.Path===f){if(a.isPropertyHidden(l[i])){continue;}c=c+i+'/Value/Path';return c;}if(l[i].RecordType==="com.sap.vocabularies.UI.v1.DataField"&&l[i].Value.Path===H){if(a.isPropertyHidden(l[i])){continue;}t=true;T=i;}if(l[i].RecordType==="com.sap.vocabularies.UI.v1.DataField"&&l[i].Value.Path===s){if(a.isPropertyHidden(l[i])){continue;}d=true;D=i;}}if(t){c=c+T+'/Value/Path';return c;}else if(d){c=c+D+'/Value/Path';return c;}}else{jQuery.sap.log.warning("No entity type provided");}},isPropertyHidden:function(l){var h=false;if(l["com.sap.vocabularies.UI.v1.Hidden"]||(l["com.sap.vocabularies.Common.v1.FieldControl"]&&l["com.sap.vocabularies.Common.v1.FieldControl"].EnumMember&&l["com.sap.vocabularies.Common.v1.FieldControl"].EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden")){h=true;}return h;},getColumnHeaderText:function(d,D){var r;if(D.Label){return D.Label.String;}else{r=d["sap:label"]||(d["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return r;}},getColumnToolTip:function(d,D){var r;if(D.Label){return D.Label.String;}else{r=d["sap:quickinfo"]||(d["com.sap.vocabularies.Common.v1.QuickInfo"]||"").String||d["sap:label"]||(d["com.sap.vocabularies.Common.v1.Label"]||"").String||"";return r;}},getTextForDataField:function(d){var v=d["com.sap.vocabularies.Common.v1.Text"]&&d["com.sap.vocabularies.Common.v1.Text"].Path;return v;},getColumnCellFirstText:function(d,D,e,c){var r,t;t=a.getTextArrangement(e,d);switch(t){case"idAndDescription":r=D.Value.Path;if(!r){r=a.getTextForDataField(d);}break;case"idOnly":r=D.Value.Path;if(!r){r=a.getTextForDataField(d);}break;case"descriptionAndId":case"descriptionOnly":default:r=a.getTextForDataField(d);if(!r){r=D.Value.Path;}break;}if(r){if(c){return true;}else{if(d.type==="Edm.DateTimeOffset"||d.type==="Edm.DateTime"||d.type==="Edm.Time"){var f=a.formatDateTimeForCustomColumn(d.type,r);return f;}else{return"{"+r+"}";}}}},getColumnCellSecondText:function(d,D,e,c){var r,t;t=a.getTextArrangement(e,d);switch(t){case"idOnly":case"descriptionOnly":break;case"idAndDescription":if(!D.Value.Path){break;}r=a.getTextForDataField(d);break;case"descriptionAndId":default:if(!a.getTextForDataField(d)){break;}r=D.Value.Path;break;}if(r){if(c){return true;}else{if(d.type==="Edm.DateTimeOffset"||d.type==="Edm.DateTime"||d.type==="Edm.Time"){var f=a.formatDateTimeForCustomColumn(d.type,r);return f;}else{return"{"+r+"}";}}}},formatDateTimeForCustomColumn:function(d,r){if(d==="Edm.DateTimeOffset"){return"{ path: '"+r+"', type: 'sap.ui.model.odata.type.DateTimeOffset', formatOptions: { style: 'medium'}, constraints: {displayFormat: 'Date'}}";}else if(d==="Edm.DateTime"){return"{ path: '"+r+"', type: 'sap.ui.model.odata.type.DateTime', formatOptions: { style: 'medium'}, constraints: {displayFormat: 'Date'}}";}else{return"{ path: '"+r+"', type: 'sap.ui.model.odata.type.Time', formatOptions: { style: 'medium'}}";}},getAdditionalSemanticObjects:function(d){var A;var b=[];for(A in d){if(A.indexOf("com.sap.vocabularies.Common.v1.SemanticObject#")!=-1){b.push(d[A].String);}}if(b.length>0){return b;}},getColumnCellFirstTextVisibility:function(d,D,e){var c=true;var v=!!a.getColumnCellFirstText(d,D,e,c);return v;},getColumnCellSecondTextVisibility:function(d,D,e){var c=true;var v=!!a.getColumnCellSecondText(d,D,e,c);return v;},isSmartLink:function(d){var A;for(A in d){if(A.indexOf('com.sap.vocabularies.Common.v1.SemanticObject')>=0){return true;}}return false;},setInfoHighlight:function(i,h){var m=this.getModel();var M=m.getMetaModel();var c=this.getParent();while(!c.getEntitySet){c=c.getParent();}var e=M.getODataEntitySet(c.getEntitySet());var o=M.getODataEntityType(e.entityType);var C=c.getCustomData();var l=o["com.sap.vocabularies.UI.v1.LineItem"];var s="com.sap.vocabularies.UI.v1.Criticality";for(var x=0;x<C.length;x++){if(C[x].getKey()&&C[x].getKey()==="lineItemQualifier"){var b=C[x].getValue();if(b){l=o["com.sap.vocabularies.UI.v1.LineItem#"+b];s="com.sap.vocabularies.UI.v1.Criticality#"+b;break;}}}if(i===false&&h===false){return"Information";}else if(l&&l[s]){if(l[s].Path){var d=l[s].Path;if(this.getBindingContext()){var r=this.getBindingContext();var R=r.getObject(d);switch(R.toString()){case"0":return"None";case"1":return"Error";case"2":return"Warning";case"3":return"Success";}}}else if(l[s].EnumMember){var f=l[s].EnumMember;switch(f){case"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":return"None";case"com.sap.vocabularies.UI.v1.CriticalityType/Negative":return"Error";case"com.sap.vocabularies.UI.v1.CriticalityType/Critical":return"Warning";case"com.sap.vocabularies.UI.v1.CriticalityType/Positive":return"Success";}}}else{return"None";}}};sap.suite.ui.generic.template.js.AnnotationHelper=a;sap.suite.ui.generic.template.js.AnnotationHelper.getLinkTextForDFwithIBN.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getLabelForDFwithIBN.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getRepeatIndex.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatWithExpandSimple.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getNavigationPathWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getCurrentPathWithExpand.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getCurrentPathWithExpandForContact.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getEntityTypesForFormPersonalization.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.actionControl.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatHeaderTitle.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getTextArrangementForSmartControl.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.matchesBreadCrumb.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13N.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13NColumnForIndicator.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13NColumnForAction.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13NColumnForContactPopUp.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.createP13NColumnForChart.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.hasDeterminingActionsRespectingApplicablePath.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.buildExpressionForProgressIndicatorPercentValue.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.buildExpressionForProgressIndicatorDisplayValue.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.buildExpressionForProgressIndicatorCriticality.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getEditActionButtonVisibility.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getDeleteActionButtonVisibility.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getSubObjPageDeleteActionButtonVisibility.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.isRelatedEntityCreatable.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.buildBreadCrumbExpression.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getApplicablePathForChartToolbarActions.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.buildAnnotatedActionButtonEnablementExpression.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterText.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatImageUrl.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.getPathWithExpandFromHeader.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatImageOrTypeUrl.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelper.formatHeaderImage.requiresIContext=true;})();};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.AnnotationHelperMultipleViews')){jQuery.sap.declare('sap.suite.ui.generic.template.js.AnnotationHelperMultipleViews');sap.ui.define("sap/suite/ui/generic/template/js/AnnotationHelperMultipleViews",["sap/suite/ui/generic/template/js/AnnotationHelper"],function(A){"use strict";function u(m){var c=0;for(var i in m){if(m.hasOwnProperty(i)){++c;if(c>3){return false;}}}return true;}function g(i,q,I){if(q.showCounts){return"{path: '_templPriv>/listReport/multipleViews/items/"+I.key+"', formatter: '._templateFormatters.formatItemTextForMultipleView'}";}return sap.suite.ui.generic.template.js.AnnotationHelper.getIconTabFilterText(i.getInterface(0),I);}function a(t){return"{= ${_templPriv>/listReport/multipleViews/mode} !== 'multi' || ${_templPriv>/listReport/multipleViews/selectedKey} === '"+t.key+"' }";}g.requiresIContext=true;sap.suite.ui.generic.template.js.AnnotationHelperMultipleViews={useSegmentedButton:u,getTextForItem:g,getVisibleForTableTabs:a};return sap.suite.ui.generic.template.js.AnnotationHelperMultipleViews;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.AnnotationHelperReuseComponents')){(function(){"use strict";jQuery.sap.declare("sap.suite.ui.generic.template.js.AnnotationHelperReuseComponents");var U=sap.ui.require("sap/suite/ui/generic/template/extensionAPI/UIMode");function f(r,s){return r.componentName+"::"+r.id+"::"+s;}function g(r){return"!${_templPriv>/generic/embeddedComponents/"+r.id+"/hidden}";}function a(i,e,r,R,d){var t=i.getInterface(0),m=t.getModel(),E=e.entityType?m.getODataEntityType(e.entityType):R.oEntityType;var n=r.binding;if(n){var o=m.getODataAssociationSetEnd(E,n);if(o&&o.entitySet){e=m.getODataEntitySet(o.entitySet);E=m.getODataEntityType(e.entityType);}}var s=e?sap.ui.model.odata.AnnotationHelper.format(t,e["com.sap.vocabularies.Common.v1.SemanticObject"]):R.semanticObject;var O="";if(E&&E.key){E.key.propertyRef.forEach(function(k){O+="{"+k.name+"}::";});O=O.replace(/::$/,"");}var h={"uiMode":"{= ${ui>/createMode} ? '"+U.Create+"' : ( ${ui>/editable} ? '"+U.Edit+"' : '"+U.Display+"') }","semanticObject":s||"","stIsAreaVisible":d?"{= ${_templPriv>/generic/isActive} && !!${_templPriv>/generic/embeddedComponents/"+r.id+"/isInVisibleArea} && "+g(r)+" }":"{_templPriv>/generic/isActive}"};if(r){jQuery.extend(h,r.settings);var v=JSON.stringify(h);v=v.replace(/\}/g,"\\}").replace(/\{/g,"\\{");return v;}}function b(i,e,r,R){return a(i,e,r,R,true);}b.requiresIContext=true;function c(i,e,r,R){return a(i,e,r,R,false);}c.requiresIContext=true;var A={formatIdComponentSection:function(r){return f(r,"ComponentSection");},formatIdComponentSubSection:function(r){return f(r,"ComponentSubSection");},formatIdComponentContainer:function(r){return f(r,"ComponentContainer");},formatVisibleComponentSection:function(r){return"{= "+g(r)+" }";},formatComponentSettingsSubSection:b,formatComponentSettingsCanvas:c};sap.suite.ui.generic.template.js.AnnotationHelperReuseComponents=A;})();};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.QuickTemplates.AnnotationHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.js.QuickTemplates.AnnotationHelper');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/js/QuickTemplates/AnnotationHelper",["sap/ui/base/Object","sap/ui/model/Context","sap/ui/model/odata/AnnotationHelper","sap/ui/model/json/JSONModel"],function(B,C,O,J){"use strict";var A=B.extend("sap.suite.ui.generic.template.js.QuickTemplates.AnnotationHelper");A.TITLE_ANNO_HEURISTIC=["com.sap.vocabularies.UI.v1.Badge/Title/Value","com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value","com.sap.vocabularies.UI.v1.Identification/0/Value"];A.HEADLINE_ANNO_HEURISTIC=["com.sap.vocabularies.UI.v1.Badge/HeadLine/Value","com.sap.vocabularies.Communication.v1.Contact/role","com.sap.vocabularies.UI.v1.HeaderInfo/Description/Value","com.sap.vocabularies.UI.v1.Identification/0/Value","com.sap.vocabularies.UI.v1.Identification/1/Value"];A.IMAGEURL_ANNO_HEURISTIC=["com.sap.vocabularies.UI.v1.Badge/ImageUrl/Value","com.sap.vocabularies.UI.v1.HeaderInfo/ImageUrl/Value"];A.ICONURL_ANNO_HEURISTIC=["com.sap.vocabularies.UI.v1.Badge/TypeImageUrl/Value"];A.TYPENAME_ANNO_HEURISTIC=["com.sap.vocabularies.UI.v1.HeaderInfo/TypeName/Value","com.sap.vocabularies.Common.v1.SemanticObject/String"];A._getAnnotationItem=function(c,v,f,F){if(c&&v&&f){var V=c.getProperty(v);if(F&&V&&V[f]){var i=V[f];return i[F];}return V?V[f]:null;}return undefined;};A.getAnnotationItemForVocabulary=function(c,v){if(v){var p=v.split("/");return A._getAnnotationItem(c,p[0],p.length>1?p[1]:null,p.length>2?p[2]:null);}return undefined;};A.getAnnotationFirstItemFromVocabularies=function(c,v,s){var I=null;if(v&&Array.isArray(v)){for(var i=0;!I&&i<v.length;++i){I=A.getAnnotationItemForVocabulary(c,v[i]);if(s&&I&&A._isEqualValues(s,I)){I=null;}}}return I;};A._resolveBadgeImgUrl=function(c){return A.getAnnotationFirstItemFromVocabularies(c,A.IMAGEURL_ANNO_HEURISTIC);};A._resolveBadgeIconUrl=function(c){var i=A.getAnnotationFirstItemFromVocabularies(c,A.ICONURL_ANNO_HEURISTIC);if(!i){i="sap-icon://form";}return i;};A._resolveBadgeTitle=function(c){return A.getAnnotationFirstItemFromVocabularies(c,A.TITLE_ANNO_HEURISTIC);};A._resolveBadgeTypeName=function(c){return A.getAnnotationFirstItemFromVocabularies(c,A.TYPENAME_ANNO_HEURISTIC);};A._resolveBadgeHeadline=function(c,t){return A.getAnnotationFirstItemFromVocabularies(c,A.HEADLINE_ANNO_HEURISTIC,t);};A._getAnnotationObject=function(i){if(i){var p={};if(i.Label){p.Path=i.Label.Path||i.Label;}else if(i.Value){p.Path=i.Value.Path||i.Value;}else if(i.String){p.String=i.String;}else if(i.Path){p.Path=i.Path;}else{p.String=i;}return p;}return undefined;};A._isEqualValues=function(i,I){if(i&&I){if(i.String&&I.String){return i.String===I.String;}if(i.Value&&I.Value){return i.Value.Path===I.Value.Path;}if(i.Label&&I.Label){return i.Label.Path===I.Label.Path;}}return false;};A._createBadgeContext=function(i,t,T,o,s){var m=new J();var b=new C(m,"/");var I={};var a=A._getAnnotationObject(i);var c=A._getAnnotationObject(t);if(a&&a.String&&a.String.toLowerCase().indexOf("sap-icon://")<0){I.ImageUrl=a;}else{I.TypeImageUrl=c||a;}I.Title=A._getAnnotationObject(T);I.TypeName=A._getAnnotationObject(o);I.SubTitle=A._getAnnotationObject(s);m.setData(I);return b;};A.resolveBadgeTarget=function(c){if(c){var i=A._resolveBadgeImgUrl(c);var t=A._resolveBadgeIconUrl(c);var T=A._resolveBadgeTitle(c);var s=A._resolveBadgeTypeName(c);var h=A._resolveBadgeHeadline(c,T);return A._createBadgeContext(i,t,T,s,h);}return undefined;};A.resolveFieldGroupTarget=function(c){var f=A._getFacetOfType(c,"FieldGroup");if(f){return O.resolvePath(c.getModel().createBindingContext(c.getPath()+"/"+f.index+"/Target"));}return null;};A.resolveLineItemTarget=function(c){var f=A._getFacetOfType(c,"LineItem");if(f){return O.resolvePath(c.getModel().createBindingContext(c.getPath()+"/"+f.index+"/Target"));}return null;};A.resolveFieldGroupFacet=function(c){var f=A._getFacetOfType(c,"FieldGroup");if(f){return c.getPath()+"/"+f.index;}return undefined;};A.resolveLineItemFacet=function(c){var f=A._getFacetOfType(c,"LineItem");if(f){return c.getPath()+"/"+f.index;}return undefined;};A.getTooltip=function(v){var t="";if(v.String){t=v.String;}return t;};A._getFacetOfType=function(c,f){var a=c.getObject();var t=-1;var b=null;if(Array.isArray(a)){jQuery.each(a,function(i,d){if(d.Target&&d.Target.AnnotationPath&&d.Target.AnnotationPath.indexOf(f)>=0){t=i;b=d;}});}if(t>=0){return{facet:b,index:t};}return undefined;};A.getAllPropertyPathsFromFacet=function(c,f){var i=A.createFormatterInterface(c);var m=c.getModel().getMetaModel();var M=A.getMetaDataForContext(c);var o=A.getMetaModelContextForFacetType(i,M.entityType.namespace+"."+M.entityType.name,f);var r=O.resolvePath(o);var R=m.getProperty(r);var a=R.Data||R;var p=[];if(a&&Array.isArray(a)){jQuery.each(a,function(b,d){if(d.RecordType==='com.sap.vocabularies.UI.v1.DataField'&&d.Value&&d.Value.Path){p.push(d.Value.Path);}});}return p;};A.getMetaModelContextForFacetType=function(I,e,f){var m=I.getModel()||I.getModel(0);var E=m.getODataEntityType(e);var s=["QuickCreate","QuickView"];var F="";var M=null;var a=null;for(var i=0;i<s.length;i++){F="com.sap.vocabularies.UI.v1."+s[i]+"Facets";if(E[F]){a=E[F];break;}}if(a){var t=-1;if(Array.isArray(a)){jQuery.each(a,function(i,b){if(b.Target&&b.Target.AnnotationPath&&b.Target.AnnotationPath.indexOf(f)>=0){t=i;}});}if(t>=0){M=new C(m,E.$path+"/"+F+"/"+t+"/Target");}}return M;};A.formatExpandBindingPathForHeaderObject=function(i,e){var h=A.getNavigationPathsFromFacet(i,e,"FieldGroup");return A.formatExpandPaths(h);};A.getMetaDataForContext=function(c){var m=c.getModel().getMetaModel();var e=m.getODataEntityType(c.getObject().__metadata.type);var E=null;var o=m.getProperty(m.getODataEntityContainer(true)).entitySet;jQuery.each(o,function(i,b){if(b.entityType===c.getObject().__metadata.type){E=b.name;}});var a=m.getODataEntitySet(E);return{entityType:e,entitySet:a};};A.getNavigationPathsUsingAnnotationHeuristics=function(o,e){var m={};var M=o.getModel().getMetaModel();if(o&&o.getObject()){m=A.getMetaDataForContext(o);}else if(e){m.entityType=M.getODataEntityType(e);}var n={};if(m&&m.entityType){var t=A.TITLE_ANNO_HEURISTIC.concat(A.HEADLINE_ANNO_HEURISTIC);var i=0;for(;i<t.length;i++){var a=new C(M,m.entityType.$path+"/"+t[i]);var b=O.getNavigationPath(a);if(b){b=b.replace(/[{}]/g,'');if(b){n[b]="";}}}}return Object.keys(n);};A.getNavigationPathsFromFacet=function(I,e,f){var m=I.getModel()||I.getModel(0);var M=A.getMetaModelContextForFacetType(I,e,f);if(!M){return[];}var r=O.resolvePath(M);var R=m.getProperty(r);var n={};var p="/";if(R.Data){p+="Data/";}var a=R.Data||R;if(a&&Array.isArray(a)){jQuery.each(a,function(i,d){if(d.RecordType=='com.sap.vocabularies.UI.v1.DataField'&&d.Value&&d.Value.Path){var b=new C(m,r+p+i+"/Value");var c=O.getNavigationPath(b);c=c.replace(/[{}]/g,'');if(c){n[c]="";}}});}return Object.keys(n);};A.getLineItemsNavPropertyName=function(i,e){var m=A.getMetaModelContextForFacetType(i,e,"LineItem");if(m){var c=O.getNavigationPath(m);c=c.replace(/[{}]/g,'');return c;}return undefined;};A.formatBindingPathForLineItems=function(i,e,I){var l=A.getLineItemsNavPropertyName(i,e);if(arguments.length===2){I=false;}if(I){var a=A.getNavigationPathsFromFacet(i,e,"LineItem");if(a&&a.length>0){return"{path: '"+l+"', parameters : {expand:'"+A.formatExpandPaths(a)+"'}}";}}return"{path: '"+l+"'}";};A.formatExpandPaths=function(e){var E="";for(var i=0;i<e.length;i++){E+=e[i];if(i<e.length-1){E+=",";}}return E;};A.createFormatterInterface=function(b){var m=b.getModel().getMetaModel().getMetaContext(b.getPath());var i={getModel:function(){return b.getModel().getMetaModel();},getContext:function(){return m;},getPath:function(){return m.getPath();}};return i;};A.formatBindingPathForLineItems.requiresIContext=true;A.getMetaModelContextForFacetType.requiresIContext=true;A.formatExpandBindingPathForHeaderObject.requiresIContext=true;A.resolveFieldGroupTarget.requiresIContext=true;A.resolveLineItemTarget.requiresIContext=true;A.resolveLineItemFacet.requiresIContext=true;A.resolveFieldGroupFacet.requiresIContext=true;A.resolveBadgeTarget.requiresIContext=true;return A;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.QuickTemplates.ODataModelHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.js.QuickTemplates.ODataModelHelper');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');jQuery.sap.require('sap.ui.model.Context');sap.ui.define("sap/suite/ui/generic/template/js/QuickTemplates/ODataModelHelper",["sap/ui/base/Object","./AnnotationHelper","sap/ui/model/odata/AnnotationHelper","sap/ui/model/Context"],function(B,Q,O,C){"use strict";var a=B.extend("sap.suite.ui.generic.template.js.QuickTemplates.ODataModelHelper");a.createKeyFromPath=function(s,t,T){try{var b=a.parseEntityKeysFromContextPath(s);var c=a.getKeyInfoForEntitySet(t,T);if(c.entitySet===b.entitySet&&b.keys.length===c.keys.length){if(s.startsWith("/")){return s.substring(1);}return s;}var r=""+c.entitySet+"(";jQuery.each(c.keys,function(i,d){if(!d.mapped){jQuery.each(b.keys,function(j,f){if(f.property===d.property&&f.type===d.type){d.value=f.value;d.mapped=true;return false;}return true;});}if(!d.mapped){jQuery.each(b.keys,function(j,f){var g=f.property.toLowerCase();var h=d.property.toLowerCase();if(h.indexOf(g)>=0&&f.type===d.type){d.value=f.value;d.mapped=true;return false;}return true;});}if(!d.mapped){jQuery.each(b.keys,function(j,f){if(f.property===d.property){if(f.type==="Edm.String"&&d.type!=="Edm.String"){d.value=f.value.substring(1,f.value.length-1);}else if(f.type!=="Edm.String"&&d.type==="Edm.String"){d.value="'"+f.value+"'";}else{d.value=f.value;}d.mapped=true;return false;}return true;});}if(!d.mapped){jQuery.each(b.keys,function(j,f){if(f.type===d.type){d.value=f.value;d.mapped=true;return false;}return true;});}r+=d.property+"="+d.value;if(i<c.keys.length-1){r+=",";}});r+=")";return r;}catch(e){if(s&&s.startsWith("/")){return s.substring(1);}return s;}};a.parseEntityKeysFromContextPath=function(p){var b=p;var r={entitySet:"",keys:[]};if(!b){return r;}if(b.startsWith("/")){b=b.substring(1);}var c=b.split("(");if(c.length>1){r.entitySet=c[0];var k=c[1].split(")")[0];if(k){var d=k.split(",");jQuery.each(d,function(i,e){if(e){var f=e.split("=");var g={};if(f.length==1){g.value=f[0];g.property="";}else if(f.length==2){g.property=f[0];g.value=f[1];}if(g.value){if(g.value.indexOf("guid")==0&&g.value.length==42){g.type="Edm.Guid";}else if(g.value.charAt(0)==="'"&&g.value.charAt(g.value.length-1)==="'"){g.type="Edm.String";}else if(g.value=="true"||g.value=="false"){g.type="Edm.Boolean";}else if(jQuery.isNumeric(g.value)){g.type="Edm.Int";}else{g.type="";}r.keys.push(g);}}});}}return r;};a.getKeyInfoForEntitySet=function(m,e){var r={entitySet:"",keys:[]};var k={};if(m&&e){var b=m.getODataEntitySet(e);r.entitySet=b.name;var c=m.getODataEntityType(b.entityType);jQuery.each(c.key.propertyRef,function(i,p){k[p.name]="1";});jQuery.each(c.property,function(i,p){if(k[p.name]){var d={property:p.name,value:a.getDefaultKeyValueForProperty(p),type:(p.type.indexOf("Edm.Int")>=0?"Edm.Int":p.type)};r.keys.push(d);}});}return r;};a.getDefaultKeyValueForProperty=function(p){if(p.name.indexOf("IsActive")>=0&&p.type==="Edm.Boolean"){return"true";}else{switch(p.type){case"Edm.String":{return"''";}case"Edm.Guid":{return"guid'00000000-0000-0000-0000-000000000000'";}case"Edm.Boolean":{return"false";}default:{if(p.type.indexOf("Int")>=0){return"0";}return"''";}}}};a.initializeObjectProperties=function(o,p,c){var t=[];var k=o.getModel().getKey(o.getObject());var b=o.getModel().oData[k];if(b){t.push(b);}var d=o.getModel().mChangedEntities[k];if(d){t.push(d);}var e=Q.getMetaDataForContext(o);var i=0;if(p&&Array.isArray(p)){jQuery.each(p,function(f,g){var h=g.split("/");var j=h[0];var l=null;if(h.length>1){l=h.slice(1).join("/");}if(jQuery.isNumeric(j)&&l){a.initializeObjectProperties(o,[l],c);return;}i=0;var m=false;if(e.entityType.navigationProperty){for(;i<e.entityType.navigationProperty.length;i++){if(e.entityType.navigationProperty[i].name===j){m=true;break;}}}if(m&&!b[j]){var n=o.getModel().createEntry(o.getPath()+"/"+j,c);b[j]={__deferred:{}};a.restoreNavigationPropertyReferences(o,j,n);if(l){a.initializeObjectProperties(n,[l],c);}}});}};a.restoreLineItemReferences=function(e,c){var i=Q.createFormatterInterface(c);var m=Q.getMetaModelContextForFacetType(i,e,"LineItem");if(m){var s=O.getNavigationPath(m);s=s.replace(/[{}]/g,'');a.restoreNavigationPropertyReferences(c,s);}};a.restoreNavigationPropertyReferences=function(p,n,c){if(!n){return;}if(!p.getObject()){return;}var m=p.getModel().getMetaModel();var o=p.getModel().getKey(p.getObject());var b=p.getModel().oData[o];var e=m.getODataEntityType(b.__metadata.type);var N=m.getODataAssociationEnd(e,n);var s=null;var E=m.getProperty(m.getODataEntityContainer(N.type)).entitySet;jQuery.each(E,function(i,g){if(g.entityType===N.type){s=g.name;}});if(!b[n]){b[n]={};}if(b[n].__list){b[n].__list=[];}var d=function(k){if(b[n].__deferred){delete b[n].__deferred;}if(N.multiplicity==="*"){if(!b[n].__list){b[n].__list=[];}b[n].__list.push(k);}else{b[n].__ref=k;}};if(!c){var f=Object.keys(p.getModel().oData);jQuery.each(f,function(i,k){if(k.indexOf(s)>=0){d(k);}});}else{var k=c.getPath().substring(1);d(k);}};a.findObjects=function(){var p,b,c;if(arguments.length===3){p=arguments[0];b=arguments[1];c=arguments[2];}else if(arguments.length==2){b=arguments[0];c=arguments[1];}var k=c.key||undefined,m=c.matchCallback||undefined,n=c.noMatchCallback||undefined,d=c.maxNestedLevel||3;var e=true;if(!d){d=3;}if(!a.findObjects._recursionCount){a.findObjects._recursionCount=0;}a.findObjects._recursionCount++;if(a.findObjects._recursionCount>d){a.findObjects._recursionCount--;return;}var f=function(o){var s=Object.prototype.toString.call(o);return(s==='[object Array]'||s==='[object Object]');};var h=Object.prototype.hasOwnProperty.bind(b);if(b){for(var i in b){if(h(i)){var I=f(b[i]);if(b[i]&&I){b[i].__nestedKey=i;}e=true;if(i===k&&m){e=m(p,b,b[i]);}else if(n){e=n(p,b,b[i]);}if(e&&I){a.findObjects(b,b[i],{key:k,matchCallback:m,noMatchCallback:n,maxNestedLevel:d});}if(b[i]&&I){delete b[i].__nestedKey;}}}}a.findObjects._recursionCount--;};return a;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.QuickTemplates.QuickActionBaseController')){jQuery.sap.declare('sap.suite.ui.generic.template.js.QuickTemplates.QuickActionBaseController');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/suite/ui/generic/template/js/QuickTemplates/QuickActionBaseController",["sap/ui/core/mvc/Controller","sap/m/MessageBox","./AnnotationHelper"],function(M,a,A){"use strict";var B=M.extend("sap.suite.ui.generic.template.js.QuickTemplates.QuickActionBaseController",{onInit:function(){if(!this._bIsInitialized){this._bIsInitialized=true;this.oComponent=this.getOwnerComponent()||this.getView().getViewData().component;var v=this.getView();v.setModel(this.oComponent.getModel());this.sEntitySet=this.oComponent.getEntitySet();this.oDraftController=this.oComponent.getTransactionController().getDraftController();this.bDraftEnabled=this.oDraftController.getDraftContext().isDraftEnabled(this.sEntitySet);var m=this.getView().getModel().getMetaModel();this.oEntitySetMeta=m.getODataEntitySet(this.sEntitySet);this.oEntityTypeMeta=m.getODataEntityType(this.oEntitySetMeta.entityType);this.oSmartFieldEventDelegate={onAfterRendering:jQuery.proxy(function(e){this._onSmartFieldAfterRendering(e);},this)};}},_onMetaModelLoaded:function(){},_onSmartFieldAfterRendering:function(e){},onBeforeRendering:function(){if(!this._bMetaDataInit){this._bMetaDataInit=true;this.getView().getModel().getMetaModel().loaded().then(jQuery.proxy(this._onMetaModelLoaded,this),jQuery.proxy(this.onError,this));}this.setBusy(false);},setBusy:function(b){if(this.getView().getModel("ui")){this.getView().getModel("ui").setProperty("/busy",b);this.getView().getModel("ui").updateBindings();}},bindView:function(c){var i=this._getFormatterInterface(c);var e=A.formatExpandBindingPathForHeaderObject(i,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name);this.oContext=c;this.getView().bindElement({path:c.getPath(),parameters:{expand:e}});},onError:function(e){this.setBusy(false);if(e.message){this._showErrorMessage(e);}else if(e.response){this._showErrorMessage(e.response);}else{this._showErrorMessage({message:this.formatI18NMessage("QuickAction_Generic_Error")});}},onSmartFieldsCreated:function(e){var c=e.getParameters()[0];if(c&&typeof c.addEventDelegate==='function'){c.removeEventDelegate(this.oSmartFieldEventDelegate);c.addEventDelegate(this.oSmartFieldEventDelegate);}},formatI18NMessage:function(){if(arguments&&arguments[0]){var i=arguments[0];var r=this.getView().getModel("i18n").getResourceBundle();if(arguments.length>1){var b=Array.prototype.slice.call(arguments);return r.getText(i,b.splice(1,arguments.length-1));}return r.getText(i);}return arguments;},_getFormatterInterface:function(c){var b=c?c:this.getView().getBindingContext();return A.createFormatterInterface(b);},_setBindingContext:function(c){this.getView().setBindingContext(c);this.setBusy(false);},_showErrorMessage:function(e){var b=e.response||e;var d=b.message;if(b.statusText){d=b.statusText;}if(b&&b.responseText){try{var E=jQuery.parseJSON(b.responseText);var s=this._getErrorDetail(E);d=(s&&s.length>0)?s:d;}catch(c){}}a.show(d,{icon:a.Icon.ERROR,title:this.formatI18NMessage("QuickAction_Error_Popover"),actions:[a.Action.OK]});},_displaySeverity:function(e){var b;switch(e){case"error":b="Error_Severity_Error";break;case"abort":b="Error_Severity_Abort";break;case"warning":b="Error_Severity_Warning";break;case"info":b="Error_Severity_Info";break;case"termination":b="Error_Severity_Termination";break;case"success":b="Error_Severity_Success";break;}return b;},_getErrorDetail:function(e){var d="";if(e&&e.error&&e.error.message){if(e.error.innererror&&e.error.innererror.errordetails&&e.error.innererror.errordetails.length>0){jQuery.each(e.error.innererror.errordetails,jQuery.proxy(function(i,b){var c=this._displaySeverity(b.severity);d+=this.formatI18NMessage(c,[b.message]);},this));}else if(e.error.message.value){d=e.error.message.value;}}return d;}});return B;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.QuickTemplates.QuickCreateAPI')){jQuery.sap.declare('sap.suite.ui.generic.template.js.QuickTemplates.QuickCreateAPI');jQuery.sap.require('sap.ui.base.ManagedObject');jQuery.sap.require('sap.ui.generic.app.transaction.DraftContext');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/suite/ui/generic/template/js/QuickTemplates/QuickCreateAPI",["sap/ui/base/ManagedObject","sap/ui/generic/app/transaction/DraftContext","sap/m/MessageToast"],function(M,D,a){"use strict";var Q=M.extend("sap.suite.ui.generic.template.js.QuickTemplates.QuickCreateAPI",{metadata:{library:"sap.suite.ui.generic.template",properties:{},events:{objectCreated:{parameters:{context:{type:"sap.ui.model.Context"}}},destroyed:{parameters:{collectionItemGuid:{type:"String"}}},autofillLineItems:{parameters:{numberOfLineItems:{type:"Number"}}}}}});Q.EVENT_CONSTANTS={EventChannel:"sap.fiori.cp.quickactions.EventChannel",QUICKCREATE_LINE_ITEMS_FOUND:"LineItemsFound",QUICKCREATE_VIEW_CREATED:"QuickCreateViewCreated"};var A="items",b="participants";Q.CopilotModelName="FioriCopilotODataModel";Q._Instances={};Q.getInstance=function(c){if(!c){return undefined;}if(c.copilotEntity){return Q._Instances[c.copilotEntity.getODataKey()];}else{return Q._Instances[c];}};Q.createAPI=function(c,C,o){function g(){return o.getView().getBindingContext().getObject();}function d(){return o.getQuickCreateItem();}function e(){return C;}function f(){return c;}function h(){return sap.ui.getCore().getModel(Q.CopilotModelName);}function u(i){if(this._bDestroyed){return;}var L=this.getQuickCreateItem();if(L.draftid===i){return;}L.draftid=i;L.copilotEntity.update(L,{error:jQuery.proxy(function(N){jQuery.sap.log.error(N,"","QuickCreateAPI");},this)});}function j(){return C.getAggregation("rootControl");}function k(){return this.oRootView;}function s(i){this.oRootView=i;this.calculateViewHeight(this.oRootView,true);}function l(){if(this.oRootView&&this.oRootView.getController()&&this.oRootView.getController().bDraftEnabled!==undefined){return this.oRootView.getController().bDraftEnabled;}if(!this.oRootView||!this.oRootView.getBindingContext()){return undefined;}var i=new D(this.getQuickCreateModel());return i.hasDraft(this.oRootView.getBindingContext());}function m(){var i=this.getComponentInstance().getModel();if(!i&&this.oRootView){i=this.oRootView.getModel();}return i;}function n(){return o.isCurrentUserCreator();}function p(){if(!this.oRootView){return undefined;}return this.oRootView.getBindingContext();}function q(){var i=this.getQuickCreateRootBindingContext();if(i&&i.getObject()){return i.getObject().__metadata.type;}return undefined;}function _(i,L,P){var N=P.numberOfLineItems;if(N<=0){return;}this.fireAutofillLineItems({numberOfLineItems:N});}function r(){this._attachToModelBindingChanges();if(!this.oRootView){var V=o.oViewUtils.findFirstViewFromControlHierarchy(this.getRootControl());if(V){this.setRootView(V);}}}function t(){if(!this._bBindingChangeAttached){var i=C.getModel();if(i){var L=i.addBinding.bind(i);var N=this;i.addBinding=function(O){L(O);O.attachEvent("change",N._onDataBindingChanged);};this._bBindingChangeAttached=true;}}}function v(){return new Promise(jQuery.proxy(function(i,L){var N=this.getCopilotModel();N.read("/"+N.getKey(this.getQuickCreateItem()),{success:jQuery.proxy(function(O,R){if(O.modeljson){var P=this.getQuickCreateModel();this._loadingJSON=true;if(this.isDraftEnabled()){P.oData=JSON.parse(O.modeljson);}else{var S=JSON.parse(O.modeljson);P.mChangedEntities=S.mChangedEntities;P.mChangeHandles=S.mChangeHandles;P.mDeferredRequests=S.mDeferredRequests;P.oData=S.oData;}P.updateBindings();}if(i){i();}delete this._loadingJSON;},this),error:jQuery.proxy(function(O){if(L){L(O);}},this)});},this));}function w(){if(!this._oUpdateModelJSONTimer){this._oUpdateModelJSONTimer=setTimeout(this._updateModelJSON,2000);}}function x(){if(this._loadingJSON||this._bDestroyed||!this.isCurrentUserCreator()){return;}this._oUpdateModelJSONTimer=null;var L=this.getQuickCreateItem();var N=this.getQuickCreateModel();var O="";if(this.isDraftEnabled()){var P={};var R=Object.keys(N.mChangedEntities);var S=Object.keys(N.oData);var T={};jQuery.each(S,jQuery.proxy(function(i,V){if(N.mChangedEntities[V]){T={};jQuery.extend(T,N.oData[V]);jQuery.extend(T,N.mChangedEntities[V]);P[V]=T;}else{P[V]=N.oData[V];}},this));jQuery.each(R,jQuery.proxy(function(i,V){if(!P[V]){P[V]=N.mChangedEntities[V];}},this));O=JSON.stringify(P);}else{var U={};U.mChangedEntities=N.mChangedEntities;U.mChangeHandles=N.mChangeHandles;U.mDeferredRequests=N.mDeferredRequests;U.oData=N.oData;O=JSON.stringify(U);}if(O===L.modeljson){return;}L.modeljson=O;L.copilotEntity.update(L,{error:jQuery.proxy(function(i){jQuery.sap.log.error(i,"","QuickCreateAPI");},this)});}function y(){return new Promise(jQuery.proxy(function(i,L){var N=this.getQuickCreateModel();if(this.oRootView&&this.oRootView.getBindingContext()){if(this.isDraftEnabled()){N.remove(this.oRootView.getBindingContext().getPath(),{success:function(){a.show("Draft has been discarded");i();},error:function(O){L(O);}});}else{N.resetChanges();i();}}else{i();}},this));}function z(V,i){if(V){o.calculateViewHeight(V,i);}}function B(i){o.setComponentContainerHeight(i);}function E(i){if(this._bDestroyed){return;}this.fireObjectCreated({context:i});}function F(){sap.ui.getCore().getEventBus().publish(Q.EVENT_CONSTANTS.EventChannel,Q.EVENT_CONSTANTS.QUICKCREATE_VIEW_CREATED,{api:this});}function G(){if(this._bDestroyed){return;}if(this._oUpdateModelJSONTimer){clearTimeout(this._oUpdateModelJSONTimer);this._oUpdateModelJSONTimer=null;}delete Q._Instances[this._InstanceKey];if(c&&!c._bIsBeingDestroyed&&!c.bIsDestroyed){c.destroy();}this.oRootView=undefined;sap.ui.getCore().getEventBus().unsubscribe(Q.EVENT_CONSTANTS.EventChannel,Q.EVENT_CONSTANTS.QUICKCREATE_LINE_ITEMS_FOUND,this._onLineItemsFound,this);this.fireDestroyed({collectionItemGuid:this._InstanceKey});M.prototype.destroy.call(this);this._bDestroyed=true;}function H(P,i){if(this.getCollectionItem()&&this.getCollectionItem().copilotEntity&&this.getCollectionItem().copilotEntity.getParentEntity()&&this.getCollectionItem().copilotEntity.getParentEntity().copilotEntity){if(P===A){return this.getCollectionItem().copilotEntity.getParentEntity().copilotEntity.getItemsPublic(i);}else if(P===b){return this.getCollectionItem().copilotEntity.getParentEntity().copilotEntity.getParticipantsPublic();}else{return new Promise(function(L,N){if(N){N("Error: "+P+" is not a valid part of a collection.");}else{L([]);}});}}return new Promise(function(L,N){if(N){N("Error: Cannot load collection "+P+". Copilot collection entity cannot be accessed");}else{L([]);}});}function I(i){return H.call(this,A,i);}function J(){return H.call(this,b);}var K=new Q();K.COLLECTION_ITEM_TYPES={};K.COLLECTION_ITEM_TYPES.ITEM_TYPE_NOTE="NOTE";K.COLLECTION_ITEM_TYPES.ITEM_TYPE_RELOBJ="RO";K.COLLECTION_ITEM_TYPES.ITEM_TYPE_SCREENSHOT="SCRS";K.COLLECTION_ITEM_TYPES.ITEM_TYPE_IMAGE="IMG";K.COLLECTION_ITEM_TYPES.ITEM_TYPE_DOCUMENT="DOC";K.COLLECTION_ITEM_TYPES=Object.freeze(K.COLLECTION_ITEM_TYPES);jQuery.extend(K,{getCollectionItem:g.bind(K),getQuickCreateItem:d.bind(K),updateDraftID:u.bind(K),getRootControl:j.bind(K),isDraftEnabled:l.bind(K),isCurrentUserCreator:n.bind(K),getQuickCreateRootBindingContext:p.bind(K),getQuickCreateRootEntityType:q.bind(K),_onComponentContainerAfterRendering:r.bind(K),calculateViewHeight:z.bind(K),setComponentContainerHeight:B.bind(K),getQuickCreateModel:m.bind(K),objectCreated:E.bind(K),destroy:G.bind(K),getRootView:k.bind(K),setRootView:s.bind(K),getComponentInstance:e.bind(K),getComponentContainer:f.bind(K),_onDataBindingChanged:w.bind(K),_attachToModelBindingChanges:t.bind(K),loadQuickCreateModelFromJSON:v.bind(K),_updateModelJSON:x.bind(K),getCopilotModel:h.bind(K),discardQuickCreateDraft:y.bind(K),_onLineItemsFound:_.bind(K),fireQuickCreateViewCreated:F.bind(K),getCollectionItems:I.bind(K),getCollectionParticipants:J.bind(K)});c.addEventDelegate({onAfterRendering:K._onComponentContainerAfterRendering});K._InstanceKey=K.getCollectionItem().copilotEntity.getODataKey();if(Q._Instances[K._InstanceKey]){Q._Instances[K._InstanceKey].destroy();}delete Q._Instances[K._InstanceKey];Q._Instances[K._InstanceKey]=K;sap.ui.getCore().getEventBus().subscribe(Q.EVENT_CONSTANTS.EventChannel,Q.EVENT_CONSTANTS.QUICKCREATE_LINE_ITEMS_FOUND,K._onLineItemsFound,K);C.oQuickCreateAPI=K;return C.oQuickCreateAPI;};return Q;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.js.QuickTemplates.QuickTemplateComponentFactory')){jQuery.sap.declare('sap.suite.ui.generic.template.js.QuickTemplates.QuickTemplateComponentFactory');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.ui.model.resource.ResourceModel');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.generic.app.ApplicationController');sap.ui.define("sap/suite/ui/generic/template/js/QuickTemplates/QuickTemplateComponentFactory",["sap/ui/base/Object","sap/ui/core/UIComponent","sap/ui/model/resource/ResourceModel","sap/ui/core/mvc/ViewType","sap/ui/model/json/JSONModel","sap/ui/generic/app/ApplicationController"],function(B,U,R,V,J,A){"use strict";var f=B.extend("sap.suite.ui.generic.template.js.QuickTemplates.QuickTemplateComponentFactory");function e(o){var I=new R({bundleName:"sap/suite/ui/generic/template/QuickCreate/i18n/i18n"});var q=new R({bundleName:"sap/suite/ui/generic/template/QuickView/i18n/i18n"});I.enhance(q.getResourceBundle());var t=o.getModel("i18n");if(t){I.enhance(t.getResourceBundle());}o.setModel(I,"i18n");}function d(o){return o.getMetadata().getComponentName()+"::"+o.getViewName()+"::"+o.getEntitySet();}function c(o,s){var a=o.getTransactionController().getDraftController().getDraftContext().isDraftEnabled(o.getEntitySet());var S=null;var b=o.oContainer.getSettings();S=jQuery.extend({},b);delete S.appComponent;delete S.entitySet;delete S.navigationProperty;return new J({entitySet:o.getEntitySet(),entityType:s,"sap-ui-debug":window["sap-ui-debug"],isDraftEnabled:a,settings:S,manifest:o.getManifest()});}function C(o){return new Promise(jQuery.proxy(function(r,a){var v=null;var m=this.getModel().getMetaModel();m.loaded().then(jQuery.proxy(function(){var b=m.getODataEntitySet(this.getEntitySet());if(!b||!b.entityType){jQuery.sap.log.error("The specified entity set "+this.getEntitySet()+" was not found in loaded metadata of service");if(a){a();}return;}var s=d(this);v=sap.ui.getCore().byId(s);if(v){jQuery.sap.log.warning("View with ID: "+s+" already exists - old view is getting destroyed now!");try{v.destroy();}catch(g){jQuery.sap.log.warning("Error destroying view: "+g);}v=null;}var p=this.getComponentData()?this.getComponentData().preprocessorsData:null;v=sap.ui.view({async:false,viewData:{component:this},preprocessors:{xml:{bindingContexts:{meta:m.createBindingContext(m.getODataEntityType(b.entityType,true)),entitySet:m.createBindingContext(m.getODataEntitySet(this.getEntitySet(),true))},models:{meta:m,entitySet:m,parameter:c(this,b.entityType)},preprocessorsData:p}},id:s,type:V.XML,viewName:this.getViewName(),height:"100%"});r(v);},this));},o));}function i(){U.prototype.init.apply(this,arguments);this._oApplicationController=new A(this.getModel());}function E(){if(this._oApplicationController){this._oApplicationController.destroy();}this._oApplicationController=null;}f.createQuickTemplateComponent=function(o,a){var g={metadata:{library:"sap.suite.ui.generic.template",properties:{viewName:{type:"string",defaultValue:null},entitySet:{type:"string",defaultValue:null}}},getAppComponent:function(){return this;},onBeforeRendering:function(){var j=this.oContainer;var m=!this.createViewStarted&&this.getModel();if(m){m.getMetaModel().loaded().then(function(){if(!this.createViewStarted){this.createViewStarted=true;C(this).then(function(v){this.setAggregation("rootControl",v);if(this.oQuickCreateAPI){this.oQuickCreateAPI.fireQuickCreateViewCreated();}e(this);var k=this.getModel("i18n");if(k){v.setModel(k,"i18n");}j.invalidate();}.bind(this));}}.bind(this));}},getTransactionController:function(){return this._oApplicationController.getTransactionController();},getApplicationController:function(){return this._oApplicationController;}};var b=a.init;a.init=function(){i.apply(this,arguments);if(typeof b==="function"){b.apply(this,arguments);}};var h=a.exit;a.exit=function(){E.apply(this,arguments);if(typeof h==="function"){h.apply(this,arguments);}};jQuery.extend(true,g,a);return U.extend(o,g);};return f;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.ComponentUtils')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.ComponentUtils');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/lib/ComponentUtils",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";var C={};function g(c,o){var h;var H=null;var a;var b;var I=false;var d=[];var e=[];function f(i){var e1;var f1=c.getModel();if(i){if(f1){e1=f1.getProperty(i);}}else{var g1=c.getBindingContext();if(g1){e1=g1.getObject();}}return!!(e1&&e1.__metadata&&e1.__metadata.created);}function j(){return c.getModel("_templPriv");}function k(){return j().getProperty("/generic/viewLevel");}function l(){return o.preprocessorsData;}function m(){return o.oParameterModel;}function n(){var i=c.getModel("i18n").getResourceBundle();return{dataLoadFailedTitle:i.getText("ST_ERROR"),dataLoadFailedText:i.getText("ST_GENERIC_ERROR_LOAD_DATA_TEXT")};}function A(i,e1,f1){if(typeof f1!=="function"){throw new Error("Event handler must be a function");}e.push({template:i,event:e1,handler:f1});}function D(e1,f1,g1){for(var i=e.length;i--;){if(e[i].handler===g1&&e[i].event===f1&&e[i].template===e1){e.splice(i,1);}}}function F(e1,f1,g1){for(var i=0;i<e.length;i++){if(e[i].event===f1&&e[i].template===e1){e[i].handler(g1);}}}function p(i){return i.getMetadata().getName();}function r(){return o.oApplication.isComponentActive(c);}function P(i,e1){var f1=o.oNavigationObserver.getProcessFinished(true);f1.then(function(){if(r()){if(e1){z(true);}F(p(o.oController),"PageDataLoaded",{context:i});}});}function s(){h.then(function(i){if(i){P(i);}});}function S(){o.oHeaderLoadingObserver.startProcess();if(!b){var i=new Promise(function(e1){b=e1;});o.oApplication.getBusyHelper().setBusy(i);}}function t(){I=true;if(!H){h=new Promise(function(i){H=i;});}if(!c.getComponentContainer().getElementBinding().isSuspended()){S();}}function E(){if(b){b();b=null;}o.oHeaderLoadingObserver.stopProcess();}function u(i){var e1=i.getSource().getBoundContext();if(e1){return e1;}if(c.getComponentContainer().getElementBinding().isSuspended()){e1=null;}else{e1=C;}U();E();return e1;}function N(){var i=n();var e1=c.getAppComponent().getNavigationController();e1.navigateToMessagePage({title:i.dataLoadFailedTitle,text:i.dataLoadFailedText,description:"",viewLevel:k()});}function v(){I=false;if(!a){return;}if(a===C){N();}else if(!c.getComponentContainer().getElementBinding().isSuspended()){if(H){H(a);}(o.methods.updateBindingContext||q.noop)();}else{return;}H=null;a=null;}function w(i){E();if(I){a=u(i);}v();}function x(i){a=u(i);v();o.oHeaderLoadingObserver.stopProcess();}function R(i){var e1={};var f1=l();if(f1.rootContextExpand&&f1.rootContextExpand.length){e1.expand=f1.rootContextExpand.join(",");}o.oHeaderLoadingObserver.startProcess();if(o.methods.beforeRebind){o.methods.beforeRebind();}h=new Promise(function(g1){a=null;H=g1;c.getComponentContainer().bindElement({path:i,events:{dataRequested:t,dataReceived:w,change:x},parameters:e1,batchGroupId:"Changes",changeSetId:"Changes"});});if(o.methods.afterRebind){o.methods.afterRebind();}}function U(){var i=c.getComponentContainer();i.unbindElement();a=null;}function y(){var e1=T();var f1=(e1.length===d.length);for(var i=0;i<e1.length&&f1;i++){f1=e1[i]===d[i];}d=e1;return!f1;}function z(e1){var f1=o.reuseComponentProxies;for(var i=0;i<f1.length;i++){f1[i].pathUnchangedCallBack(e1);}}function G(i,e1){var f1=y();if(!i){if(o.routingSpec&&o.routingSpec.noOData){P(null,f1);}return;}var g1=c.getComponentContainer();if(!g1){return;}if(f(i)){U();g1.setBindingContext(g1.getModel().getContext(i));Promise.all([o.oViewRenderedPromise,o.viewRegisterd]).then(z.bind(null,true));}else{var h1=g1.getElementBinding();if(h1){if(h1.getPath()===i){if(h1.isSuspended()){h1.resume();v();}if(I){S();}o.oApplication.getBusyHelper().getUnbusy().then(z.bind(null,f1&&o.routingSpec.noOData));if(!e1){s();}return;}else if(!e1){U();}}var i1=c.getModel("ui");i1.setProperty("/enabled",false);i1.setProperty("/editable",false);R(i);s();}}function J(){var i=c.getComponentContainer().getElementBinding();if(i){c.getModel().invalidateEntry(i.getBoundContext());if(i.isSuspended()){U();}else{i.refresh(true);}}}function K(){var i,e1;i=c.getComponentContainer();if(!i){return;}e1=i.getElementBinding();if(e1){e1.refresh();}}function L(){var i=c.getComponentContainer();var e1=i.getBindingContext();var f1=e1&&e1.getPath();var g1=f1&&f(f1);if(g1){i.setBindingContext();return;}var h1=i.getElementBinding();if(h1&&!h1.isSuspended()){if(o.oTemplateContract.oValidationMessageBinding.getLength()){U();}else{h1.suspend();}E();}}function M(i){o.oApplication.setBackNavigation(i);}function O(i){var e1=k();return o.oApplication.registerContext(i,e1);}function Q(){return o.oApplication.getBreadCrumbInfo(c.getEntitySet());}function T(){return o.oApplication.getCurrentKeys(k());}function V(){return o.oApplication.getCommunicationModel(c);}function W(i){return o.oApplication.getCommunicationObject(c,i);}function X(i,e1,f1,g1){o.oApplication.navigateRoute(i,e1,o,f1,g1);}function Y(){var i=c.getEntitySet();var e1=o.oTemplateContract.mEntityTree[i];return e1.headerTitle;}function Z(){var i=c.getEntitySet();var e1=o.oTemplateContract.mEntityTree[i];return e1.isDraft;}function $(){if(Z()){var i=o.oApplication.getHierarchySectionsFromCurrentHash();return"/"+i[0];}}function _(){return!(o.routingSpec&&o.routingSpec.noOData);}function a1(){return h;}function b1(){return o.oTemplateContract.oPaginatorInfo[k()-1];}function c1(i,e1){var f1=k();if(!e1){f1--;}o.oTemplateContract.oPaginatorInfo[f1]=i;}function d1(i,e1){var f1=e1.getId();var g1=f1.split("::");var h1=g1[g1.length-2];var i1=j();i1.setProperty("/generic/embeddedComponents/"+h1+"/isInVisibleArea",i);}return{setEditableNDC:function(i){o.oApplication.setEditableNDC(i);},getEditableNDC:function(){return o.oApplication.getEditableNDC();},getBusyHelper:function(){return o.oApplication.getBusyHelper();},isNonDraftCreate:f,attach:function(i,e1,f1){A(p(i),e1,f1);},detach:function(i,e1,f1){D(p(i),e1,f1);},fire:function(i,e1,f1){F(p(i),e1,f1);},isListReportTemplate:function(){return sap.suite.ui.generic.template.js.AnnotationHelper.isListReportTemplate(o.routeConfig);},getPreprocessorsData:l,getParameterModelForTemplating:m,bindComponent:G,refreshBinding:K,refreshBindingUnconditional:J,suspendBinding:L,setBackNavigation:M,getTemplatePrivateModel:j,registerContext:O,getViewLevel:k,getBreadCrumbInfo:Q,getCurrentKeys:T,getDraftRootPath:$,getCommunicationModel:V,getCommunicationObject:W,navigateRoute:X,getTitleFromTreeNode:Y,isDraftEnabled:Z,isODataBased:_,isComponentActive:r,navigateToDataLoadedFailedPage:N,getHeaderDataAvailablePromise:a1,getPaginatorInfo:b1,setPaginatorInfo:c1,onVisibilityChangeOfReuseComponent:d1};}return B.extend("sap.suite.ui.generic.template.lib.ComponentUtils",{constructor:function(c,o){q.extend(this,g(c,o));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.ContextBookkeeping')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.ContextBookkeeping');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/lib/ContextBookkeeping",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(a){var p={};var P=[];function c(C){var D=a.getTransactionController().getDraftController();var i=D.getDraftContext();var s=C.getObject();var I=i.hasDraft(C);var t=I&&!s.IsActiveEntity;var u=t&&!s.HasActiveEntity;var v=false;if(s.DraftEntityCreationDateTime&&s.DraftEntityLastChangeDateTime){v=s.DraftEntityCreationDateTime.getTime()!==s.DraftEntityLastChangeDateTime.getTime();}return{bIsDraft:t,bIsDraftSupported:I,bIsCreate:u,bIsDraftModified:v};}function r(C,v){var s=C.getPath();var i=c(C);if(v===1&&!i.bIsCreate){P.push(s);}p[s]={oContextInfo:i,oContext:C};return i;}function b(){for(var i=P.length-1;i>=0;i--){var C=p[P[i]].oContext;if(C){return P[i];}}}function d(C){var s=C.getPath();var R=p[s];return R;}function e(C,R,i){var s=d(C);if(!s.oContextInfo.bIsCreate||!i){s.oRemovalPromise=R;}R.then(function(t){if(!s.oContextInfo.bIsCreate||!i){var D=t.context.getPath();var u=p[D];if(u){delete u.oEditingPromise;}}s.oContext=null;},function(){delete s.oRemovalPromise;});}function f(C,i){e(C,i,false);}function h(C,i){e(C,i,true);}function j(C,E){var i=d(C);i.oEditingPromise=new Promise(function(R,s){var N=function(){delete i.oEditingPromise;s();};E.then(function(t){if(t.draftAdministrativeData){N();}else{R(t);}},N);});i.oEditingPromise.catch(q.noop);}function A(s){var C=p[s];if(C){C.oContext=null;}}function k(M,s){return new Promise(function(R,i){M.read(s+"/SiblingEntity",{success:function(t){var u=M.getContext("/"+M.getKey(t));R(u);},error:function(E){i(E);}});});}function l(C){var i=d(C);if(i.oContextInfo.bIsCreate){return Promise.resolve();}var s=i.oSiblingPromise;if(!s){s=i.oContextInfo.bIsDraftSupported?k(C.getModel(),C.getPath()):Promise.resolve(C);if(i.oContextInfo.bIsDraft||!i.oContextInfo.bIsDraftSupported){i.oSiblingPromise=s;}}return s;}function m(s){var C=p[s];if(!C){return Promise.resolve();}return new Promise(function(R){var i=null;var t=function(){R(i);};var H=function(E){E.then(function(u){var v=u.context.getPath();var w=p[v];if(!w||w.oContext){i={context:u.context,iDisplayMode:2};}t();},t);};if(C.oRemovalPromise){C.oRemovalPromise.then(function(u){i={context:u.context,iDisplayMode:1};var D=u.context.getPath();var v=p[D];var E=v&&v.oEditingPromise;if(E){H(E);}else{t();}},t);}else if(C.oEditingPromise){H(C.oEditingPromise);}else{t();}});}function n(s){if(p[s]){p[s].oContextInfo.bIsDraftModified=true;}}function o(s){return p[s].oContextInfo.bIsDraftModified;}return{registerContext:r,adaptAfterObjectDeleted:A,activationStarted:f,cancellationStarted:h,editingStarted:j,getDraftSiblingPromise:l,getAlternativeContextPromise:m,getPathOfLastShownDraftRoot:b,markDraftAsModified:n,getIsDraftModified:o};}return B.extend("sap.suite.ui.generic.template.lib.ContextBookkeeping",{constructor:function(a){q.extend(this,g(a));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.FlexEnabler')){jQuery.sap.declare("sap.suite.ui.generic.template.lib.FlexEnabler");sap.ui.core.Control.extend("sap.suite.ui.generic.template.lib.FlexEnabler",{metadata:{properties:{flexEnabled:{type:"boolean",group:"Misc",defaultValue:true}}},renderer:function(r,c){"use strict";}});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.FlexibleColumnLayoutHandler')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.FlexibleColumnLayoutHandler');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.f.FlexibleColumnLayoutSemanticHelper');jQuery.sap.require('sap.f.LayoutType');sap.ui.define("sap/suite/ui/generic/template/lib/FlexibleColumnLayoutHandler",["jquery.sap.global","sap/ui/base/Object","sap/f/FlexibleColumnLayoutSemanticHelper","sap/f/LayoutType"],function(q,B,F,L){"use strict";function o(O){sap.ui.require(["sap/suite/ui/generic/template/lib/routingHelper"],O);}var r=Promise.resolve();var d=2;var c=["begin","mid","end"];var m=["messagePageBeginColumn","messagePageMidColumn","messagePageEndColumn"];function t(v){return c[v]?v:d;}function a(v){return t(v)===v;}function g(v){return c[t(v)]+"ColumnPages";}function b(C){for(var i=0;i<c.length;i++){C(m[i],g(i));}}function e(v){return m[t(v)];}function f(v){return c[t(v)];}function h(R){return R.name.length>5&&R.name.lastIndexOf("query")===R.name.length-"query".length;}function j(T){var i;if(T instanceof sap.ui.table.Table){i=T.getRows();}else if(T instanceof sap.m.Table){i=T.getItems();}return i;}function k(T){var i=j(T);var R=i?i[0]:false;return R;}function l(n,N){var M=N.oTemplateContract.oAppComponent.getConfig();var p=M.settings&&M.settings.flexibleColumnLayout;var s=F.getInstanceFor(n,p);var D=s.getDefaultLayouts();var R;var u;var U;var C;var S;var v=-1;var T=N.oTemplateContract,w=N.oRouter;var x=p&&p.maxColumnCountInFCL||3;var y=p&&p.initialColumnsCount&&p.initialColumnsCount===2||false;var z=p&&p.displayNextObjectAfterDelete&&p.displayNextObjectAfterDelete===true;function A(i){if(i>=x||sap.ui.Device.system.phone){return 1;}else{var y1=p&&p.initialColumnsCount||1;var z1=Math.max(i+1,y1);if(sap.ui.Device.system.tablet&&z1>2){z1=2;}return z1;}}function E(i,y1,z1){i.showBeginColumn=i.viewLevel<3;i.showMidColumn=i.viewLevel===0&&y||i.viewLevel===1||i.viewLevel===2;i.showEndColumn=i.viewLevel>1;var A1=A(i.viewLevel);if(y&&i.viewLevel===0){if(A1===1){i.target=[i.name];i.showMidColumn=false;}else{i.target=[i.name,i.pages[0].entitySet];}}else if(y&&i.viewLevel===1){if(A1===1){i.target=[i.name];i.showBeginColumn=false;}else{i.target=z1;}}else{i.target=i.showMidColumn?z1.concat([y1]):y1;}return g(i.viewLevel);}function G(i){if(i==="OneColumn"&&y){return false;}return i===D.defaultLayoutType||i===D.defaultTwoColumnLayoutType||i===D.defaultThreeColumnLayoutType;}function H(i,y1,z1){var A1=T.mRouteToTemplateComponentPromise[z1];if(A1){return A1.then(function(B1){return N.activateOneComponent(y1,i,B1);});}return r;}function I(i){var y1=i.substring(i.length-5,i.length);if(y1==="query"){return i.substring(0,i.length-5);}return i;}function J(i){return Promise.all(i).then(N.afterActivation);}function K(i,y1){var z1=G(i);if(u&&h(u)){u.arguments.query=u.arguments["?query"];if(z1){delete u.arguments.query.FCLLayout;if(q.isEmptyObject(u.arguments.query)){delete u.arguments.query;u.name=I(u.name);}}else{u.arguments.query.FCLLayout=i;}}else if(!z1){u.name=u.name+"query";u.arguments.query={FCLLayout:i};}var A1=w.getURL(u.name,u.arguments);A1=A1.replace("/?","?");N.navigate(A1,y1);}function O(i,y1){return new Promise(function(z1){o(function(A1){z1(A1.determinePath(i,y1,T.routeViewLevel1.pattern));});});}function P(){var i=function(y1,z1){var A1={};if(!u){z1();return;}var B1=u.event.getParameter("config").viewLevel;if(B1<3){A1.begin={route:"root",path:"",isVisible:U.columnsVisibility.beginColumn};if(B1===0){y1(A1);return;}}var C1=I(u.name);if(B1>0){var D1=f(B1);A1[D1]={route:C1,path:u.path,isVisible:B1>2||(B1===1&&U.columnsVisibility.midColumn)||(B1===2&&U.columnsVisibility.endColumn)};}if(B1===2){O(u.routeConfig,u.event).then(function(E1){A1.mid={route:T.routeViewLevel1.name,path:E1,isVisible:U.columnsVisibility.midColumn};y1(A1);});}else{y1(A1);}};return new Promise(i);}function Q(i){var y1=P();y1.then(function(z1){var A1=[];var B1=[z1.begin,z1.mid,z1.end];var C1=N.performPseudoHashChange(B1);for(var D1 in i){if(i[D1]){var E1=z1[D1];if(E1){A1.push(H(C1,E1.path,E1.route));}}}J(A1);},q.noop);}function V(){return!(U.columnsVisibility.beginColumn?U.columnsVisibility.midColumn:U.columnsVisibility.midColumn&&U.columnsVisibility.endColumn);}function W(i){var y1=s.getCurrentUIState();var z1={};z1.end=U&&(U.columnsVisibility.endColumn!==y1.columnsVisibility.endColumn);z1.mid=U&&(U.columnsVisibility.midColumn!==y1.columnsVisibility.midColumn);z1.begin=U&&(U.columnsVisibility.beginColumn!==y1.columnsVisibility.beginColumn);U=y1;T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/midActionButtons",{fullScreen:U.actionButtonsInfo.midColumn.fullScreen!==null,exitFullScreen:U.actionButtonsInfo.midColumn.exitFullScreen!==null,closeColumn:U.actionButtonsInfo.midColumn.closeColumn!==null});T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/endActionButtons",{fullScreen:U.actionButtonsInfo.endColumn.fullScreen!==null,exitFullScreen:U.actionButtonsInfo.endColumn.exitFullScreen!==null,closeColumn:U.actionButtonsInfo.endColumn.closeColumn!==null});T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/isVisuallyFullScreen",V());var A1;if(U.columnsVisibility.endColumn){A1=T.oTemplatePrivateGlobalModel.getProperty("/generic/routeLevel");}else if(U.columnsVisibility.midColumn){A1=1;}else{A1=0;}T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/highestViewLevel",A1);var B1;if(U.columnsVisibility.midColumn){B1=1;}else{B1=T.oTemplatePrivateGlobalModel.getProperty("/generic/routeLevel");}T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL/lowestDetailViewLevel",B1);if(u&&C!==U.layout){K(U.layout,true);}else if((z1.begin||z1.mid||z1.end)&&!i){Q(z1);}}function X(i,y1,z1,A1){return new Promise(function(B1,C1){W(true);var D1=P();D1.then(function(E1){var F1=[];for(var G1 in E1){var H1=E1[G1];if(H1.isVisible){F1.push(H(A1,H1.path,H1.route));}}J(F1).then(B1,C1);});});}function Y(i){i=q.extend({},i);u={name:i.getParameter("name"),arguments:i.getParameter("arguments"),event:i};var y1=i.getParameter("config").viewLevel;var z1=i.getParameter("arguments")["?query"];if(a(y1)){C=(z1&&z1.FCLLayout);if(!C){switch(y1){case 0:var A1=s.getNextUIState(0).columnsVisibility;if(A1.midColumn){C=D.defaultTwoColumnLayoutType;}else{C=D.defaultLayoutType;if(A(y1)>1){K(D.defaultLayoutType,true);}}break;case 1:C=D.defaultTwoColumnLayoutType;break;case 2:C=D.defaultThreeColumnLayoutType;}}}else{C=L.EndColumnFullScreen;}n.setLayout(C);}function Z(i,y1,z1,A1){v=-1;var B1=T.oTemplatePrivateGlobalModel.getProperty("/generic/routeLevel");R=B1===2?i:null;u.path=z1;u.routeConfig=y1;return X(i,y1,z1,A1);}function $(i){return G(i)?{}:{FCLLayout:[i]};}function _(i){return i===L.EndColumnFullScreen||i===L.MidColumnFullScreen;}function a1(i,y1){if(!a(i)){return N.getParStringPromise(y1,false);}var z1=S||s.getNextUIState(i).layout;q.extend(y1,$(z1));S=null;if(_(z1)){return N.getParStringPromise(y1,false);}var A1=(i===2)?N.addUrlParameterInfoForRoute(T.routeViewLevel1.name,y1):r;return new Promise(function(B1){A1.then(function(){N.getParStringPromise(y1,true).then(B1);});});}function b1(){S=U.actionButtonsInfo.midColumn.closeColumn;N.navigateToRoot(true);}function c1(){S=U.actionButtonsInfo.endColumn.closeColumn;var i=R.getParameter("config");O(i,R).then(function(y1){N.navigateToContext(y1,null,true,0);});}function d1(i,y1){var z1=N.oHashChanger.getHash()||"";z1=z1.split("?")[0];var A1=N.getParStringPromise(i,y1);N.navigateToParStringPromise(z1,A1,false);}function e1(i){if(i===0&&u1()){return L.OneColumn;}else if(i===1){return L.MidColumnFullScreen;}else if(i===2){return L.EndColumnFullScreen;}else{return"";}}function f1(){var y1=U.actionButtonsInfo.midColumn.fullScreen;var z1;if(y1===null){y1=U.actionButtonsInfo.endColumn.fullScreen;var A1=N.getActiveComponents();for(var i=0;i<A1.length;i++){var B1=T.componentRegistry[A1[i]];if(B1.viewLevel===2){z1=B1.route;break;}}}else{z1=T.routeViewLevel1.name;}var C1=$(y1);N.addUrlParameterInfoForRoute(z1,C1).then(function(){d1(C1,false);});}function g1(){var i=U.actionButtonsInfo.midColumn.exitFullScreen;var y1;var z1;if(i===null){i=U.actionButtonsInfo.endColumn.exitFullScreen;}var A1=$(i);if(i===U.actionButtonsInfo.endColumn.exitFullScreen){var B1=N.getActiveComponents();var C1=B1[0];var D1=T.componentRegistry[C1];if(D1){y1=N.addUrlParameterInfoForRoute(D1.route,A1);z1=O(u.routeConfig,u.event);}}(y1||r).then(function(){(z1||r).then(function(E1){var F1=N.addUrlParameterInfoForRoute(T.routeViewLevel1.name,A1,E1);F1.then(function(){d1(A1,true);});});});}function h1(i){return a(i)&&{onCloseColumnPressed:i===1?b1:c1,onFullscreenColumnPressed:f1,onExitFullscreenColumnPressed:g1};}function i1(i){return T.oApplicationProxy.getDraftSiblingPromise(i);}function j1(i){if(T.oTemplatePrivateGlobalModel.getProperty("/generic/FCL/highestViewLevel")===2){var y1=R.getParameter("config");var z1=T.mRouteToTemplateComponentPromise[I(y1.name)];var A1=new Promise(function(B1,C1){z1.then(function(D1){var E1=D1.getBindingContext();var F1=i1(E1,true);F1.then(function(G1){o(function(H1){var I1=y1.navigationProperty;var J1=i.getPath()+"/"+H1.determineNavigationPath(G1,I1).path;S=U.layout;N.navigateToContext(J1,null,true,2);B1();});},C1);},C1);});T.oBusyHelper.setBusy(A1);}else{N.navigateToContext(i,null,true,2);}}function k1(i){if(T.oTemplatePrivateGlobalModel.getProperty("/generic/FCL/highestViewLevel")!==2){return Promise.resolve(i);}var y1=new Promise(function(z1){var A1=R.getParameter("config");var B1=T.mRouteToTemplateComponentPromise[I(A1.name)];B1.then(function(C1){var D1=C1.getBindingContext();var E1=i1(D1,true);E1.then(function(F1){if(!F1){z1(i);return;}o(function(G1){var H1=A1.navigationProperty;var I1=i.getPath()+"/"+G1.determineNavigationPath(F1,H1).path;z1(I1);});});});});T.oBusyHelper.setBusy(y1);return y1;}T.oTemplatePrivateGlobalModel.setProperty("/generic/FCL",{});function l1(i){var y1=N.getTargetLevel(i);switch(y1){case 1:return!U.columnsVisibility.midColumn;case 2:return!U.columnsVisibility.endColumn;default:return true;}}function m1(i){C=s.getNextUIState(i).layout;n.setLayout(C);}function n1(){return!V();}function o1(y1){v=t(y1.viewLevel);m1(y1.viewLevel);var z1=N.oRouter.getTargets();var A1=e(y1.viewLevel);z1.display(A1);var B1;if(y1.viewLevel===v){B1=[];for(var i=0;i<y1.viewLevel;i++){B1.push(true);}}return B1;}function p1(i){if(i<v||v<0){return U.columnsVisibility[f(i)+"Column"];}return false;}function q1(i,y1){if(!a(y1)){return i;}var z1=s.getNextUIState(y1).layout;if(G(z1)){return i;}return i+"?FCLLayout="+z1;}function r1(){return x;}function s1(i,y1){if(!y){return;}var z1=false;var A1=s.getNextUIState(0).columnsVisibility;if(A1.midColumn){var B1=u.event.getParameter("config").viewLevel;if(B1===0){z1=true;if(h(u)){u.arguments.query=u.arguments["?query"];if(u.arguments.query.FCLLayout==="OneColumn"){z1=false;}}}}if(z1){if(i){y1(i);}else{N.navigateToRoot(true);}}else{return;}}function t1(){return z;}function u1(){return y;}function v1(i,y1,z1){var A1;A1=k(i);T.oApplicationProxy.setListReportTable(i);if(u1&&u1()){s1(A1,function(){setTimeout(function(){z1.oCommonEventHandlers.onListNavigate(A1,y1);},0);});}}function w1(){S=L.OneColumn;}function x1(i){return{oActionButtonHandlers:h1(i),navigateToDraft:j1,getMaxColumnCountInFCL:r1,handleListReceived:s1,handleDataReceived:v1,isListAndFirstEntryLoadedOnStartup:u1};}n.attachStateChange(W.bind(null,false));return{adaptRoutingInfo:E,createMessagePageTargets:b,displayMessagePage:o1,isLevelActive:p1,handleBeforeRouteMatched:Y,handleRouteMatched:Z,getAppStateParStringForNavigation:a1,getActionButtonHandlers:h1,getTargetAfterCancelPromise:k1,isNewHistoryEntryRequired:l1,adaptBreadCrumbUrl:q1,isAppTitlePrefered:n1,getFullscreenLayout:e1,getMaxColumnCountInFCL:r1,isNextObjectLoadedAfterDelete:t1,getFclProxyForView:x1,setStoredTargetLayoutToOneColumn:w1,isListAndFirstEntryLoadedOnStartup:u1};}return B.extend("sap.suite.ui.generic.template.lib.FlexibleColumnLayoutHandler",{constructor:function(i,n){q.extend(this,l(i,n));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.MessageUtils')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.MessageUtils');jQuery.sap.require('sap.ui.generic.app.util.ModelUtil');jQuery.sap.require('sap.ui.generic.app.util.MessageUtil');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/suite/ui/generic/template/lib/MessageUtils",["sap/ui/generic/app/util/ModelUtil","sap/ui/generic/app/util/MessageUtil","sap/m/MessageBox"],function(M,G,a){"use strict";var l=new jQuery.sap.log.getLogger("sap.suite.ui.generic.template.lib.MessageUtils");function h(o,c,s,e,p){p=p||{};var E=G.parseErrorResponse(e);var m=E.messageText;var b;var n=false;var S=false;var C=c&&c.getOwnerComponent();var r=p.resourceBundle||C.getModel("i18n").getResourceBundle();var N=p.navigationController||s.oNavigationController;var d=p.model||C.getModel();l.debug("handleError has been called with operation "+o+" and HTTP response status code "+E.httpStatusCode);switch(E.httpStatusCode){case"400":switch(o){case G.operations.modifyEntity:break;case G.operations.callAction:m=r.getText("ST_GENERIC_BAD_REQUEST_ACTION");break;case G.operations.deleteEntity:m=r.getText("ST_GENERIC_BAD_REQUEST_DELETE");break;case G.operations.editEntity:m=r.getText("ST_GENERIC_BAD_REQUEST_EDIT");break;case G.operations.saveEntity:case G.operations.activateDraftEntity:if(s&&s.oTemplateCapabilities&&s.oTemplateCapabilities.oMessageButtonHelper&&s.oTemplateCapabilities.oMessageButtonHelper.showMessagePopover){s.oTemplateCapabilities.oMessageButtonHelper.showMessagePopover();S=true;}else{l.info("A MessageButtonHelper class instance could not be found as one of the services' template capabilities.");}break;default:m=r.getText("ST_GENERIC_BAD_REQUEST");break;}break;case"401":n=true;m=r.getText("ST_GENERIC_ERROR_AUTHENTICATED_FAILED");b=r.getText("ST_GENERIC_ERROR_AUTHENTICATED_FAILED_DESC");break;case"403":switch(o){case G.operations.callAction:m=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_ACTION");break;case G.operations.deleteEntity:m=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_DELETE");break;case G.operations.editEntity:m=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_EDIT");break;default:m=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED");b=r.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_DESC");n=true;break;}break;case"404":switch(o){case G.operations.callAction:m=r.getText("ST_GENERIC_BAD_REQUEST_ACTION");break;default:m=r.getText("ST_GENERIC_BAD_REQUEST");break;}break;case"409":case"412":break;case"500":case"501":case"502":case"503":case"504":case"505":n=true;switch(o){case G.operations.callAction:m=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE_FOR_ACTION");break;default:m=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE");break;}b=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE_DESC");break;case undefined:n=false;S=true;break;default:n=true;m=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE");b=r.getText("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE_DESC");break;}if(n){var v;if(C){var t=C.getModel("_templPriv");v=t.getProperty("/generic/viewLevel");}N.navigateToMessagePage({title:r.getText("ST_GENERIC_ERROR_TITLE"),text:m,description:b,icon:"sap-icon://message-error",viewLevel:v});}else{if(!E.containsTransientMessage&&!S){G.addTransientErrorMessage(m,b,d);}}}return{operations:G.operations,handleTransientMessages:G.handleTransientMessages,handleError:h,removeTransientMessages:G.removeTransientMessages};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.ProcessObserver')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.ProcessObserver');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/lib/ProcessObserver",["jquery.sap.global","sap/ui/base/Object"],function(q,B){"use strict";function g(s){var p;var P;function f(){if(s.processName){q.sap.log.info("Process "+s.processName+" started");}p=p||new Promise(function(r){P=r;});}function a(){if(s.processName){q.sap.log.info("Process "+s.processName+" stopped");}if(p){P();p=null;P=null;}}if(s.eventHandlers){s.eventHandlers.attachProcessStart(f);s.eventHandlers.attachProcessStop(a);}function h(){var o=null;for(var i=0;i<s.processObservers.length&&!o;i++){var d=s.processObservers[i];o=d.getProcessFinished();}if(o){f();o.then(h);}else{a();}}function b(A){if(!p&&s.processObservers){h();}return p||(A&&Promise.resolve());}function c(o){s.processObservers.push(o);}return{startProcess:f,stopProcess:a,getProcessFinished:b,addObserver:c};}return B.extend("sap.suite.ui.generic.template.lib.ProcessObserver",{constructor:function(s){q.extend(this,g(s||{}));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.TemplateComponent')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.TemplateComponent');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.CustomizingConfiguration');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.ui.core.Component');jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.resource.ResourceModel');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/suite/ui/generic/template/lib/TemplateComponent",["jquery.sap.global","sap/ui/core/CustomizingConfiguration","sap/ui/core/mvc/ViewType","sap/ui/core/Component","sap/ui/core/UIComponent","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/Device"],function(q,C,V,a,U,J,R,D){"use strict";function g(o){var s=o&&typeof o==="string"?o:(o&&a.getOwnerIdFor(o));var i=s&&sap.ui.component(s);if(i instanceof T){i=i.getAppComponent();}return i;}var G=C.getViewExtension;C.getViewExtension=function(v,s,o){var i=g(o),k=i&&i.getId(),r=G.call(C,v,s,k);return r;};var f=C.getControllerExtension;C.getControllerExtension=function(s,o){var i=g(o),k=i&&i.getId(),r=f.call(C,s,k);return r;};function e(o){var I=new R({bundleName:"sap/suite/ui/generic/template/lib/i18n/i18n"});var k=[];var m=o.getAppComponent().getModel("i18n|"+o.getMetadata().getComponentName()+"|"+o.getEntitySet());if(m){k.push(m);}var t=o.getModel("i18n");if(t){k.push(t);}var p=true;for(var P="i18n";p;){P=P+"||Parent";p=o.getModel(P);if(p){k.push(p);}}for(var i=k.length-1;i>=0;i--){I.enhance(k[i].getResourceBundle());}o.setModel(I,"i18n");}function E(o,m){var M=o.getAppComponent().getManifestEntry("sap.ui5");var i=M.extends&&M.extends.extensions&&M.extends.extensions["sap.ui.controllerExtensions"];var t=o.getTemplateName();var k=i&&i[t]&&i[t]["sap.ui.generic.app"];var s=o.getEntitySet();var B=k&&k[s]&&k[s].Actions;var l={};var n=b(o);if(B){if(n){A(l,B,n);}else{c(l,B);}}else{var S=k&&k[s];for(var p in S){B=S[p]["Actions"];if(B){c(l,B);}}}o.getModel("_templPriv").setProperty("/generic/listCommons/breakoutActionsEnabled",l);}function b(o){var r;var i=o.getAppComponent().getConfig();var s=i&&i.pages[0]&&i.pages[0].component&&i.pages[0].component.settings;if(s&&s.quickVariantSelectionX){r=s.quickVariantSelectionX.variants;}return r;}function A(B,o,t){var k;for(var s in o){k=true;if(o[s].requiresSelection){k=false;}for(var i in t){var l=o[s].id;var m=t[i];var S=sap.suite.ui.generic.template.js.AnnotationHelper.getSuffixFromIconTabFilterKey(m);if(S){l=l.concat(S);}B[l]={enabled:k};}}}function c(B,o){var i;for(var s in o){i=true;if(o[s].requiresSelection){i=false;}B[o[s].id]={enabled:i};}}function d(o){if(o.getAppComponent().getMetadata().getComponentName()===""||o.getTemplateName()===""||o.getEntitySet()===""){}return o.getAppComponent().getMetadata().getComponentName()+"::"+o.getTemplateName()+"::"+o.getEntitySet();}function h(s,o,m,t){var i=o.oComponent;var k=i.getAppComponent();var l=i.getEntitySet();var n=o.utils.isDraftEnabled();var S=null;var p=i.getComponentContainer().getSettings();S=q.extend({},p);delete S.appComponent;delete S.entitySet;delete S.navigationProperty;S.subPages=o.routeConfig.pages;S.routeConfig=o.routeConfig;return new J({entitySet:l,entityType:s,routingSpec:o.routingSpec,"sap-ui-debug":window["sap-ui-debug"],isDraftEnabled:n,settings:S,manifest:k.getInternalManifest(),metaModel:m,templateSpecific:t&&t(),appComponentName:i.getAppComponent().getMetadata().getComponentName(),helper:{bool:{"true":true,"false":false}}});}function j(o,i){var k=o.oComponent,l=o.createViewController,t=o.methods&&o.methods.getTemplateSpecificParameters,m=k.getModel(),M,s,n,p,r,N=o.routingSpec&&o.routingSpec.noOData;if(N){M=new J({entitySet:{},entityType:{}});p=M.createBindingContext("/entitySet");r=M.createBindingContext("/entityType");}else{M=m&&m.getMetaModel();s=m&&k.getEntitySet();var u=s&&M.getODataEntitySet(s);n=u&&u.entityType;if(!n){return{loaded:function(){return Promise.reject(new Error("Unknown entityset "+s));}};}p=M.createBindingContext(M.getODataEntitySet(s,true));r=M.createBindingContext(M.getODataEntityType(n,true));}e(k);E(k,m);q.sap.require("sap.ui.model.odata.AnnotationHelper");var S=d(k);var v=sap.ui.getCore().byId(S);if(v){q.sap.log.warning("View with ID: "+S+" already exists - old view is getting destroyed now!");try{v.destroy();}catch(w){q.sap.log.warning("Error destroying view: "+w);}v=null;}var x=new J(D);x.setDefaultBindingMode("OneWay");o.oParameterModel=h(n,o,M,t);k.runAsOwner(function(){var P=o.preprocessorsData;var y={async:true,preprocessors:{xml:{bindingContexts:{entitySet:p,entityType:r},models:{device:x,entitySet:M,entityType:M,parameter:o.oParameterModel},preprocessorsData:P}},id:S,type:V.XML,viewName:k.getTemplateName(),height:"100%",cache:{keys:i,additionalData:[P]}};if(l){var z=l();y.controller=new z();}v=sap.ui.view(y);});return v;}var T=U.extend("sap.suite.ui.generic.template.lib.TemplateComponent",{metadata:{properties:{templateName:{type:"string",defaultValue:null},entitySet:{type:"string",defaultValue:null},navigationProperty:{type:"string",defaultValue:null},appComponent:{type:"object",defaultValue:null},isRefreshRequired:{type:"boolean",defaultValue:false},isLeaf:{type:"boolean"}},library:"sap.suite.ui.generic.template"},init:function(o){(U.prototype.init||q.noop).apply(this);var u=new J({editable:false,enabled:false});this.setModel(u,"ui");var t=new J({generic:{isActive:false,listCommons:{},viewLevel:this.getComponentData().registryEntry.viewLevel,controlProperties:{},supportedIntents:{},embeddedComponents:{}}});t.setDefaultBindingMode("TwoWay");this.setModel(t,"_templPriv");},getManifestEntry:function(k){var v=U.prototype.getManifestEntry.apply(this,arguments);if(/^\/sap\.ui5\/componentUsages(\/.+)?$/.test(k)){v=q.extend(true,{},v,U.prototype.getManifestEntry.apply(this.getAppComponent(),arguments));}return v;},getComponentContainer:function(){return this.oContainer;},onBeforeRendering:function(o){if(o){var k=o.oComponent.getComponentContainer();var m=!o.createViewStarted&&k&&k.getModel();if(m){m.getMetaModel().loaded().then(function(){if(!o.createViewStarted){var l=[];var p=m.metadataLoaded().then(function(P){var s;if(P&&P.lastModified){s=new Date(P.lastModified).getTime()+"";}else{q.sap.log.error("TemplateComponent: no valid cache key segment last modification date provided by the OData Model");s=new Date().getTime()+"";}return s;});l.push(p);var n=m.annotationsLoaded().then(function(P){var r=0;if(P){for(var i=0;i<P.length;i++){if(P[i].lastModified){var L=new Date(P[i].lastModified).getTime();if(L>r){r=L;}}else{q.sap.log.error("TemplateComponent: no valid cache key segment last modification date provided by OData annotations");r=new Date().getTime()+"";}}}if(r===0){q.sap.log.error("TemplateComponent: no valid cache key segment last modification date provided by OData annotations");r=new Date().getTime();}return r+"";});l.push(n);o.createViewStarted=true;j(o,l).loaded().then(function(v){o.oComponent.setAggregation("rootControl",v);k.invalidate();},function(i){o.fnViewRegisteredResolve(i||{});});}});}}},setContainer:function(){U.prototype.setContainer.apply(this,arguments);},getRouter:function(){if(this.getAppComponent()){return this.getAppComponent().getRouter();}return U.prototype.getRouter.apply(this,arguments);}});return T;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.TemplateViewController')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.TemplateViewController');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/lib/TemplateViewController",["sap/ui/core/mvc/Controller"],function(m){"use strict";return m.extend("sap.suite.ui.generic.template.lib.TemplateViewController",{metadata:{library:"sap.suite.ui.generic.template"}});},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.deletionHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.deletionHelper');sap.ui.define("sap/suite/ui/generic/template/lib/deletionHelper",[],function(){"use strict";function g(t){var A=t.oNavigationControllerProxy.getActiveComponents();var r=[];for(var i=0;i<A.length;i++){var c=A[i];var R=t.componentRegistry[c];var v=R.viewLevel;if(v>0){var C=R.oComponent.getBindingContext();if(C){r[v]=C.getPath();}}}return r;}function a(t,T){var A=t.oNavigationControllerProxy.getActiveComponents();for(var i=0;i<A.length;i++){var c=A[i];var r=t.componentRegistry[c];var v=r.viewLevel;if(v===T){return r;}}}function d(t,o){var r=a(t,0);if(r&&r.methods.displayNextObject){return r.methods.displayNextObject(o);}return Promise.reject();}function G(t,i){var I=t.oFlexibleColumnLayoutHandler&&t.oFlexibleColumnLayoutHandler.isNextObjectLoadedAfterDelete();if(I){var r=a(t,0);if(r){if(i){return[t.oApplicationProxy.getPathOfLastShownDraftRoot()];}return r.methods.getItems&&r.methods.getItems();}}return null;}function n(t,k){if(k===0){t.oNavigationControllerProxy.navigateToRoot(true);}else{var r=a(t,k+1);if(r&&r.methods.navigateUp){r.methods.navigateUp();}else{t.oNavigationControllerProxy.navigateToRoot(true);}}}function p(t,s,i,o){var O=[];var b;var c=[];var C;for(var k=0;k<i.length;k++){C=i[k].getBindingContextPath();c.push(C);}for(var j=0;j<c.length;j++){if(c[j]===s){O.push(c[j]);b=j;break;}}if(b>=0){var I=c.slice(b+1,c.length);var e;if(b>0){e=c.slice(0,b);e.reverse();}O=O.concat(I,e);}else{O=c;}o.then(function(){var N=d(t,O);N.catch(function(){n(t,0);});});}function P(t,o){o.then(function(){var F=t.oTemplatePrivateGlobalModel.getProperty("/generic/forceFullscreenCreate");if(F){t.oNavigationControllerProxy.navigateBack();}else{var O=G(t,true);if(O){d(t,O);}else{n(t,0);}}});}function f(t,o){var c=g(t);var D=[];var s=null;var I;var h=function(j,i){return{deleted:i,position:j};};for(var b in o){var e=o[b];t.oApplicationProxy.prepareDeletion(b,e);var j=c.indexOf(b);if(j===1){I=G(t);if(I){s=b;}}var k=e.then(h.bind(null,j,true),h.bind(null,j,false));D.push(k);}if(s){p(t,s,I,o[s]);}else{Promise.all(D).then(function(r){var K=-1;for(var i=0;i<r.length;i++){var R=r[i];if(R.deleted&&R.position>0){if(K<0||K>=R.position){K=R.position-1;}}}if(K>=0){n(t,K);}});}Promise.all(D).then(function(r){t.oViewDependencyHelper.setRootPageToDirty();});}return{prepareDeletion:f,prepareDeletionOfCreateDraft:P};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.testableHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.testableHelper');sap.ui.define("sap/suite/ui/generic/template/lib/testableHelper",[],function(){"use strict";var t=0;var p;var s={};var c=0;var S={};var C=[];function a(d){return function(I){if(t>=0){return null;}var l=d.log||[];for(var i=0;i<l.length;i++){var L=l[i];if(L.me===I){return L.args;}}};}function r(d){delete d.replace;delete d.observer;if(d.log){if(d.isStatic){var n=[];for(var i=0;i<d.log.length;i++){var l=d.log[i];if(l.testMode===0){n.push(l);}}if(n.length>0){d.log=n;}else{delete d.log;}}else{delete d.log;}}}function b(){C.forEach(r);}function o(f,d){var e;for(var i=0;i<C.length;i++){e=C[i];if(e.fnConstructor===f){e.isStatic=e.isStatic||d;return e;}}e={fnConstructor:f,isStatic:d};e.observable=function(){var g=e.replace?e.observer:f;var R=Object.create(g.prototype);R=g.apply(R,arguments)||R;if(t<0||(t===0&&e.isStatic)){var l={me:R,args:arguments,testMode:t};e.log=e.log||[];e.log.push(l);if(e.observer&&!e.replace){e.observer(R,arguments);}}return R;};C.push(e);return e;}return{startTest:function(){if(t!==0){return null;}t=-1;p={};return p;},endTest:function(){if(t<0){t=0;p=null;b();}},startApp:function(){if(t<0){return{};}t++;c++;var R={id:c};s[c]=R;return R;},endApp:function(A){if(t>0){var i=A.id;if(A===s[i]){t--;delete s[i];}}},testable:function(f,n){if(t===-1){p[n]=p[n]||f;return function(){return p[n].apply(null,arguments);};}return f;},testableStatic:function(f,n){if(t>0||(t===0&&S[n])){return f;}S[n]=S[n]||f;return function(){return S[n].apply(null,arguments);};},getStaticStub:function(){return t===-1&&S;},observableConstructor:function(f,d){if(t>0){return f;}return o(f,d).observable;},observeConstructor:function(f,O,R){if(t>=0){return null;}var d=o(f);if(O&&d.observer){throw new Error("Constructor is already observed");}d.observer=O;d.replace=O&&R;return a(d);}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.library')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.suite.ui.generic.template.library');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.library');sap.ui.define("sap/suite/ui/generic/template/library",['jquery.sap.global','sap/ui/core/library'],function(q,l){"use strict";sap.ui.getCore().initLibrary({name:"sap.suite.ui.generic.template",dependencies:["sap.ui.core"],types:[],interfaces:[],controls:[],elements:[],version:"1.52.19",extensions:{"sap.ui.support":{diagnosticPlugins:["sap/suite/ui/generic/template/support/DiagnosticsTool/DiagnosticsTool"]}}});return sap.suite.ui.generic.template;},false);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.library.support')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.suite.ui.generic.template.library.support');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/suite/ui/generic/template/library.support",["jquery.sap.global","./Config.support"],function(q,C){"use strict";return{name:"sap.suite.ui.generic.template",niceName:"Fiori Element Library",ruleset:[C]};},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.support.DiagnosticsTool.controller.DiagnosticsTool.controller')){jQuery.sap.declare('sap.suite.ui.generic.template.support.DiagnosticsTool.controller.DiagnosticsTool.controller');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/suite/ui/generic/template/support/DiagnosticsTool/controller/DiagnosticsTool.controller",["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox"],function(C,M,a){"use strict";function o(){this.getView().attachAfterRendering(function(){A();});}function O(){var m=this.getView().getModel("data");if(m.getProperty("/status")==="Loading"){M.show("Application is still loading");return;}var t=new Date().toLocaleTimeString([],{hour12:false,hour:"2-digit",minute:"2-digit",second:"2-digit"});m.setData({properties:null,retrieval:t,copyEnabled:false});m.updateBindings();this.getView().getViewData().plugin.onRefresh();}function f(){var n="\r\n";var p="- ";var d=this.getView().getModel("data").getData();if(!(d&&d.properties&&d.url)){a.error("Could not copy data to your clipboard! No data collected",{title:"Error"});return;}var P=d.properties;var c="*************+Extracted by SAP Fiori Elements Diagnostics Plugin [FEDiagnostic]+*************"+n;c+=p+"Extracted on "+new Date().toUTCString()+n;c+=p+"Host: "+d.origin+n;c+=p+"Application status: "+d.status+n;if(d.statusMessage){c+=p+"Notice: "+d.statusMessage+n;}c+=n;c+="APP DATA"+n;for(var i=0,l=P.length;i<l;i++){if(P[i].type==="string"){c+=p+P[i].name+": "+P[i].value+n;}else if(P[i].type==="link"){c+=p+P[i].name+": "+P[i].target+n;}else if(P[i].type==="group"){c+="Group: "+P[i].name+n;}}c+=n;c+="**************************"+n;c+=n;c+=n;c+="PROVIDE"+n;c+=p+"User/Password: <user>/<password>"+n;c+=p+"Steps to recreate the issue: <maybe also provide master data, pictures or video…>"+n;var t=this.getView().byId("CopyDataTextArea").getId();var T=document.getElementById(t);T.style.display="block";T.value=c;T.select();try{var S=document.execCommand("copy");if(S){M.show("Ticket relevant information copied to clip board");}else{a.error("Could not copy data to your clipboard! You can copy it manually from here: "+n+n+c,{title:"Error"});}}catch(e){a.error("Could not copy data to your clipboard! You can copy it manually from here: "+n+n+c,{title:"Error"});}finally{T.style.display="none";}}function b(){var n="<br/>",S="</span>"+n,c="<span>",p=c+"- ",d=this.getView().getModel("data").getData();if(!(d&&d.properties&&d.url)){a.error("Could not copy data to your clipboard! No data collected",{title:"Error"});return;}var P=d.properties,$=jQuery.sap.byId(this.getView().byId("CopyDataHTML").getId()),e=$[0];var g=c+"*************+Extracted by SAP Fiori Elements Diagnostics Plugin [FEDiagnostic]+*************"+S;g+=p+"Extracted on "+new Date().toUTCString()+S;g+=p+"Host: <a href=\""+d.url+"\">"+d.origin+"</a>"+S;g+=p+"Application status: "+d.status+S;if(d.statusMessage){g+=p+"Notice: "+d.statusMessage+S;}g+=n;g+=c+"APP DATA"+S;for(var i=0,l=P.length;i<l;i++){if(P[i].type==="string"){g+=p+P[i].name+": "+P[i].value+S;}else if(P[i].type==="link"){g+=p+P[i].name+": <a href=\""+P[i].target+"\">"+P[i].value+"</a>"+S;}else if(P[i].type==="group"){g+=c+"Group: "+P[i].name+S;}}g+=c+"**************************"+S;g+=n;g+=c+"PROVIDE"+S;g+=c+"User/Password: &lt;user&gt;/&lt;password&gt;"+S;g+=c+"Steps to recreate the issue: &lt;maybe also provide master data, pictures or video…&gt;"+S;function r(){try{document.getSelection().removeAllRanges();}catch(j){jQuery.noop();}}$.empty();jQuery(g).appendTo(e);try{var h=document.createRange();r();h.selectNode(e);document.getSelection().addRange(h);document.execCommand("copy");r();M.show("Ticket relevant information copied to clip board with HTML format");}catch(j){r();f();}finally{$.empty();}}function A(){var g=jQuery(".diagnosticPropertiesGroupHeaderContent");if(g.length===0){jQuery.sap.log.debug("No headers found which should be customized");return;}var G,c,$;for(var i=0;i<g.length;i++){G=jQuery(g[i]);c=G.parents("td:first");$=jQuery("#"+c[0].id);$.addClass("diagnosticPropertiesGroupHeader");$.attr("colspan",2);$.next().remove();}}function u(t,S){var m=this.getView().getModel("data");m.setData({timeLeft:t,status:S});}function s(){if(jQuery.sap.fioriElementsPluginID){var v=jQuery.sap.byId(jQuery.sap.fioriElementsPluginID);if(v&&v.parent()&&!v.parent().hasClass("sapUiSupportHidden")){M.show("Data refreshed");}}}return C.extend("sap.suite.ui.generic.template.support.DiagnosticsTool.controller.DiagnosticsTool",{onInit:o,onRefreshData:O,onCopyDataPlain:f,onCopyDataHTML:b,updateStatus:u,showDataRefreshed:s});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.support.lib.CommonMethods')){jQuery.sap.declare('sap.suite.ui.generic.template.support.lib.CommonMethods');sap.ui.define("sap/suite/ui/generic/template/support/lib/CommonMethods",[],function(){"use strict";var A={UNKNOWN:"Unknown",FAILED:"Failed",LOADING:"Loading",RENDERED:"Rendered"};var o=A.UNKNOWN;var c={};function g(P){var k=1;if(P[0]==="-"){k=-1;P=P.substr(1);}return function(a,b){if(!a[P]){return(k===1?1:-1);}else if(!b[P]){return(k===1?-1:1);}var r=0;if(a[P]<b[P]){r=-1;}else if(a[P]>b[P]){r=1;}return r*k;};}function G(P){if(P){return jQuery.getJSON(P);}return undefined;}function i(a){for(var I in A){if(A[I]===a){return true;}}return false;}function f(){return o;}function s(a){o=i(a)?a:A.UNKNOWN;}function d(){return c;}function S(a){c=a;return true;}function p(a,E,D){jQuery.sap.log.info("Global event '"+E+"' published on channel '"+a+"'");sap.ui.getCore().getEventBus().publish(a,E,D);}function C(a){if(!a||a.length<1){return"";}var b="";for(var I=0;I<a.length;I++){if(!a[I]||!(typeof a[I]==="string")){continue;}if(b){b+=", ";}b+=a[I];}return b;}function h(O){if(!O){return false;}return Object.keys(O).length>0;}function e(u){if(!u){return"";}var P=u.split("#");if(P.length<2){return"";}else{var H=P[1];var a=H.indexOf("~");var b=H.indexOf("?");var k=H.indexOf("/");var l=H.indexOf("&");if(a&&a!==-1&&(a<b||b===-1)&&(a<k||k===-1)&&(a<l||l===-1)){return H.substr(0,a);}else if(b&&b!==-1&&(b<a||a===-1)&&(b<k||k===-1)&&(b<l||l===-1)){return H.substr(0,b);}else if(k&&k!==-1&&(k<a||a===-1)&&(k<b||b===-1)&&(k<l||l===-1)){return H.substr(0,k);}else if(l&&l!==-1&&(l<a||a===-1)&&(l<b||b===-1)&&(l<k||k===-1)){return H.substr(0,l);}else{return H;}}}function j(u){if(!u){return"";}var P=u.split("#");if(P.length<=0){return"";}else if(P.length===1){return P[0];}else{return P[0]+"#"+e(u);}}return{mApplicationStatus:A,getDynamicComparator:g,getFileFromURI:G,isValidApplicationStatus:i,getApplicationStatus:f,setApplicationStatus:s,getAppComponent:d,setAppComponent:S,publishEvent:p,concatStrings:C,hasObjectContent:h,getApplicationName:e,shortenURL:j};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.extensionAPI.ExtensionAPI')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.extensionAPI.ExtensionAPI');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/extensionAPI/ExtensionAPI",["jquery.sap.global","sap/ui/base/Object","sap/suite/ui/generic/template/extensionAPI/NavigationController"],function(q,B,N){"use strict";function g(t,c,s){var n;return{getSelectedContexts:function(u){var C=s.oSmartTable;if(u){C=c.byId(u);}return t.oCommonUtils.getSelectedContexts(C);},rebindTable:function(){s.oSmartTable.rebindTable();},refreshTable:function(){if(s.oSmartTable){s.oController.getOwnerComponent().getModel("_templPriv").setProperty('/alp/_ignoreChartSelections',false);t.oCommonUtils.refreshSmartTable(s.oSmartTable);}},_refreshChart:function(){if(s.oSmartChart&&s.oSmartChart.rebindChart){s.oSmartChart.rebindChart();}},_refreshFilters:function(){if(s.alr_visualFilterBar&&s.alr_visualFilterBar.updateVisualFilterBindings){s.alr_visualFilterBar.updateVisualFilterBindings(true);}},_refreshKpi:function(){if(s.oKpiTagContainer){var C=s.oKpiTagContainer.mAggregations.content;for(var i in C){if(C[i].getModelName&&C[i].getModelName()==="kpi"){C[i]._firstTime=true;C[i].onBeforeRendering();}}}},refresh:function(){this._refreshFilters();this._refreshChart();this.refreshTable();this._refreshKpi();},attachToView:function(C){t.oCommonUtils.attachControlToView(C);},invokeActions:function(f,C,u){var a,p;if(!C){a=[];}else if(C instanceof sap.ui.model.Context){a=[C];}else{a=C;}if(u){p={urlParameters:u};}return t.oServices.oApplicationController.invokeActions(f,a,p);},getNavigationController:function(){if(!n){n=new N(t,c,s);}return n;},securedExecution:function(f,p){return t.oCommonUtils.securedExecution(f,p,s);},onCustomAppStateChange:function(){s.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();}};}return B.extend("sap.suite.ui.generic.template.AnalyticalListPage.extensionAPI.ExtensionAPI",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper')){(function(){"use strict";jQuery.sap.require('sap.ui.comp.smartfield.SmartField');jQuery.sap.require('sap.ui.model.Context');sap.ui.require("sap/suite/ui/generic/template/extensionAPI/UIMode");jQuery.sap.declare("sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper");sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper={getDetailEntitySet:function(c){var o=c.getObject();var m=c.getModel();var M=m.getProperty("/metaModel");return M.createBindingContext(M.getODataEntitySet(o,true));},resolveMetaModelPath:function(c){var p=c.getObject();var m=c.getModel();var M=m.getProperty("/metaModel");return M.createBindingContext(p);},createWorkingContext:function(c){var p=c.getObject(),s=p.settings,m=c.getModel(),M=m.getProperty("/metaModel"),E=M.getODataEntitySet(p.entitySet),o=M.getODataEntityType(E.entityType),a="",w={};a=o.$path+"/com.sap.vocabularies.UI.v1.SelectionPresentationVariant"+(s&&s.qualifier?"#"+s.qualifier:"");w.selectionPresentationVariant=M.getObject(a);w.selectionPresentationVariantQualifier=a.split("#")[1]||"";w.selectionPresentationVariantPath=a;if(w.selectionPresentationVariant&&w.selectionPresentationVariant.PresentationVariant){a=w.selectionPresentationVariant.PresentationVariant.Path||w.selectionPresentationVariant.PresentationVariant.AnnotationPath||w.selectionPresentationVariantPath+"/PresentationVariant";if(a.indexOf("@")===0){a=o.$path+"/"+a.substr(1);}}else{a=o.$path+"/com.sap.vocabularies.UI.v1.PresentationVariant"+(s&&s.qualifier?"#"+s.qualifier:"");}if(typeof a==="string"){w.presentationVariant=M.getObject(a);w.presentationVariantPath=a;w.presentationVariantQualifier=a.split("#")[1]||"";}if(s.qualifier&&!w.presentationVariant){var e=new Error("Error in manifest.json: Not SelectionPresentationVariant or PresentationVariant found for qualifier: "+s.qualifier,"./manifest.json");throw e;}if(w.presentationVariant&&w.presentationVariant.Visualizations){w.presentationVariant.Visualizations.forEach(function(v){var P="/"+v.AnnotationPath.slice(1);if(P.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1){a=o.$path+P;w.lineItem=M.getObject(a);w.lineItemPath=a;w.lineItemQualifier=a.split("#")[1]||"";}if(!s.chartPresentationQualifier&&(P.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1)){a=o.$path+P;w.chart=M.getObject(a);w.chartPath=a;w.chartQualifier=a.split("#")[1]||"";}});}if(!w.lineItem){a=o.$path+"/com.sap.vocabularies.UI.v1.LineItem";w.lineItem=M.getObject(a);w.lineItemPath=a;w.lineItemQualifier="";}if(s&&s.chartPresentationQualifier){var b=o.$path+"/com.sap.vocabularies.UI.v1.PresentationVariant"+"#"+s.chartPresentationQualifier;var C=M.getObject(b);if(!C){var e=new Error("Error in manifest.json: No PresentationVariant found for qualifier: "+s.chartPresentationQualifier,"./manifest.json");throw e;}if(C&&!C.Visualizations){var e=new Error("Error: No Visualizations found in PresentationVariant for chartPresentationVariantQualifier: "+s.chartPresentationQualifier,"./manifest.json");throw e;}else{C.Visualizations.forEach(function(v){var P="/"+v.AnnotationPath.slice(1);if(P.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1){a=o.$path+P;w.chart=M.getObject(a);w.chartPath=a;w.chartPresentationVariantQualifier=s.chartPresentationQualifier;w.chartQualifier=a.split("#")[1]||"";}});if(!w.chart){var e=new Error("Error: No chart annotations found with chartPresentationVariantQualifier "+s.chartPresentationQualifier,"./manifest.json");throw e;}}}if(!s.chartPresentationQualifier&&!w.chart){a=o.$path+"/com.sap.vocabularies.UI.v1.Chart";w.chart=M.getObject(a);w.chartPath=a;w.chartQualifier="";}m.setProperty("/workingContext",w);return"/workingContext";},hasDeterminingActionsForALP:function(t,c,e,m){if(e&&m&&m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]&&sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper._hasCustomDeterminingActionsInALP(e,m["sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"]["sap.ui.generic.app"])){return true;}for(var r=0;r<t.length;r++){if((t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||t[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&t[r].Determining&&t[r].Determining.Bool==="true"){return true;}}for(var r=0;r<c.length;r++){if((c[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"||c[r].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")&&c[r].Determining&&c[r].Determining.Bool==="true"){return true;}}return false;},_hasCustomDeterminingActionsInALP:function(e,m){if(m&&m[e]){var M=m[e];if(M.Actions){for(var a in M.Actions){if(M.Actions[a].determining){return true;}}}}return false;}};sap.suite.ui.generic.template.AnalyticalListPage.util.AnnotationHelper.getDetailEntitySet.requiresIContext=true;})();};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.FilterUtil')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.FilterUtil');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil",["sap/ui/base/Object","sap/ui/model/Context","sap/suite/ui/generic/template/AnalyticalListPage/util/OperationCode","jquery.sap.global"],function(B,C,O,q){"use strict";var F=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.FilterUtil");F.createTitle=function(d,D){var t;if(!d){return D;}if(D instanceof Date){return d;}if(d.indexOf(':')!==-1){d=d.substring(0,d.indexOf(':'));}if(d.indexOf(D)===-1){t=d+" ("+D+")";}else{t=d;}return t;};F.readProperty=function(o,n){var i=0,p=typeof n==='string'?n.split("."):[];while(i<p.length){if(!o){return undefined;}o=o[p[i++]];}return o;};F.executeFunction=function(o,f,a){var i=0,p,P=typeof f==='string'?f.split("."):[];while(i<P.length){if(!o){return undefined;}p=o;o=o[P[i++]];}return typeof o==='function'?o.apply(p,a):undefined;};F.createTitleFromCode=function(f){var v=F.readProperty(f,"value1"),V=F.readProperty(f,"value2"),o=F.readProperty(f,"operation"),r;if(!v||!o||!O[o]){return undefined;}if(V&&o!=="EQ"){r=v+O[o].code+V;}else if(O[o].position==="last"){r=v+O[o].code;}else if(O[o].position==="mid"){r=O[o].code+v+O[o].code;}else{r=O[o].code+v;}if(f.exclude){r="!("+r+")";}return r;};F.formatFiltersLink=function(c){var i=this.getModel("i18n"),r=i.getResourceBundle();var l=c?(Object.keys(c).length-(Object.keys(c).indexOf("_CUSTOM")!==-1)):0;return(c&&l)?r.getText("VISUAL_FILTER_FILTERS_WITH_COUNT",[l]):r.getText("VISUAL_FILTER_FILTERS");};F.getBooleanValue=function(v,d){if(v&&v.Bool){if(v.Bool.toLowerCase()==="true"){return true;}else if(v.Bool.toLowerCase()==="false"){return false;}}return d;};F.getPrimitiveValue=function(v){var a;if(v){if(v.String){a=v.String;}else if(v.Bool){a=F.getBooleanValue(v);}else if(v.EnumMember){a=v.EnumMember.split("/")[1];}else{a=F.getNumberValue(v);}}return a;};F.getNumberValue=function(v){if(v){var V=Object.keys(v)[0];return(v&&V&&["String","Int","Decimal","Double","Single"].indexOf(V)!==-1)?Number(v[V]):undefined;}};F.getPathOrPrimitiveValue=function(i){if(i){return(i.Path)?"{path:'"+i.Path+"'}":F.getPrimitiveValue(i);}else{return"";}};F.isFilterDiff=function(f,a){if(q.isArray(f)!=q.isArray(a)){return true;}if(q.isArray(f)){return this.isFilterListDiff(f,a);}else{return this.isFilterObjDiff(f,a);}};F.isFilterObjDiff=function(f,b){if(!f||!b){return true;}for(var a in f){if(a=="aFilters"){if(this.isFilterListDiff(f.aFilters,b.aFilters)){return true;}}else if(f[a]!=b[a]){return true;}}return false;};F.getDateInMedium=function(d){return(d instanceof Date)?sap.ui.core.format.DateFormat.getDateInstance({style:"medium"}).format(d):undefined;};F.isDefaultVariantSelected=function(s){var v=s.oSmartFilterbar.getSmartVariant();return(v&&v.getCurrentVariantId()===v.getDefaultVariantKey());};F.isFilterListDiff=function(l,L){if(!l||!L){return true;}if(l.length!=L.length){return true;}for(var i=0;i<l.length;i++){var f=l[i];var a=L[i];if(this.isFilterObjDiff(f,a)){return true;}}return false;};F.getTextArrangement=function(d,i,t){var l,D=d?d:i,s=(d&&i)?d+" ("+i+")":D;if(i!=="__IS_OTHER__"&&i!=="Other"){switch(t){case sap.ui.comp.smartfilterbar.DisplayBehaviour.descriptionAndId:l=s;break;case sap.ui.comp.smartfilterbar.DisplayBehaviour.descriptionOnly:l=d?d:"";break;case sap.ui.comp.smartfilterbar.DisplayBehaviour.idAndDescription:l=(d&&i)?i+" ("+d+")":D;break;case sap.ui.comp.smartfilterbar.DisplayBehaviour.idOnly:l=i?i:"";break;default:l=s;break;}}else{l=d;}return l;};F.getTooltipForValueHelp=function(i,d,r,c){var t="";if(!c){t=i?r.getText("VALUE_HELP",d):r.getText("DROPDOWN_WITHOUT_SELECTIONS",d);}else{if(!i){t=r.getText("DROPDOWN_WITH_SELECTIONS",d);}else{t=(c===1)?r.getText("VH_SINGLE_SELECTED",[d,c]):r.getText("VH_MULTI_SELECTED",[d,c]);}}return t;};F.getPropertyNameDisplay=function(m,e,p){var b="/"+e+"/",a=m.getData(b+p+"/#@sap:label");return a?a:p;};return F;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiUtil')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiUtil');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/KpiUtil",["sap/ui/base/Object","sap/ui/model/Context","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms"],function(B,C,V){"use strict";var K=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.KpiUtil");K.getNumberValue=function(v){if(v){var a=Object.keys(v)[0];return(v&&a&&["String","Int","Decimal","Double","Single"].indexOf(a)!==-1)?Number(v[a]):undefined;}};K.getBooleanValue=function(v,d){if(v&&v.Bool){if(v.Bool.toLowerCase()==="true"){return true;}else if(v.Bool.toLowerCase()==="false"){return false;}}return d;};K.getPrimitiveValue=function(v){var a;if(v){if(v.String){a=v.String;if(a.indexOf(">")>0){a=a.replace(/[{}]/g,"");}}else if(v.Bool){a=K.getBooleanValue(v);}else if(v.EnumMember){a=v.EnumMember.split("/")[1];}else{a=K.getNumberValue(v);}}return a;};K.getPathOrPrimitiveValue=function(i){if(i){return(i.Path)?"{path:'"+i.Path+"'}":K.getPrimitiveValue(i);}else{return"";}};K.isBindingValue=function(v){return(typeof v==="string")&&v.charAt(0)==="{";};K.getNumberFormatter=function(s,a,m){var f=sap.ui.core.format.NumberFormat.getIntegerInstance({style:"short",minFractionDigits:0,maxFractionDigits:m,showScale:s,shortRefNumber:a});return f;};K.determineThousandsRefNumber=function(s){var a=s;if(s>=1000){var t=0;while(a>=1000){a/=1000;t++;}return t==0?undefined:t*1000;}else{return undefined;}};K.formatNumberForPresentation=function(v,s,n,S){var a=Number(v);var c=sap.ui.getCore().getConfiguration().getLanguage();var o=new sap.ui.core.Locale(c);if(n>2){n=2;}var N=sap.ui.core.format.NumberFormat.getFloatInstance({style:"short",showScale:s,minFractionDigits:0,maxFractionDigits:2,decimals:n,shortRefNumber:S},o).format(a);return N;};K.formatNumberForPercentPresentation=function(v,n){var p=Number(v);if(n){var m=0;var a=n;if(n>2){a=2;}var b=sap.ui.core.format.NumberFormat.getPercentInstance({style:"short",minFractionDigits:m,maxFractionDigits:a});return b.format(p);}else{var b=sap.ui.core.format.NumberFormat.getPercentInstance({style:"short",minFractionDigits:0,maxFractionDigits:1});return b.format(p);}};K.getUnitofMeasure=function(m,e){return(e)?e["Org.OData.Measures.V1.ISOCurrency"]||e["Org.OData.Measures.V1.Unit"]:"";};K.isRelative=function(d){var t=d.TrendCalculation;var r=false;if(t){var a=t.IsRelativeDifference.DefaultValue;r=K.getBooleanValue(t.IsRelativeDifference,a?({"true":true,"false":false})[a.toLowerCase()]:false);}return r;};K.getFilter=function(r,s){var f={path:s.PropertyName.PropertyPath,operator:r.Option.EnumMember.split("/")[1],value1:r.Low.String,value2:r.High?r.High.String:"",sign:r.Sign.EnumMember===V.SelectionRangeSignType+"/I"?"I":"E"};if(f.sign==="E"&&f.operator!==sap.ui.model.FilterOperator.EQ){jQuery.sap.log.error("Exclude sign is supported only with EQ operator");}else{if(f.sign==="E"&&f.operator===sap.ui.model.FilterOperator.EQ){f.operator=sap.ui.model.FilterOperator.NE;f.sign="I";}return f;}};return K;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/KpiVizAnnotationHelper",["sap/ui/base/Object","sap/ui/model/Context","sap/ui/model/odata/AnnotationHelper","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms"],function(B,C,O,V){"use strict";var A=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper");sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper.constants={LABEL_KEY:"sap:label",TEXT_KEY:"sap:text",TYPE_KEY:"type"};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper.config={"Line":{"type":"line","dimensions":{"min":1,"defaultRole":"Category"},"measures":{"min":1},"feeds":[{"uid":"valueAxis","type":"measure"},{"uid":"categoryAxis","min":1,"type":"dimension","role":"Category"},{"uid":"color","type":"dimension","role":"Series"}]},"Column":{"type":"column","dimensions":{"min":1,"defaultRole":"Category"},"measures":{"min":1,"defaultRole":"Axis1"},"feeds":[{"uid":"valueAxis","min":1,"type":"measure"},{"uid":"categoryAxis","min":1,"type":"dimension"}]},"Donut":{"type":"donut","dimensions":{"min":1},"measures":{"min":1,"max":1},"feeds":[{"uid":"size","min":1,"max":1,"type":"measure"},{"uid":"color","min":1,"type":"dimension"}]},"Bar":{"type":"bar","dimensions":{"min":1,"defaultRole":"Category"},"measures":{"min":1,"defaultRole":"Axis1"},"feeds":[{"uid":"valueAxis","min":1,"type":"measure"},{"uid":"categoryAxis","min":1,"type":"dimension"}]}};A._createSortObject=function(d,m,c){var s="";if(c.EnumMember=="com.sap.vocabularies.UI.v1.ChartType/Line"){s=d[0].Dimension.PropertyPath;}else{s=m[0].Measure.PropertyPath;}return s;};A.formatItems=function(c,e,s,p,D,M,o,S){var a=c.getSetting("dataModel");var r="{";var b=[];var f=[];var g=[];var F=s&&s.SelectOptions;var P=s&&s.Parameters;var h=p&&p.SortOrder;var j=p&&p.MaxItems,k=null;var t;var l=null;var n=sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper;var q="sap:text";if(j){k=j.Int32?j.Int32:j.Int;}if(k){if(k=="0"){jQuery.sap.log.error("maxItems is configured as "+k);r+="}";return r;}if(!/^\d+$/.test(k)){jQuery.sap.log.error("maxItems is Invalid. "+"Please enter an Integer.");r+="}";return r;}}if(P){var u=sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationHelper.resolveParameterizedEntitySet(a,e,s);r+="path: '"+u+"'";}else{r+="path: '"+S.model+">/"+e.name+"'";}var v=[];if(!S){jQuery.sap.log.error("NO KPI card settings in card formmater");r+="}";return r;}l=S.entitySet;if(!a||!l){return r;}var w=n.getMetadata(a,l);if(F){F.forEach(function(d){var m=d.PropertyName.PropertyPath;d[m].forEach(function(R){if(R.Sign.EnumMember===V.SelectionRangeSignType+"/I"){var I={path:m,operator:R.Option.EnumMember.split("/")[1],value1:R.Low.String,value2:R.High?R.High.String:""};v.push(I);}});});}if(v.length>0){r+=", filters: "+JSON.stringify(v);}if(h){var x=p.SortOrder;if(x.length<1){jQuery.sap.log.warning("Kpi Card no Sort annotaion defined");}else{var y="";var z;var E;var G;for(var i=0;i<x.length;i++){z=x[i];G=z.Property.PropertyPath;if(!G||!w[G]){G=n._createSortObject(D,M,o);}g.push(G);if(typeof z.Descending=="undefined"){E="true";}else{var H=z.Descending.Bool;if(!H){jQuery.sap.log.warning(n.errorMessages.CARD_WARNING+n.errorMessages.BOOLEAN_ERROR);E="true";}else{E=H.toLowerCase()==="true";}}y=y+"{path: '"+G+"',descending: "+E+"},";}r+=", sorter: ["+y.substring(0,y.length-1)+"]";}}jQuery.each(M,function(i,m){t=m.Measure.PropertyPath;f.push(t);if(w&&w[t]&&w[t][q]&&t!=w[t][q]){f.push(w[t][q]?w[t][q]:t);}});jQuery.each(D,function(i,d){t=d.Dimension.PropertyPath;b.push(t);if(w&&w[t]&&w[t][q]&&t!=w[t][q]){b.push(w[t][q]?w[t][q]:t);}});r+=", parameters: {select:'"+[].concat(b,f).join(",");if(g.length>0){r+=","+g.join(",");}r+="'}";if(k){r+=", length: "+k;}r+="}";return r;};A.getChartType=function(c){var a=[];if(!c.EnumMember||!(a=c.EnumMember.split("/"))||a.length<2){jQuery.sap.log.error("KPI Card M - wrong or missing chart type");return"";}else{return A.config[a[1]].type;}};A.setupChartAttributes=function(v,s){var c,e,a;var o,b,d,D,m;var f;var q,Q,g;var p,h=[],M=[];d=A.config;var l=sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper;if(!(c=s)){jQuery.sap.log.error("KPI Card no card settings");return;}var n=v.getModel();var r=n.getMetaModel();var t=c.entitySet;var E=r.getODataEntitySet(t);if(!n||!t){return;}e=r.getODataEntityType(E.entityType,false);if(!e){jQuery.sap.log.error("KPI Card no entityType");return;}var u=l.getMetadata(n,t);var w="com.sap.vocabularies.UI.v1.Chart#"+c.qualifier;if(!w||!(a=e[w])){jQuery.sap.log.error("KPI Card no chart annotations");return;}if(!(D=a.DimensionAttributes)||!D.length){jQuery.sap.log.error("KPI Card no dimension annotations defined");return;}if(!(m=a.MeasureAttributes)||!m.length){jQuery.sap.log.error("KPI Card no measure annotations defined");return;}var x=[];o=a.ChartType;if(!o.EnumMember||!(x=o.EnumMember.split("/"))||x.length<2){jQuery.sap.log.error("KPI Card M - wrong or missing chart type");}else{b=x[1];}var H=true;v.removeAllAggregation();f={legend:{isScrollable:false},general:{background:{color:"transparent"},layout:{padding:15},groupData:false},title:{visible:false},interaction:{noninteractiveMode:false,selectability:{legendSelection:false,axisLabelSelection:false,mode:"NONE",plotLassoSelection:false,plotStdSelection:true}},plotArea:{window:{start:"firstDataPoint",end:"lastDataPoint"},background:{color:"transparent"}}};Q=D.slice();g=m.slice();jQuery.each(d[b].feeds,function(i,y){var z=y.uid;var F=[];if(y.type){var P,G,I;if(y.type==="dimension"){P=D.length;G="Dimension";I="dimensions";q=Q;p=h;}else{P=m.length;G="Measure";I="measures";q=g;p=M;}var J=0,K=P;if(y.min){J=J>y.min?J:y.min;}if(y.max){K=K<y.max?K:y.max;}if(!y.role){var L=q.length;for(var j=0;j<L&&F.length<K;++j){var N=q[j];q.splice(j,1);--L;--j;F.push(N);}}else{var R=y.role.split("|");jQuery.each(R,function(j,W){if(F.length==K){return false;}var L=q.length;for(var k=0;k<L&&F.length<K;++k){var N=q[k];if(N&&N.Role&&N.Role.EnumMember&&N.Role.EnumMember.split("/")&&N.Role.EnumMember.split("/")[1]){var X=N.Role.EnumMember.split("/")[1];if(X==W){q.splice(k,1);--L;--k;F.push(N);}}else if(jQuery.inArray(N,p)==-1){p.push(N);}}});if(F.length<K){jQuery.each(p,function(k,N){var W;var X;if((W=d[I].defaultRole)&&(jQuery.inArray(W,R)!==-1)&&(X=jQuery.inArray(N,q))!==-1){q.splice(X,1);F.push(N);if(F.length==K){return false;}}});}if(F.length<J){jQuery.sap.log.error("KPI card feed propperties < min");return false;}}if(F.length){var S=[];var T;if(!(T=v.getDataset())){jQuery.sap.log.error("KPI Card Viz framework no Dataset");return false;}jQuery.each(F,function(i,N){if(!N||!N[G]||!N[G].PropertyPath){jQuery.sap.log.error("KPI Card invalid chart annotations - propertypath");return false;}var k=N[G].PropertyPath;var W=k;var X=k;if(u&&u[k]){W=u[k][l.constants.LABEL_KEY]||k;X=u[k][l.constants.TEXT_KEY]||k;}var Y="{"+X+"}";S.push(W);if(G=="Dimension"){T.addDimension(new sap.viz.ui5.data.DimensionDefinition({name:W,value:"{"+k+"}",displayValue:Y}));}else{T.addMeasure(new sap.viz.ui5.data.MeasureDefinition({name:W,value:"{"+k+"}"}));}});var U=new sap.viz.ui5.controls.common.feeds.FeedItem({"uid":z,"type":G,"values":S});v.addFeed(U);f[z]={title:{visible:H?false:true,text:S.join(", ")},label:{formatString:"axisFormatter"}};if(z=="valueAxis"){f[z].layout={maxWidth:0.4};}}}});v.setVizProperties(f);};A.formatByType=function(m,p,v){var s=sap.ovp.cards.charts.VizAnnotationManager;var t=s.constants.TYPE_KEY;if(!m||!m[p]||!m[p][t]){return v;}var n=["Edm.Int","Edmt.Int16","Edm.Int32","Edm.Int64","Edm.Decimal"];var c=m[p][t];if(jQuery.inArray(c,n)!==-1){return Number(v);}return v;};A.getMetadata=function(m,e){var a=this.cacheODataMetadata(m);if(!a){return undefined;}return a[e];};A.cacheODataMetadata=function(m){var s=sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper;if(m){if(!jQuery.sap.getObject("sap.suite.ui.generic.template.AnalyticalListPage.kpi.cachedMetaModel")){s.cachedMetaModel={};}var a=s.cachedMetaModel[m.getId()];if(!a){var b=m.getMetaModel();a={};var c=b.getODataEntityContainer();jQuery.each(c.entitySet,function(d,e){var f=b.getODataEntityType(e.entityType);var g={};jQuery.each(f.property,function(p,h){g[h.name]=h;});a[e.name]=g;});s.cachedMetaModel[m.getId()]=a;}return a;}else{jQuery.sap.log.error(s.errorMessages.CARD_ERROR+s.errorMessages.CACHING_ERROR);}};A.formatChartAxes=function(s){jQuery.sap.require("sap.viz.ui5.format.ChartFormatter");jQuery.sap.require("sap.ui.core.format.NumberFormat");jQuery.sap.require("sap.viz.ui5.api.env.Format");var c=sap.viz.ui5.format.ChartFormatter.getInstance();var S=true;if(!s){s=undefined;}else{S=false;}if(c!=null){c.registerCustomFormatter("axisFormatter",function(v){var n=sap.ui.core.format.NumberFormat.getFloatInstance({style:"short",minFractionDigits:0,maxFractionDigits:1,decimals:2,showScale:S,shortRefNumber:s});return n.format(Number(v));});sap.viz.ui5.api.env.Format.numericFormatter(c);}};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiVizAnnotationHelper.formatItems.requiresIContext=true;return A;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.Canvas.extensionAPI.ExtensionAPI')){jQuery.sap.declare('sap.suite.ui.generic.template.Canvas.extensionAPI.ExtensionAPI');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/Canvas/extensionAPI/ExtensionAPI",["jquery.sap.global","sap/ui/base/Object","sap/suite/ui/generic/template/extensionAPI/NavigationController"],function(q,B,N){"use strict";function g(t,c,b){return{getTransactionController:b.extensionAPI.getTransactionControllerFunction(),attachToView:function(C){t.oCommonUtils.attachControlToView(C);},invokeActions:function(f,C,u){var a,p;if(!C){a=[];}else if(C instanceof sap.ui.model.Context){a=[C];}else{a=C;}if(u){p={urlParameters:u};}return t.oServices.oApplicationController.invokeActions(f,a,p);},attachPageDataLoaded:function(f){t.oComponentUtils.attach(c,"PageDataLoaded",f);},detachPageDataLoaded:function(f){t.oComponentUtils.detach(c,"PageDataLoaded",f);},registerMessageFilterProvider:function(p){b.state.messageButtonHelper.registerMessageFilterProvider(p);},getNavigationController:b.extensionAPI.getNavigationControllerFunction(),getCommunicationObject:function(l){return t.oComponentUtils.getCommunicationObject(l);},securedExecution:function(f,p){return t.oCommonUtils.securedExecution(f,p,b.state);},addFooterBarToPage:function(p){var f=c.byId("template::ObjectPage::FooterToolbar");if(f){var i=c.getView().getModel("i18n");f.setModel(i,"i18n");p.setFooter(f);}},getPaginatorButtons:function(){var p=c.byId("template::UpAndDownNavigation");if(p){var i=c.getView().getModel("i18n");p.setModel(i,"i18n");return p;}}};}return B.extend("sap.suite.ui.generic.template.Canvas.extensionAPI.ExtensionAPI",{constructor:function(t,c,b){q.extend(this,g(t,c,b));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/ListReport/extensionAPI/ExtensionAPI",["jquery.sap.global","sap/ui/base/Object","sap/suite/ui/generic/template/ListReport/extensionAPI/NonDraftTransactionController","sap/suite/ui/generic/template/extensionAPI/NavigationController"],function(q,B,N,a){"use strict";function g(t,c,s){var T;var n;return{getSelectedContexts:function(){return t.oCommonUtils.getSelectedContexts(s.oSmartTable);},getTransactionController:function(){if(t.oComponentUtils.isDraftEnabled()){throw new Error("Transaction support on ListReport for draft case not implemented yet");}T=T||new N(t,c,s);return T;},rebindTable:function(){s.oSmartTable.rebindTable();},refreshTable:function(){t.oCommonUtils.refreshModel(s.oSmartTable);t.oCommonUtils.refreshSmartTable(s.oSmartTable);},attachToView:function(C){t.oCommonUtils.attachControlToView(C);},invokeActions:function(f,C,u){var b,p;if(!C){b=[];}else if(C instanceof sap.ui.model.Context){b=[C];}else{b=C;}if(u){p={urlParameters:u};}if(s.oSmartTable){s.oSmartTable.getTable().attachEventOnce("updateFinished",function(){t.oCommonUtils.setEnabledToolbarButtons(s.oSmartTable);t.oCommonUtils.setEnabledFooterButtons(s.oSmartTable);});}return t.oServices.oApplicationController.invokeActions(f,b,p);},getNavigationController:function(){if(!n){n=new a(t,c,s);}return n;},getCommunicationObject:function(l){return t.oComponentUtils.getCommunicationObject(l);},securedExecution:function(f,p){return t.oCommonUtils.securedExecution(f,p,s);},getQuickVariantSelectionKey:function(){return s.oMultipleViewsHandler.getVariantSelectionKey();},onCustomAppStateChange:function(){var d=s.oIappStateHandler.areDataShownInTable();s.oIappStateHandler.changeIappState(true,d);}};}return B.extend("sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI",{constructor:function(t,c,s){q.extend(this,g(t,c,s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.extensionAPI.ExtensionAPI')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.extensionAPI.ExtensionAPI');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.m.ListBase');jQuery.sap.require('sap.ui.comp.smarttable.SmartTable');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/extensionAPI/ExtensionAPI",["jquery.sap.global","sap/ui/base/Object","sap/m/ListBase","sap/ui/comp/smarttable/SmartTable","sap/suite/ui/generic/template/ObjectPage/extensionAPI/DraftTransactionController","sap/suite/ui/generic/template/ObjectPage/extensionAPI/NonDraftTransactionController","sap/suite/ui/generic/template/extensionAPI/NavigationController"],function(q,B,L,S,D,N,a){"use strict";function g(t,c,b){return{getSelectedContexts:function(u){var C=c.byId(u);return t.oCommonUtils.getSelectedContexts(C);},rebind:function(u){var C=c.byId(u);if(C instanceof S){C.rebindTable();}},refresh:function(u){var C=c.byId(u);if(C instanceof S){t.oCommonUtils.refreshSmartTable(C);return;}var A;if(C instanceof L){A="items";}else if(t.oCommonUtils.isUiTable(C)){A="rows";}var o=A&&C.getBinding(A);if(o){o.refresh();}},getTransactionController:b.extensionAPI.getTransactionControllerFunction(),attachToView:function(C){t.oCommonUtils.attachControlToView(C);},invokeActions:function(f,C,u){var d,p;if(!C){d=[];}else if(C instanceof sap.ui.model.Context){d=[C];}else{d=C;}if(u){p={urlParameters:u};}var P=t.oServices.oApplicationController.invokeActions(f,d,p);t.oComponentUtils.getBusyHelper().setBusy(P);return P;},attachPageDataLoaded:function(f){t.oComponentUtils.attach(c,"PageDataLoaded",f);},detachPageDataLoaded:function(f){t.oComponentUtils.detach(c,"PageDataLoaded",f);},registerMessageFilterProvider:function(p){b.state.messageButtonHelper.registerMessageFilterProvider(p);},getNavigationController:b.extensionAPI.getNavigationControllerFunction(),getCommunicationObject:function(l){return t.oComponentUtils.getCommunicationObject(l);},securedExecution:function(f,p){return t.oCommonUtils.securedExecution(f,p,b.state);},refreshAncestors:function(l){var C=c.getOwnerComponent();if(l<0){l=null;}t.oServices.oViewDependencyHelper.setParentToDirty(C,undefined,l);}};}return B.extend("sap.suite.ui.generic.template.ObjectPage.extensionAPI.ExtensionAPI",{constructor:function(t,c,b){q.extend(this,g(t,c,b));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.QuickCreate.Component')){jQuery.sap.declare('sap.suite.ui.generic.template.QuickCreate.Component');jQuery.sap.require('sap.ca.ui.utils.Lessifier');sap.ui.define("sap/suite/ui/generic/template/QuickCreate/Component",["../js/QuickTemplates/QuickTemplateComponentFactory","../js/AnnotationHelper","../js/QuickTemplates/AnnotationHelper","sap/ca/ui/utils/Lessifier"],function(Q,A,a,L){"use strict";return Q.createQuickTemplateComponent("sap.suite.ui.generic.template.QuickCreate.Component",{metadata:{library:"sap.suite.ui.generic.template",properties:{"viewName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.QuickCreate.view.QuickCreate"}},"manifest":"json"}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.QuickCreate.view.QuickCreate.controller')){jQuery.sap.declare('sap.suite.ui.generic.template.QuickCreate.view.QuickCreate.controller');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.Context');sap.ui.define("sap/suite/ui/generic/template/QuickCreate/view/QuickCreate.controller",["../../js/QuickTemplates/QuickActionBaseController","../../js/QuickTemplates/QuickCreateAPI","sap/m/MessageToast","../../js/QuickTemplates/AnnotationHelper","sap/ui/model/odata/AnnotationHelper","../../js/QuickTemplates/ODataModelHelper","sap/ui/model/json/JSONModel","sap/ui/model/Context"],function(B,Q,M,a,b,O,J,C){"use strict";var c=B.extend("sap.suite.ui.generic.template.QuickCreate.view.QuickCreate",{onInit:function(){if(!this._bIsInitialized){B.prototype.onInit.apply(this);this.oQuickCreateAPI=this.oComponent.oQuickCreateAPI;this.oTransactionController=this.oComponent.getTransactionController();if(this.oQuickCreateAPI){this.oQuickCreateAPI.setRootView(this.getView());}this.sDraftEntityPath=this.oQuickCreateAPI?this.oQuickCreateAPI.getQuickCreateItem().draftid:undefined;this.bIsCreator=this.oQuickCreateAPI?this.oQuickCreateAPI.isCurrentUserCreator():true;this.sQuickCreateUserName=this.oQuickCreateAPI?this.oQuickCreateAPI.getQuickCreateItem().createdByName:"";this.bFormEnabled=this.bIsCreator;this._sDeferredGroupId="QuickCreateChanges";var q=new J({});this._sQuickCreateUIModelName="quickCreate";this.getView().setModel(q,this._sQuickCreateUIModelName);this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/draftExists",true);this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/quickCreateUser",this.sQuickCreateUserName);if(!this.bDraftEnabled){this.getView().getModel().setDeferredGroups([this._sDeferredGroupId]);}if(this.oQuickCreateAPI){this.oQuickCreateAPI.attachAutofillLineItems(this._onLineItemsFound,this);}if(typeof this.oComponent.onQCViewInit==="function"){this.oComponent.onQCViewInit(this);}}},onExit:function(){if(this._bIsBeingDestroyed||this._bDestroyed){return;}this._bIsBeingDestroyed=true;if(this.oQuickCreateAPI){this.oQuickCreateAPI.destroy();}if(B.prototype.onExit){B.prototype.onExit.apply(this);}this._bDestroyed=true;delete this._bIsBeingDestroyed;},onBeforeRendering:function(){B.prototype.onBeforeRendering.apply(this);if(!this.getView().getModel("ui")){var u=new J({});this.getView().setModel(u,"ui");}this.getView().getModel("ui").setProperty("/enabled",this.bFormEnabled);this.getView().getModel("ui").setProperty("/editable",true);if(typeof this.oComponent.onQCBeforeRendering==="function"){this.oComponent.onQCBeforeRendering(this.getView());}},_onMetaModelLoaded:function(){var t=this;this.setBusy(true);if(this.sDraftEntityPath){var o=new C(this.getView().getModel(),this.sDraftEntityPath);if(this.bDraftEnabled&&!this.bIsCreator){o._bLocalBinding=true;}else if(!this.bDraftEnabled){o._bLocalBinding=true;}if(o._bLocalBinding){if(this.oQuickCreateAPI){this.oQuickCreateAPI.loadQuickCreateModelFromJSON().then(jQuery.proxy(function(){if(o.getObject()){this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/draftExists",true);}else{this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/draftExists",false);}this.bindView(o);},this));}}else{this.getView().getModel().read(this.sDraftEntityPath,{success:jQuery.proxy(function(D,r){this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/draftExists",true);this.bindView(o);},this),error:jQuery.proxy(function(e){this.getView().getModel(this._sQuickCreateUIModelName).setProperty("/draftExists",false);this.bindView(o);},this)});}}else if(this.bDraftEnabled){this.oDraftController.createNewDraftEntity(this.sEntitySet,"/"+this.sEntitySet).then(function(r){if(t.oQuickCreateAPI){t.oQuickCreateAPI.updateDraftID(r.context.getPath());}t.bindView(r.context);},jQuery.proxy(this.onError,this));}else{var d=this.getView().getModel().createEntry("/"+this.sEntitySet,{groupId:this._sDeferredGroupId});d._bLocalBinding=true;if(this.oQuickCreateAPI){this.oQuickCreateAPI.updateDraftID(d.getPath());}this._initializeObject(d,"FieldGroup");this.bindView(d);}},onChange:function(e){if(this.bDraftEnabled){var o=this.getView().getElementBinding();var m=new Promise(jQuery.proxy(function(r,d){var E=this.oComponent.getEntitySet();var v=e.getSource().getBindingPath("value");var f=e.getSource();var s=null;if(f){s=this.oComponent.getApplicationController();}else{s=this.oComponent.getTransactionController();}s.propertyChanged(E,v,o,f).then(function(){if(r){r();}},function(){if(d){d();}});},this));m.then(function(){o.refresh();});}},onCreatePress:function(e){var t=this;this._createButton=e.getSource();this._createButton.setEnabled(false);this.setBusy(true);var r=function(R){t.setBusy(false);var g=null;var j=[];var p={key:"__metadata",matchCallback:function(i,l,n){j.push(l);return false;}};O.findObjects(R,p);var k=t.oEntityTypeMeta.namespace+"."+t.oEntityTypeMeta.name;jQuery.each(j,function(i,l){if(!g&&l.__metadata&&l.__metadata.type===k){var n=t.getView().getModel().getKey(l);g=new C(t.getView().getModel(),"/"+n);}});if(g){M.show(t.formatI18NMessage("QuickCreate_Success_CreateObject"));if(t.oQuickCreateAPI){t.oQuickCreateAPI.objectCreated(g);}}else{this._showErrorMessage({message:t.formatI18NMessage("QuickCreate_No_Created_Object")});}};var d=function(E){t.setBusy(false);if(t._createButton){t._createButton.setEnabled(true);}t.onError(E);};var o;if(this.bDraftEnabled){var f=function(){t.oDraftController.activateDraftEntity(t.getView().getBindingContext()).then(r,d);};if(typeof this.oComponent.onQCBeforeCreate==="function"){o=this.oComponent.onQCBeforeCreate(this.getView().getBindingContext(),this.getView().getBindingContext().getObject());}if(o&&o instanceof Promise){o.then(f,d);}else{f();}}else{var g=this.getView().getBindingContext();var m=this.getView().getModel().getProperty(g.getPath(),g,true);var p={key:"results",matchCallback:function(i,j,k){if(j.__nestedKey&&Array.isArray(k)){i[j.__nestedKey]=k;}return true;},maxNestedLevel:5};O.findObjects(m,p);p={key:"__metadata",matchCallback:function(i,j,k){delete j["__metadata"];return true;},maxNestedLevel:5};O.findObjects(m,p);var h=function(){t.getView().getModel().create("/"+t.sEntitySet,m,{success:r,error:d});};if(typeof this.oComponent.onQCBeforeCreate==="function"){o=this.oComponent.onQCBeforeCreate(g,m);}if(o&&o instanceof Promise){o.then(h,d);}else{h();}}},onAddLineItemPress:function(e){this._getLineItemsTableFromEvent(e);var t=this;this.setBusy(true);var d=this.getView().getBindingContext();var f=function(s){t._createLineItem(d).then(function(o){t._refreshLineItems();if(t.oQuickCreateAPI){t.oQuickCreateAPI.calculateViewHeight(t.getView(),true);}t.setBusy(false);},jQuery.proxy(t.onError,t));};if(this.bDraftEnabled){this.oTransactionController.triggerSubmitChanges().then(function(s){f(s);},jQuery.proxy(this.onError,this));}else{f();}},onRemoveLineItemPress:function(e){var t=this;this.setBusy(true);var d=e.getSource().getBindingContext();if(this.bDraftEnabled){this.oTransactionController.triggerSubmitChanges().then(function(r){t._deleteLineItem(d);},jQuery.proxy(function(E){this.setBusy(false);this.onError(E);},this));}else{this.getView().getModel().deleteCreatedEntry(d);this.setBusy(false);if(this.oQuickCreateAPI){this.oQuickCreateAPI.calculateViewHeight(this.getView(),false);}this._refreshLineItems();}},bindView:function(o){this.setBusy(false);if(this.getView().getModel(this._sQuickCreateUIModelName).getProperty("/draftExists")===false){return;}if(o._bLocalBinding){this._setBindingContext(o);this._refreshLineItems();}else{B.prototype.bindView.apply(this,arguments);}this._updateFieldControl(o);},hasLineItemAnnotation:function(){var i=this._getFormatterInterface();var m=a.getMetaModelContextForFacetType(i,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name,"LineItem");return m!==null;},_onLineItemsFound:function(e){if(!this.hasLineItemAnnotation()){return;}var n=e.getParameter("numberOfLineItems");if(n<=0){return;}this.setBusy(true);var m=this.getView().getBindingContext();var p=[];for(var i=0;i<n;i++){p.push(this._createLineItem(m));}Promise.all(p).then(jQuery.proxy(function(r){this._refreshLineItems();this.setBusy(false);},this));},_createLineItem:function(m){var t=this;var i=this._getFormatterInterface(m);var o=this.getView().getModel().getMetaModel();var d=a.getMetaModelContextForFacetType(i,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name,"LineItem");var s=b.getNavigationPath(d);s=s.replace(/[{}]/g,'');var l=o.getODataAssociationEnd(this.oEntityTypeMeta,s);var L=o.getODataEntityType(l.type);if(this.bDraftEnabled){return this.oDraftController.createNewDraftEntity(L.name,m.sPath+"/"+s);}else{return new Promise(function(r,e){var f=t.getView().getModel().createEntry(m.sPath+"/"+s,{groupId:t._sDeferredGroupId});t._initializeObject(f,"LineItem");r(f);});}},_deleteLineItem:function(o){this.oTransactionController.deleteEntity(o).then(jQuery.proxy(function(r){this._refreshLineItems();this.setBusy(false);if(this.oQuickCreateAPI){this.oQuickCreateAPI.calculateViewHeight(this.getView(),false);}},this),jQuery.proxy(function(e){this.setBusy(false);this.onError(e);},this));},_onSmartFieldAfterRendering:function(e){if(typeof e.srcControl.setEnabled=='function'){e.srcControl.setEnabled(this.bFormEnabled);}if(this.oQuickCreateAPI){this.oQuickCreateAPI.calculateViewHeight(this.getView(),true);}jQuery(".copilotQuickCreateContainerBox .sapQuickCreateFieldGroup label").css("text-align","");jQuery(".sapQuickActionCreateButtonContainer > div").addClass("sapUiSmallMarginEnd");jQuery(".sapQuickActionCreateButtonContainer .sapMBtnInner").css("padding","0");},_refreshLineItems:function(){if(this._lineItemsTable){var d=this.getView().getBindingContext();if(d&&d._bLocalBinding){O.restoreLineItemReferences(this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name,d);this._lineItemsTable.getModel().updateBindings();}else{this._lineItemsTable.getModel().refresh();}}},onTableUpdateStarted:function(e){this._getLineItemsTableFromEvent(e);},_getLineItemsTableFromEvent:function(e){if(!this._lineItemsTable&&e&&e.getSource){var d=e.getSource();while(d){if(d instanceof sap.m.Table){this._lineItemsTable=d;return;}if(typeof d.getParent==='function'){d=d.getParent();}else{return;}}}},onTableUpdateFinished:function(e){this._updateFieldControl();},_initializeObject:function(o,f){var m=this.getView().getBindingContext()?this.getView().getBindingContext():o;var p=a.getAllPropertyPathsFromFacet(m,f);if(p&&p.length>0){O.initializeObjectProperties(o,p,{groupId:this._sDeferredGroupId});}},_updateFieldControl:function(o){var d=o?o:this.getView().getBindingContext();if(d&&this.getView().getModel().getProperty(d.getPath()+"/Update_mc")!==undefined){this.getView().getModel().setProperty(d.getPath()+"/Update_mc",true);}}});return c;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.QuickView.Component')){jQuery.sap.declare('sap.suite.ui.generic.template.QuickView.Component');jQuery.sap.require('sap.ca.ui.utils.Lessifier');sap.ui.define("sap/suite/ui/generic/template/QuickView/Component",["../js/QuickTemplates/QuickTemplateComponentFactory","../js/AnnotationHelper","../js/QuickTemplates/AnnotationHelper","sap/ca/ui/utils/Lessifier"],function(Q,A,a,L){"use strict";return Q.createQuickTemplateComponent("sap.suite.ui.generic.template.QuickView.Component",{metadata:{library:"sap.suite.ui.generic.template",properties:{"viewName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.QuickView.view.QuickView"}},"manifest":"json"}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.QuickView.view.QuickView.controller')){jQuery.sap.declare('sap.suite.ui.generic.template.QuickView.view.QuickView.controller');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/QuickView/view/QuickView.controller",["sap/ui/model/Context","../../js/QuickTemplates/QuickActionBaseController","../../js/QuickTemplates/AnnotationHelper","../../js/QuickTemplates/ODataModelHelper","sap/ui/model/json/JSONModel"],function(C,B,A,O,J){"use strict";return B.extend("sap.suite.ui.generic.template.QuickView.view.QuickView",{onInit:function(){if(!this._bIsInitialized){B.prototype.onInit.apply(this);this.sEntityPath=decodeURIComponent(this.oComponent.getComponentData().startupParameters["entityPath"]);this.sEntityPath="/"+O.createKeyFromPath(this.sEntityPath,this.getView().getModel().getMetaModel(),this.sEntitySet);var b=new J({});b.setProperty("/badgeVisible",false);b.setProperty("/fallbackBadgeVisible",false);this._sBadgeModelName="badge";this.getView().setModel(b,this._sBadgeModelName);}},_onMetaModelLoaded:function(){var c=new C(this.getView().getModel(),this.sEntityPath);this.bindView(c);c.getModel().attachRequestCompleted(this._resolveBadgeModel,this);},bindView:function(c){var i=this._getFormatterInterface(c);var f=A.getNavigationPathsFromFacet(i,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name,"FieldGroup");var h=A.getNavigationPathsUsingAnnotationHeuristics(c,this.oEntityTypeMeta.namespace+"."+this.oEntityTypeMeta.name);var o={};jQuery.each(f,function(a,p){o[p]="";});jQuery.each(h,function(a,p){o[p]="";});var e=A.formatExpandPaths(Object.keys(o));this.oContext=c;this.getView().bindElement({path:c.getPath(),parameters:{expand:e}});},_resolveBadgeModel:function(){if(this._badgeResolved){this.oContext.getModel().detachRequestCompleted(this._resolveBadgeModel,this);return;}var c=this.oContext;var a=this.oComponent.ContextualManagedObject;var b=this.getView().getModel(this._sBadgeModelName);if(a){var o=new a({serviceUrl:(c.getModel().sServiceUrl)?c.getModel().sServiceUrl:null,path:c.getPath(),entitytype:this.oEntitySetMeta.entityType,uiGroup:"Main Object",priority:"1"});o.setModel(c.getModel());o.setBindingContext(c);o.resolveAnnotations();b.setProperty("/imgUrlDefined",(o.getProperty("imgUrl")!=undefined&&o.getProperty("imgUrl").indexOf("sap-icon")<0));b.setProperty("/imgUrl",o.getProperty("imgUrl"));b.setProperty("/typeImgUrlDefined",(o.getProperty("typeImgUrl")!=undefined&&!b.getProperty("/imgUrlDefined")));b.setProperty("/typeImgUrl",o.getProperty("typeImgUrl"));if(!b.getProperty("/imgUrlDefined")&&!b.getProperty("/typeImgUrlDefined")){b.setProperty("/typeImgUrl","sap-icon://form");b.setProperty("/typeImgUrlDefined",true);}b.setProperty("/title",o.getProperty("title"));if(o.getProperty("typeName")){b.setProperty("/typeName",o.getProperty("typeName"));}else if(o.getProperty("titleMetadata")&&o.getProperty("titleMetadata")["sap:label"]){b.setProperty("/typeName",o.getProperty("titleMetadata")["sap:label"]);}else{b.setProperty("/typeName","");}b.setProperty("/subtitle",o.getProperty("headline"));b.setProperty("/badgeVisible",true);}else{b.setProperty("/fallbackBadgeVisible",true);}this._badgeResolved=true;}});},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.detailTemplates.PaginatorButtonsHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.detailTemplates.PaginatorButtonsHelper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/detailTemplates/PaginatorButtonsHelper",["jquery.sap.global","sap/ui/base/Object","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,t){"use strict";var T=(function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.m");return{navDownTooltip:r.getText("FACETFILTER_NEXT"),navUpTooltip:r.getText("FACETFILTER_PREVIOUS")};})();function g(c,C,o){var a=o.oComponentUtils.getTemplatePrivateModel();var b=C.getOwnerComponent().getModel("_templPrivGlobal");function d(){var p=o.oComponentUtils.getPaginatorInfo();var P=!!p&&(!c.fclInfo.isContainedInFCL||b.getProperty("/generic/FCL/isVisuallyFullScreen"));var l=P&&(p.listBinding?p.listBinding.getLength():p.objectPageNavigationContexts.length);var n=P&&(p.selectedRelativeIndex!==(l-1));var N=P&&p.selectedRelativeIndex>0;a.setProperty("/objectPage/navButtons/navUpEnabled",N);a.setProperty("/objectPage/navButtons/navDownEnabled",n);}function h(p,j){var k=p.objectPageNavigationContexts[j];p.selectedRelativeIndex=j;o.oComponentUtils.setPaginatorInfo(p,false);var n=p.navigitionInfoProvider(k);var m=q.extend({},n.navigationData);m.replaceInHistory=true;o.oCommonUtils.navigateToContext(n.context,m);}function e(s){var j=o.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var p=o.oComponentUtils.getPaginatorInfo();var l=p.listBinding;var n=p.selectedRelativeIndex+s;var A=p.objectPageNavigationContexts;if(A&&A[n]){h(p,n);}else{var k=new Promise(function(r,R){var m=p.growingThreshold||Math.ceil(l.getLength()/5);var S=A?A.length:n;var u=S+m;var v=function(P){var N=P.getSource().getContexts(0,u);p.objectPageNavigationContexts=N;l.detachDataReceived(v);h(p,n);r();};l.attachDataReceived(v);l.loadData(0,u);});j.setBusy(k);}}function f(){e(1);}function i(){e(-1);}a.setProperty("/objectPage/navButtons",q.extend({navDownEnabled:false,navUpEnabled:false},T));if(c.fclInfo.isContainedInFCL){var F=b.bindProperty("/generic/FCL/isVisuallyFullScreen");F.attachChange(d);}return{computeAndSetVisibleParamsForNavigationBtns:d,handleShowNextObject:f,handleShowPrevObject:i};}return B.extend("sap.suite.ui.generic.template.detailTemplates.PaginatorButtonsHelper",{constructor:function(c,C,o){q.extend(this,(t.testableStatic(g,"PaginatorButtonsHelper"))(c,C,o));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.BusyHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.BusyHelper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/lib/BusyHelper",["jquery.sap.global","sap/ui/base/Object","sap/suite/ui/generic/template/lib/MessageUtils","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,M,t){"use strict";function g(T){var b={};var i=false;var a=false;var c=0;var d=T.oNavigationHost.getBusyIndicatorDelay();var u=Promise.resolve();var U=q.noop;var o={};function e(){return c!==0||!q.isEmptyObject(b);}var A;function f(I){var l=e();if(l||I){a=false;T.oNavigationHost.setBusy(l);q.sap.log.info("Physical busy state has been changed to "+l);if(l!==i){i=l;if(!i){T.oNavigationHost.setBusyIndicatorDelay(d);M.handleTransientMessages(T.oApplicationProxy.getDialogFragment,o.actionLabel);o={};U();}}}else{var n=T.oNavigationObserver.getProcessFinished(true);n.then(A,A);}}A=f.bind(null,true);function E(I){if(I){T.oNavigationHost.setBusyIndicatorDelay(0);f();}else if(!a){a=true;setTimeout(f,0);}}function h(){c--;if(!c){E(false);}}function m(){if(i){return;}i=true;u=new Promise(function(r){U=r;});M.removeTransientMessages();}function s(r,I,l,S){if(I){q.extend(o,S);m();b[r]=true;}else{delete b[r];}E(l);}function j(l,I,S){q.extend(o,S);c++;m();l.then(h,h);E(I);}function k(){return d;}return{setBusyReason:s,setBusy:j,isBusy:e,getUnbusy:function(){return u;},getBusyDelay:k};}return B.extend("sap.suite.ui.generic.template.lib.BusyHelper",{constructor:function(T){q.extend(this,(t.testableStatic(g,"BusyHelper"))(T));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.CRUDHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.CRUDHelper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/suite/ui/generic/template/lib/CRUDHelper",["jquery.sap.global","sap/ui/base/Object","sap/ui/model/Context","sap/suite/ui/generic/template/lib/MessageUtils","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(q,B,C,M,F,a){"use strict";function c(d,E,s,m,g,p){s=s||"/"+E;if(d.getDraftContext().isDraftEnabled(E)){return d.createNewDraftEntity(E,s,p).then(function(h){return h.context;});}g(true);var o=m.createEntry(s,{properties:p,batchGroupId:"Changes",changeSetId:"Changes"});return Promise.resolve(o);}function r(m,s,t){var p=new Promise(function(d,g){m.read(s,{urlParameters:{"$expand":"DraftAdministrativeData"},success:function(o){d(o);},error:function(o){g(o);}});});t.oBusyHelper.setBusy(p,true);return p;}function R(t,E,k,s,m,T){var p=new Promise(function(d,g){var i,l,P,v,h=[];if(k&&s&&m){l=k.length;for(i=0;i<l;i++){P=k[i].PropertyPath;v=s[P][0];h.push(new F(P,a.EQ,v));}if(t.getDraftController().getDraftContext().isDraftEnabled(E)){var D=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});h.push(D);}var o=new F(h,true);m.read("/"+E,{urlParameters:{"$expand":"DraftAdministrativeData"},filters:[o],success:function(j){var n=f(j,m,s);if(n){d(n);}else{g(j);}},error:function(j){g(j);}});}});T.oBusyHelper.setBusy(p,true);return p;}function f(o,m,s){var d,i,l,g;if(o&&o.results){l=o.results.length;if(l==0){g=null;}else if(l==1){g=o.results[0];}else if(l>=1){var D=[];var A=[];for(i=0;i<l;i++){d=o.results[i];if(d&&d.IsActiveEntity){A.push(d);}else if(d&&d.IsActiveEntity==false){D.push(d);}}if(A.length==0&&D.length>=2){var h;for(var j=0;j<D.length;j++){h=D[j];if(h.DraftUUID==s.DraftUUID){g=h;break;}}if(!g){g=D[0];}}else if(A.length==1&&D.length==1){g=A[0];}else if(A.length==1&&D.length>=2){g=A[0];}}}return g;}function e(t){var A=t.oAppComponent;var m=A.getModel();var o=m.getMetaModel();var n=A.getNavigationController();var d=A.getApplicationController();var D=d.getTransactionController().getDraftController().getDraftContext();var E=function(g){t.oApplicationProxy.getResourceBundleForEditPromise().then(function(h){M.handleError(M.operations.modifyEntity,null,null,g,{resourceBundle:h,navigationController:n,model:m});M.handleTransientMessages(t.oApplicationProxy.getDialogFragment);});};var p=function(g){var h=g.getParameter("context");if(!D.hasDraft(h)){return;}if(!o.getODataEntitySet(h.getPath().split("(")[0].substring(1))){return;}var P=g.getParameter("path");d.propertyChanged(P,h).catch(E);t.oApplicationProxy.markCurrentDraftAsModified();};m.attachPropertyChange(p);}function u(t,d,g){return new Promise(function(h,i){var U=t.oApplicationProxy.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.UnsavedChangesDialog",{onEdit:function(){U.close();h();},onCancel:function(){U.close();i();}},"Dialog");var s=t.getText("DRAFT_LOCK_EXPIRED",[d.LastChangedByUserDescription||d.LastChangedByUser]);var o=new sap.ui.model.resource.ResourceModel({bundleName:"sap/suite/ui/generic/template/ObjectPage/i18n/i18n",async:true});U.setModel(o,"i18n");U.getModel("Dialog").setProperty("/unsavedChangesQuestion",s);(g||q.noop)();t.oBusyHelper.getUnbusy().then(function(){U.open();});});}function b(t,E,s,m,T,d,k,S){if(s===""&&k&&S){return new Promise(function(g,h){R(t,E,k,S,m,T).then(function(i){var j="/"+m.createKey(E,i);var o=new C(m,j);if(!i.DraftAdministrativeData||i.DraftAdministrativeData.DraftIsCreatedByMe){g(t.editEntity(o,false));}else if(i.DraftAdministrativeData.InProcessByUser){h({lockedByUser:i.DraftAdministrativeData.InProcessByUserDescription||i.DraftAdministrativeData.InProcessByUser});}else{u(T,i.DraftAdministrativeData,d).then(function(){g(t.editEntity(o,false));},function(){h({lockedByUser:i.DraftAdministrativeData.LastChangedByUserDescription||i.DraftAdministrativeData.LastChangedByUser});});}},function(i){h({draftAdminReadResponse:i});});});}var D=t.getDraftController().getDraftContext();var o=new C(m,s);if(D.isDraftEnabled(E)){if(true||!D.hasPreserveChanges(o)){return new Promise(function(g,h){r(m,s,T).then(function(i){if(!i.DraftAdministrativeData||i.DraftAdministrativeData.DraftIsCreatedByMe){g(t.editEntity(o,false));}else if(i.DraftAdministrativeData.InProcessByUser){h({lockedByUser:i.DraftAdministrativeData.InProcessByUserDescription||i.DraftAdministrativeData.InProcessByUser});}else{u(T,i.DraftAdministrativeData,d).then(function(){g(t.editEntity(o,false));},function(){h({lockedByUser:i.DraftAdministrativeData.LastChangedByUserDescription||i.DraftAdministrativeData.LastChangedByUser});});}},function(i){h({draftAdminReadResponse:i});});});}}else{T.oApplicationProxy.setEditableNDC(true);return Promise.resolve({context:o});}}return{create:c,edit:b,enableAutomaticDraftSaving:e};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.CRUDManager')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.CRUDManager');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.generic.app.util.ModelUtil');jQuery.sap.require('sap.ui.generic.app.util.ActionUtil');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/suite/ui/generic/template/lib/CRUDManager",["jquery.sap.global","sap/ui/base/Object","sap/m/MessageToast","sap/ui/generic/app/util/ModelUtil","sap/ui/generic/app/util/ActionUtil","sap/suite/ui/generic/template/lib/MessageUtils","sap/m/MessageBox","sap/suite/ui/generic/template/lib/CRUDHelper","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,M,a,A,b,c,C,t){"use strict";var r=Promise.reject();r.catch(q.noop);function g(o,d,s,e,f){function h(O,i,j,P){b.handleError(O,o,s,j,P);return(i||q.noop)(j);}function l(){b.handleTransientMessages(s.oApplication.getDialogFragmentForView.bind(null,null));}var E;function m(i){return new Promise(function(j,k){var I=o.getOwnerComponent();var J=I.getBindingContext();var K=I.getModel();K.read(J.getPath(),{urlParameters:{"$expand":"DraftAdministrativeData"},success:function(R){if(!R.DraftAdministrativeData){if(i){return h(b.operations.editEntity,k,i);}return j({});}if(R.DraftAdministrativeData.InProcessByUser){var U=R.DraftAdministrativeData.InProcessByUserDescription||R.DraftAdministrativeData.InProcessByUser;i=i||new Error(e.getText("ST_GENERIC_DRAFT_LOCKED_BY_USER",[" ",U]));return h(b.operations.editEntity,k,i,i);}return j({draftAdministrativeData:R.DraftAdministrativeData});},error:h.bind(null,b.operations.editEntity,k)});});}function n(i,U,P){if(P.draftAdministrativeData){return Promise.resolve(P);}return new Promise(function(j,k){s.oTransactionController.editEntity(o.getView().getBindingContext(),!U).then(function(R){l(R);return j({context:R.context});},function(R){if(R&&R.response&&R.response.statusCode==="409"&&i&&!U){b.removeTransientMessages();return m(R).then(j,k);}else{h(b.operations.editEntity,k,R,R);}});});}E=function(U){var i=d.isDraftEnabled();var R;var j=o.getOwnerComponent();var k=j.getBindingContext();if(i&&!U){var I=s.oDraftController.getDraftContext();var P=I.hasPreserveChanges(k);if(!P){R=m().then(n.bind(null,true,true));}}R=R||n(i,U,{});if(i){s.oApplication.editingStarted(k,R);}return R;};function p(U){if(f.isBusy()){return r;}var R=E(U);f.setBusy(R);return R;}function u(i,j,k,I,S){var R=new Promise(function(J,K){var L=function(N){o.getOwnerComponent().getComponentContainer().bindElement(k.getPath());return h(b.operations.deleteEntity,K,N);};if(i&&I){s.oDraftController.getDraftForActiveEntity(k).then(function(N){s.oTransactionController.deleteEntity(N.context).then(function(){if(!S){s.oApplication.showMessageToast(e.getText("ST_GENERIC_DRAFT_WITH_ACTIVE_DOCUMENT_DELETED"));}return J();});},L);}else{s.oTransactionController.deleteEntity(k).then(function(){var N=a.getEntitySetFromContext(k);var O=s.oDraftController.getDraftContext();var P=O.isDraftRoot(N);var Q=e.getText("ST_GENERIC_OBJECT_DELETED");if(!i&&P){Q=e.getText(j?"ST_GENERIC_DRAFT_WITH_ACTIVE_DOCUMENT_DELETED":"ST_GENERIC_DRAFT_WITHOUT_ACTIVE_DOCUMENT_DELETED");}if(!S){s.oApplication.showMessageToast(Q);}return J();},L);}});return R;}function v(i,S){var R=new Promise(function(j,k){var I=o.getView().getBindingContext();var J=s.oDraftController.isActiveEntity(I);var K=s.oDraftController.hasActiveEntity(I);var L;if(i){L=Promise.resolve(I);}else if(K&&!J){L=s.oApplication.getDraftSiblingPromise(I);}else{L=Promise.resolve();}L.then(function(N){var O=u(J,K,I,i,S);O.then(j,k);if(!J){var T=function(){return{context:N};};var P=O.then(T);s.oApplication.cancellationStarted(I,P);}},k);});return R;}function w(P){var R=Object.create(null);var I=new Promise(function(J,K){var O=Object.create(null);var L=function(N,i,j){R[N]={resolve:i,reject:j};};for(var k=0;k<P.length;k++){var N=P[k];O[N]=new Promise(L.bind(null,N));}s.oApplication.prepareDeletion(O);s.oTransactionController.deleteEntities(P).then(function(Q){var S=[];var T=sap.ui.getCore().getMessageManager().getMessageModel().getData();for(var i=0;i<T.length;i++){var U=T[i].getTarget();for(var j=0;j<P.length;j++){var V=T[i].getType()||"";if(U.indexOf(P[j])>-1&&(V!=="Information"&&V!=="Success")){S.push(U);break;}}}return J(S);},function(i){return K(i);});});I.then(function(j){var k=[];for(var i=0;i<P.length;i++){var J=R[P[i]];if(j.indexOf(P[i])===-1){k.push(P[i]);J.resolve();}else{J.reject();}}});return I;}function x(i,j){if(f.isBusy()){j();return;}s.oTransactionController.triggerSubmitChanges().then(function(R){l();i(R.context);},h.bind(null,b.operations.saveEntity,j));}function y(){var R=new Promise(function(i,j){s.oApplication.performAfterSideEffectExecution(x.bind(null,i,j));});f.setBusy(R);return R;}function z(){if(f.isBusy()){return r;}var R=new Promise(function(i,j){var k=o.getView().getBindingContext();var I=s.oDraftController.activateDraftEntity(k);s.oApplication.activationStarted(k,I);I.then(function(J){var P=J.context.getPath();function K(){l();i(J);}var L=d.getPreprocessorsData().rootContextExpand;if(L){var N=L.join(",");o.getView().getModel().read(P,{urlParameters:{"$select":N,"$expand":N},success:K,error:K});}else{K();}},h.bind(null,b.operations.activateDraftEntity,j));});f.setBusy(R);return R;}function D(P){return new A(P);}function F(P,S,R,j){if(f.isBusy()){j();return;}var k=P.functionImportPath;var I=P.contexts;var J=P.sourceControl;var K=P.label;var N=P.navigationProperty;var O=P.operationGrouping;var L=D({controller:o,contexts:I,applicationController:s.oApplicationController,operationGrouping:O});var Q=function(Y,Z){if(Y.pages){for(var i in Y.pages){var $=Y.pages[i];if($.component.list!=true&&$.entitySet===Z){return true;}else{var _=Q($,Z);if(_){return true;}}}}return false;};var T=function(i,Y){var Z=i.getAppComponent().getConfig();if(Y&&Y.sPath){var $=Y.sPath.split("(")[0].replace("/","");return Q(Z.pages[0],$);}return false;};var U=function(i){var Y,Z,$,_;if(q.isArray(i)&&i.length===1){Y=i[0];}else{Y={response:{context:i.context}};}Z=Y.response&&Y.response.context;$=o.getOwnerComponent();_=T($,Z);if(_&&Z&&Z!==Y.actionContext&&Z.getPath()!=="/undefined"){if(J){e.navigateFromListItem(Z,J);}else{s.oNavigationController.navigateToContext(Z,N,false);}}if(i.length>0){var a1=e.getTableBindingInfo(J);var b1=a1&&a1.binding;if(b1&&b1.oEntityType){e.setEnabledToolbarButtons(J);if(d.isListReportTemplate()){e.setEnabledFooterButtons(J);}}}R(i);};var V=function(){if(I&&I[0]){var i=I[0].oModel;if(i&&i.hasPendingChanges()){i.resetChanges();}}};var W=function(i){V();j(i);};var X=function(i){if(q.isArray(i)){if(i.length===1){i=i[0].error;}else{i=null;}}var Y={context:I};V();h(b.operations.callAction,null,i,Y);j(i);};L.call(k,K).then(function(i){var Y={};Y.actionLabel=K;f.setBusy(i.executionPromise,null,Y);i.executionPromise.then(U,X);},W);}function G(P,S){var R=new Promise(function(i,j){s.oApplication.performAfterSideEffectExecution(F.bind(null,P,S,i,j));});return R;}function H(T,P){if(!T){throw new Error("Unknown Table");}var i="";var j="";var k=o.getOwnerComponent();var I=(k.getCreationEntitySet&&k.getCreationEntitySet())||k.getEntitySet();var J,K,N,L;var V=o.getView();var O=V.getModel();var Q=V.getBindingContext();if(Q){j=e.getTableBindingInfo(T).path;L=O.getMetaModel();K=L.getODataEntitySet(I);J=L.getODataEntityType(K.entityType);N=L.getODataAssociationSetEnd(J,j);if(N){I=N.entitySet;}j="/"+j;i=Q.getPath()+j;}else{i="/"+I;}var R=C.create(s.oDraftController,I,i,O,s.oApplication.setEditableNDC,P);s.oApplication.getBusyHelper().setBusy(R);return R.then(function(S){return{newContext:S,tableBindingPath:j};},h.bind(null,b.operations.addEntry,function(S){throw S;}));}var h=t.testable(h,"handleError");var D=t.testable(D,"getActionUtil");return{editEntity:p,deleteEntity:v,deleteEntities:w,saveEntity:y,activateDraftEntity:z,callAction:G,addEntry:H};}return B.extend("sap.suite.ui.generic.template.lib.CRUDManager",{constructor:function(o,d,s,e,f){q.extend(this,g(o,d,s,e,f));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.CommonUtils')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.CommonUtils');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.m.ListBase');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.generic.app.navigation.service.NavigationHandler');jQuery.sap.require('sap.ui.generic.app.navigation.service.NavError');sap.ui.define("sap/suite/ui/generic/template/lib/CommonUtils",["jquery.sap.global","sap/ui/base/Object","sap/ui/Device","sap/ui/model/Context","sap/ui/model/json/JSONModel","sap/m/Table","sap/m/ListBase","sap/m/MessageBox","sap/ui/generic/app/navigation/service/NavigationHandler","sap/ui/generic/app/navigation/service/NavError","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,C,J,R,L,M,N,a,t){"use strict";function b(o,p){var F=sap.ui.require(p);return typeof F==="function"&&(o instanceof F);}function c(o){return b(o,"sap/ui/comp/smarttable/SmartTable");}function d(o){return b(o,"sap/ui/comp/smartchart/SmartChart");}function e(o){return b(o,"sap/ui/table/Table");}function f(o){return b(o,"sap/ui/table/AnalyticalTable");}var c=t.testableStatic(c,"CommonUtils_isSmartTable");function g(o,s,h){var n;function A(i){s.oApplication.attachControlToParent(i,o.getView());}function l(i,j,k,o1){return s.oApplication.getDialogFragmentForView(o.getView(),i,j,k,o1);}var r;function m(){r=r||o.getOwnerComponent().getModel("i18n").getResourceBundle();return r.getText.apply(r,arguments);}function p(i){var j=i.getSelectionBehavior();if(j==="DATAPOINT"){return{"dataPoints":i.getSelectedDataPoints().dataPoints,"count":i.getSelectedDataPoints().count};}else if(j==="CATEGORY"){return{"dataPoints":i.getSelectedCategories().categories,"count":i.getSelectedCategories().count};}else if(j==="SERIES"){return{"dataPoints":i.getSelectedSeries().series,"count":i.getSelectedSeries().count};}}function u(j){var k=[];if(c(j)){j=j.getTable();}else if(d(j)){j=j.getChart();if(j&&j.getMetadata().getName()==="sap.chart.Chart"){var o1,p1=false;o1=p(j);if(o1&&o1.count>0){if(j.getSelectionBehavior()==="DATAPOINT"){p1=true;}var q1=o1.dataPoints;var r1=[];for(var i=0;i<q1.length;i++){if(p1){if(q1[i].context){k.push(q1[i].context);}}else{r1.push(q1[i].dimensions);}}if(!p1){k[0]=r1;}}}}if(j instanceof L){k=j.getSelectedContexts();}else if(e(j)){var s1=j.getSelectedIndices();for(var i=0;i<s1.length;i++){k.push(j.getContextByIndex(s1[i]));}}return k;}function v(i){var j={};if(i instanceof sap.ui.core.Element){i.getCustomData().forEach(function(k){j[k.getKey()]=k.getValue();});}return j;}function S(j){var k,o1,p1,q1,r1,s1;var t1=K(j);if(!c(t1)&&!d(t1)){t1=t1.getParent();}var u1=u(t1);var v1=t1.getModel();var w1=v1.getMetaModel();var x1=o.getView();if(c(t1)){k=t1.getCustomToolbar()&&t1.getCustomToolbar().getContent();o1=E(t1);F(o1,u1,v1,t1);}else if(d(t1)){k=t1.getToolbar()&&t1.getToolbar().getContent();var y1=o.getOwnerComponent().getAppComponent();var z1=y1.getConfig();if(o.getMetadata().getName()==='sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage'){o1=E(t1);F(o1,u1,v1,t1);}else if(z1&&z1.pages[0]&&z1.pages[0].component&&z1.pages[0].component.settings&&z1.pages[0].component.settings.quickVariantSelectionX){o1=E(t1);F(o1,u1,v1);}}if(k&&k.length>0){for(var i=0;i<k.length;i++){r1=undefined;p1=k[i];if(p1.getMetadata().getName()==="sap.m.Button"&&p1.getVisible()){s1=v(p1);if(s1&&s1.Type){q1=x1.getLocalId(p1.getId());if(s1.Type==="CRUDActionDelete"){r1=z(v1,w1,u1,t1);t1.getModel("_templPriv").setProperty("/listReport/deleteEnabled",r1);}else if(s1.Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||s1.Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){r1=y(v1,w1,u1,s1.Type,s1.Action,t1);}}if(/generic\/controlProperties/.test(p1.getBindingPath("enabled"))&&r1!==undefined){x(q1,"enabled",r1);}}}}}function w(i){var j;var k=K(i);var o1=u(k);var p1=i.getModel();j=H();F(j,o1,p1,k);}function x(i,j,k){var o1=o.getView().getModel("_templPriv");var p1=o1.getProperty("/generic/controlProperties/"+i);if(!p1){p1={};p1[j]=k;o1.setProperty("/generic/controlProperties/"+i,p1);}else{o1.setProperty("/generic/controlProperties/"+i+"/"+j,k);}}function y(i,k,o1,p1,q1,r1){var s1,t1,u1,v1;var w1=false;if(p1==="com.sap.vocabularies.UI.v1.DataFieldForAction"){s1=k.getODataFunctionImport(q1);u1=s1&&s1["sap:action-for"];if(u1&&u1!==""&&u1!==" "){if(o1.length>0){v1=s1["sap:applicable-path"];if(v1&&v1!==""&&v1!==" "){for(var j=0;j<o1.length;j++){if(!o1[j]){continue;}t1=i.getObject(o1[j].getPath());if(t1&&t1[v1]===true){w1=true;break;}}}else{w1=true;}}}else{w1=true;}}else if(p1==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"){if(o1.length>0||(d(r1)&&r1.getDrillStackFilters().length>0)){w1=true;}}return w1;}function z(j,k,o1,p1){var q1=G(p1);var r1=false;var s1=k.getODataEntitySet(p1.getEntitySet());if(sap.suite.ui.generic.template.js.AnnotationHelper.areDeleteRestrictionsValid(k,s1.entityType,q1)){if(o1.length>0){var t1=q1&&q1.Deletable&&q1.Deletable.Path;if(t1){for(var i=0;i<o1.length;i++){if(o1[i]&&j.getProperty(t1,o1[i])){r1=true;break;}}}else{r1=true;}}}return r1;}function G(i){var j=i.getModel()&&i.getModel().getMetaModel();var k=j&&j.getODataEntitySet(i.getEntitySet());var o1=k&&k["Org.OData.Capabilities.V1.DeleteRestrictions"];return o1;}function F(i,j,k,o1){var p1=I(o1);var q1=o.getView().getModel("_templPriv");var r1=q1.getProperty("/generic/listCommons/breakoutActionsEnabled");if(p1){var s1=o.byId("template::IconTabBar");var t1="";if(s1){t1=s1.getSelectedKey();}U(r1,p1,i,j,k,t1,o1);}q1.setProperty("/generic/listCommons/breakoutActionsEnabled",r1);}function U(i,j,k,o1,p1,q1,r1){var s1;for(var t1 in j){s1=true;if(j[t1].requiresSelection){if(o1.length>0){if(j[t1].applicablePath!==undefined&&j[t1].applicablePath!==""){s1=false;for(var u1=0;u1<o1.length;u1++){var v1="";var w1=j[t1].applicablePath.split("/");if(w1.length>1){for(var x1=0;x1<w1.length-1;x1++){v1+="/"+w1[x1];}}var y1=p1.getObject(o1[u1].getPath()+v1);var z1=w1[w1.length-1];if(y1[z1]===true){s1=true;break;}}}}else if(d(r1)&&r1.getDrillStackFilters().length>0){s1=true;}else{s1=false;}}var A1=j[t1].id+((q1&&!j[t1].determining)?"-"+q1:"");i[A1]={enabled:s1};}}function E(i){var j=[];var k=I(i);for(var o1 in k){j.push(k[o1].id);}return j;}function H(){var i=[];var j=I();for(var k in j){if(j[k].determining){i.push(k);}}return i;}function I(i){var j=o.getOwnerComponent().getAppComponent().getManifestEntry("sap.ui5");var k=j.extends&&j.extends.extensions&&j.extends.extensions["sap.ui.controllerExtensions"];k=k&&k[o.getOwnerComponent().getTemplateName()];k=k&&k["sap.ui.generic.app"];var o1=o.getOwnerComponent().getEntitySet();var p1=v(i).sectionId;if(!p1){return k&&k[o1]&&k[o1]["Actions"];}else{var q1=k&&k[o1]&&k[o1]["Sections"];return q1&&q1[p1]&&q1[p1].Actions;}}function K(i){var j=i;while(j){if(j instanceof R||e(j)||c(j)||d(j)){return j;}j=j.getParent&&j.getParent();}return null;}function O(i){if(c(i)){i=i.getTable();}if(e(i)){return i.getBindingInfo("rows");}else if(i instanceof R){return i.getBindingInfo("items");}return null;}function P(i){var j=O(i);if(j&&j.binding){j.binding.refresh();}else if(i&&i.rebindTable){i.rebindTable();}}function Q(i){var j=o.getOwnerComponent().getModel();var k,o1;if(o.getMetadata().getName()==='sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage'){}else{var p1=!s.oApplication.checkEtags();if(p1){o1=O(i);if(o1){k=o1.path;j.invalidate(T.bind(null,k));s.oApplication.unbindAllComponents();}}}}function T(i,k,j){var o1=i[0]==="/"?i.substr(1):i;if(k.split("(")[0]===o1){return true;}else{return false;}}function V(i,j){var k=i.getPath();var o1=o.getOwnerComponent();var p1=o1.getComponentContainer().getElementBinding();var q1=p1?p1.getPath():"";var r1=null;if(k.indexOf(q1)!==0){r1=O(j).path;}var s1=!s.oApplication.isNewHistoryEntryRequired(i,r1);var t1;if(h.isDraftEnabled()){t1=s.oDraftController.isActiveEntity(i)?1:6;}else{t1=o1.getModel("ui").getProperty("/editable")?6:1;}var u1=h.getViewLevel();if(u1===0){var v1=s.oApplication.getForwardNavigationProperty(u1);}if(v1){var w1=new Promise(function(y1){i.getModel().createBindingContext(v1,i,null,function(z1){if(z1){s.oNavigationController.navigateToContext(z1,r1,s1,t1);y1();}else{h.navigateToDataLoadedFailedPage();y1();}});});var x1=s.oApplication.getBusyHelper();x1.setBusy(w1);}else{s.oNavigationController.navigateToContext(i,r1,s1,t1);}}function W(i,j){if(i instanceof C){s.oNavigationController.navigateToContext(i,j&&j.navigationProperty,j&&j.replaceInHistory);return;}var k=j&&j.routeName;if(k){h.navigateRoute(k,i,null,j&&j.replaceInHistory);return;}q.sap.log.warning("navigateToContext called without context or route");}function X(i){if(i instanceof a){if(i.getErrorCode()==="NavigationHandler.isIntentSupported.notSupported"){M.show(m("ST_NAV_ERROR_NOT_AUTHORIZED_DESC"),{title:m("ST_GENERIC_ERROR_TITLE")});}else{M.show(i.getErrorCode(),{title:m("ST_GENERIC_ERROR_TITLE")});}}}function Y(i,j){e1(function(){n=l1();var k={semanticObject:i.semanticObject,action:i.action};var o1=n.mixAttributesAndSelectionVariant(i.parameters);o.adaptNavigationParameterExtension(o1,k);n.navigate(i.semanticObject,i.action,o1.toJSONString(),null,X);},q.noop,j,"LeavePage");}function Z(o1){var p1=[],q1,r1,s1;var t1=o.getOwnerComponent();var u1=t1.getModel().getMetaModel();if(!o1){return{};}var v1=t1.getAppComponent().getConfig().pages[0];if(!v1){return{};}var w1=function(i){s1=u1.getODataEntitySet(i.entitySet).entityType;r1=u1.getODataEntityType(s1);q1={};q1={entitySet:i.entitySet,aKeys:u1.getODataEntityType(s1).key.propertyRef,navigationProperty:i.navigationProperty};for(var j=0,y1=q1.aKeys.length;j<y1;j++){var k=0,z1=r1.property.length;for(k;k<z1;k++){if(q1.aKeys[j].name===r1.property[k].name){q1.aKeys[j].type=r1.property[k].type;break;}}}};var x1=function(o1,v1){if(!v1.pages){return p1;}for(var i=0,j=v1.pages.length;i<j;i++){if(!v1.pages[i]){break;}if(o1===v1.pages[i].entitySet){w1(v1.pages[i]);p1.splice(0,0,q1);break;}p1=x1(o1,v1.pages[i]);if(p1.length>0){w1(v1.pages[i]);p1.splice(0,0,q1);}}return p1;};return x1(o1,v1);}function $(k,o1){var p1,q1,i,r1;for(i=0,r1=k.length;i<r1;i++){if(k[i].navigationProperty){q1+="/"+k[i].navigationProperty;}else{q1="/"+k[i].entitySet;}for(var j=0,s1=k[i].aKeys.length;j<s1;j++){if(j===0){q1+="(";p1="";}else{p1=",";}switch(k[i].aKeys[j].type){case"Edm.Guid":if(o1.DraftAdministrativeData&&o1.DraftAdministrativeData.DraftIsCreatedByMe){q1+=p1+k[i].aKeys[j].name+"="+"guid'"+o1.DraftAdministrativeData[k[i].aKeys[j].name]+"'";}else{q1+=p1+k[i].aKeys[j].name+"="+"guid'"+o1[k[i].aKeys[j].name]+"'";}break;case"Edm.Boolean":if(o1.DraftAdministrativeData&&o1.DraftAdministrativeData.DraftIsCreatedByMe){q1+=p1+k[i].aKeys[j].name+"="+false;}else{q1+=p1+k[i].aKeys[j].name+"="+o1[k[i].aKeys[j].name];}break;default:if(typeof o1[k[i].aKeys[j].name]==="string"){q1+=p1+k[i].aKeys[j].name+"="+"'"+o1[k[i].aKeys[j].name]+"'";}else{q1+=p1+k[i].aKeys[j].name+"="+o1[k[i].aKeys[j].name];}break;}if(j===(s1-1)){q1+=")";}}}return q1;}function _(k,o1,o){var p1,q1,r1,s1,t1,u1,v1;var w1={semanticObject:"",action:""};n=l1();for(s1 in k.semanticAttributesOfSemanticObjects){p1=n.mixAttributesAndSelectionVariant({},o1);for(r1 in k.semanticAttributesOfSemanticObjects[s1]){if(!p1.getSelectOption(r1)){p1.addParameter(r1,"");}}t1=p1.getPropertyNames();w1.semanticObject=s1;o.adaptNavigationParameterExtension(p1,w1);u1=p1.getSelectOptionsPropertyNames();v1=p1.getParameterNames();for(var i=0,x1=t1.length;i<x1;i++){if(u1.indexOf(t1[i])<0&&v1.indexOf(t1[i])<0){delete k.semanticAttributesOfSemanticObjects[s1][t1[i]];p1.removeSelectOption(t1[i]);}}if(s1===k.semanticObject){var y1=k.semanticAttributesOfSemanticObjects[""];for(var j=0,x1=v1.length;j<x1;j++){if(v1[j]in y1){p1.removeParameter(v1[j]);}else{p1.removeParameter(v1[j]);var z1=k.semanticAttributesOfSemanticObjects[k.semanticObject][v1[j]];if(typeof z1==="undefined"||z1===null){z1="";}else{z1=String(z1);}p1.addParameter(v1[j],z1);}}p1=n.mixAttributesAndSelectionVariant(k.semanticAttributesOfSemanticObjects[s1],o1);q1=p1.toJSONString();}}delete k.semanticAttributes;n.processBeforeSmartLinkPopoverOpens(k,q1);}function a1(i,j,k){if(!i){return m("DRAFT_OBJECT");}else if(j){return m(k?"LOCKED_OBJECT":"UNSAVED_CHANGES");}else{return"";}}function b1(){var i=l("sap.suite.ui.generic.template.fragments.DraftAdminDataPopover",{formatText:function(){var j=Array.prototype.slice.call(arguments,1);var k=arguments[0];if(!k){return"";}if(j.length>0&&(j[0]===null||j[0]===undefined||j[0]==="")){if(j.length>3&&(j[3]===null||j[3]===undefined||j[3]==="")){return(j.length>2&&(j[1]===null||j[1]===undefined||j[1]===""))?"":j[2];}else{return m(k,j[3]);}}else{return m(k,j[0]);}},closeDraftAdminPopover:function(){i.close();},formatDraftLockText:a1},"admin");return i;}function c1(i,j,k,o1,p1,q1){var r1=s.oApplication.getBusyHelper();if(!p1&&r1.isBusy()){return;}if(!h.isDraftEnabled()){var s1=false;if(k&&k.aUnsavedDataCheckFunctions){s1=k.aUnsavedDataCheckFunctions.some(function(w1){return w1();});}var t1=o.getView();var u1=t1.getModel();if(s1||u1.hasPendingChanges()){var v1;g1(function(){t1.setBindingContext(null);u1.resetChanges();t1.setBindingContext();h.fire(o,"AfterCancel",{});v1=i();},function(){v1=j();},o1,q1);return v1;}}return i();}function d1(i,j,k,o1){var p1=false;if(k&&k.aUnsavedDataCheckFunctions){p1=k.aUnsavedDataCheckFunctions.some(function(r1){return r1();});}if(p1||o.getView().getModel().hasPendingChanges()){var q1;i1(function(){o.getView().getModel().resetChanges();h.fire(o,"AfterCancel",{});q1=i();},function(){q1=j();},o1);return q1;}return i();}function e1(i,j,k,o1,p1,q1){if(p1){return c1(i,j,k,o1,true,q1);}s.oApplication.performAfterSideEffectExecution(c1.bind(null,i,j,k,o1,false,q1));}var f1;function g1(i,j,k,o1){var p1;f1=i;if(!k||!o1){var q1=l("sap.suite.ui.generic.template.fragments.DataLoss",{onDataLossOK:function(){q1.close();f1();},onDataLossCancel:function(){q1.close();j();}},"dataLoss");if(!k){k="LeavePage";}p1=q1.getModel("dataLoss");p1.setProperty("/mode",k);q1.open();}else{var r1=l("sap.suite.ui.generic.template.fragments.DiscardDraftPopover",{onDiscardConfirm:function(){f1();}},"discard");p1=r1.getModel("discard");p1.setProperty("/placement",sap.m.PlacementType.Top);if(k!=="Proceed"){p1.setProperty("/isCreateDraft",true);}else{p1.setProperty("/isCreateDraft",false);}p1.setProperty("/mode",k);r1.openBy(o1.getSource());}}var h1;function i1(i,j,k){h1=i;if(!k){k="LeavePage";}var o1=l("sap.suite.ui.generic.template.fragments.DataLossTechnicalError",{onDataLossOK:function(){o1.close();h1();},onDataLossCancel:function(){o1.close();j();}},"dataLoss");var p1=o1.getModel("dataLoss");p1.setProperty("/mode",k);o1.open();}function j1(i,j,k,o1,p1,q1){if(j.busy.check&&o1.isBusy()){q1();return;}var r1=j.busy.set?function(){o1.setBusy(Promise.resolve());return i();}:i;var s1=j.mConsiderObjectsAsDeleted?function(u1){s.oApplication.prepareDeletion(j.mConsiderObjectsAsDeleted);return r1();}:r1;var t1=(j.dataloss.popup?e1(s1,q1,k,(j.dataloss.navigation?"LeavePage":"Proceed"),true):s1());if(t1 instanceof Promise){t1.then(p1,q1);}else{p1();}}function k1(i,j,k){j=q.extend(true,{busy:{set:true,check:true},dataloss:{popup:true,navigation:false}},j);var o1=s.oApplication.getBusyHelper();var p1=new Promise(function(q1,r1){s.oApplication.performAfterSideEffectExecution(j1.bind(null,i,j,k,o1,q1,r1));});if(j.busy.set){o1.setBusy(p1);}return p1;}function l1(){n=n||new N(o);return n;}function m1(j){var k;var o1=h.getTemplatePrivateModel();var p1,q1,r1,s1,t1,u1=[],v1=[],i,w1,x1,y1,z1,A1,B1;var C1,D1;p1=o.getOwnerComponent().getAppComponent();q1=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");r1=o1.getProperty("/generic/supportedIntents/");if(d(j)){k=j.getToolbar();}else if(c(j)){k=j.getCustomToolbar();}s1=k.getContent();t1=s1.length;for(i=0;i<t1;i++){w1=v(s1[i]);if(w1.hasOwnProperty("SemanticObject")&&w1.hasOwnProperty("Action")){x1=w1.SemanticObject;y1=w1.Action;z1={semanticObject:x1,action:y1,ui5Component:p1};u1.push([z1]);A1=q.extend({},z1);A1.bLinkIsSupported=false;v1.push(A1);}}if(u1.length>0&&q1){B1=q1.getLinks(u1);B1.done(function(E1){r1=o1.getProperty("/generic/supportedIntents/");C1=E1.length;for(i=0;i<C1;i++){if(E1[i][0].length>0){v1[i].bLinkIsSupported=true;}x1=v1[i].semanticObject;y1=v1[i].action;D1=o1.getProperty("/generic/supportedIntents/"+x1);if(!D1){r1[x1]={};r1[x1][y1]={"visible":v1[i].bLinkIsSupported};}else if(!D1[y1]){D1[y1]={"visible":v1[i].bLinkIsSupported};}else{D1[y1]["visible"]=v1[i].bLinkIsSupported;}}o1.updateBindings();});}}function n1(k,o1){var p1=[],q1;var r1=v(k).variantAnnotationPath;if(!r1&&o1){r1=v(o1).variantAnnotationPath;}if(r1){var s1=k.getModel();var t1=s1.getMetaModel();var u1=k.getEntitySet();var v1=t1.getODataEntitySet(u1);var w1=t1.getODataEntityType(v1.entityType);var x1=w1[r1];if(!x1.SelectOptions&&x1.SelectionVariant){x1=x1.SelectionVariant;}if(x1.AnnotationPath){q1=x1.AnnotationPath.split("@")[1];x1=w1[q1];}for(var i in x1.SelectOptions){if(x1.SelectOptions[i].PropertyName){var y1=x1.SelectOptions[i].PropertyName.PropertyPath;for(var j in x1.SelectOptions[i].Ranges){var z1=x1.SelectOptions[i].Ranges[j].Option;z1.EnumMember=z1.EnumMember.replace("com.sap.vocabularies.UI.v1.SelectionRangeOptionType/","");var A1=x1.SelectOptions[i].Ranges[j].Low;var B1=x1.SelectOptions[i].Ranges[j].High;var C1=Object.keys(A1)[0];if(B1){var D1=Object.keys(B1)[0];p1.push(new sap.ui.model.Filter(y1,z1.EnumMember,A1[C1],B1[D1]));}else{p1.push(new sap.ui.model.Filter(y1,z1.EnumMember,A1[C1]));}}}}}return p1;}var l1=t.testable(l1,"getNavigationHandler");var F=t.testable(F,"fillEnabledMapForBreakoutActions");var E=t.testable(E,"getBreakoutActionIds");var K=t.testable(K,"getOwnerControl");var u=t.testable(u,"getSelectedContexts");return{isSmartTable:c,isSmartChart:d,isUiTable:e,isAnalyticalTable:f,getText:m,getNavigationHandler:l1,getNavigationKeyProperties:Z,mergeNavigationKeyPropertiesWithValues:$,executeGlobalSideEffect:function(){if(h.isDraftEnabled()){var i=o.getView();i.attachBrowserEvent("keydown",function(j){var k=(j.target.type==="search")?true:false;var o1=(j.target.type==="textarea")?true:false;if(j.keyCode===13&&j.ctrlKey!==true&&i.getModel("ui").getProperty("/editable")&&!k&&!o1){var p1=o.getOwnerComponent().getAppComponent().getConfig();var q1=p1.settings&&p1.settings.forceGlobalRefresh;var r1;s.oApplication.addSideEffectPromise(new Promise(function(s1){r1=s1;}));setTimeout(function(){var s1=s.oApplicationController.executeSideEffects(i.getBindingContext(),null,null,q1);s1.then(function(){r1();setTimeout(function(){document.getElementById(j.target.id).focus();});});});}});}},setEnabledToolbarButtons:S,setEnabledFooterButtons:w,fillEnabledMapForBreakoutActions:F,getBreakoutActions:I,getSelectedContexts:u,getSelectionPoints:p,getDeleteRestrictions:G,setPrivateModelControlProperty:x,navigateFromListItem:V,navigateToContext:W,navigateExternal:Y,semanticObjectLinkNavigation:_,getSelectionVariantFilters:n1,getCustomData:function(j){var k=j.getSource().getCustomData();var o1={};for(var i=0;i<k.length;i++){o1[k[i].getKey()]=k[i].getValue();}return o1;},formatDraftLockText:a1,showDraftPopover:function(i,j){var k=b1();var o1=k.getModel("admin");o1.setProperty("/IsActiveEntity",i.getProperty("IsActiveEntity"));o1.setProperty("/HasDraftEntity",i.getProperty("HasDraftEntity"));k.bindElement({path:i.getPath()+"/DraftAdministrativeData"});if(k.getBindingContext()){k.openBy(j);}else{k.getObjectBinding().attachDataReceived(function(){k.openBy(j);});}},getContentDensityClass:function(){return s.oApplication.getContentDensityClass();},attachControlToView:A,getDialogFragment:l,processDataLossConfirmationIfNonDraft:e1,processDataLossTechnicalErrorConfirmation:d1,securedExecution:k1,getOwnerControl:K,getTableBindingInfo:O,refreshSmartTable:P,refreshModel:Q,getElementCustomData:v,triggerAction:function(i,j,k,o1,p1){e1(function(){s.oCRUDManager.callAction({functionImportPath:k.Action,contexts:i,sourceControl:o1,label:k.Label,operationGrouping:"",navigationProperty:""}).then(function(q1){if(q1&&q1.length>0){var r1=q1[0];if(r1.response&&r1.response.context&&(!r1.actionContext||r1.actionContext&&r1.response.context.getPath()!==r1.actionContext.getPath())){s.oViewDependencyHelper.setMeToDirty(o.getOwnerComponent(),j);}}});},q.noop,p1,"Proceed");},checkToolbarIntentsSupported:m1};}return B.extend("sap.suite.ui.generic.template.lib.CommonUtils",{constructor:function(o,s,h){q.extend(this,g(o,s,h));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.MessageButtonHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.MessageButtonHelper');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.m.MessagePopover');jQuery.sap.require('sap.m.MessagePopoverItem');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');sap.ui.define("sap/suite/ui/generic/template/lib/MessageButtonHelper",["jquery.sap.global","sap/ui/base/Object","sap/m/MessagePopover","sap/m/MessagePopoverItem","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,M,a,F,b,t){"use strict";F=t.observableConstructor(F,true);var p=new F({path:"persistent",operator:b.EQ,value1:false});var v=new F({path:"validation",operator:b.EQ,value1:true});var I=new F({path:"validation",operator:b.EQ,value1:"bla"});function g(c,C,d){var m;var s;var o=C.byId("showMessages");var e=c.getDialogFragment("sap.suite.ui.generic.template.fragments.MessagePopover");e.setModel(sap.ui.getCore().getMessageManager().getMessageModel(),"msg");var f;var E;(function(){var i=C.getOwnerComponent();E=new F({path:"target",operator:b.EQ,value1:"/"+i.getEntitySet()});f=e.getBinding("items");var T=i.getModel("_templPriv");T.setProperty("/generic/messageCount",0);var L=c.getText("MESSAGE_BUTTON_TOOLTIP_P",0);T.setProperty("/generic/messageButtonTooltip",L);f.attachChange(function(){var N=f.getLength();T.setProperty("/generic/messageCount",N);L=c.getText(N===1?"MESSAGE_BUTTON_TOOLTIP_S":"MESSAGE_BUTTON_TOOLTIP_P",N);T.setProperty("/generic/messageButtonTooltip",L);});})();var h=[];var j;var k=0;var n;var l;function r(L){if(q.isArray(L)){var N=false;for(var i=0;i<L.length;i++){N=r(L[i])||N;}return N;}if(L instanceof Promise){L.then(n);return false;}l.push(L);return true;}function u(){var L=l;if(s){for(var i=0;i<s.length;i++){L=L.concat(s[i].filters);}}return L;}function A(){var i=u();if(m){m.propagateFilters(i);}else if(s){var L=new F(i.concat(v),false);var N=[L,p];f.filter(N);}}function R(i,L){if(i===k&&r(L)){A();}}function w(i){var L=i();return r(L);}function x(){h.forEach(w);}function y(i){j=i;k++;n=R.bind(null,k);l=d?[new F({path:"target",operator:b.StartsWith,value1:j}),E]:[];x();A();}function z(i){h.push(i);if(j!==undefined&&w(i)){A();}}var S;function D(){if(m){m.showMessagePopover();return;}if(s){S=S||function(){if(f.getLength()>0){e.openBy(o);}};setTimeout(S,0);}}function G(){m=null;if(s){for(var i=0;i<s.length;i++){s[i].free();}s=null;l=null;f.filter(I);}}function P(i,L){if(s){s[i].filters=L;if(l){A();}}}function H(L){s=[];for(var i=0;i<L.length;i++){var N={showMessagePopover:D,propagateFilters:P.bind(null,i)};var O=L[i].serve(N);s.push(O);}if(l){A();}}function J(){m=null;}function K(i){m=i;f.filter(I);return{filters:l?u():[],free:J};}return{adaptToContext:y,toggleMessagePopover:e.toggle.bind(e,o),showMessagePopover:D,registerMessageFilterProvider:z,suspend:G,resume:H,serve:K};}return B.extend("sap.suite.ui.generic.template.lib.MessageButtonHelper",{constructor:function(c,C,i){q.extend(this,(t.testableStatic(g,"MessageButtonHelper"))(c,C,i));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.ViewDependencyHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.ViewDependencyHelper');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/lib/ViewDependencyHelper",["sap/ui/base/Object","sap/suite/ui/generic/template/js/AnnotationHelper","sap/suite/ui/generic/template/lib/testableHelper"],function(B,A,t){"use strict";function g(T){function s(E){E=E||[];for(var i in T.componentRegistry){if(E.indexOf(i)===-1){var C=T.componentRegistry[i];C.oComponent.setIsRefreshRequired(true);}}}function a(C,n,l){var p,P,m=T.componentRegistry;var M=C.getId();var o=T.componentRegistry[M];var r=o.routeConfig;if(r){if(r.viewLevel===0){return false;}else{for(var f in m){if(f!==M){p=m[f].routeConfig;if(p&&p.viewLevel===(r.viewLevel-1)&&(r.viewLevel===1||p.entitySet===r.parentEntitySet)){P=m[f].oComponent;b(P,n);if(!l||l>1){var S;S=l&&l-1;a(P,undefined,S);}break;}}}}}}function b(C,n){if(n){var r=T.componentRegistry[C.getId()];var R=r.oGenericData.mRefreshInfos;R[n]=true;if(r.utils.isComponentActive()){(r.methods.refreshBinding||jQuery.noop)(false,r.oGenericData.mRefreshInfos);r.oGenericData.mRefreshInfos={};}}else{if(typeof C.setIsRefreshRequired==="function"){C.setIsRefreshRequired(true);}}}function c(C){var f=[];var r=T.componentRegistry[C.getId()].routeConfig;for(var o in T.componentRegistry){var O=T.componentRegistry[o];var h=O.routeConfig;if(r.viewLevel+1===h.viewLevel&&r.entitySet===h.parentEntitySet){f.push(O.oComponent);}}return f;}function d(C){var S=[];var f=c(C);for(var i=0;i<f.length;i++){S=S.concat(d(f[i]));}return S.concat(f);}function u(C,f){var S=d(C);for(var i=0;i<S.length;i++){T.componentRegistry[S[i].getId()].oComponent.getComponentContainer().unbindElement();}if(f){C.getComponentContainer().unbindElement();}}function e(){if(T.rootContainer){var i=T.rootContainer.getComponentInstance();if(i&&typeof i.setIsRefreshRequired==="function"){i.setIsRefreshRequired(true);}}}var a=t.testable(a,"setParentToDirty");return{setAllPagesDirty:s,setParentToDirty:a,setMeToDirty:b,unbindChildren:u,setRootPageToDirty:e};}return B.extend("sap.suite.ui.generic.template.lib.ViewDependencyHelper",{constructor:function(T){jQuery.extend(this,g(T));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.modelHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.modelHelper');sap.ui.define("sap/suite/ui/generic/template/lib/modelHelper",["sap/suite/ui/generic/template/lib/testableHelper"],function(t){"use strict";function a(p,P){var r=["Path","CollectionPath","PropertyPath"];for(var i in r){var s=r[i];if(p[s]&&p[s][0]!=="/"){p[s]=P+"/"+p[s];}}for(var b in p){if(p.hasOwnProperty(b)&&typeof p[b]==="object"){a(p[b],P);}}return p;}function g(m,e,p){function f(e,P){if(P.length===0){return e;}var n=P.shift();var o=f(m.getODataEntityType(m.getODataAssociationEnd(e,n).type),P);return a(o,n);}var P=p.split("/");var s=P.pop();return m.getODataProperty(f(e,P),s);}var a=t.testableStatic(a,"modelHelper_addIndirection");return{getODataProperty:g};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.routingHelper')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.routingHelper');jQuery.sap.require('sap.f.FlexibleColumnLayout');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.routing.Targets');jQuery.sap.require('sap.ui.generic.app.util.ModelUtil');jQuery.sap.require('sap.m.MessageBox');sap.ui.define("sap/suite/ui/generic/template/lib/routingHelper",["sap/f/FlexibleColumnLayout","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/m/routing/Targets","sap/ui/generic/app/util/ModelUtil","sap/suite/ui/generic/template/lib/CRUDHelper","sap/suite/ui/generic/template/lib/FlexibleColumnLayoutHandler","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/js/AnnotationHelperReuseComponents","sap/m/MessageBox"],function(F,a,b,J,T,M,C,c,t,A,d){"use strict";var p="---";function e(i,j,X,Y,Z){var $={};$={viewName:X,controlId:j,controlAggregation:Z};var _=i.getTargets();_.addTarget(Y,$);}function f(i,j){if(i.oTemplateContract.oFlexibleColumnLayoutHandler){i.oTemplateContract.oFlexibleColumnLayoutHandler.createMessagePageTargets(e.bind(null,i.oRouter,j,"sap.suite.ui.generic.template.fragments.MessagePage"));}else{e(i.oRouter,j,"sap.suite.ui.generic.template.fragments.MessagePage","messagePage","pages");}}function E(i,j,X){var Y=i[j];if(!Y){Y={draftSpec:"OData",level:0,children:[]};for(var Z in i){var $=i[Z];if($.level===1){Y.children.push(Z);break;}}i[j]=Y;}if(Y.hasOwnProperty("isDraft")){return;}if(Y.draftSpec==="parent"){if(Y.parent){E(i,Y.parent,X);var _=i[Y.parent];Y.isDraft=_.isDraft;}else if(Y.level===1){for(var a1 in i){var b1=i[a1];if(b1.level===0){Y.isDraft=b1.isDraft;return;}}}return;}if(Y.draftSpec==="OData"){var c1=X.getDraftContext();Y.isDraft=c1.isDraftEnabled(j);return;}Y.isDraft=Y.draftSpec;}function g(i,j){var X=i.oAppComponent.getModel();var Y=X.getMetaModel();Y.loaded().then(function(){var Z=i.oTemplateContract.mEntityTree;var $=i.oAppComponent.getTransactionController().getDraftController();E(Z,j.entitySet,$);for(var _ in Z){E(Z,_,$);}});}function h(i){var j=i.oTemplateContract.oNavigationHost.getId();var X=i.oAppComponent.getConfig();if(!X.pages||!X.pages.length){throw new Error("Route Configuration missing");}if(X.pages.length>1){throw new Error("Currently only one Top route supported");}var Y=X.pages[0];i.oTemplateContract.mEntityTree={};var Z=s([],Y,"root",0,null,i,j);i.oRouter.addRoute(Z);o(Z,i);k(Z.target,Y,0,null,i,j);f(i,j);g(i,Z);return Y.entitySet;}function k(j,X,Y,Z,$,_,a1,b1,c1){var i,d1;if(X.pages){d1=X.pages.length;for(i=0;i<d1;i++){n(j,X.pages[i],(Y+1),Z,$,_,a1,b1,c1);}}}function H(i,j,X,Y,Z,$,_,a1){var b1=X.target;var c1={pages:i.pages};var d1={pattern:X.pattern+"/"+i.id,entitySet:X.entitySet,name:X.name+"/"+i.id,contextPath:X.contextPath,patternDelimiter:p,embeddedComponent:i.id};k(b1,c1,j,d1,Y,Z,$,_,a1);}function l(i,j,X,Y,Z,$,_,a1){var b1=new J();var c1={};i.embeddedComponents[_]={key:_||"implementation",componentName:a1.componentName,containerId:_?A.formatIdComponentContainer(a1):"template::ImplementingComponent",pages:a1.pages||[],communicationModel:b1,communicationObject:c1};if(a1.pages){H(a1,j,X,Y,Z,$,b1,c1);}}function m(i,j,X,Y,Z,$,_){i.embeddedComponents={};if(j.implementingComponent){l(i,X,Y,Z,$,_,null,j.implementingComponent);}else if(j.embeddedComponents){for(var a1 in j.embeddedComponents){var b1=j.embeddedComponents[a1];l(i,X,Y,Z,$,_,a1,b1);}}}function n(i,j,X,Y,Z,$,_,a1,b1){if(j.component){var c1={parent:Y&&Y.entitySet,parentEmbeddedComponent:Y&&Y.embeddedComponent,navigationProperty:j.navigationProperty,level:X,children:[],communicationModel:a1,communicationObject:b1,noKey:j.routingSpec&&j.routingSpec.noKey,draftSpec:j.routingSpec?j.routingSpec.draftSpec||"parent":"OData"};var d1=s(i,j,j.component.list?"aggregation":"detail",X,Y,Z,$);c1.sRouteName=d1.name;c1.entitySet=d1.entitySet;if(_){_.push(d1.entitySet);}var e1=Z.oTemplateContract.mEntityTree[d1.entitySet];if(!e1||e1.level>c1.level){Z.oTemplateContract.mEntityTree[d1.entitySet]=c1;}Z.oRouter.addRoute(d1);o(d1,Z);q(Z,d1);k(d1.target,j,X,d1,Z,$,c1.children,a1,b1);m(c1,j,X,d1,Z,$,_);}}function o(i,j){var X=jQuery.extend({},i);X.name=i.name+"query";X.pattern=i.pattern+"{?query}";j.oRouter.addRoute(X);}function q(i,j){var X=i.oTemplateContract.mEntityTree[j.entitySet];if(j.routingSpec&&j.routingSpec.noOData){X.headerTitle=j.routingSpec.headerTitle;X.titleIconUrl=j.routingSpec.titleIconUrl;}else{var Y=i.oAppComponent.getModel();var Z=Y.getMetaModel();Z.loaded().then(function(){var $=Z.getODataEntitySet(j.entitySet);var _=Z.getODataEntityType($.entityType);var a1=_["com.sap.vocabularies.UI.v1.HeaderInfo"];var b1=(a1&&a1.TypeName&&a1.TypeName.String)||"";if(b1.substr(0,7)==="{@i18n>"){var c1=b1.substring(1,b1.length-1);var d1=c1.split(">");b1=i.oAppComponent.getModel(d1[0]).getResourceBundle().getText(d1[1]);}X.headerTitle=b1;var e1=(a1&&a1.Title&&a1.Title.IconUrl&&a1.Title.IconUrl.String)||"";X.titleIconUrl=e1;});}}function D(i){var j,X,Y;if(i){j=i.pattern;X=i.navigationProperty||i.entitySet;if(j&&X){Y=j.indexOf("{?query}");if(Y>0){j=j.substring(0,Y);}Y=-1;X+="({keys";Y=j.indexOf(X);if(Y>0){j=j.substring(Y);}if(i.navigationProperty){j=j.replace(i.navigationProperty,i.entitySet);}j="/"+j;}}return j;}function r(i,j){return j?j.contextPath+(i.routingSpec.binding?("/"+i.routingSpec.binding):""):"";}function s(i,j,X,Y,Z,$,_){var a1=jQuery.isArray(i)?i:[i];var b1,c1;b1=(Y===1)?j.entitySet:j.navigationProperty;c1=jQuery.extend({},j);c1.path="/"+j.entitySet;c1.operation=X;c1.viewLevel=Y;c1.template=j.component?(j.component.name||j.component):j.template;switch(X){case"root":c1.name="root";c1.pattern="";break;case"aggregation":c1.name=b1+"~aggregation";c1.pattern=b1;break;default:c1.name=b1;var d1=j.routingSpec&&j.routingSpec.noKey?"":"({keys"+Y+"})";c1.pattern=b1+d1;break;}if(Z){c1.name=Z.name+"/"+c1.name;c1.pattern=Z.pattern+(Z.patternDelimiter||"/")+c1.pattern;c1.parentEntitySet=Z.entitySet;}if(c1.viewLevel===1){$.oTemplateContract.routeViewLevel1={pattern:c1.pattern,name:c1.name};}var e1;var f1=c1.name;if($.oTemplateContract.oFlexibleColumnLayoutHandler){e1=$.oTemplateContract.oFlexibleColumnLayoutHandler.adaptRoutingInfo(c1,f1,a1);}else{e1="pages";c1.target=f1;}e($.oRouter,_,c1.name,f1,e1);var g1=new Promise(function(h1){$.mRouteToComponentResolve[c1.name]=h1;});$.oTemplateContract.mRouteToTemplateComponentPromise[c1.name]=g1;c1.contextPath=(j.routingSpec&&j.routingSpec.noOData)?r(j,Z):D(c1);return c1;}function I(i,j){var X;if(!i.oHashChanger.getHash()){X="";if(j&&j.route&&j.route.length===1){X=j.route[0];i.navigate(X,true);}}i.oRouter.initialize();i.fnInitializationResolve();}function B(j,X,Y,Z){var i,$,_,a1,b1=[],c1;$=Y.length;for(i=0;i<$;i++){_=Y[i].PropertyPath;a1=Z[_][0];b1.push(new a(_,b.EQ,a1));}if(j.oAppComponent.getTransactionController().getDraftController().getDraftContext().isDraftEnabled(X)){var d1=new a({filters:[new a("IsActiveEntity","EQ",false),new a("SiblingEntity/IsActiveEntity","EQ",null)],and:false});b1.push(d1);}c1=new a(b1,true);return c1;}function R(i,j,X){jQuery.sap.require("sap.ui.model.analytics.odata4analytics");var Y="/"+j;try{var Z=new sap.ui.model.analytics.odata4analytics.Model(sap.ui.model.analytics.odata4analytics.Model.ReferenceByModel(i));var $=Z.findQueryResultByName(j);var _=new sap.ui.model.analytics.odata4analytics.QueryResultRequest($);var a1=$.getParameterization();var b1=false;if(a1){_.setParameterizationRequest(new sap.ui.model.analytics.odata4analytics.ParameterizationRequest(a1));var c1=a1.getAllParameterNames();jQuery.each(c1,function(){if(X.hasOwnProperty(this)){b1=true;_.getParameterizationRequest().setParameterValue(this,X[this][0]);}});if(X.hasOwnProperty("DisplayCurrency")){if(c1.indexOf("P_DisplayCurrency")>-1){b1=true;_.getParameterizationRequest().setParameterValue("P_DisplayCurrency",X["DisplayCurrency"][0]);}}if(b1){Y=_.getURIToQueryResultEntitySet();}}}catch(d1){jQuery.sap.log.info(d1.name+":"+d1.message);}return Y;}function u(i,j,X,Y,Z){return new Promise(function($,_){var a1=R(X,i,Y);X.read(a1,{filters:[j],success:function(b1){var c1=w(b1,X,Y);if(c1){var d1=X.getKey(c1);if(d1){$({"status":"success","value":d1,"iLevel":Z});}}$({"status":"noData"});},error:function(){$({"status":"error"});}});});}function v(j,X,Y,Z,$,_,a1){var b1=[],c1,d1,e1;var f1=new Promise(function(g1){g1({"status":"success","value":a1,"iLevel":0});});if(Y&&Z&&$){if(_.aNavigablePages){for(var i=0;i<_.aNavigablePages.length;i++){if(_.aNavigablePages&&_.aNavigablePages[i]&&_.aNavigablePages[i].bNavigationWithTechnicalKeyPossible){b1.push(f1);continue;}c1=_.aNavigablePages[i];d1=B(j,c1.sEntitySet,c1.aSemanticKey,Z);e1=u(c1.sEntitySet,d1,$,Z,c1.iLevel);b1.push(e1);}}return Promise.all(b1).then(function(g1){if(g1[0]&&g1[0].status&&g1[0].status==="success"){var i,h1="",i1;for(i=0;i<g1.length;i++){if(g1[i]&&g1[i].status&&g1[i].status==="success"){i1=g1[i].value;if(i>0){i1=i1.replace(_.aNavigablePages[i].sEntitySet,_.aNavigablePages[i].sNavigationProperty);i1='/'+i1;}h1=h1.concat(i1);continue;}else{break;}}j.navigate(h1,true);}I(j,Z);});}}function w(X,Y,Z){var $,i,_,a1;if(X&&X.results){_=X.results.length;if(_===0){a1=null;}else if(_===1){a1=X.results[0];}else if(_>=1){var b1=[];var c1=[];for(i=0;i<_;i++){$=X.results[i];if($&&$.IsActiveEntity){c1.push($);}else if($&&$.IsActiveEntity===false){b1.push($);}}if(c1.length===0&&b1.length>=2){var d1;for(var j=0;j<b1.length;j++){d1=b1[j];if(d1.DraftUUID===Z.DraftUUID){a1=d1;break;}}if(!a1){a1=b1[0];}}else if(c1.length===1&&b1.length===1){a1=c1[0];}else if(c1.length===1&&b1.length>=2){a1=c1[0];}}}return a1;}function x(i,j){if((i&&j)||(j==="display")){return{mode:"unsupported"};}var X={mode:"display",force:"false"};X.mode=j||i||X.mode;X.force=!!j;return X;}function y(j,X,Y,Z,$){var _=K(j,X,Y,Z,$);if(_.aNavigablePages&&_.aNavigablePages[0]&&_.aNavigablePages[0].aSemanticKey&&_.aNavigablePages[0].iLevel===0){v(X,Y,_.aNavigablePages[0].aSemanticKey,Z,j,_);return;}else if(_.aNavigablePages&&_.aNavigablePages[0]&&_.aNavigablePages[0].bNavigationWithTechnicalKeyPossible){if(Z.IsActiveEntity&&Z.IsActiveEntity[0]==="false"&&Z.DraftUUID&&Z.DraftUUID[0]!==""){var a1=[];for(var i=0;i<_.aNavigablePages[0].aTechnicalKey.length;i++){var b1=_.aNavigablePages[0].aTechnicalKey[i]&&_.aNavigablePages[0].aTechnicalKey[i].name;if(b1==="DraftUUID"||b1==="IsActiveEntity"){continue;}if(Z.hasOwnProperty(b1)){a1.push({PropertyPath:b1});}}var c1=j.createKey(Y,Z);v(X,Y,a1,Z,j,_,c1);return;}var c1=j.createKey(Y,Z);if(c1){if(_){var a1=[];for(var i=0;i<_.aNavigablePages[0].aTechnicalKey.length;i++){var b1=_.aNavigablePages[0].aTechnicalKey[i]&&_.aNavigablePages[0].aTechnicalKey[i].name;if(b1==="DraftUUID"||b1==="IsActiveEntity"){continue;}if(Z.hasOwnProperty(b1)){a1.push({PropertyPath:b1});}}v(X,Y,a1,Z,j,_,c1);return;}X.navigate(c1,true);}}I(X,Z);}function z(j,X){var i,Y,Z=false,$,_;if(X&&j){Y=j.length;for(i=0;i<Y;i++){Z=true;$=j[i];_=$.name||$.PropertyPath;if(!X[_]||X[_].length>1){Z=false;break;}}}return Z;}function G(j,X,Y,Z,$,_){var a1,b1,c1,d1,e1,f1,g1;for(var i=0;i<Z.length;i++){f1=Z[i];if(f1&&f1.navigation&&f1.navigation[Y.mode]){continue;}b1=j.getMetaModel().getODataEntitySet(f1.entitySet);c1=f1.component&&f1.component.settings&&f1.component.settings.allowDeepLinking;if(!b1||!($===0||c1)){continue;}d1=j.getMetaModel().getODataEntityType(b1.entityType);e1=d1["com.sap.vocabularies.Common.v1.SemanticKey"];a1={};g1={};if(e1&&z(e1,X)){a1["sEntitySet"]=f1.entitySet;a1["aSemanticKey"]=e1;a1["sNavigationProperty"]=f1.navigationProperty;a1["iLevel"]=$;_.push(a1);}else{if(d1.key.propertyRef&&($===0)&&z(d1.key.propertyRef,X)){g1.bNavigationWithTechnicalKeyPossible=z(d1.key.propertyRef,X);g1.aTechnicalKey=d1.key.propertyRef;_.push(g1);}}if(f1.pages){G(j,X,Y,f1.pages,++$,_);}else{break;}}return _;}function K(i,j,X,Y,Z){var $={},_=[],a1=[];var b1=j.oAppComponent.getConfig();_=b1.pages&&b1.pages[0]&&b1.pages[0].pages;if(!_){return{};}a1=G(i,Y,Z,_,0,a1);$.aNavigablePages=a1;return $;}function P(i){var j=i.oAppComponent.getModel("_templPrivGlobal");j.setProperty("/generic/forceFullscreenCreate",true);}function L(X,Y,Z){var $,_,a1,b1,c1,d1,i,e1,j,f1,g1;if(jQuery.isEmptyObject(Z)){return;}$=X&&X.getMetaModel();_=$&&$.getODataEntitySet(Y);a1=_&&_.entityType;b1=$&&$.getODataEntityType(a1);c1=b1&&b1.property;d1=[];g1=c1&&c1.length;for(i=0;i<g1;i++){e1=c1[i];if(e1["type"]==="Edm.Guid"){d1.push(e1["name"]);}}for(j=0;j<d1.length;j++){if(!Z[d1[j]]){continue;}f1=Z[d1[j]][0];f1=f1.toLowerCase().replace(/(guid')([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})(')/,"$2");if(!f1.match(/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/)){f1=f1.replace(/([0-9a-f]{8})([0-9a-f]{4})([0-9a-f]{4})([0-9a-f]{4})([0-9a-f]{12})/,"$1-$2-$3-$4-$5");}Z[d1[j]][0]=f1;}}function N(i){var j=i.oAppComponent.getConfig();var X=j.settings;var Y=X&&X.inboundParameters;var Z=[];if(Y){Object.keys(Y).forEach(function($){if(Y[$].useForCreate){Z.push($);}});}return Z;}function S(j,X){var Y;var Z=N(j);for(var i=0;i<Z.length;i++){var $=Z[i];var _=X[$];if(_&&_.length===1){Y=Y||Object.create(null);Y[$]=_[0];}}return Y;}function O(j,X,Y){var Z;Z=j.oAppComponent.getModel();Z.attachMetadataFailed(j.fnInitializationResolve);Z.getMetaModel().loaded().then(function(){var $;L(Z,X,Y);var _=Y.preferredMode&&Y.preferredMode[0];var a1=Y.mode&&Y.mode[0];var b1=x(_,a1);switch(b1.mode){case"create":P(j);var c1=S(j,Y);var d1=C.create(j.oAppComponent.getTransactionController().getDraftController(),X,"/"+X,Z,j.oTemplateContract.oApplicationProxy.setEditableNDC,c1);d1.then(function(i){j.navigateToContext(i,"",true,4).then(I.bind(null,j,Y));},function(i){I(j,Y);j.navigateToMessagePage({title:j.oTemplateContract.getText("ST_GENERIC_ERROR_TITLE"),text:i.messageText,description:"",icon:"sap-icon://message-error"});});j.oTemplateContract.oBusyHelper.setBusy(d1,true);break;case"createWithContext":P(j);var e1=new Promise(function(i1,j1){var k1=function(q1){j1();I(j,Y);j.navigateToMessagePage({title:j.oTemplateContract.getText("ST_ERROR"),text:(q1&&q1.messageText)||j.oTemplateContract.getText("ST_GENERIC_UNKNOWN_NAVIGATION_TARGET"),icon:"sap-icon://message-error",description:""});};$=Z.getMetaModel().getODataEntitySet(X);var l1=$["com.sap.vocabularies.Common.v1.DraftRoot"];if(l1&&l1.NewAction){var m1=Z.getMetaModel().getODataFunctionImport(l1.NewAction.String.split("/")[1]);var n1={};if(m1){var o1=m1.parameter?m1.parameter.length:0;for(var i=0;i<o1;i++){var p1=m1.parameter[i];if(p1.mode==="In"&&Y[p1.name]&&Y[p1.name][0]){n1[p1.name]=Y[p1.name][0];}}Z.callFunction("/"+m1.name,{success:function(q1,r1){var s1=new M(Z);var t1=s1.getContextFromResponse(q1);if(t1){i1();j.navigateToContext(t1,null,true,4).then(I.bind(null,j,Y));}else{k1();}},error:k1,method:"POST",urlParameters:n1});}else{k1();}}else{k1();}});j.oTemplateContract.oBusyHelper.setBusy(e1,true);break;case"edit":var f1=K(Z,j,X,Y,b1);if(f1.aNavigablePages&&f1.aNavigablePages[0]&&(f1.aNavigablePages[0].bNavigationWithTechnicalKeyPossible||(f1.aNavigablePages[0].aSemanticKey&&f1.aNavigablePages[0].iLevel===0))){var g1="";var h1;if(f1.aNavigablePages[0].bNavigationWithTechnicalKeyPossible){g1=Z.createKey(X,Y);h1=C.edit(j.oAppComponent.getTransactionController(),X,"/"+g1,Z,j.oTemplateContract,j.fnInitializationResolve);}else if(f1.aNavigablePages&&f1.aNavigablePages[0]&&f1.aNavigablePages[0].aSemanticKey&&f1.aNavigablePages[0].iLevel===0){g1="";h1=C.edit(j.oAppComponent.getTransactionController(),X,g1,Z,j.oTemplateContract,j.fnInitializationResolve,f1.aNavigablePages[0].aSemanticKey,Y);}h1.then(function(i){j.navigate(i.context.getPath(),true);I(j);},function(i){if(i.lockedByUser){if(!b1.force){y(Z,j,X,Y,b1);}else{j.fnInitializationResolve();j.navigateToMessagePage({title:j.oTemplateContract.getText("LOCKED_OBJECT_POPOVER_TITLE"),text:j.oTemplateContract.getText("LOCKED_OBJECT_POPOVER_TITLE"),description:j.oTemplateContract.getText("ST_GENERIC_LOCKED_OBJECT_POPOVER_TEXT",[i.lockedByUser]),icon:"sap-icon://message-error",replaceURL:true});}}else if(i.draftAdminReadResponse){I(j,Y);}else{var i1=j.oTemplateContract.getText("ST_GENERIC_ERROR_NOT_AUTORIZED_EDIT");d.warning(i1,{onClose:function(j1){y(Z,j,X,Y,{mode:"display",force:false});}});}});}else{I(j,Y);}break;case"display":y(Z,j,X,Y,b1);break;default:j.fnInitializationResolve();j.navigateToMessagePage({title:j.oTemplateContract.getText("ST_GENERIC_ERROR_TITLE"),text:j.oTemplateContract.getText("ST_GENERIC_ERROR_TITLE"),description:j.oTemplateContract.getText("PARAMETER_COMBINATION_NOT_SUPPORTED",[a1,_]),icon:"sap-icon://message-error",replaceURL:true});}});}function Q(i){var j=i.oAppComponent.getConfig();if(j.settings&&j.settings.flexibleColumnLayout){i.oTemplateContract.oFlexibleColumnLayoutHandler=new c(i.oTemplateContract.oNavigationHost,i);}var X=h(i);var Y=i.oAppComponent.getComponentData();var Z=Y&&Y.startupParameters;if(X&&Z&&!i.oHashChanger.getHash()){O(i,X,Z);}else{I(i);}}function U(i,j,X){var Y,Z,$;if(i.operation==="root"){return null;}if(i.operation==="aggregation"){Y=i.pattern;}else if(X){Y=X;}else{Y=i.contextPath;}if(!Y){return"";}if(Y.indexOf("/")!==0){Y="/"+Y;}Z=j.getParameter("arguments");if(Z){for($ in Z){if($!=="?query"){Y=Y.replace("{"+$+"}",Z[$]);}}return Y;}}function V(i,j){var X,Y,Z;X=i.getPath().substring(1);Y=X.split("(");if(Y[0]){Z=Y[0];}if(j){X=X.replace(Z,j);if(X.indexOf("/")===0){X=X.substring(1);}}return{entitySet:Z,path:X};}function W(){return p;}var h=t.testableStatic(h,"routingHelpergenerateRoutingMetadataAndGetRootEntitySet");var I=t.testableStatic(I,"routingHelper_initialiseRouting");var v=t.testableStatic(v,"routingHelper_readObject");var O=t.testableStatic(O,"routingHelper_processStartupParameters");var L=t.testableStatic(L,"routingHelper_transformStartupGuidParameters");return{startupRouter:Q,determinePath:U,determineNavigationPath:V,getPatternDelimiter:W,readObjectProcessResults:w};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.support.lib.CommonChecks')){jQuery.sap.declare('sap.suite.ui.generic.template.support.lib.CommonChecks');sap.ui.define("sap/suite/ui/generic/template/support/lib/CommonChecks",["sap/suite/ui/generic/template/support/lib/CommonMethods"],function(C){"use strict";var f={UNKNOWN:"Unknown",LISTREPORT:"sap.suite.ui.generic.template.ListReport",ANALYTICALLISTPAGE:"sap.suite.ui.generic.template.AnalyticalListPage",OVERVIEWPAGE:"sap.ovp"};var t={UNKNOWN:"CA-UI5-ST",LISTREPORT:"CA-UI5-ST",ANALYTICALLISTPAGE:"CA-UI5-ST-ALP",OVERVIEWPAGE:"CA-UI5-ST-OVP"};function g(){return sap.ui.getVersionInfo();}function G(M){return(M&&M["sap.app"]&&M["sap.app"].ach)?M["sap.app"].ach:"";}function a(M){if(M&&M["sap.app"]&&M["sap.app"].id){if(M["sap.app"].id==="${project"+".artifactId}"){return e();}return M["sap.app"].id;}return"";}function b(M){return(M&&M["sap.fiori"]&&M["sap.fiori"].registrationIds&&M["sap.fiori"].registrationIds.length>0)?M["sap.fiori"].registrationIds:[];}function c(v,P){for(var i=0;i<v.length;i++){if(v[i]&&v[i].id&&v[i].id.indexOf(P)!==-1){return v[i].id.split("::")[0];}}return"";}function d(){var x=jQuery(".sapUiXMLView"),O=jQuery(".ovpWrapper"),P="::sap.suite.ui.generic.template",M;if(O&&O.length&&O.length>0){x=O.closest(".sapUiXMLView");if(x&&x.length&&x.length>0&&x[0]&&x[0].id&&sap.ui.getCore().byId(x[0].id)&&sap.ui.getCore().byId(x[0].id).getController()&&sap.ui.getCore().byId(x[0].id).getController().getOwnerComponent()&&sap.ui.getCore().byId(x[0].id).getController().getOwnerComponent().getMetadata()&&sap.ui.getCore().byId(x[0].id).getController().getOwnerComponent().getMetadata().getManifest()){M=sap.ui.getCore().byId(x[0].id).getController().getOwnerComponent().getMetadata().getManifest();}else{return undefined;}}else if(x&&x.length&&x.length>0){for(var i=0;i<x.length;i++){if(x[i].id.indexOf(P)!==-1){if(sap.ui.getCore().byId(x[i].id)&&sap.ui.getCore().byId(x[i].id).getController()&&sap.ui.getCore().byId(x[i].id).getController().getOwnerComponent()&&sap.ui.getCore().byId(x[i].id).getController().getOwnerComponent().getAppComponent()&&sap.ui.getCore().byId(x[i].id).getController().getOwnerComponent().getAppComponent().getMetadata()&&sap.ui.getCore().byId(x[i].id).getController().getOwnerComponent().getAppComponent().getMetadata().getManifest()){M=sap.ui.getCore().byId(x[i].id).getController().getOwnerComponent().getAppComponent().getMetadata().getManifest();break;}}}if(!M||!C.hasObjectContent(M)){return undefined;}if(M&&C.hasObjectContent(M)&&M["sap.app"]&&M["sap.app"].id&&M["sap.app"].id==="${project"+".artifactId}"){M["sap.app"].id=c(x,P);}}else{return undefined;}return M;}function e(){var M=d(),x,O,P="::sap.suite.ui.generic.template";if(M&&C.hasObjectContent(M)&&M["sap.app"]&&M["sap.app"].id){x=jQuery(".sapUiXMLView");O=jQuery(".ovpWrapper");if(O&&O.length&&O.length>0){x=O.closest(".sapUiXMLView");}if(x&&x.length&&x.length>0){return c(x,P);}}return"";}function h(A){if(!A){return"";}return jQuery.sap.getModulePath(A,"/manifest.json");}function j(O,P,M){if(!O||!M){return"";}if(M.indexOf("./")===0||M.indexOf("../")===0){if(!P){return"";}return O+P.substring(0,P.lastIndexOf("/")+1)+M;}if(M.indexOf("/")===0){return O+M;}return"";}function k(M){if(M){return M.replace("manifest.json","");}return"";}function I(F){if(!F){return false;}for(var K in f){if(!f.hasOwnProperty(K)){continue;}if(f[K]===F){return true;}}return false;}function l(F){if(F===f.UNKNOWN){return t.UNKNOWN;}else if(F===f.LISTREPORT){return t.LISTREPORT;}else if(F===f.ANALYTICALLISTPAGE){return t.ANALYTICALLISTPAGE;}else if(F===f.OVERVIEWPAGE){return t.OVERVIEWPAGE;}else{return t.UNKNOWN;}}function m(M){return M&&M.hasOwnProperty("sap.ovp")&&Object.keys(M["sap.ovp"]).length!==0;}function n(M){if(!(M&&M["sap.ui.generic.app"]&&M["sap.ui.generic.app"].pages&&M["sap.ui.generic.app"].pages!==[])){return false;}var P=M["sap.ui.generic.app"].pages;for(var K in P){if(P.hasOwnProperty(K)){if(P[K]&&P[K].component&&P[K].component.name&&P[K].component.name==="sap.suite.ui.generic.template.ListReport"){return true;}}}return false;}function o(M){if(!(M&&M["sap.ui.generic.app"]&&M["sap.ui.generic.app"].pages&&M["sap.ui.generic.app"].pages!==[])){return false;}var P=M["sap.ui.generic.app"].pages;for(var K in P){if(P.hasOwnProperty(K)){if(P[K]&&P[K].component&&P[K].component.name&&P[K].component.name==="sap.suite.ui.generic.template.AnalyticalListPage"){return true;}}}return false;}function p(M){if(M){if(m(M)){return f.OVERVIEWPAGE;}else if(n(M)){return f.LISTREPORT;}else if(o(M)){return f.ANALYTICALLISTPAGE;}}return f.UNKNOWN;}function q(){return m(d());}function r(){return n(d());}function s(){return o(d());}function u(){var M=d();if(m(M)){return f.OVERVIEWPAGE;}else if(n(M)){return f.LISTREPORT;}else if(o(M)){return f.ANALYTICALLISTPAGE;}return f.UNKNOWN;}return{mFloorplans:f,mTicketComponents:t,getUI5VersionInfo:g,getApplicationComponentByManifest:G,getApplicationIDByManifest:a,getRegistrationIDsByManifest:b,getComponentIDByStructure:e,getManifestByStructure:d,getManifestPath:h,getManifestURL:j,getRootPath:k,isValidFloorplan:I,getTicketComponentForFloorplan:l,isOverviewPageByManifest:m,isListReportByManifest:n,isAnalyticalListPageByManifest:o,getFloorplanByManifest:p,isOverviewPageByStructure:q,isListReportByStructure:r,isAnalyticalListPageByStructure:s,getFloorplanByStructure:u};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroChart')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroChart');jQuery.sap.require('sap.ui.model.Sorter');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemMicroChart",["sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItem","sap/ui/model/Sorter","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil"],function(F,S,c){"use strict";var C="Donut";var d="Line";var f="Bar";var I="__IS_OTHER__";var g=F.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroChart",{metadata:{properties:{smartFilterId:{type:"string",group:"Misc",defaultValue:null}},aggregations:{control:{type:"sap.ui5.controls.microchart",multiple:false}}},renderer:function(r,o){r.write("<div");r.writeControlData(o);r.writeClasses();r.addStyle("width","100%");jQuery(document.body).hasClass("sapUiSizeCozy")?r.addStyle("height","9.9rem"):r.addStyle("height","7.9rem");r.writeStyles();r.write(">");r.renderControl(o.getAggregation("control"));r.write("</div>");}});g.prototype._formattingId="__UI5__ShortIntegerMaxFraction2";g.prototype._maxFractionalDigits=2;g.prototype._maxFractionalDigitsValsLessThanZero=7;g.prototype._minFractionalDigits=0;g.prototype._shortRefNumber;g.prototype._isTriggeredBySync=false;g.prototype._multiUnit=false;g.prototype.technicalIssueMessage="TECHNICAL_ISSUES_OVERLAY_MESSAGE";g.prototype.noDataIssueMessage="NO_DATA_FOUND_OVERLAY_MESSAGE";g.prototype.requiredFilterMessage="REQUIRED_FIELDS_OVERLAY_MESSAGE";g.prototype.multipleCurrencyMessage="MULTIPLE_CURRENCY_OVERLAY_MESSAGE";g.prototype.multipleUnitMessage="MULTIPLE_UNIT_OVERLAY_MESSAGE";g.prototype.init=function(){this._bAllowBindingUpdateOnPropertyChange=false;this._attachChartEvents();};g.prototype._attachChartEvents=function(){var m=this;this._chart.addEventDelegate({onAfterRendering:function(){if(m._getChartAggregations().length){if(m._multiUnit){m.applyOverlay(m.getIsCurrency()?m.multipleCurrencyMessage:m.multipleUnitMessage);}}}});this._chart.attachSelectionChanged(this._onSelectionChanged,this);};g.prototype._getCurrentSelectedChart=function(r){if(this._chart.getPoints){return r?d:"point";}else if(this._chart.getSegments){return r?C:"segment";}else if(this._chart.getBars){return r?f:"bar";}};g.prototype._getCustomData=function(e){var s=this._getCurrentSelectedChart();var a=(s)?e.getParameter(s):undefined;if(s&&a){var b=a.getCustomData();var h={dimValue:b[0].getValue(),dimValueDisplay:a.getLabel()};return h;}};g.prototype._onSelectionChanged=function(e){var s=this.getFilterRestriction(),o=this._getCustomData(e),b=e.getParameter("selected"),a=(s==="single"&&o.dimValue===I&&b);if(o.dimValue===I&&b&&this.getIsDropDown()){e.getParameter("segment").setSelected(false);return;}if(a){e.getParameter("segment").setSelected(false);}if(b&&o.dimValue===I&&s==="multiple"||(b&&o.dimValue!==I)){this._onChartSelectData(e);}else if(!b){this._onChartDeselectData(e);}};g.prototype._onChartSelectData=function(e){var D,s=this.getFilterRestriction();if(s==="multiple"){D=jQuery.extend(true,{items:[],ranges:[],value:null},this.getDimensionFilter());var o=this._getCustomData(e),a=this._getCurrentSelectedChart(true);if(a===C){D=this._applyDonutChartSelections(o,D);}else{D.items.push({key:o.dimValue,text:o.dimValueDisplay});}}else{D=this.getDimensionFilter();if(D){D=null;var b=e.getParameter("bar")||e.getParameter("point")||e.getParameter("segment");this._setSelectedAggregation(b);b.setSelected(true);}var o=this._getCustomData(e);D=o.dimValue;}this.setProperty("dimensionFilter",D);this.fireFilterChange();};g.prototype._setSelectedAggregation=function(s){var a=this._chart.setSelectedBars||this._chart.setSelectedPoints||this._chart.setSelectedSegments;a.call(this._chart,s);};g.prototype._getChartAggregations=function(){var a=this._chart.getPoints||this._chart.getSegments||this._chart.getBars;return a.call(this._chart);};g.prototype._onChartDeselectData=function(e){var D,s=this.getFilterRestriction(),o=this._getCustomData(e),u=[],U=[];if(s==="single"){D=null;}else{D=jQuery.extend(true,{},this.getDimensionFilter());var a=(D&&D.items)?D.items:undefined,b=(D&&D.ranges)?D.ranges:undefined,h=(D&&D.value)?D.value:null;if(a){a.forEach(function(i){if(i.key!==o.dimValue){u.push(i);}});}D.items=u;if(h){if(o.dimValue===h){D.value=null;}}if(b){b.forEach(function(i){if(i.operation==="EQ"&&o.dimValue!==I&&i.exclude){U.push(i);}else if(i.operation==="EQ"&&!i.exclude){if(i.value1 instanceof Date&&o.dimValue instanceof Date){if(c.getDateInMedium(i.value1)!==c.getDateInMedium(o.dimValue)){U.push(i);}}else if(i.value1!==o.dimValue){U.push(i);}}else if(i.operation!=="EQ"&&!i.exclude&&i.value1!==o.dimValue){U.push(i);}});}D.ranges=U;}this.setProperty("dimensionFilter",D);this.fireFilterChange();};g._getSorter=function(s){var a=[],b=[],e=[];for(var i=0;i<s.length;i++){a[i]=s[i].Field.String;b[i]=s[i].Descending.Boolean;e.push(new S(a[i],b[i]));}var o={sorter:e,sortFields:a};return o;};g.prototype._getNumberFormatter=function(s){var a=sap.ui.core.format.NumberFormat.getIntegerInstance({style:"short",showScale:false,shortRefNumber:s});return a;};g.prototype.setWidth=function(w){this.setProperty("width",w);};g.prototype.setHeight=function(h){this.setProperty("height",h);};g.prototype.setEntitySet=function(e){this.setProperty("entitySet",e);};g.prototype.setDimensionField=function(a){this.setProperty("dimensionField",a);};g.prototype.setDimensionFieldIsDateTime=function(a){this.setProperty("dimensionFieldIsDateTime",a);};g.prototype.setDimensionFieldDisplay=function(a){this.setProperty("dimensionFieldDisplay",a);};g.prototype.setMeasureField=function(m){if(m&&m.constructor===Object){if(m.value){this.setProperty("measureField",m.value);}if(m.bUpdateBinding){this._updateBinding();}}else if(m&&m.constructor===Array){this.setProperty("measureField",m);}else{this.setProperty("measureField",m);}};g.prototype.setUnitField=function(u){this.setProperty("unitField",u);};g.prototype.setSortOrder=function(s){if(s&&s.constructor===Object){if(s.value){this.setProperty("sortOrder",s.value);}if(s.bUpdateBinding){this._updateBinding();}}else if(s&&s.constructor===Array){this.setProperty("sortOrder",s);}else{this.setProperty("sortOrder",s);}};g.prototype.setDimensionFilterExternal=function(a){this.setProperty("dimensionFilterExternal",a);if(this._bAllowBindingUpdateOnPropertyChange){this._updateBinding();}};g.prototype.getP13NConfig=function(){var p=["width","height","filterRestriction","isDropDown","sortOrder","measureField","scaleFactor","numberOfFractionalDigits","chartQualifier","entitySet","dimensionField","dimensionFieldDisplay","dimensionFieldIsDateTime","dimensionFilter","unitField","isCurrency","isMandatory","outParameter","inParameters","parentProperty"];var o={};for(var i=0;i<p.length;i++){var n=p[i];o[n]=this.getProperty(n);if((n=="outParameter"||n=="inParameters")&&o[n]==""){o[n]=undefined;}}return o;};g.prototype.setDimensionFilter=function(a,i){this.setProperty("dimensionFilter",a);};g.prototype._onDataReceived=function(a){if(!a){return;}this._determineUnit(a);this._getShortRefNumber(a.slice(0));};g.prototype._determineUnit=function(a){this._multiUnit=false;var u=this.getUnitField();if(u){var p=a[0][u];for(var i=1;i<a.length;i++){if(a[i].dimensionValue!==I){var b=a[i][u];}if(b!=p){if(a.length>1){this._multiUnit=true;}break;}p=b;}this._applyUnitValue(this._multiUnit?"":p);}else{this._applyUnitValue("");}};g.prototype._applyUnitValue=function(v){if(this._lastUnitValue!=v){this._lastUnitValue=v;this.fireTitleChange();}};g.prototype._getShortRefNumber=function(D){this._scaleValue="";this._shortRefNumber=undefined;var s=this.getScaleFactor(),a;if(!s){var b=this._getScaleFactorFromMedian(D);s=b.iShortRefNumber;a=b.scale;}else{var e=this._getNumberFormatter(s);a=e.getScale()?e.getScale():"";}this._shortRefNumber=s;this._scaleValue=a;this.fireTitleChange();};g.prototype._getScaleFactorFromMedian=function(D){var m=this.getMeasureField();D.sort(function(a,b){if(Number(a[m])<Number(b[m])){return-1;}if(Number(a[m])>Number(b[m])){return 1;}return 0;});var M=D.length/2,e=M%1===0?(parseFloat(D[M-1][m])+parseFloat(D[M][m]))/2:parseFloat(D[Math.floor(M)][m]),v=e,s;for(var i=0;i<14;i++){s=Math.pow(10,i);if(Math.round(Math.abs(v)/s)<10){break;}}var h=this._getNumberFormatter(s);for(var i=0;i<D.length;i++){var j=D[i],k=h.format(j[m]),l=k.split(".");if((!l[1]&&parseInt(l[0],10)===0)||(l[1]&&parseInt(l[0],10)===0&&l[1].indexOf('0')===0)||(k/1000)>=1000){s=undefined;break;}}return{iShortRefNumber:s,scale:s?h.getScale():""};};g.prototype._getScaleFactor=function(v){var v=parseFloat(v);var p=this._minFractionalDigits;for(var i=0;i<14;i++){var s=Math.pow(10,i);if(Math.round(Math.abs(v)/s,p-1)<10){return s;}}return undefined;};g.prototype.getTitle=function(){var m=this.getModel();if(!m){return"";}var a=c.getPropertyNameDisplay(m,this.getEntitySet(),this.getMeasureField());var b=c.getPropertyNameDisplay(m,this.getEntitySet(),this.getDimensionField());var u=this._lastUnitValue?this._lastUnitValue:"";var s=this._scaleValue?this._scaleValue:"";var i=this.getModel("i18n");if(!i){return"";}var r=i.getResourceBundle();var t="";if(s&&u){t=r.getText("VIS_FILTER_TITLE_MD_UNIT_CURR",[a,b,s,u]);}else if(u){t=r.getText("VIS_FILTER_TITLE_MD_UNIT",[a,b,u]);}else if(s){t=r.getText("VIS_FILTER_TITLE_MD_UNIT",[a,b,s]);}else{t=r.getText("VIS_FILTER_TITLE_MD",[a,b]);}return t;};g.prototype.getFormattedNumber=function(v,s){var n=this.getNumberOfFractionalDigits();if(n===""||n===undefined){n="1";}else{if(Number(n)>1){n="1";}}var a=sap.ui.core.format.NumberFormat.getFloatInstance({style:"short",decimals:Number(n),showScale:s,shortRefNumber:this._shortRefNumber,minFractionDigits:this._minFractionalDigits,maxFractionDigits:this._maxFractionalDigits});return a.format(parseFloat(v));};g.prototype._getFormattedNumberWithUoM=function(v,U){U=(U)?U:"";var l=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();var a=sap.ui.core.format.NumberFormat.getFloatInstance({maxFractionDigits:2,groupingEnabled:true},l).format(v);return(U==="%")?a+"%":a+" "+U;};g.prototype._getDisplayedValue=function(v,u){var s=(this._scaleValue===""),n=this.getFormattedNumber(v,s),i=(u==="%");return(i)?n+"%":""+n;};g.prototype._getToolTip=function(a,b,u){var n=this._getFormattedNumberWithUoM(b,u);return a+"\n"+n;};g.prototype._getSelected=function(o,D){var b=false,s=this.getFilterRestriction(),e=[];if(o){if(s==='multiple'){if(o.items){o.items.forEach(function(h){if(h.key===D){b=true;}});}if(o.value&&o.value===D){b=true;}if(o.ranges){for(var i=0;i<o.ranges.length;i++){var r=o.ranges[i];if(r.operation==="EQ"&&r.value1&&!r.exclude){if(r.value1 instanceof Date&&D instanceof Date){if(c.getDateInMedium(r.value1)===c.getDateInMedium(D)){b=true;break;}}else if(r.value1===D){b=true;break;}}else if(r.exclude&&r.operation==='EQ'){e.push(r.value1);}}if(e.length===2&&D===I){var v=0,a=this._chart.getSegments();a.forEach(function(h){var V=h.getCustomData()[0].getValue();if(e.indexOf(V)>-1){v++;}});if(v===2){b=true;}}}}else{if(o&&o===D){b=true;}}}return b;};g.prototype._getChartAggregationSettings=function(i){var D=i?'dimensionValue':this.getDimensionField(),s=this.getDimensionFieldDisplay(),m=this.getMeasureField(),u=this.getUnitField(),l=(D===s)?[s]:[s,D],t=(D===s)?[s,m,""]:[s,m,D],U=u?t.push(u):t,a=this,o={label:{parts:l,formatter:function(b,D){var T=a.getTextArrangement();return(b instanceof Date)?c.getDateInMedium(b):c.getTextArrangement(b,D,T);}},value:{path:m,formatter:function(v){return parseFloat(v);}},displayedValue:{parts:[m,u],formatter:function(v,b){return a._getDisplayedValue(v,b);}},tooltip:{parts:U.constructor===Array?U:t,formatter:function(b,e,D,h){var T=a.getTextArrangement();D=D.constructor===Object?undefined:D;b=(b instanceof Date)?c.getDateInMedium(b):c.getTextArrangement(b,D,T);return a._getToolTip(b,e,h);}},selected:{parts:["_filter>/"+a.getParentProperty(),D],formatter:function(b,e){return a._getSelected(b,e);}},customData:{Type:"sap.ui.core.CustomData",key:D,value:"{"+D+"}"},color:"{color}"};return o;};g.prototype.applyOverlay=function(i){var p=this.data("sPath");if(p){var s=p+"/showChartOverlay";var a=this.getModel('_visualFilterConfigModel');a.setProperty(s,(i?true:false));if(i){var o=p+"/overlayMessage";a.setProperty(o,i);}}};g.prototype.considerAnalyticBinding=function(b,s){if(s&&s.getAnalyticBindingPath&&s.getConsiderAnalyticalParameters()){try{var a=s.getAnalyticBindingPath();if(a){return a;}}catch(e){jQuery.sap.log.warning("Mandatory parameters have no values","","AnalyticalListPage");}}return b;};return g;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.VisualFilterProvider')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.VisualFilterProvider');jQuery.sap.require('sap.ui.comp.odata.MetadataAnalyser');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/VisualFilterProvider",["sap/ui/comp/odata/MetadataAnalyser","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms"],function(M,F,V){"use strict";var c=function(f){this._filter=f;this._oMetadataAnalyser=new M(f.getModel());this._groupList=[];this._groupListByName={};this._groupMap={};this._measureList=[];this._measureMap={};this._dimensionMap={};this._selectionFieldsLength=0;this._selectionFieldsParsed=0;this._annotationData={Filters:[]};this._allSelectionFields;this._initMetadata();};c.prototype._initMetadata=function(){var e=this._filter.getEntitySet();var a=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(e);this._getFieldAnnotations(e,a);this._getVisualFilterAnnotation(a);};c.prototype.getVisualFilterConfig=function(){return this._filterConfig;};c.prototype.getMetadataAnalyser=function(){return this._oMetadataAnalyser;};c.prototype._getFieldAnnotations=function(e,a){if(!e){return;}var b=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(e);if(!b){return;}var m=this._filter.getModel();var d=m.getMetaModel();if(!a||!d){return;}var g={};var f={};var h=this._oMetadataAnalyser.getFieldGroupAnnotation(b);for(var i=0;i<h.length;i++){var k=h[i];var l={name:k.groupName,label:k.groupLabel,fieldList:k.fields};f[l.name]=l;for(var j=0;j<k.fields.length;j++){g[k.fields[j]]=l;}}var n=d.getODataEntityType(a);var s=n[V.SelectionFields];var o={};if(s){for(var i=0;i<s.length;i++){var p=s[i];o[p.PropertyPath]=p;}}var u={};var q=this._oMetadataAnalyser.getFieldsByEntityTypeName(b);for(var i=0;i<q.length;i++){var r=q[i];var t=r.name;var v=d.getODataProperty(n,t);var w=v["sap:aggregation-role"];if(w=="dimension"){var x={name:t,fieldInfo:r,propInfo:v};var l=g[t];if(l){for(var j=0;j<l.fieldList.length;j++){if(l.fieldList[j]==t){l.fieldList[j]=x;break;}}}else{var L=n[V.Label]?n[V.Label].String:undefined;var y=o[t]?"_BASIC":(n[L]||n.name);var l=f[y];if(!l){l={name:y,label:y=="_BASIC"?this._filter.getModel("i18n").getResourceBundle().getText("VIS_FILTER_GRP_BASIC_TITLE"):y,fieldList:[]};f[y]=l;}l.fieldList.push(x);g[t]=l;}u[l.name]=true;}}var z=[];if(u["_BASIC"]){z.push(f["_BASIC"]);delete f["_BASIC"];}for(var i=0;i<h.length;i++){var y=h[i].groupName;if(y=="_BASIC"){continue;}if(u[y]){z.push(f[y]);}delete f[y];}for(var y in f){if(u[y]){z.push(f[y]);}delete f[y];}f={};for(var i=0;i<z.length;i++){var l=z[i];f[l.name]=l;}};c.prototype.getGroupList=function(){return this._groupList?this._groupList:[];};c.prototype.getGroupMap=function(){return this._groupMap?this._groupMap:{};};c.prototype.getMeasureMap=function(){return this._measureMap;};c.prototype.getDimensionMap=function(){return this._dimensionMap;};c.prototype.getEntityType=function(e){return this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(e);};c.prototype._updateGroupList=function(e,a,p,d){var i=function(g){return g.PropertyPath===p;};var b;if(this._allSelectionFields){b=this._allSelectionFields.filter(i);}b=(b&&b.length)?true:false;var m=this._filter.getModel().getMetaModel();var f=m.getODataEntityType(e);f=f[V.Label]?f[V.Label].String:f.name;var u=function(g,h){for(var k in h._groupList){var j=h._groupList[k],l=false;if(j.name===g){var n=j.fieldList;for(var o in n){if(n[o].name===d){l=true;}else{continue;}}if(!l){var q=m.getODataEntityType(a);var r=h._oMetadataAnalyser.getFieldsByEntityTypeName(a);for(var k in r){if(r[k].name===d){var s=m.getODataProperty(q,r[k].name);n.push({name:r[k].name,fieldInfo:r[k],propInfo:s});}}}}else{continue;}}};if(b){u('_BASIC',this);}else{u(f,this);}};c.prototype._createDimensionMap=function(e,a){var b,m=this._filter.getModel(),d=m.getMetaModel(),f,g={},p,h,i,j={};if(!d){return false;}f=d.getODataEntityType(a);b=this._oMetadataAnalyser.getFieldsByEntityTypeName(a);for(var k in b){p=d.getODataProperty(f,b[k].name);if(b[k]['aggregationRole']==='dimension'){h={name:b[k].name,fieldInfo:b[k],propInfo:p};g[b[k].name]=h;}else if(b[k]['aggregationRole']==='measure'){i={name:b[k].name,label:b[k].fieldLabel,fieldInfo:b[k],propInfo:p};j[b[k].name]=i;}}if(Object.keys(g).length){this._dimensionMap[e]=g;}if(Object.keys(j).length){this._measureMap[e]=j;}};c.prototype._createGroupList=function(f,p,i,g){var a;if(i){a=this._filter.getModel("i18n").getResourceBundle().getText("VIS_FILTER_GRP_BASIC_TITLE");this._addToGroupListByName('_BASIC',a,f,p);}else{a=f.groupTitle;this._addToGroupListByName(g,a,f,p);}};c.prototype._addToGroupListByName=function(g,a,f,p){if(this._groupListByName[g]===undefined){this._groupListByName[g]=[];this._groupListByName[g].push({name:g,label:a,fieldList:[]});this._groupListByName[g][0].fieldList.push({name:f.name,fieldInfo:f,propInfo:p});}else{this._groupListByName[g][0].fieldList.push({name:f.name,fieldInfo:f,propInfo:p});}};c.prototype._setGroupListForDialog=function(){if(Object.keys(this._groupListByName).length){for(var k in this._groupListByName){this._groupList.push(this._groupListByName[k][0]);}}var g={};for(var i=0;i<this._groupList.length;i++){var a=this._groupList[i];g[a.name]=a;}this._groupMap=g;};c.prototype._sortVisualFilter=function(d,e){if(e.filterList){e.filterList.sort(function(a,b){var I,f;if(d){for(var i=0;i<d.length;i++){if(d[i].PropertyPath===a.parentProperty){I=i;}if(d[i].PropertyPath===b.parentProperty){f=i;}if(I&&f){break;}}}if((I<f)||(!I&&a.isMandatory)){return-1;}if((I>f)||(!f&&b.isMandatory)){return 1;}return 0;});}return e;};c.prototype._getScaleFactor=function(e,a){if(!a){return"";}if(a.indexOf("com.sap.vocabularies.UI.v1.DataPoint")>-1){a=a.toString();if(a.charAt(0)==="@"){a=a.slice(1);}var E=e[a];if(E&&E.ValueFormat&&E.ValueFormat.ScaleFactor){return F.getPathOrPrimitiveValue(E.ValueFormat.ScaleFactor);}else{return"";}}};c.prototype._getNumberOfFractionalDigits=function(e,a){if(!a){return"";}if(a.indexOf("com.sap.vocabularies.UI.v1.DataPoint")>-1){a=a.toString();if(a.charAt(0)==="@"){a=a.slice(1);}var E=e[a];if(E&&E.ValueFormat&&E.ValueFormat.NumberOfFractionalDigits){return F.getPathOrPrimitiveValue(E.ValueFormat.NumberOfFractionalDigits);}else{return"";}}};c.prototype._getVisualFilterAnnotation=function(e){var m=this._filter.getModel();var a=m.getMetaModel();if(!e||!a){return null;}var b=a.getODataEntityType(e);if(!b){return null;}this._allSelectionFields=b[V.SelectionFields];var d=this._filter._smartFilterContext.getFilterBarViewMetadata(),i,f,g,G,h,v,j,k,l,n=[],o,p,q;for(var r in d){n=d[r].fields;G=d[r].groupName;for(var P in n){i=n[P].filterable;f=n[P].filterRestriction;l=n[P].hasFixedValues===true;q=n[P].displayBehaviour;if(f==="auto"){f="multiple";}if(f!=="interval"&&i!=="false"){o=n[P];j=n[P].fieldName;g=n[P].isMandatory;h=n[P].requiredFilterField;for(var s in n[P]){if(s.indexOf(V.ValueList)>-1&&n[P][s].PresentationVariantQualifier){k=(G==="_BASIC")||g||h;p=a.getODataProperty(b,j);v=n[P][s];this._createGroupList(o,p,k,G);this._getAnnotationFromValueList(e,k,v,j,f,l,g,q);}}}}}this._setGroupListForDialog();this._filterConfig=this._getConfig(this._annotationData);};c.prototype._getAnnotationFromValueList=function(e,i,v,p,f,a,I,d,b){var P=e;if(v!==undefined){var g={Filters:[]},h=F.readProperty(v,"PresentationVariantQualifier.String"),j=F.readProperty(v,"CollectionPath"),k=F.readProperty(v,"Parameters"),l=F.readProperty(j,"String"),P=this.getEntityType(l),m=this._filter.getModel(),n=m.getMetaModel(),o=n.getODataEntityType(P);if(h){var q=h,r=this._oMetadataAnalyser.getPresentationVariantAnnotation(P,q),s={},t=F.readProperty(r,"chartAnnotation.annotation.Dimensions.0.PropertyPath");if(t){this._createDimensionMap(j.String,P);this._updateGroupList(e,P,p,t);if(!d){var E=this._oMetadataAnalyser.getTextArrangementValue(e);if(a){d=E?E:sap.ui.comp.smartfilterbar.DisplayBehaviour.descriptionOnly;}else{d=E?E:sap.ui.comp.smartfilterbar.DisplayBehaviour.descriptionAndId;}}s=this._createConsumeableObjectFromAnnotation(r,j,i,k,p,f,a,I,d,o);if(s){g.Filters.push(s);this._annotationData.Filters.push(s);}}}}};c.prototype._createSortObject=function(C,m,d,D){var s=m,S=true;if(C==="Line"){s=d;if(!D){S=false;}}var o={};o.Field={"String":s};o.Descending={"Boolean":S};return o;};c.prototype._createSortOrderFromAnnotation=function(p,m,d,C,a,D){a.SortOrder=[];var s=p.annotation.SortOrder,S,b;if(s!==undefined&&s.length){for(var i=0;i<s.length;i++){var e=F.readProperty(s,i+".Property.PropertyPath"),I=F.readProperty(s,i+".Descending.Bool");if(e&&I){if(C==="Line"){if(!D){if(e===d){b=d;S=!(I==="false");break;}}}else if(e===m){b=m;S=!(I==="false");break;}}}if(b){var o={};o.Field={"String":b};o.Descending={"Boolean":S};a.SortOrder.push(o);}}if(!a.SortOrder.length){a.SortOrder.push(this._createSortObject(C,m,d,D));}return a;};c.prototype._getChartQualifier=function(p){var v=p.annotation.Visualizations,a;a=v?(v[0].AnnotationPath).substring(1):undefined;return a;};c.prototype._IsDimensionDateTime=function(e,d){var D=this.getDimensionMap(),o=F.readProperty(D,e+"."+d+".fieldInfo"),b=false,f;if(o.type==="Edm.DateTime"||o.type==="Edm.Time"){b=true;}else{f=o[V.CalendarYear]||o[V.CalendarYearMonth]||o[V.CalendarYearMonthDay];if(f&&f.Bool&&f.Bool==="true"){b=true;}}return b;};c.prototype._createConsumeableObjectFromAnnotation=function(p,a,i,b,d,f,e,I,g,h){var j={},E=this._oMetadataAnalyser.getEntitySetNameFromEntityTypeName(this.getEntityType(a.String)),k=p.chartAnnotation.annotation.ChartType.EnumMember.split("/"),l=k[k.length-1],D;if(l){j.Type={"String":l};}var m=F.readProperty(p,"chartAnnotation.annotation.Dimensions.0.PropertyPath");var n=F.readProperty(p,"chartAnnotation.annotation.Measures.0.PropertyPath");var o=this._isValidDimensionandMeasure(E,m,n);if(!o){jQuery.sap.log.error("The dimension "+m+" or the measure "+n+" or both are either NOT given in the chart, or IS given but undefined in metadata, or have NO 'sap:aggregation-role' defined in metadata. Corresponding chart cannot be displayed as VisualFilter.");return o;}D=this._IsDimensionDateTime(E,m);j.dimensionFieldIsDateTime=D;j=this._createSortOrderFromAnnotation(p,n,m,l,j,D);var s="";if(p.chartAnnotation.measureAttributes[n]){s=p.chartAnnotation.measureAttributes[n].dataPoint;}var q=this._getScaleFactor(h,s);var r=this._getNumberOfFractionalDigits(h,s);var t=this._getChartQualifier(p);j.scaleFactor={"String":q};j.numberOfFractionalDigits={"String":r};j.chartQualifier=t;if(f){j.filterRestriction={"String":f};}else{j.filterRestriction={"String":undefined};}j.isDropDown=e;j.Dimensions=[];var u={};u.Field={"String":m};j.Dimensions.push(u);j.Measures=[];var v={};v.Field={"String":n};j.Measures.push(v);if(i){j.Selected={"Boolean":"true"};}else{j.Selected={"Boolean":"false"};}if(a){j.CollectionPath=a;}if(b&&b.length){j.InParameters=[];for(var w in b){var x=b[w]?b[w]:undefined,y=(x&&x.RecordType)?x.RecordType:undefined,z=(x.ValueListProperty&&x.ValueListProperty.String)?x.ValueListProperty.String:undefined,A=(x.LocalDataProperty&&x.LocalDataProperty.PropertyPath)?x.LocalDataProperty.PropertyPath:undefined;if(x&&y&&z&&A){if(j.OutParameter===undefined&&(y===V.ValueListParameterOut||y===V.ValueListParameterInOut)&&z===m&&A===d){j.OutParameter=A;}if(A!==d&&(y===V.ValueListParameterIn||y===V.ValueListParameterInOut)){var B=this._filter.getModel().getMetaModel(),C=this.getEntityType(a.String),G=B.getODataEntityType(C),H=B.getODataProperty(G,z);if(H['sap:filterable']===undefined||H['sap:filterable']=="true"){j.InParameters.push({localDataProperty:A,valueListProperty:z});}else{jQuery.sap.log.error('IN Parameter valueListProperty: '+z+' is not sap:filterable');}}}}}if(d){j.ParentProperty=d;}j.isMandatoryProperty=I;j.displayBehaviour=g;return j;};c.prototype._getConfig=function(a){var b={filterList:[]};if(!a){return b;}var f={};var d={};var e=a.Filters;for(var i=0;i<e.length;i++){var g=e[i];var p=g.ParentProperty;var h=g.Dimensions[0].Field.String;var l=g.CollectionPath.String;var m=this._dimensionMap[l][h];if(!m){jQuery.sap.log.error("Unknown Dimension :"+h);continue;}var n=g.Measures[0].Field.String;var o=this._measureMap[l][n];if(!o){jQuery.sap.log.error("Unknown Measure :"+n);continue;}var q=m.fieldInfo.description;if(!q){q=h;}if(!f[h]){f[h]=[];}if(!d[p]){d[p]=[];}var r={type:g.Type.String,selected:g.Selected.Boolean=="true",dimension:{field:h,fieldDisplay:q},measure:{field:g.Measures[0].Field.String},sortOrder:g.SortOrder,scaleFactor:g.scaleFactor.String,numberOfFractionalDigits:g.numberOfFractionalDigits.String,chartQualifier:g.chartQualifier,dimensionFieldIsDateTime:g.dimensionFieldIsDateTime};r.collectionPath=g.CollectionPath.String;r.outParameter=g.OutParameter;r.inParameters=g.InParameters;r.parentProperty=g.ParentProperty;r.filterRestriction=g.filterRestriction.String;r.isMandatory=g.isMandatoryProperty;r.isDropDown=g.isDropDown;r.displayBehaviour=g.displayBehaviour;d[p].push(r);f[h].push(r);}var u={};for(var i=0;i<this._groupList.length;i++){var s=this._groupList[i];for(var j=0;j<s.fieldList.length;j++){var t=s.fieldList[j];var e=d[t.name];if(!e){continue;}u[s.name]=true;for(var k=0;k<e.length;k++){b.filterList.push(e[k]);}}}for(var i=this._groupList.length-1;i>=0;i--){var s=this._groupList[i];if(u[s.name]){continue;}this._groupList.splice(i,1);delete this._groupMap[s.name];}b=this._sortVisualFilter(this._allSelectionFields,b);return b;};c.prototype._isValidDimensionandMeasure=function(e,d,m){if(!(d&&m)){return false;}var D=this.getDimensionMap(),o=F.readProperty(D,e+"."+d+".fieldInfo");var a=this.getMeasureMap(),b=F.readProperty(a,e+"."+m+".fieldInfo");if(!(o&&b)){return false;}if(!(o['aggregationRole']==="dimension"&&b['aggregationRole']==="measure")){return false;}return true;};return c;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.DetailController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.DetailController');jQuery.sap.require('sap.ui.base.EventProvider');jQuery.sap.require('sap.ui.comp.personalization.Util');jQuery.sap.require('sap.ui.table.AnalyticalTable');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.ui.model.FilterType');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/DetailController",["sap/ui/base/EventProvider","sap/ui/comp/personalization/Util","sap/ui/table/AnalyticalTable","sap/ui/core/mvc/Controller","sap/ui/model/FilterType","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil"],function(E,P,A,C,F,a){"use strict";var b=new E();var t=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.DetailController",{setState:function(s){var m=this;this.oState=s;this._enableExpandByFilter=true;this._enableUpdateExpandLevelInfo=false;var c=this.oState.oSmartTable;var d=c.getTable();d.attachEvent("_rowsUpdated",function(e){if(m.oState.oSmartChart){m._updateRows("_rowsUpdated");}});var o=this.oState.oController.getOwnerComponent();var T=this.oState.oController.getOwnerComponent().getModel("_templPriv");T.setProperty('/alp/autoHide',o.getAutoHide()?"filter":"highlight");c.attachInitialise(this._onSmartTableInit,this);c.attachBeforeRebindTable(this._onBeforeRebindTable,this);},_onSmartTableInit:function(){var s=this.oState.oSmartTable,c=s.getCustomToolbar(),T=c.getContent(),n;this.oState.oTemplateUtils.oCommonUtils.checkToolbarIntentsSupported(s);if(this.oState._pendingTableToolbarInit){c.insertContent(this.oState.alr_viewSwitchButtonOnTable,T.length);}if(this.oState._pendingTableToolbarInit){for(var i=0;i<T.length;i++){if(T[i].mProperties.text==="Settings"){n=i;}}c.insertContent(this.oState._autoHideToggleBtn,n);}delete this.oState._pendingTableToolbarInit;this.oState.oSmartTable.attachShowOverlay(function(e){this.oState.oSmartTable.getCustomToolbar().setEnabled(!e.getParameter("overlay").show);},this);},_onBindingDataReceived:function(){var c=this.oState.oSmartTable.getTable();if(c instanceof A){this._expandByFilter("bindingDataReceived");}if(!this.isFilter()&&this.oState.oSmartChart){this._applyParamsToTableAsHighlight("bindingDataReceived");}},_onBeforeRebindTable:function(o){var v=this.oState.oSmartTable.fetchVariant(),l=v,c={};if(!v){return;}var T=this.oState.oController.getOwnerComponent().getModel("_templPriv");var _=T.getProperty('/alp/_ignoreChartSelections');if(this.isFilter()&&this.oState.oSmartChart&&!_){this._applyChartSelectionOnTableAsFilter(o);}var g=[];var d=this.oState.oSmartTable.getTable().getColumns();for(var i=0;i<d.length;i++){var f=d[i];if(f.getGrouped&&f.getGrouped()){g.push(f.getLeadingProperty?f.getLeadingProperty():P.getColumnKey(f));}}this._updateExpandLevelInfo(g);var s=[];if(v.sort&&v.sort.sortItems){for(var i=0;i<v.sort.sortItems.length;i++){var h=v.sort.sortItems[i].operation==="Descending"?true:false;s.push(new sap.ui.model.Sorter(v.sort.sortItems[i].columnKey,h));}}else if(!l.sort){c.allTableSortRemoved=true;}T.setProperty('/alp/_ignoreChartSelections',false);if(this.oState.oSmartFilterbar&&this.oState.oSmartFilterbar.getAnalyticBindingPath&&this.oState.oSmartFilterbar.getConsiderAnalyticalParameters()){try{var j=this.oState.oSmartFilterbar.getAnalyticBindingPath();if(j){this.oState.oSmartTable.setTableBindingPath(j);}}catch(e){jQuery.sap.log.warning("Mandatory parameters have no values","","AnalyticalListPage");}}if(this.oState.oController.getOwnerComponent().getModel().getDefaultCountMode()==="None"&&this.oState.oSmartTable._isAnalyticalTable){o.mParameters.bindingParams.parameters.provideTotalResultSize=false;this.oState.oSmartTable.setShowRowCount(false);}this.oState.oController.onBeforeRebindTableExtension(o);},attachTableChange:function(d,f,l){return b.attachEvent("TableChange",d,f,l);},detachTableChange:function(f,l){return b.detachEvent("TableChange",f,l);},isFilter:function(){var T=this.oState.oController.getOwnerComponent().getModel("_templPriv");return T.getProperty("/alp/autoHide")==="filter";},applyParamsToTable:function(){var d=this.oState.oSmartChart&&this.oState.oSmartChart.getChart()&&this.oState.oSmartChart.getDrillStackFilters(),i=d&&d.length,c=this.oState.oSmartChart.getChart(),o;if(c&&c._getVizFrame().vizSelection()){o=this.oState.oTemplateUtils.oCommonUtils.getSelectionPoints(c);this.oState.oController.getOwnerComponent().getModel("_templPriv").setProperty('/alp/_ignoreChartSelections',false);if(this.isFilter()||(o&&o.count)||i){this.oState.oSmartTable.rebindTable();}else{this._applyParamsToTableAsHighlight("bindingDataReceived");}}},_getBindingProperty:function(c,n){if(c.getProperty){return c.getProperty(n);}else{var p=c.oEntityType.property;for(var i=0;i<p.length;i++){if(p[i].name==n){return p[i];}}return null;}},_getPageFilters:function(B){var p=this.oState.oSmartFilterbar.getFilters();for(var i=0;i<p.length;i++){if(p[i].aFilters!==undefined){var f=p[i].aFilters;for(var j=0;j<f.length;j++){var c=f[j];var n=c.sPath;if(!B.getProperty(n)){jQuery.sap.log.warning("Could not apply filter with name \""+n+"\" as that field does not exist in the entity type");continue;}c.sPath=n;}}else{var c=p[i];var n=c.sPath;if(!B.getProperty(n)){jQuery.sap.log.warning("Could not apply filter with name \""+n+"\" as that field does not exist in the entity type");continue;}c.sPath=n;}}return p;},_applyParamsToTableAsHighlight:function(u){if(!this.oState){return;}var c=this.oState.oSmartChart.getChart();if(!c){return;}var p=this._getSelParamsFromChart(c);var d=c.getVisibleDimensions();var l=this.oState.oSmartChart._lastSelected;var e=this.oState.oSmartTable.getTable();var f=this._getTableBinding(e);if(!f){jQuery.sap.log.error("No table binding to apply the selection(s) to");return;}var g=[];for(var i=0;i<p.length;i++){var h=p[i];var j={};for(var n in h){if(d.indexOf(n)==-1||!this._getBindingProperty(f,n)){continue;}j[n]=h[n];}g.push(j);}var k=this.oState.oSmartChart.getDrillStackFilters();k.forEach(function(o){var n=o.sPath,m={};m[n]=o.oValue1;g.push(m);});var j={};g.forEach(function(o){for(var m in o){if(!j.hasOwnProperty(m)){j[m]=[o[m]];}else{j[m].push(o[m]);}}});this._paramListFiltered=g;this._lastSelected=l;this._paramMap=j;this._updateRows(u);},_expandByFilter:function(u){if(!this._enableExpandByFilter){return;}var c=this.oState.oSmartTable.getTable();var d=this._getTableBinding(c);if(d&&this._lastBinding!=d){var m=this;d.attachDataReceived(this._onBindingDataReceived,this);d.attachEvent("change",function(h){if(m._expandingProgrammatically){return;}var j=h.getParameter("reason");if(j=="expand"||j=="collapse"){m._inUserChartSelectMode=false;}});this._lastBinding=d;}if(u=="selection"||u=="bindingDataReceived"){this._firstVisibleRelevantEventTS=new Date().getTime();}if(u=="selection"){this._inUserChartSelectMode=true;}if(!this._inUserChartSelectMode){return;}var r=this._getTableRows();for(var i=0;i<r.length;i++){var e=r[i];var f=e.getBindingContext();if(!f){continue;}var g=c.getFirstVisibleRow()+i;if(this._isRowHighlighted(f.getObject())){if(c.isExpanded(g)){continue;}if(!e._bHasChildren){continue;}if(!d.findNode(g)){continue;}this._expandingProgrammatically=true;c.expand(g);this._expandingProgrammatically=false;}else{if(!c.isExpanded(g)){continue;}if(!e._bHasChildren){continue;}if(!d.findNode(g)){continue;}this._expandingProgrammatically=true;c.collapse(g);this._expandingProgrammatically=false;}}this._updateFirstVisibleRow(u);},_updateFirstVisibleRow:function(u){var c=this.oState.oSmartTable.getTable();var d=this._getTableBinding(c);var e=d.getTotalSize();if(e==0||(new Date().getTime()-this._firstVisibleRelevantEventTS)>250){return;}var c=this.oState.oSmartTable.getTable();if(u=="selection"&&(!this._paramListFiltered||this._paramListFiltered.length==0)){c.setFirstVisibleRow(0);return;}var f=d.getContexts(0,e);for(var i=0;i<f.length;i++){var r=f[i].getObject();if(!this._isRowHighlighted(r)){continue;}if(this._lastSelected&&!this._rowMatch(this._lastSelected,r)){continue;}var l=c.getFirstVisibleRow();if(u=="selection"||this.isFilter()){c.setFirstVisibleRow(i);}else{if(i>l){c.setFirstVisibleRow(i);}}break;}},_rowMatch:function(s,r){for(var n in s){if(n.indexOf("__")!=-1){continue;}if(!r.hasOwnProperty(n)){continue;}if(s[n]!=r[n]){return false;}}return true;},_updateExpandLevelInfo:function(g){if(!this._enableUpdateExpandLevelInfo){return false;}var T=this.oState.oSmartTable.getTable();if(!T.getNumberOfExpandedLevels){return false;}var B=T.getBinding();if(!B){return false;}var e=g.length;var l=false;if(e>=B.aMaxAggregationLevel.length){l=true;e=B.aMaxAggregationLevel.length-1;this.wasAtMaxLevel=true;}else{l=T.getNumberOfExpandedLevels()!=e||this.wasAtMaxLevel;this.wasAtMaxLevel=false;}if(l){if(e>=0){T.setNumberOfExpandedLevels(e);T.bindRows(T.getBindingInfo("rows"));}var c=T.getGroupedColumns();T.fireGroup({column:c[0],groupedColumns:c,type:sap.ui.table.GroupEventType.group});}return l;},_updateRows:function(u){var c=this.oState.oSmartChart.getChart();var p=this._getSelParamsFromChart(c);this._latestUpdateRow(p.length);var d=this.oState.oSmartTable.getTable();if(d instanceof A){this._expandByFilter(u);}},_getTableRows:function(){var c=this.oState.oSmartTable.getTable();if(c.getRows){return c.getRows();}else{return c.getItems();}},_isRowHighlighted:function(r){var p=this._paramMap;if(!p||jQuery.isEmptyObject(p)){return false;}var m=true;for(var n in p){if(!r.hasOwnProperty(n)){continue;}if(p[n].indexOf(r[n])==-1){m=false;}}return m;},_getTableBinding:function(c){return c.getBinding()?c.getBinding():c.getBinding("items");},_applyChartSelectionOnTableAsFilter:function(e){var f=this.oState.oSmartChart.getDrillStackFilters();e.mParameters.bindingParams.filters.push.apply(e.mParameters.bindingParams.filters,f);var c=this.oState.oSmartChart.getChart();if(!c){return;}var p=this._getSelParamsFromChart(c);if(p.length>0){var d=c.getVisibleDimensions();for(var i=0;i<p.length;i++){var g=p[i];for(var n in g){if(d.indexOf(n)==-1){jQuery.sap.log.warning("Could not apply filter with name \""+n+"\" as that field does not exist in the entity type");continue;}var h=false;var o=e.mParameters.bindingParams.filters;if(o.length>0){var o=o[0].aFilters?o[0].aFilters:o;for(var j=0;j<o.length;j++){var D=o[j].aFilters?o[j].aFilters:o;if(D.length==1){if(D[0].sPath===n&&D[0].oValue1===g[n]){h=true;}}}}if(!h){e.mParameters.bindingParams.filters.push(new sap.ui.model.Filter({path:n,operator:sap.ui.model.FilterOperator.EQ,value1:g[n]}));}}}}this._latestUpdateRow(p.length);},_latestUpdateRow:function(p){var c=this.isFilter();var r=this._getTableRows();var d=false;for(var i=0;i<r.length;i++){var e=r[i];if(!c){if(e.getBindingContext()){var f=e.getBindingContext().getObject();d=this._isRowHighlighted(f);}}var g=e.getDomRefs?e.getDomRefs(true):e.getDomRef();if(!g){continue;}if(g.row){g.row.toggleClass("sapSmartTemplatesAnalyticalListPageRowHighlighted",(c&&p)?c:d);}else{$(g).toggleClass("sapSmartTemplatesAnalyticalListPageRowHighlighted",(c&&p)?c:d);}}},_getSelParamsFromChart:function(c){var d=[];if(c._getVizFrame().vizSelection()){d=this.oState.oTemplateUtils.oCommonUtils.getSelectionPoints(c).dataPoints;}return this._getSelParamsFromDPList(d);},_getSelParamsFromDPList:function(d){if(!d){return[];}var p=[];for(var i=0;i<d.length;i++){var c=d[i];var e=c.context;if(!e){if(c.dimensions){p.push(c.dimensions);}continue;}var f=e.getProperty(e.sPath);var g={};if(this._selectFilterByMeasure){for(var j=0;j<c.measures.length;j++){var n=c.measures[j];var v=f[n];g[n]=v;}}else{for(var n in f){g[n]=f[n];}}p.push(g);}return p;}});return t;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.StandardListItem');jQuery.sap.require('sap.m.List');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.SearchField');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/DropDownController",['jquery.sap.global','sap/ui/core/mvc/Controller','sap/ui/model/Filter','sap/ui/model/json/JSONModel',"sap/m/Button","sap/m/StandardListItem","sap/m/List","sap/m/ToolbarSpacer","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/ui/model/FilterOperator","sap/m/SearchField"],function(q,C,F,J,B,S,L,T,a,b,c){"use strict";var s=false,t={},I={},u="",D=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController",{});sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.createDropdown=function(o,d,m,e,p){u=(p.filterRestriction=='multiple')?q.extend(true,{items:[],ranges:[],value:null},d.getDimensionFilter()):d.getDimensionFilter();var i=o.getModel('i18n'),f={"descriptionAndId":p.dimensionFieldDisplay,"descriptionOnly":p.dimensionFieldDisplay,"idAndDescription":p.dimensionField,"idOnly":p.dimensionField},f=(Object.keys(f).indexOf(p.textArrangement)!==-1)?f[p.textArrangement]:p.dimensionFieldDisplay,g=new sap.m.ToggleButton({icon:"sap-icon://menu",type:"Transparent",iconFirst:true,enabled:(u&&u.hasOwnProperty("items"))?Boolean(u.items.length):Boolean(u),tooltip:i.getResourceBundle().getText("VIS_VALUEHELP_DROPDOWN_VIEW_SELECTED")}),l=sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.createStandardListItem(m,d,i,e,p,g,f),h=sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.createPopoverWithList(m,d,i,p,e,l,f,g),O=new sap.m.Button({text:i.getResourceBundle().getText("OK"),press:function(E){d.setDimensionFilter(u);d.fireFilterChange();h.close();}}),k=new sap.m.Button({text:i.getResourceBundle().getText("CANCEL"),press:function(){h.close();}});s=false;h.addContent(l);l.attachSelectionChange(function(E){var n=l.getModel().getData(E.mParameters.listItem.getBindingContext().sPath);n=n[p.dimensionField];var r=E.getParameters().listItem.mProperties.selected;if(p.filterRestriction==='multiple'){if(u.items&&u.items.length){for(var j=0;j<u.items.length;j++){if(u.items[j].key===n){u.items.splice(j,1);}else if(r){u.items.push({key:n});break;}}}else if(u.items){u.items.push({key:n});}else{u.items=[];}if(u.items.length){t.setVisible(true);I.setText(i.getResourceBundle().getText("VIS_VALUEHELP_DROPDOWN_SELECTED_COUNT",[e,u.items.length]));}t.setVisible(Boolean(u.items.length));g.setEnabled(this.bUpdateToolbarButton||Boolean(u.items.length));}else if(p.filterRestriction==='single'){u=n;if(u){t.setVisible(true);I.setText(i.getResourceBundle().getText("VIS_VALUEHELP_DROPDOWN_SELECTED_COUNT",[e,+Boolean(u)]));}g.setEnabled(Boolean(u));}}.bind(this));h.addStyleClass("sapSmartTemplatesAnalyticalListPageSelectedLinkDialog");h.setBeginButton(O);h.setEndButton(k);h.openBy(o);};sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.createPopoverWithList=function(m,o,i,p,d,l,f,e){var g=sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.isEntitytypeSearchable(m,p);if(this._oPopoverDialog){this._oPopoverDialog;}if(l){var A=function(E){if(E.getParameter("clearButtonPressed")){return;}var h=this.fnApplyFilterFromSearchField(f,E.getSource().getValue());var j=l.getBinding("items");s=false;e.setPressed(false);e.setTooltip(i.getResourceBundle().getText("VIS_VALUEHELP_DROPDOWN_VIEW_SELECTED"));j.filter(h);}.bind(this);this.oSearchField=new c({liveChange:A,search:A,enabled:g,initialFocus:true});this._oPopoverDialog=new sap.m.ResponsivePopover('',{placement:sap.m.PlacementType.Bottom,verticalScrolling:true,title:d,subHeader:[new sap.m.Toolbar({content:[this.oSearchField,e]})],content:[l]});this._oPopoverDialog.setModel(o.getModel("_filter"),"_filter");}return this._oPopoverDialog;};sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.createStandardListItem=function(m,o,i,d,p,e,f){var g="/"+p.entitySet,h=sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.standardListItemTemplateCreation(o,p);I=new sap.m.Label({text:i.getResourceBundle().getText("VIS_VALUEHELP_DROPDOWN_SELECTED_COUNT",[d,typeof(o.getDimensionFilter())==="object"&&o.getDimensionFilter()!==null?o.getDimensionFilter().items.length:+Boolean(o.getDimensionFilter())])});t=new sap.m.Toolbar({content:[I,new sap.m.ToolbarSpacer(),new sap.ui.core.Icon({src:"sap-icon://sys-cancel",tooltip:i.getResourceBundle().getText("VIS_VALUEHELP_DROPDOWN_CLEAR_SELECTION"),press:function(E){t.setVisible(false);s=false;e.setTooltip(i.getResourceBundle().getText("VIS_VALUEHELP_DROPDOWN_VIEW_SELECTED"));e.setEnabled(false);e.setPressed(false);l.removeSelections(true);(u&&u.hasOwnProperty("items"))?u.items=[]:u="";I.setText(i.getResourceBundle().getText("VIS_VALUEHELP_DROPDOWN_SELECTED_COUNT",[d,(u&&u.hasOwnProperty("items"))?u.items.length:+Boolean(u)]));l.getBinding("items").filter(this.fnApplyFilterFromSearchField(f,this.oSearchField.getValue()));}.bind(this)}).addStyleClass("sapSmartTemplatesAnalyticalListPageDropdownDialogCancelButton")],"visible":(u&&u.hasOwnProperty("items"))?Boolean(u.items.length):Boolean(u)});if(o.getSmartFilterId()){var j=sap.ui.getCore().byId(o.getSmartFilterId());if(j&&j.getEntitySet()===p.entitySet){g=o.considerAnalyticBinding(g,j);}}var k=[p.measureField,p.dimensionField,p.dimensionFieldDisplay],l=new sap.m.List({mode:p.filterRestriction==="single"?sap.m.ListMode.SingleSelectMaster:sap.m.ListMode.MultiSelect,growing:true,growingThreshold:15,showNoData:false,infoToolbar:t,items:{path:g,template:h,sorter:sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.getSortObject(p),parameters:{select:k.join(",")}}});h.setModel(o.getModel("_filter"),"_filter");l.setModel(m);e.attachPress(function(E){if(p.filterRestriction=="multiple"&&u.items.length||u&&u.hasOwnProperty('items')&&!u.items.length&&s){sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.updateFilterWithListBindings(l,e,i,p.filterRestriction,p.dimensionField);}else if(p.filterRestriction=="single"&&u!=null||u==null&&s){sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.updateFilterWithListBindings(l,e,i,p.filterRestriction,p.dimensionField);}});return l;};sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.selectedVisibilityUpdateFormatter=function(u,d){for(var i=0;i<u.items.length;i++){if(u.items[i].key===d){return true;}}return false;};sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.isEntitytypeSearchable=function(m,p){var o=m.getMetaModel().getODataEntitySet(p.entitySet);if(o.extensions.length){for(var i=0;i<o.extensions.length;i++){if(o.extensions[i].name=="searchable"){return o.extensions[i].value=="true";}}}return true;};sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.standardListItemTemplateCreation=function(o,p){var d=p.textArrangement,e=[];e.push({path:p.measureField});p.unitField?e.push({path:p.unitField}):"";var f=new sap.m.StandardListItem({title:{parts:[p.dimensionFieldDisplay,p.dimensionField],formatter:function(g,h){return a.getTextArrangement(g,h,d);}},description:{parts:e,formatter:function(g,h){return sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroChart.prototype._getFormattedNumberWithUoM(g,h);}},selected:{parts:["_filter>/"+o.getParentProperty(),p.dimensionField],formatter:function(g,h){if(s){return true;}else{if(typeof(u)==="object"&&u!==null){for(var i=0;i<u.items.length;i++){if(u.items[i].key===h){return true;}}}else{return(u!==null&&u===h)?true:false;}}}}});return f;};sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.getSortObject=function(p){if(p.sortOrder&&p.sortOrder.length){return new sap.ui.model.Sorter((p.sortOrder[0].Field)?p.sortOrder[0].Field.String:"",p.sortOrder[0].Descending.Boolean);}};sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.updateFilterWithListBindings=function(l,o,d,f,e){var g=[];s=!s;this.bUpdateToolbarButton=s;if(s){o.setTooltip(d.getResourceBundle().getText("VIS_VALUEHELP_DROPDOWN_VIEW_ALL"));o.setEnabled(true);if(f==='multiple'){for(var i=0;i<u.items.length;i++){var h=new F(e,sap.ui.model.FilterOperator.EQ,(f==="multiple")?u.items[i].key:u);g.push(h);}}else if(f==='single'){var h=new F(e,sap.ui.model.FilterOperator.EQ,u);g.push(h);}l.getBinding("items").filter(g);}else{o.setTooltip(d.getResourceBundle().getText("VIS_VALUEHELP_DROPDOWN_VIEW_SELECTED"));o.setEnabled((u&&u.hasOwnProperty("items"))?Boolean(u.items.length):Boolean(u));l.getBinding("items").filter(g);}};sap.suite.ui.generic.template.AnalyticalListPage.controller.DropDownController.fnApplyFilterFromSearchField=function(f,Q){var d=[];if(Q&&Q.length>0){var e=new F(f,b.Contains,Q);d.push(e);}return d;};return D;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.IappStateHandler')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.IappStateHandler');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.generic.app.navigation.service.SelectionVariant');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/IappStateHandler",["jquery.sap.global","sap/ui/base/Object","sap/ui/generic/app/navigation/service/SelectionVariant","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/ui/Device"],function(q,B,S,F,D){"use strict";function g(s,c,n){var a="sap.suite.ui.generic.template.customData";var b="sap.suite.ui.generic.template.genericData";var d="visual";var e="compact";var p;var I=false;var o=null;var A=null;var r={appStateKey:"",urlParams:{}};function f(){return p.then(function(){if(r.appStateKey){return{"sap-iapp-state":[r.appStateKey]};}return r.urlParams;});}function R(i){if(i&&i.editStateFilter!==undefined){var H=c.byId("editStateFilter");if(H){H.setSelectedKey((i.editStateFilter===null)?0:i.editStateFilter);}}var T=s.oController.getOwnerComponent().getModel("_templPriv");if(i.chartVariantId&&s.oSmartChart){s.oSmartChart.setCurrentVariantId(i.chartVariantId);}if(i.filterMode){T.setProperty('/alp/filterMode',i.filterMode);s.filterBarController.handleFilterSwitch(i.filterMode);}else{j();}if(i.contentView){((D.system.phone||D.system.tablet&&!D.system.desktop)&&i.contentView==="charttable")?T.setProperty('/alp/contentView',"chart"):T.setProperty('/alp/contentView',i.contentView);}if(i.autoHide){T.setProperty('/alp/autoHide',i.autoHide);}}function h(i){i=i||{};if(i.hasOwnProperty(a)&&i.hasOwnProperty(b)){R(i[b]);t(i[a]);}else{if(i._editStateFilter!==undefined){R({editStateFilter:i._editStateFilter});delete i._editStateFilter;}j();t(i);}}function j(){var T=s.oController.getOwnerComponent().getModel("_templPriv"),i=s.oSmartFilterbar.isCurrentVariantStandard()?s.oController.getOwnerComponent().getDefaultFilterMode():T.getProperty('/alp/filterMode');if(!(i===d||i===e)){q.sap.log.error("Defaulting to Visual filter due to incorrect value of defaultFilterMode in App descriptor");i=d;}if(i===d&&s.hideVisualFilter){q.sap.log.error("Visual filter is hidden defaulting to compact");i=e;}s.filterBarController.setDefaultFilter(i);}function k(i,H,N){s.oSmartFilterbar.setSuppressSelection(false);var J=i.appStateKey||"";if(I){return;}A=J;I=true;var K=(!J&&H)||{};if(N!==sap.ui.generic.app.navigation.service.NavType.initial){var L=i&&i.bNavSelVarHasDefaultsOnly;var M=new S(i.selectionVariant);u(M,i);x(M);if(!L||s.oSmartFilterbar.isCurrentVariantStandard()){w(M);}if(i.tableVariantId&&s.oSmartTable){s.oSmartTable.setCurrentVariantId(i.tableVariantId);}var T=s.oController.getOwnerComponent().getModel("_templPriv");if(N===sap.ui.generic.app.navigation.service.NavType.xAppState&&T.getProperty('/alp/filterMode')===d){v();}if(i.customData){h(i.customData);}else{j();}if(!L){s.oSmartFilterbar.checkSearchAllowed(s);var T=s.oController.getView().getModel("_templPriv"),O=T.getProperty("/alp/searchable");if(O){s.oSmartFilterbar.search();}}r={appStateKey:J,urlParams:K};}else{j();}U();o=null;I=false;}function l(){var i={};i[a]={};var T=s.oController.getOwnerComponent().getModel("_templPriv");i[b]={chartVariantId:s.oSmartChart&&s.oSmartChart.getCurrentVariantId(),filterMode:T.getProperty('/alp/filterMode'),contentView:T.getProperty('/alp/contentView'),autoHide:T.getProperty('/alp/autoHide')};var H=c.byId("editStateFilter");if(H){i[b].editStateFilter=H.getSelectedKey();}c.getCustomAppStateDataExtension(i[a]);return i;}function m(){var H=new S(s.oSmartFilterbar.getDataSuiteFormat());var V=c.getVisibleSelectionsWithDefaults();for(var i=0;i<V.length;i++){if(!H.getValue(V[i])){H.addSelectOption(V[i],"I","EQ","");}}if(s.oController.byId('template::PageVariant').currentVariantGetModified()&&H.getID()){H.setID("");}return{selectionVariant:H.toJSONString(),tableVariantId:s.oSmartTable&&s.oSmartTable.getCurrentVariantId(),customData:l()};}function t(i){c.restoreCustomAppStateDataExtension(i||{});}function u(i,H){var J=s.oSmartFilterbar.determineMandatoryFilterItems();var K;for(var L=0;L<J.length;L++){if((J[L].getName().indexOf("$Parameter.P_DisplayCurrency")!==-1)&&!(i.getParameter("$Parameter.P_DisplayCurrency"))&&!(i.getParameter("P_DisplayCurrency"))){var M=H.oSelectionVariant.getSelectOption("DisplayCurrency");if(M&&M[0]&&M[0].Low){K=M[0].Low;}else if(H.oDefaultedSelectionVariant.getSelectOption("DisplayCurrency")&&H.oDefaultedSelectionVariant.getSelectOption("DisplayCurrency")[0].Low){K=H.oDefaultedSelectionVariant.getSelectOption("DisplayCurrency")[0].Low;}if(K){i.addParameter("$Parameter.P_DisplayCurrency",K);}if(s.alr_visualFilterBar&&K){s.alr_visualFilterBar.setDisplayCurrency(K);}break;}}}function v(){var i=q.extend(true,{},s.oSmartFilterbar.getFilterData(true)),H=s.oController.getOwnerComponent().getModel("_filter");H.setData(i);s.filterBarController._updateFilterLink();}function w(i){s.oSmartFilterbar.clearVariantSelection();s.oSmartFilterbar.clear();s.oSmartFilterbar.setDataSuiteFormat(i.toJSONString(),true);}function x(H){var J=H.getParameterNames().concat(H.getSelectOptionsPropertyNames());for(var i=0;i<J.length;i++){s.oSmartFilterbar.addFieldToAdvancedArea(J[i]);}if(s.alr_visualFilterBar){s.alr_visualFilterBar.addVisualFiltersToBasicArea(J);}}function y(){var i=m();try{o=n.storeInnerAppStateWithImmediateReturn(i);}catch(H){q.sap.log.error("AnalyticalListPage.fnStoreCurrentAppStateAndAdjustURL: "+H);}if(o instanceof sap.ui.generic.app.navigation.service.NavError){o=null;return;}if(o&&A!==o.appStateKey){r.appStateKey=o.appStateKey;}}function C(){var T=s.oController.getOwnerComponent().getModel("_templPriv");if(T.getProperty('/alp/filterMode')===d){if(!T.getProperty("/alp/searchable")){s.oSmartFilterbar.showFilterDialog();}}}function z(){if(s.oSmartFilterbar.isInitialised()){s.oSmartFilterbar.checkSearchAllowed(s);}}function U(){z();C();var i=s.oController.getOwnerComponent().getModel("_filter");i.setData(q.extend(true,{},s.oSmartFilterbar.getFilterData(true)));s.filterBarController._updateFilterLink();if(s.alr_visualFilterBar&&s.alr_visualFilterBar.updateVisualFilterBindings){s.alr_visualFilterBar.updateVisualFilterBindings(true);}}function E(i){p=n.parseNavigation();}function G(){try{p.done(k);p.fail(function(H){if(H instanceof Error){H.showMessageBox();}j();U();});}catch(i){j();U();}}return{getFilterState:l,fnCheckMandatory:z,getCurrentAppState:m,fnSetDefaultFilter:j,fnRestoreFilterState:h,getUrlParameterInfo:f,onSmartFilterBarInitialise:E,onSmartFilterBarInitialized:G,fnStoreCurrentAppStateAndAdjustURL:y};}return B.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.IappStateHandler",{constructor:function(s,c,n){q.extend(this,g(s,c,n));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiCardController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiCardController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.Fragment');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.thirdparty.d3');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/KpiCardController",["jquery.sap.global","sap/ui/core/Fragment","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/thirdparty/d3","sap/suite/ui/generic/template/AnalyticalListPage/util/KpiUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms"],function(q,F,C,J,D,K,V){"use strict";q.sap.require("sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter");var n,s;var c=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiCardController",{onInit:function(e){q.sap.require("sap.ovp.cards.CommonUtils");},onExit:function(){},onBeforeRendering:function(){var o=sap.ovp.cards.CommonUtils;var d,S;var v=this.getView();var a=v.data("qualifierSettings");var Q=a.qualifier;var m=v.getModel();var M=m.getMetaModel();var e=M.getODataEntitySet(a.entitySet);var E=M.getODataEntityType(e.entityType);var b="kpiCard"+Q;var f={"cards":{}};S=V.SelectionPresentationVariant+(Q?"#"+Q:"");var p=E[S].PresentationVariant&&E[S].PresentationVariant.Path;if(!p){q.sap.log.error("PresentationVariant does not have Path.");return;}var g=E[p.split("@")[1]].Visualizations;g.forEach(function(A){if(A.AnnotationPath.indexOf("DataPoint")>0){d=A.AnnotationPath.split("@")[1];}});f["cards"][b]={"model":a.model,"template":"sap.ovp.cards.charts.analytical","settings":{"title":v.data("kpiTitle"),"entitySet":a.entitySet,"selectionPresentationAnnotationPath":S,"dataPointAnnotationPath":d,"showFilterInHeader":true,"navigation":"chartNav"}};o.createCardComponent(v,f,"template::ALPcardContainer");o.onHeaderClicked=function(h){this.handleNavigationPress(v);}.bind(this);o.onContentClicked=function(h){var i=h.getObject();this.handleNavigationPress(v,i);}.bind(this);},handleNavigationPress:function(v,o){var N=v.getModel("detailNavigation");if(N){var t=N.getProperty("/target");var a=N.getProperty("/action");if(t&&a){if(!n){n=s.getNavigationHandler();}this._oSelectionVariant=new sap.ui.generic.app.navigation.service.SelectionVariant();var b=JSON.parse(N.getProperty("/parameters"));this._createNavigationContext(b,true);this._getSelectOptionsFromAnnotation(v);if(o){this._createNavigationContext(o);}this._oSelectionVariant=this._oSelectionVariant.toJSONString();n.navigate(t,a,this._oSelectionVariant,null,function(e){if(e instanceof sap.ui.generic.app.navigation.service.NavError){if(e.getErrorCode()==="NavigationHandler.isIntentSupported.notSupported"){sap.m.MessageBox.show(s.getText("ST_NAV_ERROR_NOT_AUTHORIZED_DESC"),{title:s.getText("ST_GENERIC_ERROR_TITLE")});}else{sap.m.MessageBox.show(e.getErrorCode(),{title:s.getText("ST_GENERIC_ERROR_TITLE")});}}});}}},_assignCommonUtils:function(o){s=o;n=s.getNavigationHandler();},_createNavigationContext:function(p,I){var k=Object.keys(p);for(var i=0;i<k.length;i++){var e=k[i];if(!p[e]&&p[e]!==""){return;}if(I){this._oSelectionVariant.addParameter(e,p[e]);}else{if(this._oSelectionVariant.getSelectOption(e)){this._oSelectionVariant.removeSelectOption(e);}this._oSelectionVariant.addSelectOption(e,"I","EQ",p[e]);}}},_getSelectOptionsFromAnnotation:function(v){var t=this;var S=v.data("selectionVariant");var a=S.SelectOptions;var b=S.Parameters;if(b&&b.length){b.forEach(function(p){var P=p.PropertyName.PropertyPath;var d=p.PropertyValue.String;if(t._oSelectionVariant.getParameter(P)){t._oSelectionVariant.removeParameter(P);}t._oSelectionVariant.addParameter(P,d);});}if(a&&a.length){a.forEach(function(o){var p=o.PropertyName.PropertyPath;var r=o.Ranges;r.forEach(function(R){var l=R.Low.String;var h=(R.High&&R.High.String)?R.High.String:null;var d=R.Sign.EnumMember.split("/")[1];var O=R.Option.EnumMember.split("/")[1];t._oSelectionVariant.addSelectOption(p,d,O,l,h);});});}}});return c;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiTagController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiTagController');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.m.Popover');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/KpiTagController",["sap/suite/ui/generic/template/AnalyticalListPage/controller/KpiCardController","sap/ui/model/json/JSONModel","sap/ui/model/json/JSONModel","sap/ui/core/mvc/ViewType","sap/m/Popover","sap/ui/Device"],function(K,J,F,V,P,D){"use strict";var O;jQuery.sap.declare("sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiTagController");sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiTagController={_kpiCards:[],init:function(s){var m=this;m.oState=s;m.oGenericModel=new J();var g={header:"Some Header",title:"Some Title",titleUrl:"",icon:"sap-icon://camera"};m.oGenericModel.setData(g);if(O===undefined){O=sap.ui.getCore().loadLibrary("sap.ovp",{async:true});}},openKpiCard:function(e){var m=this;var s;if(typeof e.currentTarget!="undefined"){s=sap.ui.getCore().byId(e.currentTarget.id);}else{s=e.getSource();}O.then(function(){m.createPopover(function(){m._openCard(s);}.bind(m,s),s);});},_openCard:function(s){var m=this;jQuery.sap.delayedCall(0,this,function(){m._kpiCards[s.getQualifier()].openBy(s);});},handleKpiPress:function(e){this.openKpiCard(e);},createPopover:function(o,s){var m=this;var q=s.getQualifier();var c=m.oState.oController.getOwnerComponent();var S=c.getComponentContainer().getSettings();var k=S.keyPerformanceIndicators;var Q;for(var a in k){if(k[a].hasOwnProperty("qualifier")&&k[a].qualifier===q){Q=k[a];break;}}if(!Q){jQuery.sap.log.error("KPI settings not found with qualifier.");return;}var b=S.appComponent.getManifestEntry("/sap.app/crossNavigation/outbounds/"+Q.detailNavigation);var M=c.getModel(Q.model);M.getMetaModel().loaded().then(function(){var m=this;m._oCardController=new K();var c=m.oState.oController.getOwnerComponent();var p=new J();var Q=arguments[0];var M=c.getModel(Q.model);var d=M.getMetaModel();var e=d.getODataEntitySet(Q.entitySet);var E=d.getODataEntityType(e.entityType);var f=E["com.sap.vocabularies.UI.v1.SelectionPresentationVariant#"+q];var g=f.SelectionVariant&&f.SelectionVariant.Path;var h=E[g.split("@")[1]];Q.metaModel=d;p.setData(Q);var v=sap.ui.view({async:false,preprocessors:{xml:{bindingContexts:{entityType:d.createBindingContext(d.getODataEntityType(e.entityType,true)),entitySet:d.createBindingContext(d.getODataEntitySet(Q.entitySet,true))},models:{entitySet:d,entityType:d,parameter:p},dataModel:M,settings:p,preprocessorsData:c.getComponentData().preprocessorsData}},type:V.XML,viewName:"sap.suite.ui.generic.template.AnalyticalListPage.view.KpiCardSizeM",height:"100%"});v.data({"kpiTitle":s._nameFromPath,"qualifierSettings":Q,"selectionVariant":h});v.setModel(c.getModel(Q.model));var i=new sap.ui.model.json.JSONModel();var j={"visible":Q.detailNavigation?true:false};if(Q.detailNavigation&&b){j.target=b.semanticObject;j.action=b.action;j.parameters=JSON.stringify(b.parameters?b.parameters:{});}else{j.visible=false;}i.setData(j);v.setModel(i,"detailNavigation");if(typeof m._kpiCards[q]!="undefined"){m._kpiCards[q].destroy();}m._kpiCards[q]=new P();if(D.system.tablet&&!D.system.desktop){m._kpiCards[q].setPlacement("Bottom");}m._kpiCards[q].setShowHeader(false);m._kpiCards[q].addContent(v);m._oKpiCardController=v.getController();m._oKpiCardController._assignCommonUtils(m.oState.oTemplateUtils.oCommonUtils);m.oState.oController.getView().addDependent(m._kpiCards[q]);o();}.bind(this,Q));},onExit:function(){if(this._oKpiCard){this._oKpiCard.destroy();}},_setModel:function(m){this._oKpiCard.setModel(m);}};return sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiTagController;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.SmartChartController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.SmartChartController');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.m.FlexItemData');jQuery.sap.require('sap.m.ToolbarDesign');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/SmartChartController",["sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/FlexItemData","sap/m/ToolbarDesign","sap/ui/core/mvc/Controller","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil"],function(O,T,F,b,C,c){"use strict";var d=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.SmartChartController",{setState:function(s){this.triggeredByTableSort=false;this.tableSortSelection;this._selectFilterByMeasure=false;this.oState=s;s.oSmartChart.attachInitialise(this._onSmartChartInit,this);s.oSmartChart.attachBeforeRebindChart(this._onBeforeRebindChart,this);s.oSmartChart.attachDataReceived(this._onDataReceived,this);},_onBeforeRebindChart:function(E){if(this.triggeredByTableSort&&this.tableSortSelection){var v=this.oState.oSmartChart.fetchVariant();if(this.tableSortSelection.length>0){v.sort={};v.sort.sortItems=[];for(var i=0;i<(this.tableSortSelection.length);i++){E.mParameters.bindingParams.sorter.push(this.tableSortSelection[i]);v.sort.sortItems.push({columnKey:this.tableSortSelection[i].sPath,operation:this.tableSortSelection[i].bDescending?"Descending":"Ascending"});}}else{E.mParameters.bindingParams.sorter=this.tableSortSelection;if(v.sort){delete v.sort;}}this.oState.oSmartChart.applyVariant(v);this.triggeredByTableSort=false;}if(this.oState.oSmartFilterbar&&this.oState.oSmartFilterbar.getAnalyticBindingPath&&this.oState.oSmartFilterbar.getConsiderAnalyticalParameters()){try{var a=this.oState.oSmartFilterbar.getAnalyticBindingPath();if(a){this.oState.oSmartChart.setChartBindingPath(a);}}catch(e){jQuery.sap.log.warning("Mandatory parameters have no values","","AnalyticalListPage");}}this.oState.oController.onBeforeRebindChartExtension(E);this.checkToPreventChartBinding(E);},_onDataReceived:function(e){if(!this.oState.oSmartChart.getToolbar().getEnabled()){this.oState.oContentArea.enableToolbar();}this.oState.oTemplateUtils.oCommonUtils.setEnabledToolbarButtons(e.getSource());},_onSmartChartInit:function(e){var s=this.oState;this.oChart=s.oSmartChart.getChart();s.oSmartChart.attachShowOverlay(function(E){s.oSmartChart.getToolbar().setEnabled(!E.getParameter("overlay").show);},this);this.oState.oTemplateUtils.oCommonUtils.setEnabledToolbarButtons(e.getSource());this.oState.oTemplateUtils.oCommonUtils.checkToolbarIntentsSupported(e.getSource());this.oChart.attachSelectData(this._onChartSelectData,this);this.oChart.attachDeselectData(this._onChartDeselectData,this);this.oState.oSmartChart.attachChartDataChanged(this._onPersonalisationDimeasureChange,this);if(this.oState._pendingChartToolbarInit&&this.oState.oSmartTable){this.oState.oSmartChart.getToolbar().insertContent(this.oState.alr_viewSwitchButtonOnChart,this.oState.oSmartChart.getToolbar().getContent().length);}delete this.oState._pendingChartToolbarInit;this._changeValueAxisTitleVisibility();this.oState.oSmartChart.getChart().setVizProperties({"legendGroup":{"layout":{"position":"bottom"}},"categoryAxis":{"layout":{"maxHeight":0.5}}});this.oState.oSmartChart.attachSelectionDetailsActionPress(function(E){var o=E.getSource();var a=E.getParameter("itemContexts")&&E.getParameter("itemContexts")[0];s.oTemplateUtils.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){if(!a){jQuery.sap.log.error("Binding context for the selected chart item is missing");return;}if(o.data("CrossNavigation")){s.oTemplateUtils.oCommonEventHandlers.onEditNavigateIntent(o,a,s.oSmartFilterbar,s.oSmartChart.getChart());return;}s.oTemplateUtils.oCommonUtils.navigateFromListItem(a,s.oSmartChart);},jQuery.noop,s);});jQuery.sap.log.info("Smart Chart Annotation initialized");},_onChartSelectData:function(e){var a=this.oState.oSmartChart.getChart();if(a._getVizFrame().vizSelection()){var s=this.oState.oTemplateUtils.oCommonUtils.getSelectionPoints(a).dataPoints;this._lastSelected=this._getLastSel(s,this._lastSelectedList);this._lastSelectedList=s;}this._updateTable();this.oState.oTemplateUtils.oCommonUtils.setEnabledToolbarButtons(e.getSource());},_onPersonalisationDimeasureChange:function(e){var o=e.getParameters().changeTypes;if(o.dimeasure&&!o.filter&&!o.sort){this._onChartSelectData(e);}this._changeValueAxisTitleVisibility();},_getLastSel:function(n,o){var e=this.oState.oSmartChart.getChart();var f=this.oState.detailController&&this.oState.detailController._getSelParamsFromDPList(n);var g=this.oState.detailController&&this.oState.detailController._getSelParamsFromDPList(o);if(f){for(var i=0;i<f.length;i++){var h=f[i];var m=false;for(var j=0;j<g.length;j++){var k=g[j];m=true;for(var a in k){if(a.indexOf("__")!=-1){continue;}if(h[a]!=k[a]){m=false;break;}}if(m){break;}}if(!m){var l=e.getVisibleDimensions();var p={};for(var j=0;j<l.length;j++){var q=l[j];p[q]=h[q];}return p;}}}return null;},_onChartDeselectData:function(e){var m=this;this._lastSelected=null;setTimeout(function(){var f=m.oState.oSmartChart.getChart();if(m.oState.oTemplateUtils.oCommonUtils.getSelectionPoints(f).count==0){m._updateTable();}else if(f.getSelectionMode()=="MULTIPLE"){m._onChartSelectData(e);}},1);var a=e.getParameter("oSource");if(a&&a instanceof sap.m.Link&&a.getParent()instanceof sap.m.Breadcrumbs){m._onChartDrilledUp(e);}this.oState.oTemplateUtils.oCommonUtils.setEnabledToolbarButtons(e.getSource());this.oState.oTemplateUtils.oCommonUtils.setEnabledFooterButtons(e.getSource());},_onChartDrilledUp:function(e){this._updateTable();},_onChartDrilledDown:function(e){this._updateTable();},_updateTable:function(){var a=this.oState.oSmartChart.getChart();if(!a){return;}var e=[];if(a._getVizFrame().vizSelection()){e=this.oState.oTemplateUtils.oCommonUtils.getSelectionPoints(a).dataPoints;}if(!e||e.length==0){this._lastSelected=null;}if(this.oState.detailController){this.oState.detailController.applyParamsToTable();}},checkToPreventChartBinding:function(e){var p=false;var a=e.mParameters.bindingParams.filters;var f=e.mParameters.bindingParams.sorter;p=this._lastFilter&&!c.isFilterDiff(this._lastFilter,a);p=p?this._lastSorter&&!c.isFilterDiff(this._lastSorter,f):false;this._lastFilter=a;this._lastSorter=f;var s=e.mParameters.bindingParams.parameters.custom&&e.mParameters.bindingParams.parameters.custom.search;var g=s?e.mParameters.bindingParams.parameters.custom.search:s;if(this._lastSearch||g){p=p?(this._lastSearch===g):false;this._lastSearch=g;}var o=this.oState.oSmartFilterbar.getFilterData();var h={};for(var k in o){if(k.indexOf("$Parameter")!==-1){h[k]=o[k];}}p=p?this._lastParam&&!c.isFilterObjDiff(this._lastParam,h):false;this._lastParam=h;if(p){e.mParameters.bindingParams.preventChartBind=true;this.oState.oSmartChart.showOverlay(false);this.oState.oSmartChart.getToolbar().setEnabled(true);}},_changeValueAxisTitleVisibility:function(){if(this.oState.oSmartChart.getChart().getChartType().indexOf("dual_")==0){this.oState.oSmartChart.getChart().setVizProperties({"valueAxis":{"title":{"visible":true}}});}else{this.oState.oSmartChart.getChart().setVizProperties({"valueAxis":{"title":{"visible":false}}});}}});return d;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.Bar');jQuery.sap.require('sap.m.SearchField');jQuery.sap.require('sap.m.Toolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.m.Title');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.m.HBox');jQuery.sap.require('sap.m.CheckBox');jQuery.sap.require('sap.m.Link');jQuery.sap.require('sap.m.List');jQuery.sap.require('sap.m.TextArea');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.StandardListItem');jQuery.sap.require('sap.m.ListSeparators');jQuery.sap.require('sap.m.Popover');jQuery.sap.require('sap.ui.layout.form.SimpleForm');jQuery.sap.require('sap.ui.layout.GridData');jQuery.sap.require('sap.ui.core.mvc.Controller');jQuery.sap.require('sap.m.SegmentedButton');jQuery.sap.require('sap.m.SegmentedButtonItem');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.m.OverflowToolbarButton');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterDialogController",["sap/m/Button","sap/m/ButtonType","sap/m/Label","sap/m/Dialog","sap/m/Bar","sap/m/SearchField","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/Title","sap/m/VBox","sap/m/HBox","sap/m/CheckBox","sap/m/Link","sap/m/List","sap/m/TextArea","sap/m/Text","sap/m/StandardListItem","sap/m/ListSeparators","sap/m/Popover","sap/ui/layout/form/SimpleForm","sap/ui/layout/GridData","sap/ui/core/mvc/Controller","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms",'sap/ui/model/Filter',"sap/suite/ui/generic/template/AnalyticalListPage/controller/DropDownController","sap/m/OverflowToolbarButton"],function(B,a,L,D,b,S,T,c,d,V,H,C,f,g,h,j,k,l,P,m,G,n,F,o,p,q,r,s,O){"use strict";var t="_BASIC";var u="100%";var v=0.33;var w=0.5;var x=n.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController",{init:function(e){this.oState=e;this.oRb=sap.ui.getCore().getLibraryResourceBundle("sap.ui.comp");this.bIsTimeBasedLine;this.bSortOrder;},_createForm:function(){this.sJsonModel=this.oState.alr_visualFilterBar.getModel('_visualFilterConfigModel').getJSON();this.oConfig=JSON.parse(this.sJsonModel);this._filterModified=false;this.filterCompList=[];this.filterChartList=[];this._buildFiltersFromConfig();this.oVerticalBox=new V();this.oVerticalBox.setModel(this.oState.oController.getView().getModel("_templPriv"),"_templPriv");this.oVerticalBox.setModel(this.oState.oController.getView().getModel());this.oVerticalBox.setModel(this.oState.oController.getView().getModel("i18n"),"i18n");this.oVerticalBox.setModel(this.oState.oController.getOwnerComponent().getModel("_filter"),"_filter");this.oVerticalBox.setModel(this.oState.alr_visualFilterBar.getModel('_visualFilterConfigModel'),"_visualFilterConfigModel");this._addFilterSwitch();this._addGroupsAndFilters();return this.oVerticalBox;},_toggle:function(){var e=this.oState.oSmartFilterbar.getFilterDialogContent();if(e&&(e.length===2)){if(e[0].getVisible()){e[0].setVisible(false);e[1].setVisible(true);e[1].getItems()[0].getContent()[1].addCustomData(new sap.ui.core.CustomData({key:'isToggle',value:true}));}else{e[0].setVisible(true);e[1].setVisible(false);e[0].getToolbar().getContent()[1].addCustomData(new sap.ui.core.CustomData({key:'isToggle',value:true}));}}},_addFilterSwitch:function(){var e=[new sap.m.SegmentedButtonItem({icon:"sap-icon://filter-fields",width:"inherit",key:"compact",tooltip:"{i18n>FILTER_COMPACT}"}),new sap.m.SegmentedButtonItem({icon:"sap-icon://filter-analytics",width:"inherit",key:"visual",tooltip:"{i18n>FILTER_VISUAL}"})];var i=new o({width:"inherit",selectedKey:"visual",items:e}).addEventDelegate({onAfterRendering:function(E){if(E.srcControl.getCustomData()[0]&&E.srcControl.getCustomData()[0].getValue()){E.srcControl.focus();E.srcControl.removeAllCustomData();}}});i.attachSelect(function(E){var z=E.getSource();z.setSelectedKey("visual");this._toggle();}.bind(this));var y=new sap.m.OverflowToolbar({design:sap.m.ToolbarDesign.Transparent,content:[new sap.m.ToolbarSpacer(),i]}).addStyleClass("sapSmartTemplatesAnalyticalListPageFilterDialogToolbar");this.oVerticalBox.addItem(y);},_searchDialog:function(){this.oState.alr_visualFilterBar._setVariantModified();},_restoreDialog:function(){this.oState.alr_visualFilterBar.getModel('_visualFilterConfigModel').setData(JSON.parse(this.sJsonModel));this.oConfig=JSON.parse(this.sJsonModel);this._reloadForm();this._filterModified=false;},_cancelDialog:function(){if(this._filterModified){var e=this.oState.alr_visualFilterBar.getModel('_visualFilterConfigModel');e.setData(JSON.parse(this.sJsonModel));this.oState.alr_visualFilterBar.updateVisualFilterBindings(true);}},_buildFiltersFromConfig:function(){var i;this.filterCompList=[];this.filterChartList=[];for(i=0;i<this.oConfig.filterCompList.length;i++){var e=this.oConfig.filterCompList[i].component.properties.sortOrder;if(e.constructor===Object&&e.value){this.oConfig.filterCompList[i].component.properties.sortOrder=e.value;}this.filterCompList.push({obj:{shownInFilterBar:this.oConfig.filterCompList[i].shownInFilterBar,shownInFilterDialog:this.oConfig.filterCompList[i].shownInFilterDialog,cellHeight:this.oConfig.filterCompList[i].cellHeight,component:{type:this.oConfig.filterCompList[i].component.type,cellHeight:this.oConfig.filterCompList[i].component.cellHeight},group:{label:this.oConfig.filterCompList[i].group.label,name:this.oConfig.filterCompList[i].group.name}},searchVisible:this.oConfig.filterCompList[i].searchVisible===undefined||this.oConfig.filterCompList[i].searchVisible});}},_rebuildConfig:function(){var i;var e={filterCompList:[]};for(i=0;i<this.filterCompList.length;i++){e.filterCompList.push({shownInFilterBar:this.filterCompList[i].obj.shownInFilterBar&&this.filterCompList[i].obj.shownInFilterDialog,shownInFilterDialog:this.filterCompList[i].obj.shownInFilterDialog,cellHeight:this.filterCompList[i].obj.cellHeight,group:{label:this.filterCompList[i].obj.group.label,name:this.filterCompList[i].obj.group.name},component:{type:this.filterCompList[i].obj.component.type,cellHeight:this.filterCompList[i].obj.component.cellHeight,properties:{scaleFactor:this.filterChartList[i].getScaleFactor(),numberOfFractionalDigits:this.filterChartList[i].getNumberOfFractionalDigits(),sortOrder:this.filterChartList[i].getSortOrder(),filterRestriction:this.oConfig.filterCompList[i].component.properties.filterRestriction,entitySet:this.filterChartList[i].getEntitySet(),isDropDown:this.oConfig.filterCompList[i].component.properties.isDropDown,width:this.oConfig.filterCompList[i].component.properties.width,height:this.oConfig.filterCompList[i].component.properties.height,dimensionField:this.filterChartList[i].getDimensionField(),dimensionFieldDisplay:this.filterChartList[i].getDimensionFieldDisplay(),dimensionFieldIsDateTime:this.filterChartList[i].getDimensionFieldIsDateTime(),dimensionFilter:this.filterChartList[i].getDimensionFilter(),unitField:this.filterChartList[i].getUnitField(),isCurrency:this.filterChartList[i].getIsCurrency(),isMandatory:this.oConfig.filterCompList[i].component.properties.isMandatory,measureField:this.filterChartList[i].getMeasureField(),outParameter:this.oConfig.filterCompList[i].component.properties.outParameter,inParameters:this.oConfig.filterCompList[i].component.properties.inParameters,parentProperty:this.oConfig.filterCompList[i].component.properties.parentProperty,chartQualifier:this.oConfig.filterCompList[i].component.properties.chartQualifier}}});}return e;},_reloadForm:function(){this.oVerticalBox.destroyItems();this._buildFiltersFromConfig();this._addFilterSwitch();this._addGroupsAndFilters();},_addGroupsAndFilters:function(){var i;var e;var y;var z=[];var A=0;for(i=0;i<this.filterCompList.length;i++){if(!Array.isArray(this.filterCompList[i])){if(this.filterCompList[i].searchVisible===false){continue;}if(!(z.indexOf(this.filterCompList[i].obj.group.name)>-1)){if(y){this.oVerticalBox.addItem(y);}e=this.filterCompList[i].obj.group.name;z.push(e);y=new V();y.setWidth("100%");y.setLayoutData(new G({span:"L12 M12 S12"}));y.addStyleClass("sapUiSmallMarginTop");A++;this._addGroupToolbar(y,this.filterCompList[i].obj.group.label,this.filterCompList[i].obj.group.name);}if(this.filterCompList[i].obj.shownInFilterDialog){this.filterCompList[i].toolbar=this._addChartCustomToolbar(this.oConfig.filterCompList[i],i);this.filterCompList[i].overlay=this._addChartOverlay(this.oConfig.filterCompList[i],i);this.filterChartList[i]=this._addChart(this.oConfig.filterCompList[i].component.type,this.oConfig.filterCompList[i].component.properties,i);var E=this,I=this.filterChartList[i].getParentProperty().replace(/[^\w]/gi,'')+"checkBox";var J=[new V({items:[E.filterCompList[i].toolbar,E.filterCompList[i].overlay,E.filterChartList[i]]}).setWidth("100%").addStyleClass("sapUiSmallMarginEnd")];if(sap.ui.Device.system.desktop){J[0].setWidth("80%");J.splice(1,0,new V({items:[new L({text:"{i18n>SHOW_ON_FILTER_BAR}",labelFor:I}).addStyleClass("sapUiTinyMarginTop"),new C({id:I,text:"",selected:E.oConfig.filterCompList[i].shownInFilterBar}).data("idx",i).attachSelect(null,E._onCheckBoxSelect,E)]}).setAlignItems("Center"));J[1].setWidth("20%");}var K=new H({items:J}).addStyleClass("sapUiSmallMarginTop").setWidth("100%");y.addItem(K);}}if(y){this.oVerticalBox.addItem(y);}}if(A==1&&e===t){F.executeFunction(y,"mAggregations.items.0.setVisible",[false]);}},_onCheckBoxSelect:function(e){var i=e.getSource().data("idx");this.selectCheckBox(i,e.getSource().getSelected());},_addGroupToolbar:function(e,i,y){var z=new d({text:i});var A=new T({content:[z,new c()]});if(y!=t){A.addContent(this._createMoreFiltersLink(y,z));}e.addItem(A);},selectCheckBox:function(i,e){this._filterModified=true;var y=this.oState.alr_visualFilterBar.getModel('_visualFilterConfigModel'),z=jQuery.extend(true,{},y);z.setProperty('/filterCompList/'+i+'/shownInFilterBar',e);y.setData(z.getData());this.oConfig=JSON.parse(y.getJSON());this.oState.alr_visualFilterBar.updateVisualFilterBindings(true);this.oState.oSmartFilterbar._oVariantManagement.currentVariantSetModified(true);},_addChartOverlay:function(e,i){var y=new V({width:"100%",height:e.component.properties.height,items:[new sap.m.Label({text:{path:'_visualFilterConfigModel>/filterCompList/'+i+'/overlayMessage',formatter:function(z){return this.getModel("i18n").getResourceBundle().getText(z);}}})],visible:{path:'_visualFilterConfigModel>/filterCompList/'+i+'/showChartOverlay',formatter:function(z){return z;}}});y.addStyleClass("sapUiOverlay");y.addStyleClass("sapSmartTemplatesAnalyticalListPageVFOverflow");return y;},_addChartCustomToolbar:function(e,i){var y=this;var z=e.component.properties.parentProperty,A=e.component.properties,E=F.getPropertyNameDisplay(this.oState.alr_visualFilterBar.getModel(),e.component.properties.entitySet,e.component.properties.dimensionField),M=z.replace(/[^\w]/gi,''),I=this.oState.alr_visualFilterBar._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(e.component.properties.entitySet),J=e.component.properties.sortOrder[0].Descending.Boolean,K=F.readProperty(e,"component.type")==="Line"&&F.readProperty(e,"component.properties.dimensionFieldIsDateTime"),N=this.oState.alr_visualFilterBar._resolveChartType(e.component.type),Q=this._getChartTypeIconLink(N),R=new L({text:y._getChartTitle(e,i),tooltip:y._getChartTitle(e,i)});if(this.oConfig.filterCompList[i].component.properties.isMandatory){R.addStyleClass("sapMLabelRequired");}var U=this.oState.oSmartFilterbar.getControlByKey(e.component.properties.parentProperty);this.oState.oSmartFilterbar.ensureLoadedValueHelp(e.component.properties.parentProperty);var W=U.getShowValueHelp&&U.getShowValueHelp(),X=(A.isDropDown)?"sap-icon://slim-arrow-down":"",Y=W?"sap-icon://value-help":X,Z,$=this.oVerticalBox.getModel("i18n").getResourceBundle(),_=[new B({type:"Transparent",icon:"sap-icon://line-chart-time-axis",visible:false,press:function(b1){y._showLineChartTimeAxisPopup(b1);}}).data("idx",i),new B({type:"Transparent",icon:(W||A.isDropDown)?Y:"",visible:{path:"_filter>/"+z,formatter:function(b1){if(W||A.isDropDown){return true;}else{if(!b1){return false;}if(typeof b1==="object"){return(b1.value||(b1.items&&b1.items.length)||(b1.ranges&&b1.ranges.length))?true:false;}return true;}}},text:{path:"_filter>/"+z,formatter:function(b1){Z=0;if(b1){if(typeof b1==="object"){if(b1.value){Z++;}if(b1.items){Z+=b1.items.length;}if(b1.ranges){Z+=b1.ranges.length;}}else{Z++;}}return Z?"("+Z+")":"";}},press:function(b1){if(W){U.fireValueHelpRequest.call(U);}else if(A.isDropDown){s.createDropdown(b1.getSource(),y.filterChartList[b1.getSource().data("idx")],this.getModel(),E,A);}else{sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController.launchAllFiltersPopup(b1.getSource(),y.filterChartList[b1.getSource().data("idx")],b1.getSource().getModel('i18n'));}},tooltip:{path:"_filter>/"+z,formatter:function(){return F.getTooltipForValueHelp(W,E,$,Z);}},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow})}).data("idx",i),new O({type:"Transparent",icon:(J?"sap-icon://sort-descending":"sap-icon://sort-ascending"),visible:!K,tooltip:"{i18n>VISUAL_FILTER_SORT_ORDER}",text:"{i18n>VISUAL_FILTER_SORT_ORDER}",press:function(b1){y._showChartSortPopup(b1);},layoutData:new sap.m.OverflowToolbarLayoutData({closeOverflowOnInteraction:false,priority:(!sap.ui.Device.system.desktop)?sap.m.OverflowToolbarPriority.AlwaysOverflow:sap.m.OverflowToolbarPriority.High})}).data("idx",i),new O({type:"Transparent",icon:Q,tooltip:"{i18n>VISUAL_FILTER_CHART_TYPE}",text:"{i18n>VISUAL_FILTER_CHART_TYPE}",press:function(b1){y._showChartTypesPopup(b1);},layoutData:new sap.m.OverflowToolbarLayoutData({closeOverflowOnInteraction:false,priority:(!sap.ui.Device.system.desktop)?sap.m.OverflowToolbarPriority.AlwaysOverflow:sap.m.OverflowToolbarPriority.High})}).data("idx",i),new O({id:"template::VisualFilterDialog::MeasureChangeButton::"+I+"::"+M,type:"Transparent",icon:"sap-icon://measure",tooltip:"{i18n>VISUAL_FILTER_MEASURE}",text:"{i18n>VISUAL_FILTER_MEASURE}",press:function(b1){y._showChartMeasuresPopup(b1);},layoutData:new sap.m.OverflowToolbarLayoutData({closeOverflowOnInteraction:false,priority:(!sap.ui.Device.system.desktop)?sap.m.OverflowToolbarPriority.AlwaysOverflow:sap.m.OverflowToolbarPriority.High})}).data("idx",i)];if((sap.ui.Device.system.tablet||sap.ui.Device.system.phone)&&!sap.ui.Device.system.desktop){_.splice(2,0,new C({tooltip:"{i18n>SHOW_ON_FILTER_BAR}",text:"{i18n>SHOW_ON_FILTER_BAR}",selected:y.oConfig.filterCompList[i].shownInFilterBar,layoutData:new sap.m.OverflowToolbarLayoutData({closeOverflowOnInteraction:false,priority:sap.m.OverflowToolbarPriority.AlwaysOverflow})}).data("idx",i).attachSelect(null,y._onCheckBoxSelect,y));_[2].addStyleClass("sapSmartTemplatesAnalyticalListPageVFDShowInFilterBarCozy");}var a1=new sap.m.OverflowToolbar({design:sap.m.ToolbarDesign.Transparent,content:[R,new sap.m.ToolbarSpacer(),_]}).addStyleClass("sapSmartTemplatesAnalyticalListPageFilterDialogTitleToolbar");a1.getContent()[0].addStyleClass("sapUiTinyMarginTop");a1.getContent()[0].addStyleClass("sapSmartTemplatesAnalyticalListPageVFDialogChartTitle");a1.setWidth("100%");return a1;},_addChart:function(i,y,z){var A;var E=this;var I={scaleFactor:y.scaleFactor,numberOfFractionalDigits:y.numberOfFractionalDigits,sortOrder:y.sortOrder,filterRestriction:y.filterRestriction,isDropDown:y.isDropDown,width:u,height:y.height,labelWidthPercent:v,entitySet:y.entitySet,dimensionField:y.dimensionField,dimensionFieldDisplay:y.dimensionFieldDisplay,dimensionFieldIsDateTime:y.dimensionFieldIsDateTime,unitField:y.unitField,isCurrency:y.isCurrency,isMandatory:y.isMandatory,measureField:y.measureField,dimensionFilter:y.dimensionFilter,outParameter:y.outParameter,inParameters:y.inParameters,parentProperty:y.parentProperty,textArrangement:y.textArrangement,chartQualifier:y.chartQualifier};var J="/filterCompList/"+z;if(i==="Donut"){I.labelWidthPercent=w;}i=this.oState.alr_visualFilterBar._resolveChartType(i);var A=this.oState.alr_visualFilterBar._createFilterItemOfType(i,I);A.data("idx",z);A.addCustomData(new sap.ui.core.CustomData({key:'sPath',value:J}));A.bindProperty('visible',{path:'_visualFilterConfigModel>/filterCompList/'+z+'/showChartOverlay',formatter:function(e){return!e;}});A.bindProperty('dimensionFilter',{path:'_filter>/'+A.getParentProperty()});var K=A.getInParameters(),M=[];if(K&&K.length>0){K.forEach(function(e){M.push({path:"_filter>/"+e.localDataProperty});});}if(E.oState.alr_visualFilterBar.getEntitySet()===A.getEntitySet()){var N=E.oState.alr_visualFilterBar._smartFilterContext.determineMandatoryFilterItems();if(N&&N.length>0){N.forEach(function(e){if(!e.data("isCustomField")){M.push({path:'_filter>/'+e.getName()});}});}}if(M&&M.length>0){A.bindProperty('dimensionFilterExternal',{parts:M,formatter:function(){var K=this.getInParameters(),Q=this.getParentProperty();var R,U;if(E.oState.alr_visualFilterBar.getEntitySet()===this.getEntitySet()){var N=E.oState.alr_visualFilterBar._smartFilterContext.determineMandatoryFilterItems();N.forEach(function(i1){var j1=i1.getName();var k1=K&&K.some(function(e){return e.localDataProperty===j1;});if(j1.indexOf("$Parameter")===-1&&!k1){K.push({localDataProperty:j1,valueListProperty:j1});}});}if(!(E.oState.alr_visualFilterBar.getEntitySet()===this.getEntitySet()&&E.oState.alr_visualFilterBar._smartFilterContext.getAnalyticBindingPath()!=="")&&(E.oState.alr_visualFilterBar._smartFilterContext.getAnalyticBindingPath()===""||E.oState.alr_visualFilterBar._smartFilterContext.getAnalyticBindingPath().indexOf("P_DisplayCurrency")!=-1)){var W=this.getMeasureField();var X=E.oState.alr_visualFilterBar.getModel();var Y=X.getMetaModel();var Z=Y.getODataEntityType(E.oState.alr_visualFilterBar._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.getEntitySet()));var $=Y.getODataEntitySet(this.getEntitySet());var _=Y.getODataProperty(Z,W);var a1=E.oState.alr_visualFilterBar.getProperty("displayCurrency");var b1=_&&_[q.ISOCurrency];if(a1&&b1){var c1=b1.Path;for(var d1=(K.length-1);d1>-1;d1--){var e1=K[d1].valueListProperty;var f1=K[d1].localDataProperty;if(e1===c1){var g1=E.oState.alr_visualFilterBar._smartFilterContext.getFilterData();if(!g1[f1]){U=Y.getODataProperty(Z,c1);var h1=U&&F.isPropertyNonFilterable($,U.name);if(!h1){R=new r({aFilters:[new r({path:c1,operator:"EQ",value1:a1,value2:undefined})],and:false});}}break;}}}}return E.oState.alr_visualFilterBar._getFiltersForFilterItem(K,Q,R,c1);}});}A._updateBinding();A._bAllowBindingUpdateOnPropertyChange=true;A.attachFilterChange(function(e){E._filterModified=true;E.oState.alr_visualFilterBar.fireFilterChange();});A.attachTitleChange(function(e){var z=e.getSource().data("idx");if(E.filterCompList[z].toolbar.getContent().length>0){if(I.isMandatory){E.filterCompList[z].toolbar.getContent()[0].addStyleClass("sapMLabelRequired");}E.filterCompList[z].toolbar.getContent()[0].setText(E._getChartTitle(E.filterCompList[z].obj,z));}});return A;},_createMoreFiltersLink:function(e,y){var z=this;var A=0;var i;var E=new f();for(i=0;i<this.filterCompList.length;i++){if(this.filterCompList[i].searchVisible&&this.filterCompList[i].obj.group.name===e&&!this.filterCompList[i].obj.shownInFilterDialog){A++;}}if(A>0){E.setText(this.oRb.getText("FILTER_BAR_SHOW_MORE_FILTERS",[A]));}else{E.setText(this.oRb.getText("FILTER_BAR_SHOW_CHANGE_FILTERS"));}E.attachPress(function(I){z._createAddRemoveFiltersDialog(e,E);});if(y){E.addAriaLabelledBy(y);}return E;},_showChartMeasuresPopup:function(e){var i=this;var y=e.getSource().data("idx");var z=this.filterChartList[y].getProperty("entitySet");var A=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(e.getSource().getModel('i18n'),"VISUAL_FILTER_MEASURES");var E=new g({mode:sap.m.ListMode.SingleSelectLeft,includeItemInSelection:true});E.data("idx",y);A.addContent(E);var I=this.oState.alr_visualFilterBar._getMeasureMap()[z];E.addStyleClass("sapUiSizeCompact");if(I){for(var J in I){var K=new k({title:I[J].label?I[J].label:I[J].name,tooltip:(I[J].fieldInfo&&I[J].fieldInfo.quickInfo)||I[J].label||I[J].name}).data("measureName",I[J].name);E.addItem(K);if(this.filterChartList[y].getMeasureField()===I[J].name){E.setSelectedItem(K);}}}E.attachSelectionChange(function(e){var y=e.getSource().data("idx"),M=e.getSource().getSelectedItem().data("measureName");i.filterChartList[y].setProperty("unitField",I[M].fieldInfo.unit);i.filterCompList[y].toolbar.getContent()[0].setText(i._getChartTitle(i.filterCompList[y].obj,y));i.oConfig.filterCompList[y].component.properties.measureField=M;if(!i.filterChartList[y]._chart.getPoints){var N=jQuery.extend(true,[],i.filterChartList[y].getSortOrder());N[0].Field.String=M;i.filterChartList[y].setSortOrder(N);i._updateVisualFilterConfigModel(y,'/component/properties/sortOrder',N);}var Q={bUpdateBinding:true,value:M};i.filterChartList[y].setMeasureField(Q);i._updateVisualFilterConfigModel(y,'/component/properties/measureField',Q);i._updateVisualFilterConfigModel(y,'/component/properties/measureField',M);i._updateVisualFilterConfigModel(y,'/component/properties/unitField',I[M].fieldInfo.unit);i._filterModified=true;if(A){A.close();}});A.attachAfterClose(function(){A.destroy();A=null;});A.openBy(e.getSource());},_showChartTypesPopup:function(e){var y=this;var z=e.getSource();var A=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(e.getSource().getModel('i18n'),"VISUAL_FILTER_CHART_TYPES");var E=this.oState.alr_visualFilterBar._getSupportedFilterItemList();var I=[];var J=false;for(var i=0;i<E.length;i++){var K=E[i];var M=new k({title:"{i18n>"+K.textKey+"}",icon:K.iconLink,selected:z.getIcon()===K.iconLink}).data("type",K.type);I.push(M);}var N=new g({mode:sap.m.ListMode.SingleSelectMaster,items:I});N.data("button",z);N.addStyleClass("sapUiSizeCompact");A.addContent(N);N.attachSelectionChange(function(e){var Q=e.getSource().data("button").data("idx"),R=e.getSource().getSelectedItem().data("type"),U=y.filterChartList[Q],W=U.getDimensionField(),X=U.getMeasureField(),Y=U.getDimensionFieldIsDateTime(),Z=F.readProperty(y.oConfig,"filterCompList."+Q+".component.properties.sortOrder.0.Field.String"),$=y.oState.alr_visualFilterBar.getModel('_visualFilterConfigModel'),_=jQuery.extend(true,{},$.getProperty('/filterCompList/'+Q)),a1=F.readProperty(_,"component.properties.sortOrder.0.Field.String");y.oConfig.filterCompList[Q].component.type=R;J=true;e.getSource().data("button").setIcon(y._getChartTypeIconLink(R));if(Z&&a1){if(R==="Line"){y.oConfig.filterCompList[Q].component.properties.sortOrder[0].Field.String=W;_.component.properties.sortOrder[0].Field.String=W;if(Y){y.bSortOrder=y.oConfig.filterCompList[Q].component.properties.sortOrder[0].Descending.Boolean;y.oConfig.filterCompList[Q].component.properties.sortOrder[0].Descending.Boolean=true;_.component.properties.sortOrder[0].Descending.Boolean=true;y.bIsTimeBasedLine=true;}}else{y.oConfig.filterCompList[Q].component.properties.sortOrder[0].Field.String=X;_.component.properties.sortOrder[0].Field.String=X;if(y.bIsTimeBasedLine){y.oConfig.filterCompList[Q].component.properties.sortOrder[0].Descending.Boolean=y.bSortOrder;_.component.properties.sortOrder[0].Descending.Boolean=y.bSortOrder;y.bIsTimeBasedLine=false;}}}_.component.type=R;$.setProperty('/filterCompList/'+Q,_);y.oState.oSmartFilterbar._oVariantManagement.currentVariantSetModified(true);y.oState.alr_visualFilterBar.updateVisualFilterBindings(true);if(A){A.close();}});A.attachBeforeClose(function(){if(J){y._filterModified=true;y._reloadForm();}});A.attachAfterClose(function(){A.destroy();A=null;});A.openBy(e.getSource());},_showLineChartTimeAxisPopup:function(e){var i=e.getSource().data("idx");var y=e.getSource();var z=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(e.getSource().getModel('i18n'),"VISUAL_FILTER_LINE_CHART_TIME_LINE");var A=new g({mode:sap.m.ListMode.SingleSelectLeft,items:[new k({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_DAYS}"}).data("idx",i),new k({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_MONTH}"}).data("idx",i),new k({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_QUARTERS}"}).data("idx",i),new k({title:"{i18n>VISUAL_FILTER_LINE_CHART_TIME_LINE_YEARS}"}).data("idx",i)]});A.data("button",y);A.addStyleClass("sapUiSizeCompact");z.addContent(A);A.attachSelectionChange(function(e){z.close();});z.attachAfterClose(function(){z.destroy();z=null;});z.openBy(e.getSource());},_showChartSortPopup:function(e){var i=this;var y=e.getSource().data("idx");var z=e.getSource();var A=e.getSource().getModel('i18n');var E=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(A,"VISUAL_FILTER_SORTING");var I=new g({mode:sap.m.ListMode.SingleSelectLeft,includeItemInSelection:true,items:[new k({title:A.getResourceBundle().getText("VISUAL_FILTER_SORTING_ASCENDING")}).data("idx",y),new k({title:A.getResourceBundle().getText("VISUAL_FILTER_SORTING_DESCENDING")}).data("idx",y)]});I.data("button",z);I.addStyleClass("sapUiSizeCompact");if(this.filterChartList[y].getSortOrder()[0].Descending.Boolean){I.setSelectedItem(I.getItems()[1],true);}else{I.setSelectedItem(I.getItems()[0],true);}E.addContent(I);I.attachSelectionChange(function(e){var z=e.getSource().data("button");var y=z.data("idx");var J=jQuery.extend(true,[],i.filterChartList[y].getSortOrder());J[0].Descending.Boolean=e.getSource().getItems()[1].isSelected();if(J[0].Descending.Boolean){z.setIcon("sap-icon://sort-descending");}else{z.setIcon("sap-icon://sort-ascending");}var K={bUpdateBinding:true,value:J};i.filterChartList[y].setSortOrder(K);i._updateVisualFilterConfigModel(y,'/component/properties/sortOrder',K);i._updateVisualFilterConfigModel(y,'/component/properties/sortOrder',J);i._filterModified=true;if(E){E.close();}});E.attachAfterClose(function(){E.destroy();E=null;});E.openBy(e.getSource());},_createAddRemoveFiltersDialog:function(e,y){var i;var z=this;var A=new sap.m.Dialog();A.setTitle(this.oRb.getText("SELECT_FILTER_FIELDS"));A.addStyleClass("sapUiPopupWithPadding");A.addStyleClass("sapUiCompAddRemoveFilterDialog");A.addStyleClass("sapUiSizeCompact");A.setVerticalScrolling(true);var E=new b();var I=new S({placeholder:this.oRb.getText("FILTER_BAR_SEARCH")});this._oSearchField=I;I.attachLiveChange(function(N){z._onAddRemoveFiltersSearch(N);});E.addContentRight(I);A.setSubHeader(E);this.addRemoveList=new g({mode:sap.m.ListMode.MultiSelect});this.addRemoveList.setShowSeparators(l.None);A.addContent(this.addRemoveList);for(i=0;i<this.filterCompList.length;i++){if(this.filterCompList[i].obj.group.name===e&&this.filterCompList[i].searchVisible){var J=new k({title:this._getChartTitle(this.filterCompList[i].obj,i,true)}).data("idx",i);this.addRemoveList.addItem(J);if(this.filterCompList[i].obj.shownInFilterDialog){this.addRemoveList.setSelectedItem(J,true);}}}this.addRemoveList.attachSelectionChange(function(N){if(N){var Q=N.getParameters();if(Q){var J=Q.listItem;var R=J.data("idx");if(J){var U={bVisible:Q.selected,propertyName:z.oConfig.filterCompList[R].component.properties.parentProperty};z.oState.alr_visualFilterBar.fireFilterChange(U);}}}});var K=new B({text:this.oRb.getText("FORM_PERS_DIALOG_OK")});K.attachPress(function(){var i;var N=z.addRemoveList.getItems();var Q=z.oState.alr_visualFilterBar.getModel('_visualFilterConfigModel'),R=jQuery.extend(true,{},Q);for(i=0;i<N.length;i++){var U=N[i].data("idx");var W=N[i].isSelected();R.setProperty('/filterCompList/'+U+'/shownInFilterBar',W);R.setProperty('/filterCompList/'+U+'/shownInFilterDialog',W);}Q.setData(R.getData());z.oConfig=JSON.parse(Q.getJSON());z.oState.alr_visualFilterBar.updateVisualFilterBindings(true);z.oState.oSmartFilterbar._oVariantManagement.currentVariantSetModified(true);z._filterModified=true;z._reloadForm();A.close();});A.addAggregation("buttons",K);A.setInitialFocus(this._oSearchField);A.setContentHeight("23.25rem");var M=new B({text:this.oRb.getText("FORM_PERS_DIALOG_CANCEL"),press:function(){A.close();}});A.addAggregation("buttons",M);A.attachAfterClose(function(){A.destroy();A=null;});A.open();},_onAddRemoveFiltersSearch:function(e){var i;if(!e){return;}var y=e.getParameters();if(!y){return;}var z=(y.newValue?y.newValue:"").toLowerCase();var A=this.addRemoveList.getItems();for(i=0;i<A.length;i++){var E=(A[i].getTitle()).toLowerCase();A[i].setVisible(E.indexOf(z)>=0);}},_getChartTypeIconLink:function(i){var e=this.oState.alr_visualFilterBar._getSupportedFilterItemMap();var y=e[i];return!y?"":y.iconLink;},_getChartTitle:function(e,i,y){var z="";if(this.filterChartList[i]){if(y){e.component.properties=this.filterChartList[i].getP13NConfig();z=this.oState.alr_visualFilterBar.getTitleByFilterItemConfig(e);}else{z=this.filterChartList[i].getTitle();}}else{e.component.properties=this.oConfig.filterCompList[i].component.properties;z=this.oState.alr_visualFilterBar.getTitleByFilterItemConfig(e);}return z;},_adjustToolbarIcons:function(i){if(this.filterCompList[i].obj.component.type==="Line"){this.filterCompList[i].toolbar.getContent()[1].getItems()[1].setVisible(true);this.filterCompList[i].toolbar.getContent()[1].getItems()[2].setVisible(false);}else{this.filterCompList[i].toolbar.getContent()[1].getItems()[1].setVisible(false);this.filterCompList[i].toolbar.getContent()[1].getItems()[2].setVisible(true);}},_updateVisualFilterConfigModel:function(i,e,y,I){var z=this.oState.alr_visualFilterBar.getModel('_visualFilterConfigModel');z.setProperty('/filterCompList/'+i+e,y);if(I){var M=jQuery.extend(true,{},z.getProperty('/filterCompList/'+i));z.setProperty('/filterCompList/'+i,M);this.oState.alr_visualFilterBar.updateVisualFilterBindings(true);}this.oConfig=JSON.parse(z.getJSON());this.oState.oSmartFilterbar._oVariantManagement.currentVariantSetModified(true);},_triggerSearchInFilterDialog:function(e){var i;if(!e){return;}var y=e.getParameters();if(!y){return;}var z=(y.newValue?y.newValue:"").toLowerCase();for(i=0;i<this.oConfig.filterCompList.length;i++){var A=this.oConfig.filterCompList[i].component.properties;this.oConfig.filterCompList[i].searchVisible=(A.parentProperty.toLowerCase().indexOf(z)>=0)||(A.measureField.toLowerCase().indexOf(z)>=0);}this._reloadForm();}});sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog=function(i,e){if(this._oPopoverDialog){this._oPopoverDialog.destroy();}this._oPopoverDialog=new sap.m.Popover();this._oPopoverDialog.setTitle(i.getResourceBundle().getText(e));this._oPopoverDialog.setPlacement(sap.m.PlacementType.PreferredBottomOrFlip);this._oPopoverDialog.addStyleClass("sapUiPopupWithPadding");return this._oPopoverDialog;};sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createFilterItemSelectedList=function(e,y){var z=new g({mode:sap.m.ListMode.Delete}),A,E=e.getFilterRestriction();z.data("chart",e);if(E==='multiple'){A=jQuery.extend(true,{},e.getDimensionFilter());var I=(A&&A.items)?A.items:undefined,J=(A&&A.ranges)?A.ranges:undefined,K=(A&&A.value)?A.value:null;A=jQuery.extend(true,{},e.getDimensionFilter());if(I){for(var i=0;i<I.length;i++){var M=new k({title:I[i].text?I[i].text:I[i].key});if(M){M.addCustomData(new sap.ui.core.CustomData({key:'items',value:i}));}z.addItem(M);}}if(J){for(var i=0;i<J.length;i++){var M=new k({title:J[i].tokenText?J[i].tokenText:F.createTitleFromCode(J[i])});M.addCustomData(new sap.ui.core.CustomData({key:'ranges',value:i}));z.addItem(M);}}if(K){var M=new k({title:K});M.addCustomData(new sap.ui.core.CustomData({key:'value'}));z.addItem(M);}}else{z.addItem(new k({title:e.getDimensionFilter()}));}z.attachDelete(function(N){var Q=N.getParameter("listItem"),R=z.data('chart'),U;if(E==='single'){U=null;}else{U=jQuery.extend(true,{},R.getDimensionFilter());var W=Q.getCustomData()[0],X=W.getKey(),Y=U[X];if(X!=='value'){var Z=W.getValue();Y.splice(Z,1);}else{U.value=null;}}z.removeItem(Q);R.setDimensionFilter(U);R.fireFilterChange();y.removeContent(z);var $=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createFilterItemSelectedList(R,y);if($.getItems().length>0){y.addContent($);y.focus();}else{y.close();}});return z;};sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController.launchAllFiltersPopup=function(e,i,y){var z=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createPopoverDialog(y,"VISUAL_FILTER_ALL_SELECTED_FILTERS"),A=sap.suite.ui.generic.template.AnalyticalListPage.controller.VisualFilterDialogController._createFilterItemSelectedList(i,z);z.addContent(A);z.addStyleClass("sapUiSizeCompact");z.addStyleClass("sapSmartTemplatesAnalyticalListPageSelectedLinkDialog");var E=new sap.m.Bar();var I=new B({text:y.getResourceBundle().getText("CLEAR_FILTERS_ALL"),press:function(J){var K=A.data('chart'),M=K.getFilterRestriction(),N;if(M==='multiple'){N=jQuery.extend(true,{},K.getDimensionFilter());N.items=[];N.ranges=[];N.value=null;}else{N=null;}z.removeContent(A);K.setDimensionFilter(N);K.fireFilterChange();z.close();}});E.addContentRight(I);z.setFooter(E);z.attachAfterClose(function(){z.destroy();z=null;});z.openBy(e);};return x;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.CriticalityUtil')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.CriticalityUtil');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.Context');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/CriticalityUtil",["sap/ui/base/Object","sap/ui/model/Context","sap/suite/ui/generic/template/AnalyticalListPage/util/OperationCode","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","jquery.sap.global"],function(B,C,O,F,q){"use strict";var P="Positive",N="Negative",a="Critical",b="Neutral",G="Good",E="Error",T="Target",M="Maximize",c="Minimize";var d=B.extend("sap.suite.ui.generic.template.AnalyticalListPage.util.CriticalityUtil");d.setVals=function(t,v,D,e,V){this.toleranceLow=t;this.toleranceHigh=v;this.deviationLow=D;this.deviationHigh=e;this._value=V;this.state=undefined;};d.Maximize=function(){if(this.toleranceLow||this.deviationLow||this.toleranceLow===0||this.deviationLow===0){if(this._value>=this.toleranceLow){this.state=sap.m.ValueColor.Good;}else if(this._value<this.deviationLow){this.state=sap.m.ValueColor.Error;}else{this.state=sap.m.ValueColor.Critical;}}return this.state;};d.Maximizing=function(){this.Maximize();};d.Minimize=function(){if(this.toleranceHigh||this.deviationHigh||this.toleranceHigh===0||this.deviationHigh===0){if(this._value<=this.toleranceHigh){this.state=sap.m.ValueColor.Good;}else if(this._value>this.deviationHigh){this.state=sap.m.ValueColor.Error;}else{this.state=sap.m.ValueColor.Critical;}}return this.state;};d.Minimizing=function(){this.Minimize();};d.Target=function(){if((this.toleranceLow||this.toleranceLow===0)&&(this.toleranceHigh||this.toleranceHigh===0)){if(this._value>=this.toleranceLow&&this._value<=this.toleranceHigh){this.state=sap.m.ValueColor.Good;}else if(this._value<this.deviationLow||this._value>this.deviationHigh){this.state=sap.m.ValueColor.Error;}else{this.state=sap.m.ValueColor.Critical;}}return this.state;};d.getDataPoint=function(m,e){var f=m.getMetaModel(),o=f.getODataEntityType(f.getODataEntitySet(e.getEntitySet()).entityType),g=e.getChartQualifier()in o?o[e.getChartQualifier()]:undefined,D,h=0,j=g?g.MeasureAttributes:undefined;if(j){for(var i=0;i<j.length;i++){if(j[i].Measure&&j[i].Measure.PropertyPath===e.getMeasureField()){D=j[i].DataPoint?o[j[i].DataPoint.AnnotationPath.substring(1)]:undefined;if(D){h++;break;}}}}if(h===0){q.sap.log.info("There is no datapoint for the measure "+e.getMeasureField());}return D;};d.getCriticalityRefProperties=function(D){var r=[];var e=D.Criticality;if(e){var s=F.readProperty(e,"Path");if(s){r.push(s);}}else{var f=D.CriticalityCalculation,i=F.readProperty(D,"CriticalityCalculation.ImprovementDirection.EnumMember")?F.getPrimitiveValue(D.CriticalityCalculation.ImprovementDirection):undefined,g=F.readProperty(f,"DeviationRangeLowValue.Path"),h=F.readProperty(f,"DeviationRangeHighValue.Path"),t=F.readProperty(f,"ToleranceRangeLowValue.Path"),j=F.readProperty(f,"ToleranceRangeHighValue.Path");if(i===M){if(g){r.push(g);}if(t){r.push(t);}}else if(i===c){if(j){r.push(j);}if(h){r.push(h);}}else if(i===T){if(g){r.push(g);}if(t){r.push(t);}if(h){r.push(h);}if(j){r.push(j);}}}return r.length>0?r:undefined;};d.CalculateCriticality=function(D,e,m){for(var i=0;i<e.results.length;i++){if(D&&D.Criticality){var f=(D.Criticality.EnumMember||D.Criticality.Path)?F.getPathOrPrimitiveValue(D.Criticality):undefined;if(f){if(f.indexOf("path")!==-1){f=D.Criticality.Path?e.results[i][D.Criticality.Path]:undefined;}if(f===N){e.results[i].color=E;}else if(f===P){e.results[i].color=G;}else if(f===a){e.results[i].color=a;}else if(f===b){e.results[i].color=b;}}}else{var I=F.readProperty(D,"CriticalityCalculation.ImprovementDirection.EnumMember")?F.getPrimitiveValue(D.CriticalityCalculation.ImprovementDirection):undefined;if(I){if(F.readProperty(D,"CriticalityCalculation.ToleranceRangeLowValue")){var t=F.readProperty(D,"CriticalityCalculation.ToleranceRangeLowValue.Int")?Number(D.CriticalityCalculation.ToleranceRangeLowValue.Int):Number(e.results[i][D.CriticalityCalculation.ToleranceRangeLowValue.Path]);}if(F.readProperty(D,"CriticalityCalculation.ToleranceRangeHighValue")){var g=F.readProperty(D,"CriticalityCalculation.ToleranceRangeHighValue.Int")?Number(D.CriticalityCalculation.ToleranceRangeHighValue.Int):Number(e.results[i][D.CriticalityCalculation.ToleranceRangeHighValue.Path]);}if(F.readProperty(D,"CriticalityCalculation.DeviationRangeLowValue")){var h=F.readProperty(D,"CriticalityCalculation.DeviationRangeLowValue.Int")?Number(D.CriticalityCalculation.DeviationRangeLowValue.Int):Number(e.results[i][D.CriticalityCalculation.DeviationRangeLowValue.Path]);}if(F.readProperty(D,"CriticalityCalculation.DeviationRangeHighValue")){var j=F.readProperty(D,"CriticalityCalculation.DeviationRangeHighValue.Int")?Number(D.CriticalityCalculation.DeviationRangeHighValue.Int):Number(e.results[i][D.CriticalityCalculation.DeviationRangeHighValue.Path]);}if(isNaN(h)){h=undefined;}if(isNaN(j)){j=undefined;}if(isNaN(t)){t=undefined;}if(isNaN(g)){g=undefined;}var v=Number(e.results[i][m]);this.setVals(t,g,h,j,v);e.results[i].color=(this[I]());}}}return e;};return d;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter')){
// Copyright (c) 2009-2014 SAP SE, All Rights Reserved
jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/util/KpiAnnotationFormatter",["sap/suite/ui/generic/template/AnalyticalListPage/util/KpiUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms","sap/suite/ui/generic/template/AnalyticalListPage/util/KpiAnnotationHelper"],function(K,V,a){"use strict";jQuery.sap.declare("sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter");sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter={};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions={count:0};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.NumberFormatFunctions={};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.criticalityConstants={StateValues:{None:"None",Negative:"Error",Critical:"Warning",Positive:"Success"},ColorValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};function c(l,C){var S;if(C){S=C.None;if(l&&l.EnumMember){var v=l.EnumMember;if(e(v,"Negative")){S=C.Negative;}else if(e(v,"Critical")){S=C.Critical;}else if(e(v,"Positive")){S=C.Positive;}}}return S;}function e(S,l){return S&&S.indexOf(l,S.length-l.length)!==-1;}function b(v,I,l,m,t,n,C){var o={};o.EnumMember="None";if(v!==undefined){v=Number(v);if(e(I,"Minimize")||e(I,"Minimizing")){o.EnumMember="None";if(n||m){if(v<=n){o.EnumMember="Positive";}else if(v>m){o.EnumMember="Negative";}else{o.EnumMember="Critical";}}}else if(e(I,"Maximize")||e(I,"Maximizing")){o.EnumMember="None";if(t||l){if(v>=t){o.EnumMember="Positive";}else if(v<l){o.EnumMember="Negative";}else{o.EnumMember="Critical";}}}else if(e(I,"Target")){o.EnumMember="None";if(t&&n){if(v>=t&&v<=n){o.EnumMember="Positive";}else if(v<l||v>m){o.EnumMember="Negative";}else{o.EnumMember="Critical";}}}}return c(o,C);}function d(l,r,u,m){if(!l||!r){return;}l=Number(l);if(!u&&(l-r>=0)){return"Up";}if(!m&&(l-r<=0)){return"Down";}if(r&&u&&(l-r>=u)){return"Up";}if(r&&m&&(l-r<=m)){return"Down";}}function f(v,n,S,u){var l=true;var m=K.formatNumberForPresentation(v,l,n,S);return m+" "+(u?u:"");}function g(l,n,t,S,u){var m=true;if(!l){return;}l=Number(l);var D=l-t;var o=K.formatNumberForPresentation(D,m,n,S);return o+" "+(u?u:"");}function h(v,r,l){if(!r){return;}r=Number(r);if(l){return r+"%";}return r;}function i(v,t,n,S,u){var l=true;if(!t){return;}else{t=Number(t);var m=K.formatNumberForPresentation(t,l,n,S);return m+" "+(u?u:"");}}sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForKpiTargetValue=function(C,D){if(!D||!D.Value||!D.TargetValue){return"";}var S=C.getSetting("settings").getData();var v=K.getPathOrPrimitiveValue(D.Value);var t=K.getPathOrPrimitiveValue(D.TargetValue);var m=C.getSetting("dataModel");var M=m.getMetaModel();var E=M.getODataEntitySet(S.entitySet);var o=M.getODataEntityType(E.entityType);var l=M.getODataProperty(o,D.Value.Path);var u=K.getUnitofMeasure(S.model,l);var I=K.isBindingValue(t);var n=K.isBindingValue(v);var p=0;var q;if(D.ValueFormat){p=K.getPathOrPrimitiveValue(D.ValueFormat.NumberOfFractionalDigits);q=K.getPathOrPrimitiveValue(D.ValueFormat.ScaleFactor);}var r=u.match(/{@i18n>.+}/gi);var w=K.isBindingValue(u)&&!r;var x=false;var P="parts: ["+(n?v:"{path: 'DUMMY'}");P+=I?","+t:"";P+=w&&!r?","+u:"";P+="]";if(u==="%"){x=true;}if(p===""||p===undefined){p=0;if(x){p=1;}}q=q==""?undefined:q;var y=function(){var z=1;if(x){return i(n?arguments[0]:v,I?arguments[z++]:t,p,q,w?arguments[z++]:u);}else{return i(n?arguments[0]:v,I?arguments[z++]:t,p,q);}};var F=s(y,"formatReferenceValueCalculation");return"{"+P+", formatter: '"+F+"'}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForKpiReferenceValue=function(C,D){var v=K.getPathOrPrimitiveValue(D.Value);var r=K.getPathOrPrimitiveValue(D.TrendCalculation.ReferenceValue);var l=K.isRelative(D);var I=K.isBindingValue(r);var p="parts: ["+v;p+=I?","+r:"";p+="]";var m=function(){var n=1;return h(arguments[0],I?arguments[n++]:r,l);};var F=s(m,"formatReferenceValueCalculation");return"{"+p+", formatter: '"+F+"'}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForKpiValue=function(C,D){if(!D||!D.Value){return"";}var S=C.getSetting("settings").getData();var m=C.getSetting("dataModel");var M=m.getMetaModel();var E=M.getODataEntitySet(S.entitySet);var o=M.getODataEntityType(E.entityType);var l=M.getODataProperty(o,D.Value.Path);var u=K.getUnitofMeasure(S.model,l);var S=C.getSetting("settings").getData();var v=K.getPathOrPrimitiveValue(D.Value);var n=u.match(/{@i18n>.+}/gi);var I=K.isBindingValue(u)&&!n;var p=K.isBindingValue(v);var P="parts: ["+(p?v:"{path: 'DUMMY'}");P+=I&&!n?","+u:"";P+="]";var q=false;if(u==="%"){q=true;}var r=0;var t;if(D.ValueFormat){r=K.getPathOrPrimitiveValue(D.ValueFormat.NumberOfFractionalDigits);t=K.getPathOrPrimitiveValue(D.ValueFormat.ScaleFactor);}if(r===""||r===undefined){r=0;if(q){r=1;}}t=t==""?undefined:t;var w=function(){var x=1;if(q){return f(p?arguments[0]:v,r,t,I?arguments[x++]:u);}else{return f(p?arguments[0]:v,r,t);}};var F=s(w,"formatFieldWithScaleCalculation");return"{"+P+", formatter: '"+F+"'}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolveKpiHeaderState=function(C,D){return j(C,D,sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.criticalityConstants.ColorValues);};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForDeviation=function(C,D){if(!D||!D.Value||!D.TargetValue){return"";}var S=C.getSetting("settings").getData();var v=K.getPathOrPrimitiveValue(D.Value);var t=K.getPathOrPrimitiveValue(D.TargetValue);var m=C.getSetting("dataModel");var M=m.getMetaModel();var E=M.getODataEntitySet(S.entitySet);var o=M.getODataEntityType(E.entityType);var l=M.getODataProperty(o,D.Value.Path);var u=K.getUnitofMeasure(S.model,l);var I=K.isBindingValue(t);var n=u.match(/{@i18n>.+}/gi);var p=K.isBindingValue(u)&&!n;var q=K.isBindingValue(v);var r=false;var w=0;var x;if(D.ValueFormat){w=K.getPathOrPrimitiveValue(D.ValueFormat.NumberOfFractionalDigits);x=K.getPathOrPrimitiveValue(D.ValueFormat.ScaleFactor);}var P="parts: ["+(q?v:"{path: 'DUMMY'}");P+=I?","+t:"";P+=p&&!n?","+u:"";P+="]";if(u==="%"){r=true;}if(w===""||w===undefined){w=0;if(r){w=1;}}x=x==""?undefined:x;var y=function(){var z=1;if(r){return g(q?arguments[0]:v,w,I?arguments[z++]:t,x,p?arguments[z++]:u);}else{return g(q?arguments[0]:v,w,I?arguments[z++]:t,x);}};var F=s(y,"formatDeviationCalculation");return"{"+P+", formatter: '"+F+"'}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForTrendIcon=function(C,D){if(!D||!D.Value||!D.Value.Path||!D.TrendCalculation){return"";}if(D.Trend){var t=K.getPathOrPrimitiveValue(D.Trend);return t;}var v=K.getPathOrPrimitiveValue(D.Value);var r=K.getPathOrPrimitiveValue(D.TrendCalculation.ReferenceValue);var l=K.getPathOrPrimitiveValue(D.TrendCalculation.DownDifference);var u=K.getPathOrPrimitiveValue(D.TrendCalculation.UpDifference);var I=K.isBindingValue(r);var m=K.isBindingValue(l);var n=K.isBindingValue(u);var p="parts: ["+v;p+=I?","+r:"";p+=m?","+l:"";p+=n?","+u:"";p+="]";var o=function(){var q=1;return d(arguments[0],I?arguments[q++]:r,m?arguments[q++]:l,n?arguments[q++]:u);};var F=s(o,"formatTrendDirection");return"{"+p+", formatter: '"+F+"'}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatDPTitle=function(C,D){var S=C.getSetting("settings").getData();var m=C.getSetting("dataModel");var M=m.getMetaModel();var E=M.getODataEntitySet(S.entitySet);var o=M.getODataEntityType(E.entityType);var l=M.getODataProperty(o,D.Value.Path);var t=K.getPathOrPrimitiveValue(D.Title);var r="",u="";if(l["Org.OData.Measures.V1.Unit"]){var U=l["Org.OData.Measures.V1.Unit"];u=K.getPathOrPrimitiveValue(U);}else if(l["Org.OData.Measures.V1.ISOCurrency"]){var n=l["Org.OData.Measures.V1.ISOCurrency"];u=K.getPathOrPrimitiveValue(n);}var I=K.isBindingValue(u)&&!u.match(/{@i18n>.+}/gi),p=K.isBindingValue(t);var q=function(v,w){w=w||t;v=v||u;var x=(u==="%");if(v===undefined){return w;}else{if(!x){if(v.match(/{@i18n>.+}/gi)){return this.getModel('i18n').getResourceBundle().getText("KPI_CARD_TITLE_UNIT",[w,this.getModel('i18n').getResourceBundle().getText(v.substring(7,u.length-1))]);}else{return this.getModel('i18n').getResourceBundle().getText("KPI_CARD_TITLE_UNIT",[w,v]);}}else{return w;}}};var F=s(q,"formatTitleForDP");var P="["+(I?u:"{path:'DUMMY'}")+", "+(p?t:"{path: 'DUMMY'}")+"]";r="{parts: "+P+", formatter: '"+F+"'}";return r;};function j(C,D,o){var S=o.None;if(D.Criticality){var l=D.Criticality?D.Criticality.EnumMember.split("/")[1]:undefined;var I=K.isBindingValue(l);if(I){S=l;}else{S=c(D.Criticality,o);}}else if(D.CriticalityCalculation&&D.Value&&D.Value){S=k(C,D,o);}return S;}function k(C,D,o){var v=K.getPathOrPrimitiveValue(D.Value);var I=K.isBindingValue(v);var l=D.CriticalityCalculation.ImprovementDirection.EnumMember;var m=D.CriticalityCalculation.DeviationRangeLowValue?K.getPathOrPrimitiveValue(D.CriticalityCalculation.DeviationRangeLowValue):undefined;var n=D.CriticalityCalculation.DeviationRangeHighValue?K.getPathOrPrimitiveValue(D.CriticalityCalculation.DeviationRangeHighValue):undefined;var t=D.CriticalityCalculation.ToleranceRangeLowValue?K.getPathOrPrimitiveValue(D.CriticalityCalculation.ToleranceRangeLowValue):undefined;var p=D.CriticalityCalculation.ToleranceRangeHighValue?K.getPathOrPrimitiveValue(D.CriticalityCalculation.ToleranceRangeHighValue):undefined;var q=K.isBindingValue(m);var r=K.isBindingValue(n);var u=K.isBindingValue(t);var w=K.isBindingValue(p);var P="parts: ["+(I?v:"{path:'DUMMY'}");P+=q?","+m:"";P+=r?","+n:"";P+=u?","+t:"";P+=w?","+p:"";P+="]";var x=function(){var y=1;return b(I?arguments[0]:v,l,q?arguments[y++]:m,r?arguments[y++]:n,u?arguments[y++]:t,w?arguments[y++]:p,o);};var F=s(x,"formatCriticalityCalculation");return"{"+P+", formatter: '"+F+"'}";}function s(l,n){if(!sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions[n]){sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions[n]=0;}sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions[n]++;var F=n+sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions[n];sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions[F]=l;return"sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatFunctions."+F;}sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.getAggregateNumber=function(C,E,D,S,o){var l=S&&S.SelectOptions;var p;var m=",filters:";var n=[];if(l){l.forEach(function(z){p=z.PropertyName.PropertyPath;z[p].forEach(function(R){if(R.Sign.EnumMember===V.SelectionRangeSignType+"/I"||R.Sign.EnumMember===V.SelectionRangeSignType+"/E"){if(R.Low){n.push(K.getFilter(R,z));}}});});}var q=D&&D.Value&&D.Value.Path;var t=D&&D.TargetValue&&D.TargetValue.Path;var r="";m+=JSON.stringify(n);var P=a.resolveParameterizedEntitySet(C.getSetting("dataModel"),E,S);r+="{path: '"+P+"',length:1";var u=o.metaModel.getODataEntityType(E.entityType,false);var v=o.metaModel.getODataProperty(u,q);var w=v&&v[V.Unit]&&v[V.Unit].Path;var x=v&&v[V.ISOCurrency]&&v[V.ISOCurrency].Path;var y=[];y.push(q);if(w){y.push(w);}if(t){y.push(t);}if(x){y.push(x);}if(D.TrendCalculation&&D.TrendCalculation.ReferenceValue&&D.TrendCalculation.ReferenceValue.Path){y.push(D.TrendCalculation.ReferenceValue.Path);}return r+", parameters:{select:'"+y.join(",")+"'}"+m+"}";};sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.getAggregateNumber.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolveKpiHeaderState.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForTrendIcon.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForKpiValue.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForDeviation.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.resolvePathForKpiTargetValue.requiresIContext=true;sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter.formatDPTitle.requiresIContext=true;return sap.suite.ui.generic.template.AnalyticalListPage.util.KpiAnnotationFormatter;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.controller.MultipleViewsHandler')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.controller.MultipleViewsHandler');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');sap.ui.define("sap/suite/ui/generic/template/ListReport/controller/MultipleViewsHandler",["jquery.sap.global","sap/ui/base/Object","sap/suite/ui/generic/template/ListReport/controller/MultipleViewsSingleTableModeHelper","sap/suite/ui/generic/template/ListReport/controller/MultipleViewsMultipleTablesModeHelper","sap/suite/ui/generic/template/lib/BusyHelper"],function(q,B,M,a,b){"use strict";var P="/listReport/multipleViews";var c=P+"/selectedKey";var d=P+"/mode";var e=P+"/items";function g(s,C,t){var I;var Q;var m;var S;var T=t.oComponentUtils.getTemplatePrivateModel();var o={};var f;var D=t.oServices.oApplication.getBusyHelper().getBusyDelay();function h(){return Q&&Q.enableAutoBinding;}function r(){if(I&&I.fnRegisterToChartEvents){return I.fnRegisterToChartEvents.apply(null,arguments);}}function j(){if(I&&I.onDetailsActionPress){return I.onDetailsActionPress.apply(null,arguments);}}function k(){if(!I){return;}var i=w();if(i){return i.templateSortOrder;}}function l(i){var F;if(!i){return"";}if(i.state==="error"){return t.oCommonUtils.getText("SEG_BUTTON_ERROR",i.text);}if(i.state===""||i.state==="busy"){var A=sap.ui.core.format.NumberFormat.getIntegerInstance({style:"short"});F=A.format(i.count);}return t.oCommonUtils.getText("SEG_BUTTON_TEXT",[i.text,i.state==="busyLong"?"...":F]);}function n(){if(I){var i=T.getProperty(c);var A=I.getContentForIappState(i);return{mode:m,state:A};}}function R(G){if(I){var i=I.getSelectedKeyAndRestoreFromIappState(G);T.setProperty(c,i);}}function p(){return T.getProperty(c);}function u(E){if(!I){return;}var i=function(K,A,F){var G=t.oCommonUtils.getElementCustomData(A);var H=f[K]||Object.create(null);H.selectionVariantFilters=F;H.templateSortOrder=G.TemplateSortOrder;H.implementingControl=A;f[K]=H;if(S){var J=e+"/"+K;var L=function(O,V,W){if(H.numberOfUpdates!==V){return;}var N=q.extend({},T.getProperty(J));if(!N.state&&O=="busy"){setTimeout(function(){if(T.getProperty(J).state==="busy"){N=q.extend({},T.getProperty(J));N.state="busyLong";T.setProperty(J,N);}},D);}N.state=O;if(!O){N.count=W;}T.setProperty(J,N);};H.numberOfUpdates=0;H.updateStartFunction=L.bind(null,"busy");H.updateSuccessFunction=L.bind(null,"");H.errorFunction=L.bind(null,"error");var N={text:G.text,count:0,state:""};T.setProperty(J,N);}};I.init(E,i);}function v(){return m;}function w(){return f[T.getProperty(c)];}function x(E){if(!I){return;}var A=E.getParameter("bindingParams");o.filters=A.filters.slice(0);o.parameters=A.parameters;var F=w();var G=F.selectionVariantFilters;for(var i in G){A.filters.push(G[i]);}}function U(){var i=s.oSmartTable.getModel();var A=s.oSmartTable.getEntitySet();var E=s.oSmartFilterbar.getBasicSearchValue();var F={};if(E){F={search:E};}for(var K in f){var G=f[K];G.numberOfUpdates++;G.updateStartFunction(G.numberOfUpdates);var H=o.filters.concat(G.selectionVariantFilters);i.read("/"+A+"/$count",{urlParameters:F,filters:H,groupId:"updateMultipleViewsItemsCounts",success:G.updateSuccessFunction.bind(null,G.numberOfUpdates),error:G.errorFunction.bind(null,G.numberOfUpdates)});}}function y(){if(S){U();}}function z(){return I;}(function(){var i,A,E,F;i=C.getOwnerComponent().getAppComponent().getConfig();A=i&&i.pages[0]&&i.pages[0].component&&i.pages[0].component.settings;if(!A){return;}E=A.quickVariantSelectionX;F=A.quickVariantSelection;if(E&&F){throw new Error("Defining both QuickVariantSelection and QuickVariantSelectionX in the manifest is not allowed.");}Q=E||F;if(!Q){return;}S=Q.showCounts;f=Object.create(null);T.setProperty(P,Object.create(null));T.setProperty(e,Object.create(null));var G=function(H){T.setProperty(c,H);var J=T.bindProperty(c);J.attachChange(function(K){if(I.onSelectedKeyChanged){var N=K.getSource().getValue();I.onSelectedKeyChanged(N);}var L=s.oIappStateHandler.areDataShownInTable();var O=true;if(typeof I.isTableDirty==='function'){O=I.isTableDirty(s.oSmartTable);}if(L&&O){if(t.oCommonUtils.isSmartChart(s.oSmartTable)){s.oSmartTable.rebindChart();if(typeof I.setTableDirty==='function'){I.setTableDirty(s.oSmartTable,false);}}else if(t.oCommonUtils.isSmartTable(s.oSmartTable)){s.oSmartTable.rebindTable();t.oCommonUtils.refreshSmartTable(s.oSmartTable);}}else{t.oCommonUtils.setEnabledToolbarButtons(s.oSmartTable);}s.oIappStateHandler.changeIappState(true,L);});};if(F){I=new M(F,s,C,t,G,f);m="single";q.sap.log.info("This list supports multiple views with single table");}else{I=new a(E,s,C,t,G,f);m="multi";q.sap.log.info("This list supports multiple views with multiple tables/charts");}T.setProperty(d,m);})();return{getEnableAutoBinding:h,fnRegisterToChartEvents:r,onDetailsActionPress:j,determineSortOrder:k,onDataRequested:y,formatItemTextForMultipleView:l,getContentForIappState:n,restoreFromIappState:R,getVariantSelectionKey:p,init:u,getMode:v,onRebindContentControl:x,getImplementingHelper:z};}return B.extend("sap.suite.ui.generic.template.ListReport.controller.MultipleViewsHandler",{constructor:function(s,C,t){q.extend(this,g(s,C,t));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.detailTemplates.detailUtils')){jQuery.sap.declare('sap.suite.ui.generic.template.detailTemplates.detailUtils');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.routing.HashChanger');jQuery.sap.require('sap.m.DraftIndicator');sap.ui.define("sap/suite/ui/generic/template/detailTemplates/detailUtils",["jquery.sap.global","sap/ui/core/routing/HashChanger","sap/suite/ui/generic/template/extensionAPI/NavigationController","sap/suite/ui/generic/template/lib/MessageButtonHelper","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/detailTemplates/PaginatorButtonsHelper","sap/suite/ui/generic/template/ObjectPage/extensionAPI/DraftTransactionController","sap/suite/ui/generic/template/ObjectPage/extensionAPI/NonDraftTransactionController","sap/m/DraftIndicator"],function(q,H,N,M,t,P,D,a){"use strict";var b=sap.m.DraftIndicatorState;function g(C,o,v){function i(){var T=o.getTemplatePrivateModel();T.setProperty("/objectPage",{displayMode:0});}function d(B){var U=C.getModel("ui");var T=o.getTemplatePrivateModel();if(o.getEditableNDC()){U.setProperty("/editable",true);var e=o.isNonDraftCreate();U.setProperty("/createMode",e);T.setProperty("/objectPage/displayMode",e?4:2);}else if(!o.isDraftEnabled()){U.setProperty("/editable",false);U.setProperty("/createMode",false);T.setProperty("/objectPage/displayMode",1);}(v.onComponentActivate||q.noop)(B);}function u(){var B=C.getBindingContext();var e=o.registerContext(B);var T=C.getModel("_templPrivGlobal");T.setProperty("/generic/draftIndicatorState",b.Clear);(v.refreshFacets||q.noop)(null,true);(v.getHeaderInfoTitleForNavigationMenue||q.noop)();var A=B.getObject();var U=C.getModel("ui");var I;var h=o.getTemplatePrivateModel();if(e.bIsDraft){I=true;U.setProperty("/enabled",true);h.setProperty("/objectPage/displayMode",e.bIsCreate?4:2);}else{I=o.getEditableNDC();h.setProperty("/objectPage/displayMode",I?2:1);if(A.hasOwnProperty("HasDraftEntity")&&A.HasDraftEntity){U.setProperty("/enabled",false);var m=C.getModel();var r=new Promise(function(R,k){m.read(B.getPath(),{urlParameters:{"$expand":"SiblingEntity,DraftAdministrativeData"},success:R,error:k});});var j=o.getBusyHelper();j.setBusy(r);r.then(function(R){var s=m.getContext("/"+m.getKey(R.SiblingEntity));if(s){(v.draftResume||q.noop)(s,A,R.DraftAdministrativeData);}U.setProperty("/enabled",true);},function(E){});}else{U.setProperty("/enabled",true);}}U.setProperty("/createMode",e.bIsCreate);U.setProperty("/editable",I);}function f(){return o.getDraftRootPath();}function n(){v.navigateUp();}return{init:i,onActivate:d,getTitle:o.getTitleFromTreeNode,updateBindingContext:u,currentDraftModified:f,navigateUp:n};}function c(v,T,C){var o;var e;var l;var p;var h;function G(){return h||H.getInstance();}function f(j,i){return function(){T.oServices.oApplication.subTitleForViewLevelChanged(j,i.getText());};}function s(i){var I=!T.oComponentUtils.isDraftEnabled();if(I||!i){var U=C.getView().getModel("ui");U.setProperty("/editable",i);}if(I){T.oComponentUtils.setEditableNDC(i);}}function O(){T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var i=T.oComponentUtils.isDraftEnabled();if(!i){s(false);}T.oServices.oNavigationController.navigateBack();},q.noop,o.state);}function A(){var y=T.oComponentUtils.getTemplatePrivateModel();var U=y.getProperty("/generic/viewLevel")-1;var S=U?T.oServices.oApplication.getHierarchySectionsFromCurrentHash():[];var B=v.aBreadCrumbs;h=G();l="";var j="";for(var i=0;i<U;i++){var z=S[i];l=l+j+z;j="/";var E=e[i];var I=z.split("(");if(I&&I[1]){var L=B&&B[i];if(L){var J=h.hrefForAppSpecificHash?h.hrefForAppSpecificHash(l):"#/"+l;J=T.oServices.oApplication.adaptBreadCrumbUrl(J,i+1);var K="/"+E+"("+I[1];L.setHref(J);L.bindElement({path:K,events:{change:f(i+1,L)}});}}}}function d(i){var j=i.getBindingContext();var z=G().getHash();return T.oServices.oApplicationController.propertyChanged(z,j);}function n(){if(l){T.oServices.oNavigationController.navigateToContext(l,"",true);}else{T.oServices.oNavigationController.navigateToRoot(true);}}function k(E){var i=E.getSource();T.oServices.oApplication.performAfterSideEffectExecution(function(){var B=T.oServices.oApplication.getBusyHelper();if(B.isBusy()){return;}var U=C.getView().getModel("ui");var j=C.getOwnerComponent().getModel("_templPrivGlobal");var z=d(i).then(function(R){if(!o.fclInfo.isContainedInFCL||j.getProperty("/generic/FCL/isVisuallyFullScreen")){n();}},function(){B.getUnbusy().then(function(R){if(!o.fclInfo.isContainedInFCL||j.getProperty("/generic/FCL/isVisuallyFullScreen")){T.oCommonUtils.processDataLossTechnicalErrorConfirmation(function(){n();U.setProperty("/enabled",true);},q.noop,o.state);}else{T.oCommonUtils.processDataLossTechnicalErrorConfirmation(q.noop,q.noop,o.state,"StayOnPage");}});});B.setBusy(z);});}function m(){o.state.messageButtonHelper.toggleMessagePopover();}function r(){var i;return function(){i=i||new N(T,C,o.state);return i;};}function u(){var i;return function(){if(!i){var j=T.oComponentUtils.isDraftEnabled()?D:a;i=new j(T,C,o.state);}return i;};}function w(){p.handleShowNextObject();}function x(){p.handleShowPrevObject();}var G=t.testable(G,"getHashChangerInstance");var A=t.testable(A,"adaptLinksToUpperLevels");o={onInit:function(R){e=T.oServices.oApplication.getSections(C.getOwnerComponent().getEntitySet(),true);if(!R||R.footerBar){var i=T.oComponentUtils.isODataBased();o.state.messageButtonHelper=new M(T.oCommonUtils,C,i);T.oServices.oTemplateCapabilities.oMessageButtonHelper=o.state.messageButtonHelper;}if(!R||R.paginatorButtons){p=new P(o,C,T);}},handlers:{handleShowNextObject:w,handleShowPrevObject:x,onShowMessages:m,applyAndUp:k,onBack:O},extensionAPI:{getNavigationControllerFunction:r,getTransactionControllerFunction:u},fclInfo:{isContainedInFCL:false},state:{},onComponentActivate:function(B){if(o.state.messageButtonHelper){o.state.messageButtonHelper.adaptToContext(B);}T.oComponentUtils.setBackNavigation(O);A();if(p){p.computeAndSetVisibleParamsForNavigationBtns();}}};v.navigateUp=n;v.setEditable=s;var y=T.oComponentUtils.getTemplatePrivateModel();var V=y.getProperty("/generic/viewLevel");var F=T.oServices.oApplication.getFclProxyForView(V);if(F.oActionButtonHandlers){o.handlers.fclActionButtonHandlers=F.oActionButtonHandlers;o.fclInfo.isContainedInFCL=true;}o.fclInfo.navigateToDraft=F.navigateToDraft;return o;}return{getComponentBase:g,getControllerBase:c};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.Application')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.Application');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.Device');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.routing.History');jQuery.sap.require('sap.ui.core.routing.HistoryDirection');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.ActionSheet');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.Popover');sap.ui.define("sap/suite/ui/generic/template/lib/Application",["jquery.sap.global","sap/ui/base/Object","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/core/routing/History","sap/ui/core/routing/HistoryDirection","sap/m/MessageToast","sap/m/ActionSheet","sap/m/Dialog","sap/m/Popover","sap/suite/ui/generic/template/lib/deletionHelper","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/ContextBookkeeping","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,D,J,H,a,M,A,b,P,d,r,C,t){"use strict";var c=(t.testableStatic(function(T,o){var s="sapUiSizeCozy",h="sapUiSizeCompact";if(o.hasClass(s)||o.hasClass(h)){return"";}else{return T?s:h;}},"Application_determineContentDensityClass")(D.support.touch,q(document.body)));function g(){return c;}function f(o,p){q.sap.syncStyleClass(c,p,o);p.addDependent(o);}var f=t.testableStatic(f,"Application_attachControlToParent");function e(T){var o=new C(T.oAppComponent);var l,E;function h(){return l;}function s(i){l=i;}function k(i){var j=T.oNavigationControllerProxy.getActiveComponents();return j.indexOf(i.getId())>=0;}var I=false;function m(i){T.fnAddSideEffectPromise(i);}function p(i){if(I){return;}var j=q.grep(T.aRunningSideEffectExecutions,function(i1){return!!i1;});if(j.length){I=true;Promise.all(j).then(function(){I=false;p(i);});}else{i();}}function n(i){var j;if(i instanceof b){j="open";}else if(i instanceof P||i instanceof A){j="openBy";}if(j){var i1=i[j];i[j]=function(){var j1=arguments;p(function(){if(!T.oBusyHelper.isBusy()){T.oBusyHelper.getUnbusy().then(function(){i1.apply(i,j1);});}});};}}var F={};function u(i,j,i1,j1,k1){i=i||T.oNavigationHost;var l1=i.getId();var m1=F[l1]||(F[l1]={});var n1=m1[j];if(!n1){n1=sap.ui.xmlfragment(l1,j,i1);f(n1,i);var o1;if(j1){o1=new J();n1.setModel(o1,j1);}(k1||q.noop)(n1,o1);m1[j]=n1;n(n1);}return n1;}function v(){return new Promise(function(i){T.oNavigationObserver.getProcessFinished(true).then(function(){T.oBusyHelper.getUnbusy().then(i);});});}function w(i){T.oShellServicePromise.then(function(j){j.setBackNavigation(i);});}function x(i){if(!T.oFlexibleColumnLayoutHandler){return{handleDataReceived:function(){return false;}};}return T.oFlexibleColumnLayoutHandler.getFclProxyForView(i);}var y=false;function z(i){y=i;}function G(i,j){if(!T.oFlexibleColumnLayoutHandler){return true;}var i1=r.determineNavigationPath(i,j);return T.oFlexibleColumnLayoutHandler.isNewHistoryEntryRequired(i1);}function R(i){T.aStateChangers.push(i);}function K(i){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getTargetAfterCancelPromise(i):Promise.resolve(i);}function L(i,j){j.then(function(){o.adaptAfterObjectDeleted(i);});}function N(i,j,i1){var j1=T.mEntityTree[i];var k1;if(j1.navigationProperty&&j1.parent){k1=j?j1.entitySet:j1.navigationProperty;}else{k1=i;}if(i1.indexOf(k1)<0){i1.unshift(k1);if(j1.navigationProperty&&j1.parent){N(j1.parent,j,i1);}}}function O(i,j){var i1=[];N(i,j,i1);return i1;}function Q(j){var i1=O(j);i1.pop();var j1="";var k1="";var l1=[];for(var i=0;i<i1.length;i++){j1=j1+k1+i1[i];l1.push(j1);k1="/";}return l1;}function S(){var i=T.oNavigationControllerProxy.oHashChanger.getHash();var j=i.split("?")[0];var i1=j.split("/");if(i1[0]===""||i1[0]==="#"){i1.splice(0,1);}return i1;}function U(i,j,i1){if(T.oFlexibleColumnLayoutHandler){return T.oFlexibleColumnLayoutHandler.adaptBreadCrumbUrl(i,j,i1);}return i;}function V(){var j=T.oNavigationControllerProxy.getActiveComponents();var i1=0;var j1;for(var i=0;i<j.length;i++){var k1=T.componentRegistry[j[i]];if(k1.viewLevel>0&&(i1===0||k1.viewLevel<i1)){i1=k1.viewLevel;j1=k1.oComponent;}}var l1=j1?Promise.resolve(j1):T.oNavigationControllerProxy.getRootComponentPromise();return l1.then(function(m1){return m1.getModel("i18n").getResourceBundle();});}function W(){return T.oNavigationControllerProxy.getAppTitle();}function X(i,j){T.oNavigationControllerProxy.subTitleForViewLevelChanged(i,j);}function Y(i){return T.oNavigationControllerProxy.getCurrentKeys(i);}function Z(){for(var i in T.componentRegistry){var j=T.componentRegistry[i];if(j.viewLevel===1){if(k(j.oComponent)){var i1=j.oComponent.getComponentContainer().getElementBinding();return i1&&i1.getPath();}else{return null;}}}return null;}function $(i1,j1,k1,l1,m1){var n1=k1.oComponent.getEntitySet();var o1=T.mEntityTree[n1];var p1=false;var q1;var r1=true;for(var i=0;i<o1.children.length&&!q1;i++){var s1=o1.children[i];var t1=T.mEntityTree[s1];if(t1.navigationProperty===i1){q1=t1.sRouteName;r1=!t1.noKey;}}if(l1&&!q1){var u1=o1.embeddedComponents[l1];if(u1){for(var j=0;j<u1.pages.length&&!p1;j++){var v1=u1.pages[j];if(v1.navigationProperty===i1){p1=true;q1=n1+"/"+l1+"/"+i1;r1=!(v1.routingSpec&&v1.routingSpec.noKey);}}}}if(q1){var w1=p1?l1+r.getPatternDelimiter():"";var x1=r1?"("+j1+")":"";var y1=w1+i1+x1;T.oNavigationControllerProxy.navigateToSuffix(y1,k1.viewLevel+1,q1,m1);}}var _;function a1(i){var j=i.getEntitySet();var i1=T.mEntityTree[j];if(i1&&i1.communicationModel){return i1.communicationModel;}_=_||new J();return _;}var b1;function c1(j,i1){var i=i1||0;if(i>0){return null;}var j1=j.getEntitySet();var k1=T.mEntityTree[j1];var l1=k1&&k1.communicationObject;for(;i<0&&l1;){k1=T.mEntityTree[k1.parent];if(k1.communicationObject!==l1){i++;l1=k1.communicationObject;}}if(i<0||l1){return l1;}b1=b1||{};return b1;}function d1(i){for(var j in T.mEntityTree){if(T.mEntityTree[j].navigationProperty&&(T.mEntityTree[j].level===i+1)){return T.mEntityTree[j].navigationProperty;}}}function e1(){return T.oFlexibleColumnLayoutHandler?T.oFlexibleColumnLayoutHandler.getMaxColumnCountInFCL():false;}function f1(){var j=T.oNavigationControllerProxy.getActiveComponents();for(var i=0;i<j.length;i++){var i1=j[i];var j1=T.componentRegistry[i1];var k1=j1.methods.currentDraftModified&&j1.methods.currentDraftModified();if(k1){o.markDraftAsModified(k1);}}}function g1(){if(E!==undefined){return E;}var i,j,i1,j1,k1,l1,m1=true;var n1=T.oAppComponent.getModel();var o1=n1.getMetaModel();var p1=n1.mContexts;for(i1 in p1){m1=false;k1=p1[i1].sPath;j1=k1&&k1.substring(1,k1.indexOf('('));l1=j1&&o1.getODataEntitySet(j1);if(l1){i=n1.getProperty(k1);j=i&&n1.getETag(undefined,undefined,i)||null;if(j){E=true;return E;}}}if(m1){return true;}E=false;return E;}function h1(){var i,j,i1;var j1=T.oNavigationControllerProxy.getAllComponents();for(i=0;i<j1.length;i++){j=j1[i];i1=T.componentRegistry[j];i1.utils.refreshBinding();}}T.oApplicationProxy={getDraftSiblingPromise:o.getDraftSiblingPromise,getAlternativeContextPromise:o.getAlternativeContextPromise,getPathOfLastShownDraftRoot:o.getPathOfLastShownDraftRoot,getResourceBundleForEditPromise:V,getHierarchySectionsFromCurrentHash:S,getContentDensityClass:g,setEditableNDC:z,getDialogFragment:u.bind(null,null),destroyView:function(i){delete F[i];},setListReportTable:s,markCurrentDraftAsModified:f1,prepareDeletion:L};return{setEditableNDC:z,getEditableNDC:function(){return y;},getContentDensityClass:g,attachControlToParent:f,getDialogFragmentForView:u,getBusyHelper:function(){return T.oBusyHelper;},addSideEffectPromise:m,performAfterSideEffectExecution:p,isComponentActive:k,showMessageToast:function(){var i=arguments;var j=function(){q.sap.log.info("Show message toast");M.show.apply(M,i);};Promise.all([v(true),T.oBusyHelper.getUnbusy()]).then(j);},setBackNavigation:w,getFclProxyForView:x,isNewHistoryEntryRequired:G,registerStateChanger:R,getDraftSiblingPromise:o.getDraftSiblingPromise,registerContext:o.registerContext,activationStarted:o.activationStarted,cancellationStarted:o.cancellationStarted,editingStarted:o.editingStarted,getTargetAfterCancelPromise:K,getBreadCrumbInfo:Q,adaptBreadCrumbUrl:U,getSections:O,getHierarchySectionsFromCurrentHash:S,getAppTitle:W,subTitleForViewLevelChanged:X,getCurrentKeys:Y,getPathForViewLevelOneIfVisible:Z,getCommunicationModel:a1,getCommunicationObject:c1,navigateRoute:$,getForwardNavigationProperty:d1,getMaxColumnCountInFCL:e1,getListReportTable:h,markCurrentDraftAsModified:f1,checkEtags:g1,unbindAllComponents:h1,getIsDraftModified:o.getIsDraftModified,prepareDeletion:d.prepareDeletion.bind(null,T),prepareDeletionOfCreateDraft:d.prepareDeletionOfCreateDraft.bind(null,T)};}return B.extend("sap.suite.ui.generic.template.lib.Application",{constructor:function(T){q.extend(this,e(T));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.CommonEventHandlers')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.CommonEventHandlers');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.core.format.NumberFormat');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.m.Select');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.comp.smartfilterbar.SmartFilterBar');jQuery.sap.require('sap.ui.model.odata.type.Time');jQuery.sap.require('sap.ui.table.TreeTable');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.mvc.ViewType');sap.ui.define("sap/suite/ui/generic/template/lib/CommonEventHandlers",["jquery.sap.global","sap/ui/base/Object","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/m/Select","sap/m/MessageBox","sap/m/MessageToast","sap/m/Table","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/comp/smartfilterbar/SmartFilterBar","sap/ui/model/odata/type/Time","sap/suite/ui/generic/template/lib/testableHelper","sap/ui/table/TreeTable","sap/ui/model/json/JSONModel","sap/ui/core/mvc/ViewType","sap/suite/ui/generic/template/js/AnnotationHelper","sap/suite/ui/generic/template/lib/modelHelper"],function(q,B,N,D,S,M,a,T,F,b,c,d,t,e,J,V,A,m){"use strict";function g(p,i){var o;if(i){o=N.getCurrencyInstance({showMeasure:false});}else{o=N.getFloatInstance({precision:p.precision,decimals:p.scale});}return function(P,u){P=o.format(P,u);if(u){P+=" "+u;}return P;};}function f(C,p,s){var o=C.getModel("entitySet").getMetaModel(),i=o.getObject(o.getMetaContext(C.sPath).sPath),P=o.getObject(o.getMetaContext(C.sPath+"/"+p).sPath),j={path:p,data:{type:P.type,displayFormat:" ",label:s,textPath:p,textArrangement:A.getTextArrangement(i,P),unit:null,fnDecimalFormatter:null}},O="Org.OData.Measures.V1.Unit",l="Org.OData.Measures.V1.ISOCurrency",I=false,n,r,u,L;if(P){if(P.extensions){L=P.extensions.length;for(var k=0;k<L;k++){n=P.extensions[k];if(n.namespace==="http://www.sap.com/Protocols/SAPData"){switch(n.name){case"display-format":j.data.displayFormat=n.value;break;case"label":if(!j.data.label){j.data.label=n.value;}break;case"text":r=n.value;u=p.split("/");u[u.length-1]=r;j.data.textPath=u.join("/");break;default:break;}}}}if(j.data.label===""||j.data.label===undefined){j.data.label=p;}if(P.type==="Edm.Decimal"){if(P[l]){j.data.unit=P[l].Path;I=true;}else if(P[O]){j.data.unit=P[O].Path;}j.data.fnDecimalFormatter=g(P,I);}}return j;}function G(p,C){var i={};return function(o){var P=o.getProperty(p),s="",j,u,k,l,n;j=i[p];if(!j){j=f(o,p,C);i[p]=j;}if(j.data.textPath&&j.data.textPath!==""){k=o.getProperty(j.data.textPath);}switch(j.data.type){case"Edm.DateTime":if(j.data.displayFormat==="Date"){if(P&&P!==""&&P.getTime){l=D.getDateInstance({style:"medium"});n=new Date(0).getTimezoneOffset()*60*1000;P=l.format(new Date(P.getTime()+n));}}break;case"Edm.Time":if(P&&P!==""){P=new d().formatValue(P,"string");}break;case"Edm.Boolean":if(P===true){P="{i18n>YES}";}else if(P===false){P="{i18n>NO}";}break;case"Edm.Decimal":u=(j.data.unit)?o.getProperty(j.data.unit):"";P=j.data.fnDecimalFormatter(P,u);break;default:break;}if(!k||j.data.textPath===p){s=P?P:"";}else{switch(j.data.textArrangement){case"idAndDescription":s=P+" ("+k+")";break;case"idOnly":s=P;break;case"descriptionOnly":s=k;break;default:s=k+(P?" ("+P+")":"");break;}}return{key:s?s:p,text:j.data.label?j.data.label+": "+s:s};};}function h(C,o,s,l){function E(i){var j={};for(var k in i){var x=i[k];if(typeof x==="string"){j[k]=x;}else if(typeof x==="object"){if(x.value){j[k]=E(x).value;}else{j[k]=x;}}}return j;}function H(i){if(i instanceof sap.ui.generic.app.navigation.service.NavError){if(i.getErrorCode()==="NavigationHandler.isIntentSupported.notSupported"){sap.m.MessageBox.show(l.getText("ST_NAV_ERROR_NOT_AUTHORIZED_DESC"),{title:l.getText("ST_GENERIC_ERROR_TITLE")});}else{sap.m.MessageBox.show(i.getErrorCode(),{title:l.getText("ST_GENERIC_ERROR_TITLE")});}}}function n(){var i=C.getView().getBindingContext();return s.oApplication.getDraftSiblingPromise(i);}function p(j){var k=j;var x=-1;var D1=l.getOwnerControl(j);if(D1.getTable){D1=D1.getTable();}var E1=l.isAnalyticalTable(D1);var F1=o.getViewLevel();var G1;if(!E1){var H1=l.getTableBindingInfo(D1);var I1=H1&&H1.binding;var J1=null;if(I1){if(D1 instanceof e){var K1=(I1.getLength()>0)?I1.getLength():0;if(K1>0){J1=[];for(var L1=0;L1<K1;L1++){J1.push(I1.getContextByIndex(L1));}}}else if(l.isUiTable(D1)){J1=I1.getContexts();}else if(D1 instanceof T){J1=I1.getCurrentContexts();}}var M1=null;var N1=l.getSelectedContexts(D1);var O1=null;if(N1&&N1.length>0){O1=N1[0].getPath();}else if(k){O1=k.getBindingContext()?k.getBindingContext().sPath:null;}if(I1&&I1.getContexts&&O1){for(var i=0;i<J1.length;i++){M1=J1[i];if(M1&&M1.getPath()===O1){x=i;break;}}}if(D1&&x!==-1&&J1.length>0){var P1;if(D1 instanceof T){P1=D1.getGrowingThreshold();}else if(l.isUiTable(D1)){P1=D1.getThreshold();}var Q1=F1>0?l.getTableBindingInfo(D1).path:null;var R1=function(S1){return{context:S1,navigationData:{navigationProperty:Q1}};};G1=J1&&{listBinding:I1,growingThreshold:P1,selectedRelativeIndex:x,objectPageNavigationContexts:J1,navigitionInfoProvider:R1};}}o.setPaginatorInfo(G1,true);}function r(j,k){var x=C.getView().getModel().getMetaModel();var D1=k;var E1=x.getODataEntitySet(j,false);var F1=x.getODataEntityType(E1.entityType,false);var G1=F1.key.propertyRef;var i;var H1=s.oDraftController.getDraftContext();if(H1.isDraftEnabled(j)){G1=G1.concat(H1.getSemanticKey(j));G1.push({name:"IsActiveEntity"},{name:"HasDraftEntity"},{name:"HasActiveEntity"});}if(D1.parameters.select&&D1.parameters.select.length>0){var I1=D1.parameters.select.split(",");for(i=0;i<G1.length;i++){if(q.inArray(G1[i].name,I1)===-1){D1.parameters.select+=","+G1[i].name;I1=D1.parameters.select.split(",");}}}return D1;}function u(i,j){var k=i.getSource().getUrl();i.preventDefault();l.processDataLossConfirmationIfNonDraft(function(){sap.m.URLHelper.redirect(k,false);},q.noop,j);}function v(i,j){i.preventDefault();var k=i.getSource().getHref();l.processDataLossConfirmationIfNonDraft(function(){window.location.hash=k;},q.noop,j);}function w(j){var k=[];return l.getDialogFragment("sap.suite.ui.generic.template.ListReport.view.fragments.DeleteConfirmation",{onCancel:function(i){var x=i.getSource().getParent();x.close();},onDelete:function(x){var D1=x.getSource().getParent();var E1=D1.getModel("delete");var F1=E1.getProperty("/items");var G1=[];var H1=[];var I1=[];k=[];for(var i=0;i<F1.length;i++){if(!F1[i].draftStatus.locked&&F1[i].deletable){if(!F1[i].draftStatus.draft){if(F1[i].draftStatus.draftActive){I1.push(F1[i].context.sPath);}else if(F1.length===E1.getProperty("/unsavedChangesItemsCount")||!F1[i].draftStatus.unsavedChanges||E1.getProperty("/checkboxSelected")){G1.push(F1[i].context.sPath);}}else{H1.push(F1[i].context.sPath);k.push(F1[i].context.sPath);}}}H1=H1.concat(G1).concat(I1);s.oCRUDManager.deleteEntities(H1).then(function(J1){var K1=0;var L1=[];for(var i=0;i<J1.length;i++){L1.push("/"+J1[i].split('/')[1]);if(k.indexOf(L1[i])!==-1){K1=K1+1;}}var M1=j.getTable();M1.getModel("_templPriv").setProperty("/listReport/deleteEnabled",false);var N1=H1.length-I1.length-(J1.length-K1);if((J1.length-K1)>0){var O1="";if(N1>0){O1+=(N1>1)?l.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL_WITH_COUNT",[N1]):l.getText("ST_GENERIC_DELETE_SUCCESS_WITH_COUNT",[N1]);O1+="\n";O1+=(J1.length>1)?l.getText("ST_GENERIC_DELETE_ERROR_PLURAL_WITH_COUNT",[J1.length]):l.getText("ST_GENERIC_DELETE_ERROR_WITH_COUNT",[J1.length]);}else{O1=(J1.length>1)?l.getText("ST_GENERIC_DELETE_ERROR_PLURAL"):l.getText("ST_GENERIC_DELETE_ERROR");}M.error(O1);}else{var P1="";P1=(N1>1)?l.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL"):l.getText("ST_GENERIC_OBJECT_DELETED");s.oApplication.showMessageToast(P1);}l.refreshSmartTable(j);},function(J1){M.error(l.getText("ST_GENERIC_DELETE_ERROR_PLURAL",[H1.length]),{styleClass:l.getContentDensityClass()});});D1.close();}},"delete");}function y(i,j){return new Promise(function(k,x){j.read(i+"/SiblingEntity",{success:function(D1){var E1="/"+j.getKey(D1);k(E1);},error:function(D1){var E1="Error";k(E1);}});});}function z(j){var k=C.getView().getModel();var x=k.getMetaModel();var D1=x.getODataEntitySet(C.getOwnerComponent().getEntitySet());var E1=D1["Org.OData.Capabilities.V1.DeleteRestrictions"];var F1=(E1&&E1.Deletable&&E1.Deletable.Path)?E1.Deletable.Path:"";var G1={items:undefined,itemsCount:j.length,text:{title:undefined,shortText:undefined,unsavedChanges:undefined,longText:undefined,undeletableText:undefined},lockedItemsCount:0,unsavedChangesItemsCount:0,undeletableCount:0,checkboxSelected:true};var H1=[];var I1=[];var J1,K1,L1,M1,N1;var O1=[];for(var i=0;i<j.length;i++){J1=k.getObject(j[i].getPath());if(!J1.IsActiveEntity){if(J1.HasActiveEntity){O1.push(y(j[i].getPath(),k));}}}var P1=0;return new Promise(function(Q1,R1){Promise.all(O1).then(function(S1){for(var i=0;i<j.length;i++){J1=k.getObject(j[i].getPath());K1={};L1={};M1=true;N1={};if(!J1.IsActiveEntity){K1.draft=true;if(J1.HasActiveEntity){L1.draft=false;L1.draftActive=true;if(S1[P1]!="Error"){N1["oModel"]=j[0].getModel();N1["sPath"]=S1[P1++];}}}else if(J1.HasDraftEntity){var T1=k.getProperty("DraftAdministrativeData/CreatedByUserDescription",j[i]);var U1=k.getProperty("DraftAdministrativeData/InProcessByUser",j[i]);if(U1){K1.locked=true;K1.user=T1;G1.lockedItemsCount++;}else{K1.unsavedChanges=true;K1.user=T1;G1.unsavedChangesItemsCount++;}}if(F1&&F1!==""){if(k.getProperty(F1,j[i])===false){M1=false;G1.undeletableCount++;}}H1.push({context:j[i],draftStatus:K1,deletable:M1});if(!J1.IsActiveEntity&&J1.HasActiveEntity){I1.push({context:N1,draftStatus:L1,deletable:M1});}}if(I1.length>0){H1=H1.concat(I1);}G1.items=H1;if(G1.lockedItemsCount===G1.itemsCount){G1.text.title=l.getText("ST_GENERIC_ERROR_TITLE");}else{G1.text.title=(G1.itemsCount>1)?l.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[G1.itemsCount]):l.getText("ST_GENERIC_DELETE_TITLE");}G1.text.unsavedChanges=l.getText("ST_GENERIC_UNSAVED_CHANGES_CHECKBOX");if(G1.itemsCount>1){if(G1.lockedItemsCount===G1.itemsCount){G1.text.shortText=l.getText("ST_GENERIC_DELETE_LOCKED_PLURAL");}else if(G1.unsavedChangesItemsCount===G1.itemsCount){G1.text.shortText=l.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES_PLURAL");}else if(G1.lockedItemsCount>0){var V1=G1.itemsCount-G1.lockedItemsCount;G1.text.shortText=(G1.lockedItemsCount>1)?l.getText("ST_GENERIC_CURRENTLY_LOCKED_PLURAL",[G1.lockedItemsCount,G1.itemsCount]):l.getText("ST_GENERIC_CURRENTLY_LOCKED",[G1.itemsCount]);G1.text.shortText+="\n";if(V1===G1.unsavedChangesItemsCount){G1.text.shortText+=(V1>1)?l.getText("ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES_PLURAL"):l.getText("ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES");}else{G1.text.shortText+=(V1>1)?l.getText("ST_GENERIC_DELETE_REMAINING_PLURAL",[V1]):l.getText("ST_GENERIC_DELETE_REMAINING");}}else{G1.text.shortText=l.getText("ST_GENERIC_DELETE_SELECTED_PLURAL");}if(G1.undeletableCount>0){G1.text.undeletableText=l.getText("ST_GENERIC_DELETE_UNDELETABLE",[G1.undeletableCount,G1.itemsCount]);}}else{if(G1.lockedItemsCount>0){G1.text.shortText=l.getText("ST_GENERIC_DELETE_LOCKED",[" ",G1.items[0].draftStatus.user]);}else if(G1.unsavedChangesItemsCount>0){G1.text.shortText=l.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES",[" ",G1.items[0].draftStatus.user]);}else{G1.text.shortText=l.getText("ST_GENERIC_DELETE_SELECTED");}}Q1({"mJSONData":G1});});});}function I(i,j,k,x){var D1=l.getNavigationHandler();var E1={};var F1={};for(var G1 in i.parameters){if(q.isEmptyObject(i.parameters[G1])){E1[G1]=i.parameters[G1];}else{F1[G1]=i.parameters[G1];}}F1=E(F1);D1.mixAttributesAndSelectionVariant({},x).getParameterNames().forEach(function(G1){delete E1[G1];});var H1=k&&k.getObject();var I1=j&&j.getObject?j.getObject():j&&j[0];var J1=q.extend({},E1,H1,I1,F1);return D1.mixAttributesAndSelectionVariant(J1,x);}function K(i,j,k,x){var D1=l.getNavigationHandler();var E1;if(k){E1=k.getUiState().getSelectionVariant();if(typeof E1!=="string"){E1=JSON.stringify(E1);}}var F1=I(i,j,C.getView().getBindingContext(),E1);var G1={semanticObject:i.semanticObject,action:i.action};C.adaptNavigationParameterExtension(F1,G1);D1.navigate(i.semanticObject,i.action,F1.toJSONString(),null,H);}function L(i){var j=l.getNavigationHandler();var k={semanticObject:i.semanticObject,action:i.action};var x=j.mixAttributesAndSelectionVariant(i.semanticAttributes);C.adaptNavigationParameterExtension(x,k);j.navigate(i.semanticObject,i.action,x.toJSONString(),null,H);}function O(i,k){var x=i.byId("icon");var D1=x&&x.getSrc();if(D1===""){D1=undefined;}var E1=i.byId("title");var F1=E1&&E1.getText();if(F1===""){F1=undefined;}var G1=i.byId("description");var H1=G1&&G1.getText();if(H1===""){H1=undefined;}for(var j=0;j<k.length;j++){var I1=k[j];var J1=A.getStableIdPartFromFacet(I1)+"::contactTitleAreaIcon";var K1=i.byId(J1);var L1=A.getStableIdPartFromFacet(I1)+"::contactTitleAreaTitle";var M1=i.byId(L1);var N1=A.getStableIdPartFromFacet(I1)+"::contactTitleAreaDescription";var O1=i.byId(N1);var P1=K1&&K1.getSrc();if(P1===""){P1=undefined;}var Q1=M1&&M1.getText();if(Q1===""){Q1=undefined;}var R1=O1&&O1.getText();if(R1===""){R1=undefined;}if(D1&&P1&&F1&&Q1&&H1&&R1){if((D1===P1||!P1)&&(F1===Q1||!Q1)&&(H1===R1||!R1)){var S1=A.getStableIdPartFromFacet(I1)+"::contactTitleArea";var T1=i.byId(S1);if(T1&&T1.setVisible){T1.setVisible(false);}}}}}function P(i,j,k,x){var D1=C.getOwnerComponent().getAppComponent().getManifestEntry("sap.app");var E1=D1.crossNavigation.outbounds[i.data("CrossNavigation")];var F1;if(k){if(l.isSmartChart(i)){F1=l.getOwnerControl(x);}else{F1=l.getOwnerControl(i).getParent();}}K(E1,j,k,F1);}function Q(j,k){for(var i=0;i<j.length;i++){if(j[i].indexOf("/")!==-1){var x=j[i].split("/");x.pop();var D1=x.join("/");if(k.indexOf(D1)===-1){k.push(D1);}}}}function R(i,j){}function U(C,j,k){var x=C.getOwnerComponent().getAppComponent().getConfig();if(C.getMetadata().getName()==='sap.suite.ui.generic.template.ListReport.view.ListReport'&&x&&x.pages[0]&&x.pages[0].component&&x.pages[0].component.settings&&x.pages[0].component.settings.quickVariantSelectionX){var D1=j.getFilters();if(D1){for(var i in D1){k.filters.push(D1[i]);}}}}function W(i,j){l.processDataLossConfirmationIfNonDraft(function(){var k=i.data('SemanticObject');var x=i.data('Action');var D1=i.data('SemanticAttributes');if(k&&x){var E1={semanticObject:k,action:x};if(D1){D1="{"+D1+"}";E1.semanticAttributes=JSON.parse(D1);}L(E1);}},q.noop);}function X(k,x,D1,E1,F1){var G1="";var H1=function(k2){var l2=k2.dependent.propertyRef;var m2=x.originalId;var n2=C.getView().byId(m2);if(n2&&n2.mProperties.fieldName){for(var o2 in l2){if(l2[o2].name===n2.mProperties.fieldName){G1=n2.mProperties.fieldName;return true;}}}if(!n2){var p2=q("#"+m2.replace(/(:|\.|\[|\]|,|=)/g,"\\$1"));if(p2){n2=p2.control(0);if(n2&&n2.mProperties.fieldName){for(var o2 in l2){if(l2[o2].name===n2.mProperties.fieldName){G1=n2.mProperties.fieldName;return true;}}}}}return false;};var I1=function(){var J1,Q1,k2,l2,m2,n2,o2;Q1=k.getModel().getMetaModel();k2=Q1.getODataEntitySet(k.getEntitySet());l2=Q1.getODataEntityType(k2.entityType);if(!l2||!l2.navigationProperty){return;}for(var i=0;i<l2.navigationProperty.length;i++){m2=l2.navigationProperty[i];if(m2.name==="SiblingEntity"||m2.name==="DraftAdministrativeData"){continue;}var p2=m2.relationship;var q2=p2.lastIndexOf(".");var r2=p2.slice(0,q2);var s2=p2.slice(q2+1);var t2=Q1.getObject("/dataServices/schema");var u2;for(var j in t2){if(t2[j].namespace===r2){u2=t2[j];break;}}var v2=u2.association;var w2;for(var j in v2){if(v2[j].name===s2){w2=v2[j];break;}}var x2=w2.referentialConstraint;if(x2&&x2.dependent&&x2.dependent.propertyRef){var y2=H1(x2);if(y2){n2=Q1.getODataAssociationEnd(l2,m2.name);o2=Q1.getODataEntityType(n2.type);var z2=Q1.getODataEntityContainer();var A2="";var B2="";var C2="";for(var j=0;j<z2.entitySet.length;j++){var D2=o2.entityType;if(!D2){D2=o2.namespace+"."+o2.name;}if(z2.entitySet[j].entityType===D2){A2=z2.entitySet[j].name;B2=z2.entitySet[j].entityType;break;}}J1={navigation:m2.name,entitySet:A2,entityType:B2};if(o2["com.sap.vocabularies.UI.v1.HeaderInfo"]&&B2){var C2=Q1.getODataEntityType(B2,true)+"/com.sap.vocabularies.UI.v1.HeaderInfo";J1.headerInfoPath=C2;}if(o2["com.sap.vocabularies.UI.v1.QuickViewFacets"]&&B2){var E2=Q1.getODataEntityType(B2,true)+"/com.sap.vocabularies.UI.v1.QuickViewFacets";J1.quickViewFacetODataPath=E2;}return J1;}}}return J1;};var J1=I1();var K1=false;var L1=false;var M1=false;var N1=[];var O1=C.getOwnerComponent();var P1=O1.getModel();var Q1=P1.getMetaModel();if(J1){if(J1.quickViewFacetODataPath){var R1=Q1.createBindingContext(J1.quickViewFacetODataPath,true);var S1=R1&&R1.getModel().getObject(R1.getPath());if(S1){K1=true;for(var j=0;j<S1.length;j++){var T1=S1[j];if(T1&&T1.Target&&T1.Target.AnnotationPath){if(T1.Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")>-1){L1=true;}else if(T1.Target.AnnotationPath.indexOf("com.sap.vocabularies.Communication.v1.Contact")>-1){M1=true;N1.push(T1);}}}}}}if(K1){var U1,V1;U1=Q1.getODataEntitySet(k.getEntitySet());V1=Q1.getODataEntityType(U1.entityType);var W1=J1.headerInfoPath&&Q1.createBindingContext(J1.headerInfoPath,true);var F1=x.mainNavigation;var X1=x.semanticObject;var Y1,Z1;if(X1&&F1){var $1=F1.getTarget&&F1.getTarget()||"";var _1=F1.getKey&&F1.getKey();if(_1){var a2=_1.split(X1+"-");Y1=a2&&a2[1];if(X1&&Y1){Z1={"Target":$1,"SemanticObject":X1,"Action":Y1};}if(x.semanticAttributes){Z1.SemanticAttributes=x.semanticAttributes;for(var i in x.semanticAttributes){var b2=x.semanticAttributes[i];if(b2.indexOf("{\"__deferred\":")>-1){delete Z1.SemanticAttributes[i];}if(b2.indexOf("{\"__ref\":")>-1){delete Z1.SemanticAttributes[i];}}if(Z1.SemanticAttributes){var c2=JSON.stringify(Z1.SemanticAttributes);if(c2&&c2.length>1){Z1.SemanticAttributes=c2.substring(1,c2.length-1);}}}}}var d2=Q1.getODataProperty(V1,G1);var e2=k&&k.mProperties&&k.mProperties.fieldSemanticObjectMap;var f2=new J({sourceClickedField:d2,sourceEntityType:V1,showFieldGroup:L1,showContact:M1,ignoredFields:e2,navigationPath:J1.navigation,mainNavigation:Z1});f2.setDefaultBindingMode("OneWay");var g2={};g2.oState=D1;g2._templateEventHandlers={};g2._templateEventHandlers.onSemanticObjectLinkNavigationPressed=C._templateEventHandlers.onSemanticObjectLinkNavigationPressed.bind(C._templateEventHandlers);g2._templateEventHandlers.onDataFieldWithIntentBasedNavigation=C._templateEventHandlers.onDataFieldWithIntentBasedNavigation.bind(C._templateEventHandlers);g2.onInit=function(){};g2.onExit=function(){};g2.onAfterRendering=function(){var C=this;var h2=C.oView;var k2=h2.getParent().getParent().getParent();k2.setBusy(false);};g2.connectToView=C.connectToView.bind(g2);var h2=sap.ui.view({async:true,preprocessors:{xml:{bindingContexts:{sourceEntitySet:Q1.createBindingContext(Q1.getODataEntitySet(k.getEntitySet(),true)),entitySet:Q1.createBindingContext(Q1.getODataEntitySet(J1.entitySet,true)),header:W1,facetCollection:R1},models:{sourceEntitySet:Q1,entitySet:Q1,header:Q1,facetCollection:Q1,quickView:f2,parameter:o.getParameterModelForTemplating()}}},controller:g2,type:V.XML,viewName:"sap.suite.ui.generic.template.fragments.QuickViewSmartForm",height:"100%"});x.show(undefined,undefined,undefined,h2);var i2=function(k2){var l2=k2.getSource();if(l2){var m2=l2.getParent().getParent().getParent();m2.setBusy(true);m2.setBusyIndicatorDelay(10);}};h2.attachBeforeRendering(i2.bind(this));var j2=function(k2){var l2=k2.getSource();if(l2){var m2=l2.byId("ownTitleArea");if(m2){var n2=l2.getParent();if(n2&&n2.getItems){var o2=n2.getItems()&&n2.getItems()[0];if(o2&&o2!=l2){o2.setVisible(false);}}}if(M1&&N1&&m2){O(l2,N1);}}};h2.attachAfterRendering(j2.bind(this));}else{x.show(E1,F1,undefined,undefined);}}function Y(C,i){var x=C.getView&&C.getView().getBindingContext();var D1=x.getObject();var E1=C.getOwnerComponent().getModel().getMetaModel();var F1=E1.getODataEntitySet(C.getOwnerComponent().getEntitySet());var G1=E1.getODataEntityType(F1.entityType);var H1=G1["com.sap.vocabularies.Common.v1.SemanticKey"];var I1={};if(H1&&H1.length>0){for(var j=0;j<H1.length;j++){var J1=H1[j].PropertyPath;if(!I1[J1]){I1[J1]=[];I1[J1].push(D1[J1]);}}}else{for(var k in G1.key.propertyRef){var K1=G1.key.propertyRef[k].name;if(!I1[K1]){I1[K1]=[];I1[K1].push(D1[K1]);}}}return I1;}function Z(k,i,x,D1){if(k[i].entitySet==x&&D1===k[i].navigationProperty&&k[i].navigation&&k[i].navigation["display"]&&(k[i].component&&k[i].component.settings&&k[i].component.settings.hideChevronForUnauthorizedExtNav===true)){return k[i].navigation.display.target;}else if(k[i].entitySet==x&&k[i].navigation&&k[i].navigation["display"]&&(k[i].component&&k[i].component.settings&&k[i].component.settings.hideChevronForUnauthorizedExtNav===true)){return k[i].navigation.display.target;}else if(k[i].pages){for(var j=0;j<(k[i].pages.length);j++){var E1=Z(k[i].pages,j,x,D1);if(E1!==undefined&&E1!==null){return E1;}}}}function $(i){var j=i.getSource().getTable();var k=i.getSource().getEntitySet();var x=i.getSource().getTableBindingPath();var D1=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService&&sap.ushell.Container.getService("CrossApplicationNavigation");var E1=C.getOwnerComponent().getAppComponent().getConfig().pages;var F1=Z(E1,0,k,x);if(F1!==undefined&&F1!==null&&D1){var G1=C.getOwnerComponent().getAppComponent().getManifestEntry("sap.app").crossNavigation.outbounds[F1];if(G1){var H1=G1.semanticObject;var I1=G1.action;var J1=C.getView().getModel("_templPriv");var K1=J1.getProperty("/generic/supportedIntents/");var L1=(x==="")?k:k+"::"+x;var M1=J1.getProperty("/generic/supportedIntents/"+H1+"/"+I1+"/"+L1);if(!M1){var N1={},O1;var P1=C.getOwnerComponent().getAppComponent();for(var Q1 in G1.parameters){if(!q.isEmptyObject(G1.parameters[Q1])){N1[Q1]=G1.parameters[Q1];}}if(C.getMetadata().getName()==='sap.suite.ui.generic.template.ObjectPage.view.Details'){O1=Y(C,P1);}var R1={semanticObject:H1,action:I1};var S1=q.extend({},O1,N1);var T1={target:R1,params:S1};var U1=D1.isNavigationSupported([T1],P1);U1.done(function(V1){var W1=J1.getProperty("/generic/supportedIntents/"+H1);if(!W1){K1[H1]={};K1[H1][I1]={};K1[H1][I1][L1]={"supported":V1[0].supported};}else if(!W1[I1]){W1[I1]={};W1[I1][L1]={"supported":V1[0].supported};}else{W1[I1][L1]={"supported":V1[0].supported};}J1.updateBindings();if(V1[0].supported&&l.isUiTable(j)){var X1=j.getRowActionTemplate();X1.getItems()[0].setVisible(true);j.setRowActionTemplate(X1);}});}}}}function _(i){l.setEnabledToolbarButtons(i.getSource());$(i);}function a1(i,j){if(!o.isDraftEnabled()||!i){return;}var k=i.getControlByKey("EditState");var x=k&&k.getSelectedKey()||"";switch(x){case"1":j.filters.push(new F("IsActiveEntity","EQ",true));j.filters.push(new F("HasDraftEntity","EQ",false));break;case"2":j.filters.push(new F("IsActiveEntity","EQ",false));break;case"3":j.filters.push(new F("IsActiveEntity","EQ",true));j.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));j.filters.push(new F("DraftAdministrativeData/InProcessByUser","NE",""));break;case"4":j.filters.push(new F("IsActiveEntity","EQ",true));j.filters.push(new F("SiblingEntity/IsActiveEntity","EQ",null));j.filters.push(new F("DraftAdministrativeData/InProcessByUser","EQ",""));break;default:var D1=new F({filters:[new F("IsActiveEntity","EQ",false),new F("SiblingEntity/IsActiveEntity","EQ",null)],and:false});if(j.filters[0]&&j.filters[0].aFilters){var E1=j.filters[0];j.filters[0]=new F([E1,D1],true);}else{j.filters.push(D1);}break;}}function b1(i,j,k){var x,D1;if(i){D1=i.split(",");x=D1.length;while(x--){i=D1[x];if(i&&j.indexOf(i)<0){j.push(i);k.parameters.select+=","+i;}}}}function c1(D1,E1){var F1=D1.getSource();var G1=F1.getTable(),H1=function(B2){return B2.getMetadata().getName();};if(H1(G1)==="sap.m.Table"){var I1=G1.getColumns();for(var J1=0;J1<I1.length;J1++){if(I1[J1].getCustomData()[0].getValue()&&I1[J1].getCustomData()[0].getValue()["actionButton"]==="true"){I1[J1].setPopinDisplay("WithoutHeader");}}}var K1=D1.getParameter("bindingParams");K1.parameters=K1.parameters||{};if(F1.data().allowSearch){K1.parameters["custom"]={"search":D1.getSource().data().searchString};F1.data("allowSearch",false);}else if(F1.getBindingContext()&&F1.getBindingContext().getPath()===F1.data().objectPath){if(F1.getId()===F1.data().tableId){if(!!D1.getSource().data().searchString){K1.parameters["custom"]={"search":D1.getSource().data().searchString};}}}if(F1.data().allowSearchWorkListLight){K1.parameters["custom"]={"search":D1.getSource().data().searchString};F1.data("allowSearchWorkListLight",false);if(!!D1.getSource().data().searchString){K1.parameters["custom"]={"search":D1.getSource().data().searchString};}}var L1=C.byId(F1.getSmartFilterId());if(!L1&&C.getMetadata().getName()==='sap.suite.ui.generic.template.ListReport.view.ListReport'){L1=C.byId("listReportFilter");U(C,L1,K1);var M1=L1.getBasicSearchValue();if(!!M1){K1.parameters["custom"]={"search":M1};}}a1(L1,K1);r(F1.getEntitySet(),K1);var N1=K1.parameters.select&&K1.parameters.select.split(",")||[];var O1=K1.parameters&&K1.parameters.expand&&K1.parameters.expand.split(",")||[];var P1=F1.getEntitySet();if(N1&&N1.length>0){var Q1=F1.getModel().getMetaModel();var R1=Q1.getODataEntitySet(P1);var S1={};var T1=Q1.getODataEntityType(R1.entityType);for(var U1=0;U1<N1.length;U1++){var V1=N1[U1];if(V1){var S1=Q1.getODataProperty(T1,V1);if(S1&&S1["com.sap.vocabularies.Common.v1.FieldControl"]&&S1["com.sap.vocabularies.Common.v1.FieldControl"].Path){var W1=S1["com.sap.vocabularies.Common.v1.FieldControl"].Path;if(W1!==" "&&K1.parameters.select.search(W1)===-1){K1.parameters.select+=","+W1;N1.push(W1);}}}}if(H1(G1)==="sap.m.Table"){var X1=K1.sorter[0];if(X1&&X1.vGroup){var Y1=m.getODataProperty(Q1,T1,X1.sPath);var Z1=Y1["com.sap.vocabularies.Common.v1.Text"]&&Y1["com.sap.vocabularies.Common.v1.Text"].Path;if(Z1){if(q.inArray(Z1,N1)===-1){K1.parameters.select+=","+Z1;N1.push(Z1);}}}}var $1=R1["Org.OData.Capabilities.V1.DeleteRestrictions"];if($1&&$1.Deletable&&$1.Deletable.Path&&K1.parameters.select.search($1.Deletable.Path)===-1){K1.parameters.select+=","+$1.Deletable.Path;N1.push($1.Deletable.Path);}var _1=R1["Org.OData.Capabilities.V1.UpdateRestrictions"];if(_1&&_1.Updatable&&_1.Updatable.Path&&K1.parameters.select.search(_1.Updatable.Path)===-1){K1.parameters.select+=","+_1.Updatable.Path;N1.push(_1.Updatable.Path);}var a2,b2;var T1=Q1.getODataEntityType(R1.entityType);var c2=T1["com.sap.vocabularies.UI.v1.LineItem"]||[];var d2=T1["com.sap.vocabularies.UI.v1.LineItem"];var e2="com.sap.vocabularies.UI.v1.Criticality";var f2=F1.getCustomData();for(var x=0;x<f2.length;x++){if(f2[x].getKey()&&f2[x].getKey()==="lineItemQualifier"){var g2=f2[x].getValue();if(g2){d2=T1["com.sap.vocabularies.UI.v1.LineItem#"+g2];e2="com.sap.vocabularies.UI.v1.Criticality#"+g2;break;}}}if(d2&&e2&&d2[e2]&&d2[e2].Path){N1.push(d2[e2].Path);K1.parameters.select+=","+d2[e2].Path;}for(var U1=0;U1<c2.length;U1++){if(c2[U1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAction"){a2=Q1.getODataFunctionImport(c2[U1].Action.String,true);if(a2){b2=Q1.getObject(a2);if(b2["sap:action-for"]!==" "&&b2["sap:applicable-path"]!==" "&&K1.parameters.select.search(b2["sap:applicable-path"])===-1){K1.parameters.select+=","+b2["sap:applicable-path"];N1.push(b2["sap:applicable-path"]);}}}if(c2[U1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"||c2[U1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"){var h2,i2;if(c2[U1].Value&&c2[U1].Value.Path){h2=Q1.getODataProperty(T1,c2[U1].Value.Path);if(h2){i2=h2["sap:text"]||(h2["com.sap.vocabularies.Common.v1.Text"]||"").Path||"";}if(!i2){i2=c2[U1].Value.Path;}if(N1.indexOf(i2)===-1){N1.push(i2);K1.parameters.select=K1.parameters.select+","+i2;}}}if(c2[U1].RecordType==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){if(c2[U1].Target&&c2[U1].Target.AnnotationPath){var j2=c2[U1].Target.AnnotationPath;var k2=j2.split("@")[1];var l2=T1[k2];if(l2&&l2.MeasureAttributes){if(l2.MeasureAttributes[0]&&l2.MeasureAttributes[0].DataPoint&&l2.MeasureAttributes[0].DataPoint.AnnotationPath){var m2=l2.MeasureAttributes[0].DataPoint.AnnotationPath.split("@")[1];var n2=T1[m2];if(n2){for(var o2 in n2){if(n2[o2]&&n2[o2].Path&&N1.indexOf(n2[o2].Path)===-1){K1.parameters.select=K1.parameters.select+","+n2[o2].Path;N1.push(n2[o2].Path);}if(o2==="CriticalityCalculation"&&n2.CriticalityCalculation){for(var p2 in n2.CriticalityCalculation){if(n2.CriticalityCalculation[p2].Path&&N1.indexOf(n2.CriticalityCalculation[p2].Path)===-1){K1.parameters.select=K1.parameters.select+","+n2.CriticalityCalculation[p2].Path;N1.push(n2.CriticalityCalculation[p2].Path);}}}}}}}if(l2&&l2.Measures){if(l2.Measures[0]&&l2.Measures[0].PropertyPath&&N1.indexOf(l2.Measures[0].PropertyPath)===-1){K1.parameters.select=K1.parameters.select+","+l2.Measures[0].PropertyPath;N1.push(l2.Measures[0].PropertyPath);}}}}}var q2=l.getBreakoutActions(F1);for(var r2 in q2){if(q2[r2].requiresSelection&&q2[r2].applicablePath){if(K1.parameters.select.search(q2[r2].applicablePath)===-1){K1.parameters.select+=","+q2[r2].applicablePath;N1.push(q2[r2].applicablePath);}}}}Q(N1,O1);var s2=s.oDraftController.getDraftContext();if(s2.isDraftEnabled(P1)&&s2.isDraftRoot(P1)){if(s2.hasDraftAdministrativeData(P1)){if(N1&&N1.length>0){if(N1.indexOf("DraftAdministrativeData")===-1){N1.push("DraftAdministrativeData");K1.parameters.select=K1.parameters.select+",DraftAdministrativeData";}}if(O1.indexOf("DraftAdministrativeData")===-1){O1.push("DraftAdministrativeData");}}}if(O1.length>0){K1.parameters.expand=O1.join(",");}var t2=F1.getCustomData();var u2={};for(var k=0;k<t2.length;k++){u2[t2[k].getKey()]=t2[k].getValue();}var v2=F1.fetchVariant();if(!u2.TemplateSortOrder&&E1&&E1.determineSortOrder){u2.TemplateSortOrder=E1.determineSortOrder();}if((!v2||!v2.sort)&&(H1(G1)==="sap.m.Table")&&u2.TemplateSortOrder){var w2=u2.TemplateSortOrder.split(", ");for(var j=0;j<w2.length;j++){var x2=w2[j].split(" ");if(x2.length>1){K1.sorter.push(new b(x2[0],x2[1]==="true"));}else{K1.sorter.push(new b(x2[0]));}}}if(H1(G1)==="sap.m.Table"){var X1=K1.sorter[0];if(X1&&X1.vGroup){var y2;var z2=null;for(var i=0;i<I1.length;i++){if(I1[i].data("p13nData").leadingProperty===X1.sPath){z2=I1[i];break;}}if(z2){var y2=z2.getHeader().getProperty("text");X1.fnGroup=G(X1.sPath,y2);var A2=z2.data("p13nData").additionalProperty;b1(A2,N1,K1);}}}}function d1(i,j,k){k=k||i.getBindingContext();l.processDataLossConfirmationIfNonDraft(function(){if(i.data("CrossNavigation")){P(i,k,j.oSmartFilterbar);return;}var x=l.getOwnerControl(i);p(i);l.navigateFromListItem(k,x);},q.noop,j);}function e1(i){s.oApplication.performAfterSideEffectExecution(function(){if(s.oApplication.getBusyHelper().isBusy()){q.sap.log.info("Ignore incorrect selection, since app is busy anyway");return;}var j=i?"ST_GENERIC_MULTIPLE_ITEMS_SELECTED":"ST_GENERIC_NO_ITEM_SELECTED";M.error(l.getText(j),{styleClass:l.getContentDensityClass()});});}function f1(i,j){var k=i.getParent().getParent().getTable();var x=l.getSelectedContexts(k);if(x.length===1){l.processDataLossConfirmationIfNonDraft(function(){if(i.data("CrossNavigation")){P(i,x[0],j.oSmartFilterbar);return;}p(i);l.navigateFromListItem(x[0],k);},q.noop,j);}else{e1(x.length);}}function g1(j){var k,i,x;var D1=C.getOwnerComponent(),E1=D1.getAppComponent().getConfig(),F1=j.getSource().getCustomData();if(E1.settings&&E1.settings.flexibleColumnLayout){M.error(l.getText("ST_NAV_ERROR_NO_COMBINATION_WITH_FCL"),{styleClass:l.getContentDensityClass()});return;}if(F1.length===0){return;}for(i=0,x=F1.length;i<x;i++){if(F1[i].getProperty("key")==="Target"){k=F1[i].getProperty("value");break;}}if(!k){M.error(l.getText("ST_NAV_ERROR_NAV_PROPERTY_NOT_DETERMINED"),{styleClass:l.getContentDensityClass()});return;}var G1=D1.getModel(),H1=G1.getMetaModel();var I1=j.getSource().getBindingContext().getPath(),J1=I1.slice(1,I1.indexOf("(")),K1=H1.getODataEntityType(H1.getODataEntitySet(J1).entityType);var L1=H1.getODataAssociationEnd(K1,k),M1=H1.getODataEntityType(L1.type),N1,O1;if(M1){N1=M1.namespace+"."+M1.name;}var P1=H1.getODataEntityContainer().entitySet;for(i=0,x=P1.length;i<x;i++){if(P1[i].entityType===N1){O1=P1[i].name;break;}}if(!O1){M.error(l.getText("ST_NAV_ERROR_TARGET_ENTITYSET_NOT_DETERMINED"),{styleClass:l.getContentDensityClass()});return;}var Q1=l.getNavigationKeyProperties(O1),R1=s.oNavigationController,S1;if(o.isDraftEnabled()){S1={"$expand":"DraftAdministrativeData"};}else{S1={"$expand":""};}G1.read(I1+"/"+k,{urlParameters:S1,success:function(T1){var U1=l.mergeNavigationKeyPropertiesWithValues(Q1,T1);R1.navigateToContext(U1,null,false);},error:function(T1){M.error(l.getText("ST_NAV_ERROR_MODEL_READ_FAILED"),{styleClass:l.getContentDensityClass()});return;}});}function h1(i,j){var k=i.getSource();var x=l.getOwnerControl(k);var D1=l.getSelectedContexts(x);if(D1.length>1){e1(D1.length);}else{l.processDataLossConfirmationIfNonDraft(function(){var E1={action:k.data("Action"),semanticObject:k.data("SemanticObject")};K(E1,D1[0],j.oSmartFilterbar||undefined,j.oSmartTable||undefined);},q.noop,j);}}function i1(i,j){var k=i.getSource();var x=k.getParent().getBindingContext();var D1=k.data("SemanticObject");var E1=k.data("Action");l.processDataLossConfirmationIfNonDraft(function(){var F1={action:E1,semanticObject:D1};K(F1,x,j.oSmartFilterbar||undefined,j.oSmartTable||undefined);},q.noop,j);}function j1(i,j,k){l.processDataLossConfirmationIfNonDraft(function(){var x={action:j.Action,semanticObject:j.SemanticObject};K(x,i,k.oSmartFilterbar,k.oSmartTable);},q.noop,k);}function k1(i,j,k){var x=l.getElementCustomData(i);var D1=l.getSelectedContexts(j);var E1=!(x.RequiresContext&&x.RequiresContext==="false");if(E1&&D1.length!==1){e1(D1.length);}else{var F1=E1?D1[0]:null;j1(F1,x,k);}}function l1(i,j){l.processDataLossConfirmationIfNonDraft(function(){var k={semanticObject:i.data("SemanticObject"),action:i.data("Action")};var x=i.getParent().getBindingContext();K(k,x,j.oSmartFilterbar,j.oSmartTable);},q.noop,j);}function m1(i,j){var k=i.getSource();var x=l.getOwnerControl(k).getParent();var D1=[k.getBindingContext()];var E1=l.getElementCustomData(k);var F1=x.getTableBindingPath();l.triggerAction(D1,F1,E1,x,j);}function n1(i,j){var k=C.getView();var x=j?l.getSelectedContexts(j):[k.getBindingContext()];if(x.length===0){e1(x.length);}else{var D1=i.getSource();var E1=l.getElementCustomData(D1);var F1=j?j.getTableBindingPath():k.getBindingPath();l.triggerAction(x,F1,E1,j);}}function o1(i,j){var k,x="";var D1=l.getOwnerControl(i.getSource());var E1=i.getSource().data();var F1=l.getSelectedContexts(D1);if(l.isSmartTable(D1)){k=D1.getTable();x=D1.getTableBindingPath();}else if(l.isSmartChart(D1)){k=D1.getChart();x=D1.getChartBindingPath();}var G1=q1(F1,E1);if(G1.inApplicableCount>0&&(l.isSmartTable(D1)&&((k.getMode&&k.getMode()==="MultiSelect")||(k.getSelectionMode&&k.getSelectionMode()==="MultiToggle")))){var H1=l.getText("ST_GENERIC_WARNING_TEXT",[G1.inApplicableCount]);G1.warningText=H1;var I1={functionImportPath:E1.Action,contexts:G1.aApplicableContexts,sourceControl:k,label:E1.Label,operationGrouping:E1.InvocationGrouping,navigationProperty:"",sBindingPath:x,oState:j};var J1=p1(D1);var K1=J1.getModel("Action");K1.setData(I1);var L1=new sap.ui.model.json.JSONModel(G1);J1.setModel(L1,"list");var M1=J1.getModel("list");M1.setData(G1);J1.open();}else{r1({functionImportPath:E1.Action,contexts:F1,sourceControl:k,label:E1.Label,operationGrouping:E1.InvocationGrouping,navigationProperty:""},j,x);}}function p1(i){return l.getDialogFragment("sap.suite.ui.generic.template.fragments.ActionConfirmation",{onCancel:function(j){var k=j.getSource().getParent();k.close();},onContinue:function(j){var k=j.getSource().getParent();var x=j.getSource().getParent().getModel("Action").getData();r1({functionImportPath:x.functionImportPath,contexts:x.contexts,sourceControl:x.sourceControl,label:x.label,operationGrouping:x.operationGrouping,navigationProperty:x.navigationProperty},x.oState,x.sBindingPath);k.close();}},"Action");}function q1(j,k){var x,D1,E1,F1;var G1=C.getView().getModel();var H1=G1.getMetaModel();if(j&&j.length>0){E1=j[0].sPath.substring(1,j[0].sPath.indexOf('('));F1=H1.getODataEntitySet(E1);}if(F1){var I1=k.Action.split("/")[1];var J1=[],K1=[];var L1={aInApplicableItems:undefined,inApplicableCount:0,dialogTitle:k.Label,warningText:undefined,aApplicableContexts:undefined};if(I1){D1=H1.getODataFunctionImport(I1)["sap:applicable-path"];}for(var i=0;i<j.length;i++){x=G1.getObject(j[i].getPath());if(!x[D1]){L1.inApplicableCount++;var M1=H1.getODataEntityType(H1.getODataEntitySet(E1).entityType);var N1=M1["com.sap.vocabularies.UI.v1.HeaderInfo"].Title.Value;var O1="";if(N1.Path){O1=j[i].getProperty(N1.Path);}else{O1=N1.String||"";}J1.push({sKey:O1});}else{K1.push(j[i]);}}L1.aInApplicableItems=J1;L1.aApplicableContexts=K1;}return L1;}function r1(i,j,k){var x;l.processDataLossConfirmationIfNonDraft(function(){s.oCRUDManager.callAction({functionImportPath:i.functionImportPath,contexts:i.contexts,sourceControl:i.sourceControl,label:i.label,operationGrouping:i.operationGrouping,navigationProperty:i.navigationProperty},j).then(function(D1){if(D1&&D1.length&&D1.length===1){x=D1[0];if(x.response&&x.response.context&&(!x.actionContext||x.actionContext&&x.response.context.getPath()!==x.actionContext.getPath())){s.oViewDependencyHelper.setMeToDirty(C.getOwnerComponent(),k);}}});},q.noop,j,"Proceed");}var s1;var t1;function u1(i){s1=true;t1=i;var j=l.getDialogFragment("sap.suite.ui.generic.template.fragments.DiscardDraftPopover",{onDiscardConfirm:function(){q.sap.log.info("Draft cancellation confirmed");if(!s1){q.sap.log.info("Draft popover no longer active -> Ignore.");return;}t1();}},"discard");return j;}function v1(i,j){var k=new Promise(function(D1,E1){i.then(function(F1){q.sap.log.info("Active information for current draft has been read. Start discarding the draft");var G1=F1&&F1.getObject();var H1=G1&&G1.IsActiveEntity;var I1=H1?s.oApplication.getTargetAfterCancelPromise(F1):Promise.resolve();I1.then(function(J1){var K1=s.oCRUDManager.deleteEntity(false,true);if(!J1){s.oApplication.prepareDeletionOfCreateDraft(K1);}K1.then(function(){q.sap.log.info("Draft was discarded successfully");j();s.oViewDependencyHelper.setRootPageToDirty();s.oViewDependencyHelper.unbindChildren(C.getOwnerComponent());if(J1){q.sap.log.info("Navigate to active entityy");s.oNavigationController.navigateToContext(J1,null,true,1);}D1();},E1);},E1);},E1);});var x={discardPromise:k};o.fire(C,"AfterCancel",x);s.oApplication.getBusyHelper().setBusy(k);k.catch(j);return k;}function w1(i){var j=n();s.oApplication.performAfterSideEffectExecution(function(){if(s.oApplication.getBusyHelper().isBusy()){q.sap.log.info("Ignore discarding confirmation as app is already busy");return;}var k=C.getView().getBindingContext();var x=k.getObject();var D1=x.hasOwnProperty("HasActiveEntity")&&!k.getProperty("IsActiveEntity")&&!k.getProperty("HasActiveEntity");var E1=k&&k.getPath();var F1=s.oApplication.getIsDraftModified(E1);if(F1){var G1=i.getSource();var H1;var I1=function(){s1=false;H1.close();q.sap.log.info("Draft popover closed");};H1=u1(v1.bind(null,j,I1));var J1=H1.getModel("discard");J1.setProperty("/placement",sap.m.PlacementType.Top);J1.setProperty("/isCreateDraft",D1);H1.openBy(G1);}else{v1(j,q.noop);}});}function x1(){if(o.getViewLevel()!==1||!o.isDraftEnabled()){q.sap.log.warning("Discard draft only possible on root level of draft enabled entities");return Promise.reject();}var i=C.getOwnerComponent();if(!(o.isComponentActive()&&i.getModel("ui").getProperty("/editable"))){q.sap.log.warning("Discard draft only possible in edit mode");return Promise.reject();}var j=n();return v1(j,q.noop);}function y1(i,j,k){if(i.data("CrossNavigation")){P(i,i.getBindingContext(),k);return new Promise(function(H1){H1();});}var x=l.getOwnerControl(i);var D1=x.getTableBindingPath();var E1=C.getOwnerComponent();var F1={}||(k&&C.getPredefinedValuesForCreateExtension(k));var G1=function(H1){var I1=s.oCRUDManager.addEntry(x,H1).then(function(J1){if(!j){s.oNavigationController.navigateToContext(J1.newContext,J1.tableBindingPath,false,4);s.oApplication.getBusyHelper().getUnbusy().then(s.oViewDependencyHelper.setMeToDirty.bind(null,E1,D1));}else{l.refreshSmartTable(x);s.oApplicationController.executeSideEffects(E1.getBindingContext(),[],[D1]);}});I1.catch(q.noop);return I1;};if(F1 instanceof Promise){return F1.then(G1);}else{return G1(F1);}}function z1(i){var j=l.getOwnerControl(i.getSource());var k=l.getSelectedContexts(j);if(k&&k.length>0){var x=z(k);var D1=w(j);var E1=D1.getModel("delete");x.then(function(x){E1.setData(x.mJSONData);D1.open();});}else{M.error(l.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:l.getContentDensityClass()});}}function A1(i){var j;if(i.getSource().data("Location")==="Header"){j=i.getSource().getParent().getAggregation("items")[0];}else if(i.getSource().data("Location")==="Section"){j=i.getSource().getParent().getElements()[1];}else if(i.getSource().data("Location")==="SmartTable"){j=i.getSource().getParent().getAggregation("items")[0];}else{j=i.getSource().getParent().getParent().getParent().getParent().getParent().getAggregation("items")[1];}j.bindElement(i.getSource().getBindingContext().getPath());j.openBy(i.getSource());}function B1(i){var j=i.getSource();var k=i.getParameter("bindingParams");k.parameters=k.parameters||{};var x=C.byId("listReportFilter");U(C,x,k);C1(i,j,k);}function C1(i,j,k){var x=C.byId("listReportFilter");a1(x,k);var D1=j.getEntitySet();r(D1,k);}var I=t.testable(I,"fnBuildSelectionVariantForNavigation");var E=t.testable(E,"fnEvaluateParameters");var K=t.testable(K,"fnNavigateIntent");var O=t.testable(O,"fnHideTitleArea");return{onDataReceived:_,onBeforeRebindTable:c1,onListNavigate:d1,onShowDetails:f1,onEditNavigateIntent:P,onSemanticObjectLinkPopoverLinkPressed:R,onDataFieldWithNavigationPath:g1,onDataFieldForIntentBasedNavigation:h1,onDeterminingDataFieldForIntentBasedNavigation:k1,onDeterminingDataFieldForAction:n1,onInlineDataFieldForIntentBasedNavigation:l1,onDataFieldWithIntentBasedNavigation:i1,onInlineDataFieldForAction:m1,onSmartFieldUrlPressed:u,onBreadCrumbUrlPressed:v,onCallActionFromToolBar:o1,onDiscardDraft:w1,discardDraftWithoutDialog:x1,addEntry:y1,deleteEntries:z1,onContactDetails:A1,onSemanticObjectLinkNavigationTargetObtained:X,onSemanticObjectLinkNavigationPressed:W,onBeforeRebindChart:B1};}return B.extend("sap.suite.ui.generic.template.lib.CommonEventHandlers",{constructor:function(C,o,s,i){q.extend(this,h(C,o,s,i));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.NavigationController')){
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.suite.ui.generic.template.lib.NavigationController');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.core.ComponentContainer');jQuery.sap.require('sap.ui.core.routing.HashChanger');jQuery.sap.require('sap.ui.core.routing.History');jQuery.sap.require('sap.ui.core.routing.HistoryDirection');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.MessagePage');jQuery.sap.require('sap.m.Link');sap.ui.define("sap/suite/ui/generic/template/lib/NavigationController",["jquery.sap.global","sap/ui/base/Object","sap/ui/core/ComponentContainer","sap/ui/core/routing/HashChanger","sap/ui/core/routing/History","sap/ui/core/routing/HistoryDirection","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/MessageBox","sap/m/MessagePage","sap/m/Link","sap/suite/ui/generic/template/lib/ProcessObserver","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/TemplateComponent","sap/suite/ui/generic/template/lib/testableHelper"],function(q,B,C,H,a,b,F,c,M,d,L,P,r,T,t){"use strict";var h=a.getInstance();function n(s){if(s.indexOf("/")===0){return s;}return"/"+s;}function f(o,R,i){var s=R.template;var E=R.entitySet;var v=R.viewLevel;var O=-1;if(o.oFlexibleColumnLayoutHandler){O=v<3?v:0;}var j=O<0?o.oNavigationObserver:o.aNavigationObservers[O];var k=new P();var m=O<0?o.oHeaderLoadingObserver:o.aHeaderLoadingObservers[O];m.addObserver(k);var p={};var S={appComponent:o.oAppComponent,isLeaf:!R.pages||!R.pages.length,entitySet:E,navigationProperty:R.navigationProperty,componentData:{registryEntry:{componentCreateResolve:i,route:R.name,routeConfig:R,viewLevel:v,routingSpec:R.routingSpec,oNavigationObserver:j,oHeaderLoadingObserver:k,preprocessorsData:p}}};if(R.component.settings){q.extend(S,R.component.settings);}var u;o.oAppComponent.runAsOwner(function(){try{var w=sap.ui.component({name:s,settings:S,handleValidation:true,async:true});var x;u=new C({propagateModel:true,width:"100%",height:"100%",settings:S});x=w.then(function(y){u.setComponent(y);return u;});u.loaded=function(){return x;};}catch(e){throw new Error("Component "+s+" could not be loaded");}});return u;}function g(o,e){t.testable(f,"fnCreateComponentInstance");var m={};var p={iHashChangeCount:0,backTarget:0};var s=[];var A=Promise.resolve();var u=[];var v=[];var w=[];function G(){var i=e.oRouter,j=i.getTargets()._mTargets,k=[];Object.keys(j).forEach(function(z1){var A1=j[z1],B1=A1._oOptions,C1=i.getRoute(B1.viewName),D1=C1&&C1._oConfig;if(D1&&(!D1.navigation||!D1.navigation.display)){k.push({oConfig:D1});}});return k;}t.testable(G,"fnGetAllPages");function x(i){var j=i||G();if(!Array.isArray(j)){j=[j];}j.forEach(function(k){k.oComponentContainer=f(o,k.oConfig,function(){});});return j;}t.testable(x,"fnCreatePages");function y(){var i=e.oRouter.getViews();i.getView({viewName:"root"});return o.mRouteToTemplateComponentPromise.root;}function z(){return e.oAppComponent.getManifestEntry("sap.app").title;}function D(){return p.iHashChangeCount;}function E(i,j,k){var z1=function(D1){q.extend(j,D1);};for(var A1 in o.componentRegistry){var B1=o.componentRegistry[A1];if(B1.route===i){var C1=B1.methods.getUrlParameterInfo;return C1?C1(k).then(z1):Promise.resolve();}}return Promise.resolve();}function I(j,k){var z1=k?E("root",j):Promise.resolve();return z1.then(function(){var A1="";var B1="";for(var C1 in j){var D1=j[C1];for(var i=0;i<D1.length;i++){var E1=D1[i];B1=B1+A1+C1+"="+E1;A1="&";}}return B1;});}function J(i,j){var z1=location.hash.split("&")[0]+"&/";for(var k=0;k<j;k++){z1=z1+i[k];if(k<(j-1)){z1=z1+"/";}}return z1;}function K(j){for(var i=0;i<j.length;i++){if(j[i].title!==u[j.length-i-1]||""){j[i].subtitle=u[j.length-i-1]||"";}}v=j;o.oShellServicePromise.then(function(k){k.setHierarchy(j);});}function S(i,j){u[i]=j;var k=v[v.length-i-1];if(k){if(k.title!==j){k.subtitle=j;}o.oShellServicePromise.then(function(z1){z1.setHierarchy(v);});}}function O(i,j,k){var z1=j.headerTitle;var A1=j.titleIconUrl;var B1=o.oFlexibleColumnLayoutHandler.getFullscreenLayout(j.level);var C1=J(k,j.level)+"?"+"FCLLayout="+B1;var D1={title:z1,icon:A1,intent:C1};var E1=o.oTemplatePrivateGlobalModel.getProperty("/generic/FCL/isVisuallyFullScreen");if(j.level<3&&!E1){i.push(D1);}}var Q;function R(){var i,k,z1,A1;var B1=o.oApplicationProxy.getHierarchySectionsFromCurrentHash();if(Q&&Q instanceof T){var C1=Q.getProperty("entitySet");A1=e.oTemplateContract.mEntityTree[C1];}else{return;}var D1=[];var E1,F1;if(o.oFlexibleColumnLayoutHandler){E1=A1;}if(B1.length>0){if(o.oFlexibleColumnLayoutHandler){O(D1,E1,B1);}for(var j=0;j<B1.length-1;j++){if(A1.parent){var G1=e.oTemplateContract.mEntityTree[A1.parent];if(o.oFlexibleColumnLayoutHandler){F1=J(B1,G1.level)+"?"+"FCLLayout="+o.oFlexibleColumnLayoutHandler.getFullscreenLayout(G1.level);}else{F1=J(B1,G1.level);}i=G1.headerTitle;z1=G1.titleIconUrl;A1=G1;}else{if(o.oFlexibleColumnLayoutHandler){F1=J(B1,A1.level)+"?"+"FCLLayout="+o.oFlexibleColumnLayoutHandler.getFullscreenLayout(A1.level);}else{F1=J(B1,A1.level);}i=e.oTemplateContract.mEntityTree[A1.entitySet].headerTitle;z1=e.oTemplateContract.mEntityTree[A1.entitySet].titleIconUrl;}k={title:i,icon:z1,intent:F1};D1.push(k);}k={title:z()};k.intent=location.hash.split("&")[0];if(o.oFlexibleColumnLayoutHandler&&o.oFlexibleColumnLayoutHandler.isListAndFirstEntryLoadedOnStartup()){k.intent=k.intent+"&/?"+"FCLLayout="+o.oFlexibleColumnLayoutHandler.getFullscreenLayout(0);}I({},true).then(function(H1){if(H1){if(o.oFlexibleColumnLayoutHandler&&o.oFlexibleColumnLayoutHandler.isListAndFirstEntryLoadedOnStartup()){k.intent=k.intent+"&"+H1;}else{k.intent=k.intent+"&/?"+H1;}}D1.push(k);K(D1);});}}function U(i,j){var k;if(!i&&j instanceof T){var z1=j&&o.componentRegistry[j.getId()];var A1=z1&&z1.methods.getTitle;k=A1&&A1();}else if(!i&&j&&j.title){k=j.title;}k=k||z();Q=j;o.oShellServicePromise.then(function(B1){B1.setTitle(k);R();});}function V(j,k){var z1;var A1=[];for(var i=0;i<=k;i++){var B1=j[i];if(B1){if(z1){A1.push(B1);}else{z1=B1;}}}if(z1){z1.resume(A1);}}function W(i){var j=[o.oPagesDataLoadedObserver.getProcessFinished(true)];var k=null;var z1=p.iHashChangeCount;var A1=-1;var B1={};for(var C1 in o.componentRegistry){var D1=o.componentRegistry[C1];var E1=D1.oControllerRegistryEntry&&D1.oControllerRegistryEntry.oTemplateUtils.oServices.oTemplateCapabilities.oMessageButtonHelper;var F1=D1.activationTakt===z1;var G1=D1.utils.getTemplatePrivateModel();G1.setProperty("/generic/isActive",F1);if(F1){j.push(D1.oViewRenderedPromise);if(D1.viewLevel>A1){A1=D1.viewLevel;k=D1.oComponent;}B1[D1.viewLevel]=E1;}else{D1.utils.suspendBinding();if(E1){E1.suspend();}}}V(B1,A1);var H1=o.oFlexibleColumnLayoutHandler&&o.oFlexibleColumnLayoutHandler.isAppTitlePrefered();U(H1,i||k);Promise.all(j).then(function(){if(z1===p.iHashChangeCount&&q.isEmptyObject(m)){o.oAppComponent.firePageDataLoaded();}});}var X=W.bind(null,null);function Y(){q.sap.log.info("Navigate back");if(p.backTarget&&n(h.getPreviousHash()||"")!==n(p.hash)){o.oBusyHelper.setBusyReason("HashChange",true);}p.LeaveByBack=true;window.history.back();}function Z(i,j){i=n(i||"");q.sap.log.info("Navigate to hash: "+i);if(i===p.hash){q.sap.log.info("Navigation suppressed since hash is the current hash");return;}o.oBusyHelper.setBusyReason("HashChange",true);p.targetHash=i;if(p.backTarget&&n(h.getPreviousHash()||"")===i){Y();return;}p.LeaveByReplace=j;if(j){e.oHashChanger.replaceHash(i);}else{e.oHashChanger.setHash(i);}}function $(i,j,k,z1){var A1=j.then(function(B1){if(B1){i=i+"?"+B1;}if(z1){p.backwardingInfo={backCount:z1.backCount,targetViewLevel:z1.targetViewLevel,targetHash:n(i)};Y();}else{Z(i,k);}return i;});o.oBusyHelper.setBusy(A1);return A1;}function _(i){var j=0;for(var k=p;k.oEvent;){var z1=k.oEvent.getParameter("config").viewLevel;if(z1===0){return j;}if(i&&j>0){return-1;}j++;k=s[k.backTarget];}return-1;}function a1(i,j,k){if(k===0){var z1=_(!i);return(z1>0)&&{backCount:z1,targetViewLevel:0};}var A1=s[p.backTarget];return A1&&A1.hash&&n(A1.hash.split("?")[0])===n(j)&&{backCount:1};}function b1(i){if(o.oFlexibleColumnLayoutHandler){o.oFlexibleColumnLayoutHandler.setStoredTargetLayoutToOneColumn();}g1("root","",0,i);}function c1(i){var j=o.mEntityTree[i.entitySet].sRouteName;var k=o.mRouteToTemplateComponentPromise[j];return[k];}function d1(j,k){var z1=p.iHashChangeCount;var A1=function(C1){var D1=o.componentRegistry[C1.getId()];(D1.methods.presetDisplayMode||q.noop)(k,z1===D1.activationTakt);};for(var i=0;i<j.length;i++){var B1=j[i];B1.then(A1);}}function e1(i){var j=i&&o.mEntityTree[i.entitySet];var k=j?j.level:1;return k;}function f1(j,k){var z1=o.oApplicationProxy.getHierarchySectionsFromCurrentHash();var A1=j;for(var i=k-2;i>=0;i--){A1=z1[i]+"/"+A1;}return"/"+A1;}function g1(i,j,k,z1){var A1={};var B1=new Promise(function(C1){E(i,A1,j).then(function(){var D1=o.oFlexibleColumnLayoutHandler?o.oFlexibleColumnLayoutHandler.getAppStateParStringForNavigation(k,A1):I(A1,false);var E1=a1(z1,j,k);$(j,D1,z1,E1).then(C1);});});o.oBusyHelper.setBusy(B1);return B1;}function h1(i,j,k,z1){var A1=f1(i,j);g1(k,A1,j,z1);}function i1(i,j,k,z1,A1){var B1;var C1,D1;var E1=[];if(typeof i==="string"){B1=i;D1=n(B1).split("/").length-1;}else{C1=r.determineNavigationPath(i,j);D1=e1(C1);B1=C1.path;E1=c1(C1);}if(B1){if(j){B1=f1(B1,D1);}d1(E1,z1||0);if(A1){var F1="";var G1="&";for(var H1 in A1){F1=F1+G1+H1+"="+A1[H1];G1="&";}if(F1){B1=B1+"?"+F1;}Z(B1,k);return Promise.resolve(B1);}else{var I1=C1&&o.mEntityTree[C1.entitySet].sRouteName;return g1(I1,B1,D1,k);}}}function j1(i,j,k,z1){return i1(i,j,k,z1);}function k1(i){var j=p.iHashChangeCount;p.iHashChangeCount++;s.push(null);if(i){for(var k in o.componentRegistry){var z1=o.componentRegistry[k];if(z1.activationTakt===j&&i[z1.viewLevel]){z1.activationTakt=p.iHashChangeCount;}}}return{iHashChangeCount:p.iHashChangeCount};}function l1(i){var j,k,z1,A1,B1,C1=null,D1,E1;if(i){j=i.entitySet;k=i.text;C1=i.icon;E1=i.description;}if(j){D1=o.oAppComponent.getModel().getMetaModel();if(D1){z1=D1.getODataEntitySet(j);A1=D1.getODataEntityType(z1.entityType);B1=A1["com.sap.vocabularies.UI.v1.HeaderInfo"];}if(B1&&B1.TypeImageUrl&&B1.TypeImageUrl.String){C1=B1.TypeImageUrl.String;}}o.oShellServicePromise.then(function(H1){if(H1.setBackNavigation){H1.setBackNavigation(undefined);}});o.oTemplatePrivateGlobalModel.setProperty("/generic/messagePage",{text:k,icon:C1,description:E1});var F1;if(e.oTemplateContract.oFlexibleColumnLayoutHandler){F1=e.oTemplateContract.oFlexibleColumnLayoutHandler.displayMessagePage(i);}else{var G1=e.oRouter.getTargets();G1.display("messagePage");}k1(F1);W(i);}function m1(){if(!q.isEmptyObject(m)){var j=null;for(var i=0;!j;i++){j=m[i];}m={};l1(j);}}function n1(i){if(e.oTemplateContract.oFlexibleColumnLayoutHandler){i.viewLevel=i.viewLevel||0;m[i.viewLevel]=i;var j=Promise.all([A,e.oTemplateContract.oPagesDataLoadedObserver.getProcessFinished(true)]);j.then(m1);return;}l1(i);}function o1(){var i=[];var j=p.iHashChangeCount;for(var k in o.componentRegistry){var z1=o.componentRegistry[k];if(z1.activationTakt===j){i.push(k);}}return i;}function p1(){var i=[];for(var j in o.componentRegistry){i.push(j);}return i;}function q1(i){return w.slice(0,i+1);}function r1(i,j,k){var z1=o.componentRegistry[k.getId()]||{};var A1=(z1.activationTakt===j.iHashChangeCount-1);z1.activationTakt=j.iHashChangeCount;var B1=k.onActivate(i,A1)||Promise.resolve();return Promise.all([B1,z1.viewRegisterd]);}function s1(i,j,k){return r1(i,j,k).then(X);}function t1(i,j,k){var z1={};if(j||k){var A1=i.getParameter("config").viewLevel;for(var B1=0;B1<A1;B1++){z1[B1]=o.oPaginatorInfo[B1];}}o.oPaginatorInfo=z1;}function u1(i){return o.oApplicationProxy.getAlternativeContextPromise(i);}function v1(i){if(o.oFlexibleColumnLayoutHandler){o.oFlexibleColumnLayoutHandler.handleBeforeRouteMatched(i);}}function w1(k,i){w=[""];for(var j=1;j<=i;j++){var z1="keys"+j;w.push(k[z1]);}}function x1(j){j=q.extend({},j);var k=j.getParameter("config").viewLevel;var z1=n(e.oHashChanger.getHash()||"");q.sap.log.info("Route matched with hash "+z1);var A1;if(p.backwardingInfo){A1=p;s.push(A1);var B1=A1.iHashChangeCount+1;p={iHashChangeCount:B1,forwardingInfo:{bIsProgrammatic:true,bIsBack:true,iHashChangeCount:B1,backCount:A1.backwardingInfo.backCount,targetHash:A1.backwardingInfo.targetHash,targetViewLevel:A1.backwardingInfo.targetViewLevel},backTarget:A1.backTarget};}if(p.forwardingInfo){if(p.forwardingInfo.backCount){p.backTarget=s[p.backTarget].backTarget;p.forwardingInfo.backCount--;if(p.forwardingInfo.backCount&&k!==p.forwardingInfo.targetViewLevel){p.hash=z1;Y();return;}delete p.forwardingInfo.backCount;}if(p.forwardingInfo.targetHash&&p.forwardingInfo.targetHash!==z1){p.hash=z1;var C1=p.forwardingInfo.targetHash;delete p.forwardingInfo.targetHash;Z(C1,true);return;}}var D1=false;for(var i=0;i<o.aStateChangers.length;i++){var E1=o.aStateChangers[i];if(E1.isStateChange(j)){D1=true;}}if(D1){p.hash=z1;R();return;}o.oTemplatePrivateGlobalModel.setProperty("/generic/routeLevel",k);var F1=p.forwardingInfo;delete p.forwardingInfo;if(!F1){F1={};var G1=p.iHashChangeCount;F1.iHashChangeCount=G1+1;F1.bIsProgrammatic=(z1===p.targetHash);F1.bIsBack=!!(p.LeaveByBack||(!F1.bIsProgrammatic&&(h.getDirection()===b.Backwards)));p.LeaveByBack=F1.bIsBack;p.LeaveByReplace=F1.bIsProgrammatic&&p.LeaveByReplace;A1=p;s.push(A1);p={iHashChangeCount:F1.iHashChangeCount};if(A1.LeaveByReplace){p.backTarget=A1.backTarget;}else if(F1.bIsBack){p.backTarget=s[A1.backTarget].backTarget;}else{p.backTarget=G1;}}p.oEvent=j;p.hash=z1;var H1=j.getParameter("config");var I1=r.determinePath(H1,j);var J1=k<2?I1:r.determinePath(H1,j,o.routeViewLevel1.pattern);u1(J1).then(function(K1){var L1=j.getParameter("arguments");if(K1){var M1=L1["?query"];p.forwardingInfo=F1;i1(K1.context,null,true,K1.iDisplayMode,M1||{});return;}w1(L1,k);K([]);t1(j,F1.bIsProgrammatic,F1.bIsBack);if(o.oFlexibleColumnLayoutHandler){A=o.oFlexibleColumnLayoutHandler.handleRouteMatched(j,H1,I1,F1);}else{if(H1.viewLevel===0||!(F1.bIsProgrammatic||F1.bIsBack)){o.oApplicationProxy.setEditableNDC(false);}var N1=H1.target;var O1=o.mRouteToTemplateComponentPromise[N1];A=new Promise(function(P1,Q1){O1.then(function(R1){s1(I1,F1,R1).then(P1,Q1);});});}A.then(o.oBusyHelper.setBusyReason.bind(null,"HashChange",false),q.noop);});}function y1(){n1({title:o.getText("ST_ERROR"),text:o.getText("ST_GENERIC_UNKNOWN_NAVIGATION_TARGET"),description:""});}if(o.sRoutingType==="f"){e.oRouter.attachBeforeRouteMatched(v1);}e.oRouter.attachRouteMatched(x1);e.oRouter.attachBypassed(y1);e.navigate=Z;e.navigateToParStringPromise=$;e.activateOneComponent=r1;e.afterActivation=X;e.addUrlParameterInfoForRoute=E;e.getParStringPromise=I;e.performPseudoHashChange=k1;e.getActiveComponents=o1;e.getAllComponents=p1;e.getRootComponentPromise=y;e.getCurrenActivationTakt=D;e.getCurrentKeys=q1;e.getTargetLevel=e1;e.getAppTitle=z;e.subTitleForViewLevelChanged=S;e.navigateToSuffix=h1;return{navigateToRoot:b1,navigateToContext:j1,navigateToMessagePage:n1,navigateBack:Y};}function l(o,e){var i={oAppComponent:e.oAppComponent,oRouter:e.oAppComponent.getRouter(),oTemplateContract:e,oHashChanger:H.getInstance(),mRouteToComponentResolve:{}};e.oNavigationControllerProxy=i;var j=new Promise(function(R){i.fnInitializationResolve=R;});e.oBusyHelper.setBusy(j);q.extend(o,g(e,i));q.extend(i,o);var v={};i.oRouter._oViews._getViewWithGlobalId=function(V){if(!v[V.viewName]){var R=i.oRouter.getRoute(V.viewName);var k;if(R&&R._oConfig){k=f(e,R._oConfig,i.mRouteToComponentResolve[V.viewName]);}else{k=sap.ui.view({viewName:V.viewName,type:V.type,height:"100%"});}v[V.viewName]=k;if(V.viewName==="root"){e.rootContainer=k;}}return v[V.viewName];};r.startupRouter(i);}var N=B.extend("sap.suite.ui.generic.template.lib.NavigationController",{metadata:{library:"sap.suite.ui.generic.template"},constructor:function(o){B.apply(this,arguments);t.testableStatic(l,"NavigationController")(this,o);}});N._sChanges="Changes";return N;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.TemplateAssembler')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.TemplateAssembler');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.mvc.View');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.resource.ResourceModel');sap.ui.define("sap/suite/ui/generic/template/lib/TemplateAssembler",["jquery.sap.global","sap/ui/core/mvc/View","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/suite/ui/generic/template/lib/TemplateViewController","sap/suite/ui/generic/template/lib/TemplateComponent","sap/suite/ui/generic/template/lib/Application","sap/suite/ui/generic/template/lib/CRUDManager","sap/suite/ui/generic/template/lib/CommonUtils","sap/suite/ui/generic/template/lib/ComponentUtils","sap/suite/ui/generic/template/lib/CommonEventHandlers","sap/suite/ui/generic/template/lib/ViewDependencyHelper","sap/suite/ui/generic/template/lib/routingHelper","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/support/lib/CommonMethods"],function(q,V,J,R,T,a,A,C,b,c,d,e,r,t,f){"use strict";var m=Object.create(null);var g=Object.create(null);var h=function(o){var s=o.appComponent.getId();m[s]=o;return function(){delete m[s];};};function i(o){var s=o.getId();var p=m[s];return p;}function j(o){return i(o.getAppComponent()).oTemplateContract.componentRegistry[o.getId()];}function F(o){while(o&&!(o instanceof V)){o=o.getParent();}return o;}function G(o){while(o){var v=F(o);var p=v&&v.getController();var s=p&&p.getOwnerComponent();if(s instanceof a){var u=j(s);return u;}else{o=s&&s.oContainer;}}}function k(o,s,p,u,v){p=p||{};p.constructor=function(){T.prototype.constructor.apply(this,arguments);var M=o(u,this);this._templateEventHandlers=Object.freeze(M.handlers||{});this._templateFormatters=Object.freeze(M.formatters||{});this.extensionAPI=Object.freeze(M.extensionAPI||{});this.fnGenericOnInit=function(w){var x=w.getView();var y=x.getId();q.sap.log.info("Init view "+y+" of template "+s);var z=w.getOwnerComponent();var B=j(z);B.oControllerRegistryEntry={onExit:M.onExit||q.noop,oTemplateUtils:u,oAppRegistryEntry:v};g[y]=B.oControllerRegistryEntry;u.oServices.oApplicationController.registerView(x);u.oCommonUtils=new b(w,u.oServices,u.oComponentUtils);u.oServices.oCRUDManager=new C(w,u.oComponentUtils,u.oServices,u.oCommonUtils,v.oTemplateContract.oBusyHelper);u.oCommonEventHandlers=new d(w,u.oComponentUtils,u.oServices,u.oCommonUtils);(M.onInit||q.noop)();B.oController=this;B.fnViewRegisteredResolve();};};p.onInit=function(){this.fnGenericOnInit(this);delete this.fnGenericOnInit;};p.onExit=function(){var w=this.getView().getId();var x=g[w];x.oAppRegistryEntry.oTemplateContract.oApplicationProxy.destroyView(w);x.onExit();delete g[w];q.sap.log.info("View "+w+" of template "+s+" exited");};return T.extend(s,p);}function l(o){var p=o.methods.oControllerSpecification;return p&&function(){var s=o.oComponent.getAppComponent();var u=i(s);var v=s.getTransactionController();var N=s.getNavigationController();var w={oComponentUtils:o.utils,oServices:{oTemplateCapabilities:{},oApplicationController:s.getApplicationController(),oTransactionController:v,oNavigationController:N,oDraftController:v.getDraftController(),oApplication:u.application,oViewDependencyHelper:u.oViewDependencyHelper}};o.viewRegisterd.catch(function(x){N.navigateToMessagePage({viewLevel:o.viewLevel,title:o.oTemplateContract.getText("ST_ERROR"),text:o.oTemplateContract.getText("ST_GENERIC_UNKNOWN_NAVIGATION_TARGET"),description:""});});return k(p.getMethods,o.oComponent.getTemplateName(),p.oControllerDefinition,w,u);};}function n(o,p){var s=o.oComponent.getEntitySet();var u=i(o.oComponent.getAppComponent()).oTemplateContract;var v=u.mEntityTree[s];var w=v.embeddedComponents;for(var x in w){var y=w[x];if(o.oController.byId(y.containerId)===p){var z=p.getComponentInstance();o.reuseComponentProxies.push(z._stProxy);var B=o.utils.getTemplatePrivateModel();B.setProperty("/generic/embeddedComponents/"+x,{});return{embeddedKey:x,embeddedComponent:y,templateContract:u,reuseComponent:z};}}}function E(o,p){var s=o.oController.extensionAPI;var u=q.extend({},s);if(s.getNavigationController){var N=q.extend({},s.getNavigationController());var v=N.navigateInternal;N.navigateInternal=function(w,x){var y=x&&x.routeName;if(y){o.utils.navigateRoute(y,w,p.embeddedKey,x&&x.replaceInHistory);}else{v(w,x);}};u.getNavigationController=function(){return N;};N.getSubCommunicationModel=function(){return p.embeddedComponent.communicationModel;};}u.getCommunicationObject=function(L){return L===1?p.embeddedComponent.communicationObject:o.utils.getCommunicationObject(L);};(o.methods.enhanceExtensionAPI4Reuse||q.noop)(u,p);return u;}h=t.testableStatic(h,"TemplateComponent_RegisterAppComponent");return{getTemplateComponent:function(o,s,p){var u=s+".Component";p=p||{};p.init=function(){var v=this.getComponentData().registryEntry;v.viewRegisterd=new Promise(function(w,x){v.fnViewRegisteredResolve=function(y){if(y){v.fnViewRegisteredResolve=q.noop;v.oComponent.getAppComponent().getNavigationController().navigateToMessagePage({title:v.oTemplateContract.getText("ST_ERROR"),text:v.oTemplateContract.getText("ST_GENERIC_UNKNOWN_NAVIGATION_TARGET"),description:y});x(y);}else{delete v.fnViewRegisteredResolve;w();}};});v.oViewRenderedPromise=new Promise(function(w){v.fnViewRenderdResolve=w;});v.oViewRenderedPromise.then(function(){f.setApplicationStatus(f.mApplicationStatus.RENDERED);f.publishEvent("elements","ViewRendered",{});});v.reuseComponentProxies=[];(a.prototype.init||q.noop).apply(this,arguments);v.componentName=u;v.oComponent=this;v.activationTakt=0;v.utils=new c(this,v);v.methods=o(this,v.utils)||{};v.oGenericData={mRefreshInfos:{}};(v.methods.init||q.noop)();};p.exit=function(){var I=this.getId();var v=j(this);var w=i(this.getAppComponent());var M=v.methods;(M.exit||q.noop)();delete w.oTemplateContract.componentRegistry[I];(a.prototype.exit||q.noop).apply(this,arguments);};p.onBeforeRendering=function(){var v=j(this);if(!v.oTemplateContract){var w=i(this.getAppComponent());v.oTemplateContract=w.oTemplateContract;}(a.prototype.onBeforeRendering||q.noop).bind(this,v).apply(this,arguments);var M=v.methods;(M.onBeforeRendering||q.noop)();};p.onAfterRendering=function(){var v=j(this);if(v.fnViewRenderdResolve&&!v.fnViewRegisteredResolve){v.fnViewRenderdResolve();delete v.fnViewRenderdResolve;}(a.prototype.onAfterRendering||q.noop).bind(this,v).apply(this,arguments);var M=v.methods;(M.onAftereRendering||q.noop)();};p.onActivate=function(B,I){var v=j(this);v.sCurrentBindingPath=B;var w=function(){v.utils.bindComponent(v.sCurrentBindingPath,I);var U=this.getIsRefreshRequired();if(U||!q.isEmptyObject(v.oGenericData.mRefreshInfos)){(v.methods.refreshBinding||q.noop)(U,U?{}:v.oGenericData.mRefreshInfos);this.setIsRefreshRequired(false);v.oGenericData.mRefreshInfos={};}return(v.methods.onActivate||q.noop)(B);}.bind(this);return v.fnViewRegisteredResolve?v.viewRegisterd.then(w):(w()||Promise.resolve());};p.setContainer=function(){a.prototype.setContainer.apply(this,arguments);var I=this.getId();var v=this.getAppComponent();var w=i(v);if(!w.oTemplateContract.componentRegistry[I]){var x=this.getComponentData();var y=x.registryEntry;delete x.registryEntry;y.componentCreateResolve(this);delete y.componentCreateResolve;w.oTemplateContract.componentRegistry[I]=y;w.oTemplateContract.oBusyHelper.setBusy(y.viewRegisterd,true);y.oApplication=w.application;y.createViewController=l(y);}};p.setIsRefreshRequired=function(I){if(I){var v=j(this);if(v.methods.refreshBinding&&v.utils.isComponentActive()){v.viewRegisterd.then(v.methods.refreshBinding.bind(null,true,{}));I=false;}}this.setProperty("isRefreshRequired",I);};p.onDeactivate=q.noop;return a.extend(u,p);},getRegisterAppComponent:function(){var o=h;h=null;return o;},getExtensionAPIPromise:function(o){var p=G(o);if(!p){return Promise.reject();}return p.viewRegisterd.then(function(){var s=n(p,o);if(s){return E(p,s);}return p.oController.extensionAPI;});},getExtensionAPI:function(o){var p=G(o);return p&&p.oController&&p.oController.extensionAPI;}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.support.DiagnosticsTool.DiagnosticsTool')){jQuery.sap.declare('sap.suite.ui.generic.template.support.DiagnosticsTool.DiagnosticsTool');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.support.Plugin');jQuery.sap.require('sap.ui.core.support.Support');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.MessageToast');sap.ui.define("sap/suite/ui/generic/template/support/DiagnosticsTool/DiagnosticsTool",["jquery.sap.global","sap/ui/core/support/Plugin","sap/ui/core/support/Support","sap/ui/core/format/DateFormat","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/suite/ui/generic/template/support/lib/CommonChecks","sap/suite/ui/generic/template/support/lib/CommonMethods","sap/suite/ui/generic/template/lib/testableHelper"],function(q,P,S,D,J,M,C,a,t){"use strict";var p="sapUiSupportFioriElementsPluginALPLROP";function g(s){var o,A,v=p+"-View",d=[],e=sap.ui.getCore().getEventBus(),m,b,r,c,I,T=10,f;function G(){return p;}function F(i){var o1=D.getDateInstance({source:{pattern:"YYYYMMdd"},style:"short"});return o1.format(o1.parse(String(i).substring(0,8)));}function h(i){var o1=window.location.origin;var p1=window.location.pathname;var q1=i||C.getComponentIDByStructure();if(q1){m=C.getManifestPath(q1);if(m){var r1=C.getManifestURL(o1,p1,m);if(r1){return r1;}}}return"";}function j(i,o1,p1,q1,r1){if(i==="string"){d.push({order:p1,name:o1,type:i,value:q1});return true;}else if(i==="link"){d.push({order:p1,name:o1,type:i,value:q1,target:r1});return true;}else if(i==="group"){d.push({order:p1,name:o1,type:i});return true;}return false;}function k(i,o1,p1){return j("string",i,o1,p1,"");}function l(i,o1,p1,q1){return j("link",i,o1,p1,q1);}function n(i,o1){return j("group",i,o1,"","");}function u(i){if(!(i&&a.hasObjectContent(i))){return undefined;}if(!(i.getMetadata()&&a.hasObjectContent(i.getMetadata()))){return undefined;}var o1=i.getMetadata();if(!(o1.getManifest()&&a.hasObjectContent(o1.getManifest()))){return undefined;}return o1.getManifest();}function w(i){d=[];k("Error",0,i);Y();}function x(i){try{var o1=C.getUI5VersionInfo();if(o1&&a.hasObjectContent(o1)){k("OpenUI5 Version",i,o1.version+" (built at "+F(o1.buildTimestamp)+")");return true;}else{k("OpenUI5 Version",i,"ERROR: OpenUI5 version is not available!");return false;}}catch(ex){k("OpenUI5 Version",i,sap.ui.version+", detailed UI5 version info is not available! Possible reason: missing file \"sap-ui-version.json\"");return true;}}function y(i){var o1=a.getApplicationName(window.location.href);if(o1){l("Application URL",i,"#"+o1,window.location.href);return true;}else{k("Application URL",i,"ERROR: Could not extract application name (#semanticObject-action) from URL!");return false;}}function z(i){if(m&&b){var o1=m;if(m.indexOf("./")===0){o1=m.substring(2,m.length);}l("Manifest",i,o1,b);return true;}else{k("Manifest",i,"ERROR: Could not generate link to manifest.json! Possible reason: The application did not finish loading or is not a Fiori Elements application.");return false;}}function B(i){if(!(c)){return false;}var o1=C.getRegistrationIDsByManifest(c);if(o1&&Array.isArray(o1)&&o1.length>0){k((o1.length>1?"Fiori IDs":"Fiori ID"),i,a.concatStrings(o1));return true;}return false;}function E(i){var o1=C.getApplicationComponentByManifest(c);if(o1){k("Application Component (ACH)",i,o1);return true;}else{k("Application Component (ACH)",i,"ERROR: Path /sap.app/ach not found in manifest.json! Possible reason: Invalid manifest.json");return false;}}function H(i){var o1=C.getApplicationIDByManifest(c);if(o1){k("Application ID",i,o1);return true;}else{k("Application ID",i,"ERROR: Path /sap.app/id not found in manifest.json! Possible reason: Invalid manifest.json");return false;}}function K(i){if(c){var o1=C.getFloorplanByManifest(c);}else{o1=C.getFloorplanByStructure();}if(!C.isValidFloorplan(o1)){o1=C.mFloorplans.UNKNOWN;}if(o1===C.mFloorplans.UNKNOWN){k("Floorplan Component (ACH)",i,C.getTicketComponentForFloorplan(o1)+" (ERROR: Unknown floorplan! Possible reason: Invalid manifest.json)");return false;}else{k("Floorplan Component (ACH)",i,C.getTicketComponentForFloorplan(o1)+" ("+o1+")");return true;}}function L(i,o1){if(!(c&&a.hasObjectContent(c))){return false;}if(!(c["sap.app"]&&c["sap.app"].dataSources&&c["sap.app"].dataSources[i])){k("OData Service Metadata",o1,"ERROR: Data source "+i+" not found at /sap.app/dataSources/"+i+" in manifest.json! Possible reason: Invalid manifest.json");return false;}if(!c["sap.app"].dataSources[i].uri){k("OData Service Metadata",o1,"ERROR: Data source URI not found at /sap.app/dataSources/"+i+"/uri in manifest.json! Possible reason: Invalid manifest.json");return false;}var p1=c["sap.app"].dataSources[i].uri;if(p1.lastIndexOf("/")!==p1.length-1){p1+="/";}p1+="$metadata";l("OData Metadata",o1,p1,window.location.origin+p1);return true;}function N(i,o1){if(!(c&&a.hasObjectContent(c)&&r)){return false;}if(!(c["sap.app"]&&c["sap.app"].dataSources&&c["sap.app"].dataSources[i])){k("Annotations",o1,"ERROR: Data source "+i+" not found at /sap.app/dataSources/"+i+" in manifest.json! Possible reason: Invalid manifest.json");return false;}if(!(c["sap.app"].dataSources[i].settings&&c["sap.app"].dataSources[i].settings.annotations&&c["sap.app"].dataSources[i].settings.annotations!==[])){k("Annotations",o1,"ERROR: Data source "+i+" has no annotations at /sap.app/dataSources/"+i+"/settings/annotations in manifest.json! Possible reason: Invalid manifest.json");return false;}var p1=c["sap.app"].dataSources[i].settings.annotations;p1=p1.reverse();for(var q1 in p1){if(!p1.hasOwnProperty(q1)){continue;}var r1=p1[q1];if(c["sap.app"].dataSources[r1]){var s1=c["sap.app"].dataSources[r1].uri;if(!s1){continue;}var t1="";var u1="";if(s1.indexOf("/")===0){u1="Backend Annotation";t1=window.location.origin;}else{u1="Local Annotation";t1=r;if(t1.lastIndexOf("/")!==t1.length-1){t1+="/";}}u1+=" (Prio. "+parseInt(parseInt(q1,10)+1,10)+")";l(u1,o1,c["sap.app"].dataSources[r1].uri,t1+c["sap.app"].dataSources[r1].uri);}}return true;}function O(i){if(!(c)){return;}var o1=0;function p1(x1){o1+=0.01;return x1+o1;}if(!(c["sap.ui5"]&&c["sap.ui5"].models)){k("Data Sources",i,"ERROR: Path /sap.ui5/models not found in manifest.json! Possible reason: Invalid manifest.json");return;}var q1=c["sap.ui5"].models;var r1=[];for(var s1 in q1){if(!q1.hasOwnProperty(s1)){continue;}if(q1[s1]&&q1[s1].dataSource&&q1[s1].dataSource!==""){var t1=false;for(var u1 in r1){if(!r1.hasOwnProperty(u1)){continue;}if(r1[u1].dataSource===q1[s1].dataSource){t1=true;break;}}var v1=(s1===""?"mainService":s1);if(!t1){r1.push({models:[v1],dataSource:q1[s1].dataSource});}else{r1[u1].models.push(v1);}}}if(r1.length===0){k("Data Sources",i,"ERROR: No models with data sources found in manifest.json! Possible reason: Invalid manifest.json");return;}for(var w1 in r1){if(!r1.hasOwnProperty(w1)){continue;}if(!(c["sap.app"]&&c["sap.app"].dataSources)){k("Data Sources",i,"ERROR: No data sources found at /sap.app/dataSources in manifest.json! Possible reason: Invalid manifest.json");return;}if(!c["sap.app"].dataSources[r1[w1].dataSource]){k("Data Sources",i,"ERROR: Data source "+r1[w1].dataSource+" not found at /sap.app/dataSources/"+r1[w1].dataSource+" in manifest.json! Possible reason: Invalid manifest.json");return;}n(a.concatStrings(r1[w1].models),p1(i));L(r1[w1].dataSource,p1(i));N(r1[w1].dataSource,p1(i));}}function Q(i){var o1=sap.ui.getCore().byId(i);if(o1){return o1;}else{return sap.ui.xmlview(i,{viewName:"sap.suite.ui.generic.template.support.DiagnosticsTool.view.DiagnosticsTool",viewData:{plugin:o}});}}function R(){var i=Q(v);i.placeAt(p);var o1=new J();i.setModel(o1,"data");}function U(i){if(i){var o1=q("#"+p+"-Panel #"+p+"-Panel");if(o1&&o1.length&&o1.length>0){var p1=q.sap.byId(p+"-PanelHeader");p1.off("click");p1.click(function(){var q1=p1.find("#"+p+"-PanelHandle");var r1=q.sap.byId(p+"-PanelContent");if(q1.hasClass("sapUiSupportPnlHdrHdlClosed")){q1.removeClass("sapUiSupportPnlHdrHdlClosed");r1.removeClass("sapUiSupportHidden");}else{q1.addClass("sapUiSupportPnlHdrHdlClosed");r1.addClass("sapUiSupportHidden");}});o1.replaceWith(q.sap.byId(p));}if(q.sap.fnExitFioriElementsToolInstance){q.sap.fnExitFioriElementsToolInstance();}q.sap.fnExitFioriElementsToolInstance=W;}else{if(q.sap.fnExitFioriElementsWindowInstance){q.sap.fnExitFioriElementsWindowInstance();}q.sap.fnExitFioriElementsWindowInstance=W;if(q.sap.oCommonMethodsFioriElementsWindowInstance){a.setApplicationStatus(q.sap.oCommonMethodsFioriElementsWindowInstance.getApplicationStatus());a.setAppComponent(q.sap.oCommonMethodsFioriElementsWindowInstance.getAppComponent());}q.sap.oCommonMethodsFioriElementsWindowInstance=a;}}function V(){o=this;A=window.location.hash.slice(1);U(s.isToolStub());if(s.isToolStub()){if(!s.hasListeners(p+"SetData")){s.attachEvent(p+"SetData",b1);}if(!s.hasListeners(p+"UpdateStatus")){s.attachEvent(p+"UpdateStatus",c1);}if(!s.hasListeners(p+"ShowDataRefreshed")){s.attachEvent(p+"ShowDataRefreshed",d1);}q.sap.fioriElementsPluginID=p;R();}else{if(!s.hasListeners(p+"GetData")){s.attachEvent(p+"GetData",a1);}e.unsubscribe("elements","ViewRendered",f1);e.unsubscribe("elements","ViewRenderingStarted",f1);e.subscribe("elements","ViewRendered",f1);e.subscribe("elements","ViewRenderingStarted",f1);if("onhashchange"in window){q(window).bind("hashchange",g1);}}a1();}function W(){if(s.isToolStub()){q.sap.fnFEPluginToolInstanceExit=undefined;s.detachEvent(p+"SetData",b1);s.detachEvent(p+"UpdateStatus",c1);s.detachEvent(p+"ShowDataRefreshed",d1);Q(v).destroy();}else{q.sap.fnFEPluginAppInstanceExit=undefined;s.detachEvent(p+"GetData",a1);e.unsubscribe("elements","ViewRendered",f1);e.unsubscribe("elements","ViewRenderingStarted",f1);if("onhashchange"in window){q(window).unbind("hashchange",g1);}}}function X(){s.sendEvent(p+"GetData",{});}function Y(){var i=new J();d.sort(a.getDynamicComparator("order"));var o1=new Date().toLocaleTimeString([],{hour12:false,hour:"2-digit",minute:"2-digit",second:"2-digit"});var p1=true;if(!d||d.length===0){p1=false;}var q1=a.getApplicationStatus();if(!q1){a.setApplicationStatus(a.mApplicationStatus.UNKNOWN);q1=a.mApplicationStatus.UNKNOWN;}var r1="";if(q1===a.mApplicationStatus.FAILED){r1="The application did not finish loading or is no Fiori Elements application! The shown data below could be collected anyway. If the application finishes loading, the data will be updated automatically.";}i.setData({properties:d,url:window.location.href,origin:window.location.origin,retrieval:o1,copyEnabled:p1,status:q1,statusMessage:r1});s.sendEvent(p+"SetData",JSON.parse(i.getJSON()));}function Z(i,o1){s.sendEvent(p+"UpdateStatus",{timeLeft:i,status:o1});}function $(){s.sendEvent(p+"ShowDataRefreshed",{});}function _(i){if(b){r=C.getRootPath(b);}d=[];Y();x(1);y(2);z(3);Y();if(i&&c&&a.hasObjectContent(c)){B(3);E(4);K(5);O(6);Y();$();}else if(b){q.when(a.getFileFromURI(b)).done(function(o1){c=o1;B(3);H(4);E(5);K(6);O(7);}).fail(function(){k("Manifest",3,"ERROR: Could not access manifest.json even though link could be generated! Possible reason: missing permission to access file.");}).always(function(){Y();$();});}}function a1(){c=undefined;b=undefined;r=undefined;var i=a.getApplicationStatus();var o1=a.getAppComponent();var p1=false;if(!(i&&a.isValidApplicationStatus(i))){i=a.mApplicationStatus.UNKNOWN;}if(i===a.mApplicationStatus.LOADING){f1();return;}else if(i===a.mApplicationStatus.FAILED){var q1=u(o1);if(q1&&a.hasObjectContent(q1)){c=q1;if(c&&c["sap.app"]&&c["sap.app"].id){b=h(c["sap.app"].id);if(!b){p1=true;}}else{p1=true;}}else{w("Could not load any data because manifest and component of current application are unknown!");$();return;}}else if(i===a.mApplicationStatus.RENDERED){b=h();if(!b){q1=u(o1);if(q1&&a.hasObjectContent(q1)){c=q1;if(c&&c["sap.app"]&&c["sap.app"].id){b=h(c["sap.app"].id);if(!b){p1=true;}}else{p1=true;}}else{w("Could not load any data because manifest and component of current application are unknown!");$();return;}}}else if(i===a.mApplicationStatus.UNKNOWN){if(C.getFloorplanByStructure()!==C.mFloorplans.UNKNOWN){c=C.getManifestByStructure();if(c&&a.hasObjectContent(c)){if(c&&c["sap.app"]&&c["sap.app"].id){b=h(c["sap.app"].id);if(!b){p1=true;}}else{p1=true;}}}else{w("Could not load any data because manifest and component of current application are unknown!");$();return;}}_(p1);}function b1(i){var o1=new J();o1.setJSON(JSON.stringify(i.getParameters()));var p1=Q(v);p1.setModel(o1,"data");p1.invalidate();}function c1(i){var o1=i.getParameters();Q(v).getController().updateStatus(o1.timeLeft,o1.status);}function d1(){var i=Q(v);i.getController().showDataRefreshed();}function e1(){var i=a.getApplicationStatus();if(f>0){Z(f,i);}else{f=T;a.setApplicationStatus(a.mApplicationStatus.FAILED);Z(0,a.mApplicationStatus.FAILED);I.removeListener(e1);I=undefined;a1();}f--;}function f1(i,o1){if(o1==="ViewRenderingStarted"||(!o1&&a.getApplicationStatus()===a.mApplicationStatus.LOADING)){a.setApplicationStatus(a.mApplicationStatus.LOADING);if(!I){f=T;I=new sap.ui.core.IntervalTrigger(1000);I.addListener(e1);}}else if(o1==="ViewRendered"){a.setApplicationStatus(a.mApplicationStatus.RENDERED);f=T;if(I){I.removeListener(e1);I=undefined;}a1();}}function g1(o1){function p1(u1){for(var i=0;i<u1.length;i++){if(u1[i]==="/"||u1[i]==="&"||u1[i]==="?"||u1[i]==="~"){return i;}}return u1.length;}function q1(i,u1){if(!i||!u1){return false;}if(i===u1){return true;}var v1=p1(i);var w1=p1(u1);if(v1!==w1){return false;}else if(i.substr(0,v1)===u1.substr(0,w1)){return true;}return false;}var r1,s1,t1=false;if(o1.originalEvent.oldURL&&o1.originalEvent.newURL){r1=o1.originalEvent.oldURL.split("#")[1];s1=o1.originalEvent.newURL.split("#")[1];}else{r1=A;s1=window.location.hash.slice(1);A=s1;}if(r1.length>=s1.length){t1=q1(s1,r1);}else{t1=q1(r1,s1);}if(!t1){a.setApplicationStatus(a.mApplicationStatus.LOADING);a.setAppComponent(undefined);f1();f=(T/2);}}function h1(){return s;}function i1(){return d;}function j1(){d=[];}function k1(i){c=i;}function l1(i){b=i;}function m1(i){m=i;}function n1(i){r=i;}var F=t.testable(F,"DiagnosticsTool_fnFormatDate");var u=t.testable(u,"fnGetManifestFromAppComponent");var j=t.testable(j,"fnAddToData");var k=t.testable(k,"fnAddStringToData");var l=t.testable(l,"fnAddLinkToData");var n=t.testable(n,"fnAddGroupHeaderToData");var w=t.testable(w,"fnDisplayError");var x=t.testable(x,"fnAddVersionInfo");var z=t.testable(z,"fnAddManifestLink");var E=t.testable(E,"fnAddApplicationComponent");var K=t.testable(K,"fnAddFloorplanComponent");var L=t.testable(L,"fnAddODataServiceMetadataLink");var N=t.testable(N,"fnAddAnnotationsLinks");var O=t.testable(O,"fnAddDataSources");var B=t.testable(B,"fnAddFioriID");var H=t.testable(H,"fnAddApplicationID");var h1=t.testable(h1,"fnGetSupportStub");var i1=t.testable(i1,"fnGetData");var j1=t.testable(j1,"fnResetData");var k1=t.testable(k1,"fnSetManifest");var l1=t.testable(l1,"fnSetManifestURL");var m1=t.testable(m1,"fnSetManifestPath");var n1=t.testable(n1,"fnSetsRootPath");return{init:V,exit:W,getId:G,onRefresh:X};}return P.extend("sap.suite.ui.generic.template.support.DiagnosticsTool.DiagnosticsTool",{constructor:function(s){P.apply(this,[p,"SAP Fiori Elements",s]);q.extend(this,g(s));}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.KpiTag')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.KpiTag');jQuery.sap.require('sap.ui.core.Control');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.m.NumericContent');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/KpiTag",["sap/ui/core/Control","sap/m/Label","sap/m/NumericContent","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/AnalyticalListPage/controller/KpiTagController","sap/suite/ui/generic/template/AnalyticalListPage/util/KpiUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/KpiAnnotationHelper","sap/suite/ui/generic/template/AnalyticalListPage/util/CriticalityUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms"],function(C,L,N,J,K,a,b,c,F,V){"use strict";return C.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.KpiTag",{metadata:{properties:{value:{type:"string",defaultValue:"",bindable:true},name:{type:"string",defaultValue:"",bindable:true},scale:{type:"string",defaultValue:undefined,bindable:true},indicator:{type:"sap.m.ValueColor",defaultValue:undefined},entitySet:{type:"string",defaultValue:"",bindable:false},qualifier:{type:"string",defaultValue:"",bindable:false},modelName:{type:"string",defaultValue:undefined,bindable:false}},aggregations:{_name:{type:"sap.m.Label",multiple:false,visibility:"visible"},_value:{type:"sap.m.Label",multiple:false,visibility:"visible"},_content:{type:"sap.m.NumericContent",multiple:false,visibility:"visible"}},events:{press:{}}},_firstTime:true,_dataModel:undefined,_controller:undefined,_isRelative:false,_isPercent:false,_sUnitofMeasure:"",_relativeToProperties:[],_getDataModel:function(){if(!this._dataModel){this._dataModel=new J();}return this._dataModel;},_getController:function(){if(!this._controller){this._controller=new K();}return this._controller;},onBeforeRendering:function(){if(this._firstTime){this.setBusy(true);this._firstTime=false;if(this.getModelName()){var m=this.getModel(this.getModelName());m.getMetaModel().loaded().then(function(){var M=m.getMetaModel();var e=M.getODataEntitySet(this.getEntitySet());var E=M.getODataEntityType(e.entityType);var s="com.sap.vocabularies.UI.v1.SelectionPresentationVariant#"+this.getQualifier();var S=E[s];if(!S){return;}var o=S.SelectionVariant&&S.SelectionVariant.Path;if(!o){jQuery.sap.log.error("SelectionVariant does not have Path.");return;}if(/^@/.test(o)){o=o.slice(1);}var d=E[o];var f=[];var g=d&&d.SelectOptions;var h,r;if(g){for(var i=0;i<g.length;i++){h=g[i];for(var j=0;j<h["Ranges"].length;j++){r=h["Ranges"][j];if(r.Sign.EnumMember===V.SelectionRangeSignType+"/I"||r.Sign.EnumMember===V.SelectionRangeSignType+"/E"){if(r.Low){f.push(new sap.ui.model.Filter(a.getFilter(r,h)));}}}}}var p=S.PresentationVariant&&(S.PresentationVariant.AnnotationPath||S.PresentationVariant.Path);if(!p){return;}if(/^@/.test(p)){p=p.slice(1);}var D;var v=E[p].Visualizations;v.forEach(function(A){if(A.AnnotationPath.indexOf("DataPoint")>0){D=A.AnnotationPath.split("@")[1];}});var k=E[D];this.dataPointAnnotation=k;var l=M.getODataProperty(E,k.Value.Path);this._checkForPercent(m,l);this._getCriticalityRefProperties(k);this.setModel(this._getDataModel());var P=b.resolveParameterizedEntitySet(m,e,d);if(k.Value){if(k.Value.Path){this.bindValue("/0/"+k.Value.Path);}else{this.setProperty("value",k.Value.String);}}m.read(P,{async:true,filters:f,urlParameters:{"$select":[k.Value.Path].concat(this._relativeToProperties).join(","),"$top":1},success:function(n,q){this._getDataModel().setData(n.results);n=F.readProperty(this.dataPointAnnotation,"Value.Path")?c.CalculateCriticality(this.dataPointAnnotation,n,this.dataPointAnnotation.Value.Path):n;this.setIndicator(n.results[0].color);this._setScaleInformation(this.dataPointAnnotation);this._setNameInformation(this.dataPointAnnotation);this.setBusy(false);}.bind(this),error:function(n){jQuery.sap.log.error("Error reading URL:"+n);}});}.bind(this));}}},init:function(){if(C.prototype.init){C.prototype.init.call(this);}},_onMouseClick:function(e){K.openKpiCard(e);},_onKeyPress:function(e){if(e.which===jQuery.sap.KeyCodes.ENTER||e.which===jQuery.sap.KeyCodes.SPACE){K.openKpiCard(e);}},_checkForPercent:function(m,e){this._sUnitofMeasure=a.getUnitofMeasure(m,e);if(this._sUnitofMeasure=="%"){this._isPercent=true;}},_checkIfRelative:function(d){var t=d.TrendCalculation;this._isRelative=a.isRelative(d);if(this._isRelative){if(t.ReferenceValue.Path){this._relativeToProperties.push(t.ReferenceValue.Path);}}},_setNameInformation:function(d){var t=d.Title;var r=this.getModel("i18n").getResourceBundle();var n=a.getPathOrPrimitiveValue(t);if(n===undefined){n="";}if(n.indexOf(">")>0){this.bindProperty("name",{path:n,formatter:function(v){this._nameFromPath=v;return this._getNameFromHeuristic(v);}.bind(this)});}else{this._nameFromPath=n;this.setProperty("name",this._getNameFromHeuristic(n));}var e=this._isPercent?(a.formatNumberForPresentation(this.getValue(),true,1,this.getProperty("scale"))+this._sUnitofMeasure):(a.formatNumberForPresentation(this.getValue(),true,0,this.getProperty("scale")));var f;switch(this.getIndicator()){case sap.m.ValueColor.Error:f="KPI_TOOLTIP_ERROR";break;case sap.m.ValueColor.Good:f="KPI_TOOLTIP_GOOD";break;case sap.m.ValueColor.Critical:f="KPI_TOOLTIP_CRITICAL";break;default:f="KPI_TOOLTIP_NEUTRAL";break;}this.setTooltip(r.getText(f,[this._nameFromPath,e]));},_setScaleInformation:function(d){if(d.ValueFormat){if(d.ValueFormat.ScaleFactor){this.setProperty("scale",a.getPathOrPrimitiveValue(d.ValueFormat.ScaleFactor));}}},_getCriticalityRefProperties:function(d){var e=d.CriticalityCalculation;var f=d.Criticality;this._relativeToProperties=[];if(f&&f.Path){this._relativeToProperties.push(f.Path);}else if(e){if(e.DeviationRangeLowValue&&e.DeviationRangeLowValue.Path){this._relativeToProperties.push(e.DeviationRangeLowValue.Path);}if(e.DeviationRangeHighValue&&e.DeviationRangeHighValue.Path){this._relativeToProperties.push(e.DeviationRangeHighValue.Path);}if(e.ToleranceRangeLowValue&&e.ToleranceRangeLowValue.Path){this._relativeToProperties.push(e.ToleranceRangeLowValue.Path);}if(e.ToleranceRangeHighValue&&e.ToleranceRangeHighValue.Path){this._relativeToProperties.push(e.ToleranceRangeHighValue.Path);}}},_getTitleRefProperty:function(d){var t=d.Title;if(t&&t.Path){this._relativeToProperties.push(t.Path);}},_getNameFromHeuristic:function(s){var p=s.split(/\s/);return p.length===1?this._getNameFromSingleWordHeuristic(s):this._getNameFromMultiWordHeuristic(p);},_getNameFromSingleWordHeuristic:function(w){return w.substr(0,3).toUpperCase();},_getNameFromMultiWordHeuristic:function(w){var p=[];p.push(w[0].charAt(0));p.push(w[1].charAt(0));if(w.length>=3){p.push(w[2].charAt(0));}return p.join("").toUpperCase();},renderer:function(r,o){r.write("<div");r.writeAttributeEscaped("tabIndex",0);r.writeControlData(o);r.addClass("sapSmartTemplatesAnalyticalListPageKpiTag sapSmartTemplatesAnalyticalListPageKpiTagCozy sapUiSmallMarginEnd");o._addColorClasses(r);r.writeClasses();r.writeAttributeEscaped("aria-label",o._getAriaLabelText(o.getTooltip()));r.writeAttributeEscaped("title",o.getTooltip());r.write(">");r.write("<div");r.addClass("sapSmartTemplatesAnalyticalListPageKpiTagName");r.writeClasses();r.write(">");r.writeEscaped(o.getName());r.write("</div>");r.write("<div");r.addClass("sapSmartTemplatesAnalyticalListPageKpiTagValue");r.writeClasses();r.write(">");r.writeEscaped(o._isPercent?a.formatNumberForPresentation(o.getValue(),true,1,o.getProperty("scale"))+o._sUnitofMeasure:a.formatNumberForPresentation(o.getValue(),true,0,o.getProperty("scale")));r.write("</div>");r.write("</div>");},_getAriaLabelText:function(k){var r=this.getModel("i18n").getResourceBundle();return r.getText("KPI_ARIALABEL_TAG",[k]);},_addColorClasses:function(r){switch(this.getIndicator()){case sap.m.ValueColor.Neutral:r.addClass("sapSmartTemplatesAnalyticalListPageKPINeutral");break;case sap.m.ValueColor.Error:r.addClass("sapSmartTemplatesAnalyticalListPageKPINegative");break;case sap.m.ValueColor.Good:r.addClass("sapSmartTemplatesAnalyticalListPageKPIPositive");break;case sap.m.ValueColor.Critical:r.addClass("sapSmartTemplatesAnalyticalListPageKPICritical");break;default:r.addClass("sapSmartTemplatesAnalyticalListPageKPINeutral");break;}},onAfterRendering:function(){setTimeout(function(){this.detachBrowserEvent("click",this._onMouseClick).attachBrowserEvent("click",this._onMouseClick);this.detachBrowserEvent("keypress",this._onKeyPress).attachBrowserEvent("keypress",this._onKeyPress);}.bind(this),1);},exit:function(){this._relativeToProperties=[];}});},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroBar')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroBar');jQuery.sap.require('sap.suite.ui.microchart.InteractiveBarChart');jQuery.sap.require('sap.suite.ui.microchart.InteractiveBarChartBar');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemMicroBar",["sap/suite/ui/microchart/InteractiveBarChart","sap/suite/ui/microchart/InteractiveBarChartBar","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemMicroChart","sap/suite/ui/generic/template/AnalyticalListPage/util/CriticalityUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil"],function(I,a,J,F,C,b){"use strict";var c=F.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroBar",{metadata:{properties:{fixedCount:{type:"int",defaultValue:3},labelWidthPercent:{type:"float",group:"Misc",defaultValue:1/3}},aggregations:{control:{type:"sap.suite.ui.microchart.InteractiveBarChart",multiple:false}}},renderer:{}});c.prototype.init=function(){this._chart=new sap.suite.ui.microchart.InteractiveBarChart({maxDisplayedBars:3,selectionEnabled:true,bars:[]});this.setControl(this._chart);this.setModel(new J(),'__alp_chartJSONModel');this._sorters=[];F.prototype.init.apply(this,arguments);};c.prototype._updateBinding=function(){this.applyOverlay();this._chart.setBusyIndicatorDelay(0);this._chart.setBusy(true);this._chart.unbindBars();var e=this.getEntitySet(),d=this.getDimensionField(),f=this.getDimensionFieldDisplay(),m=this.getMeasureField(),u=this.getUnitField(),g=this.getDimensionFilterExternal(),s=[],S=this.getSortOrder(),o=F._getSorter(S);this._sorters=o.sorter;s=o.sortFields;if(!e||!m||!d||!f){return;}var h=[m,d,s];if(d!=f){h.push(f);}if(u){h.push(u);}var i=[];if(g&&g.aFilters&&g.aFilters.length){i=[g];}var j=this;var k=this.getFixedCount();var M=this.getModel();var B="/"+e;if(M){var D=C.getDataPoint(M,this);if(D){(D.ValueFormat&&D.ValueFormat.ScaleFactor)?this.setScaleFactor(b.getPrimitiveValue(D.ValueFormat.ScaleFactor)):this.setScaleFactor(null);(D.ValueFormat&&D.ValueFormat.NumberOfFractionalDigits)?this.setNumberOfFractionalDigits(b.getPrimitiveValue(D.ValueFormat.NumberOfFractionalDigits)):this.setNumberOfFractionalDigits(null);var r=C.getCriticalityRefProperties(D);}if(this.getSmartFilterId()){var l=sap.ui.getCore().byId(this.getSmartFilterId());if(l&&l.getEntitySet()===e){var t=this.getModel("_templPriv"),n=t.getProperty('/alp/searchable');if(n){B=this.considerAnalyticBinding(B,l);}else{this.applyOverlay(this.requiredFilterMessage);return;}}}if(this._oObject){this._oObject.abort();}this._oObject=M.read(B,{async:true,filters:i,sorters:this._sorters,urlParameters:{"$select":r?[r].concat(h).join(","):h.join(","),"$top":k},success:function(p,q){j._oObject=null;p=D?C.CalculateCriticality(D,p,j.getMeasureField()):p;j._onDataReceived(p);},error:function(E){jQuery.sap.log.error("Error reading URL:"+E);if(E&&E.statusCode!==0&&E.statusText!=="abort"){j.applyOverlay(j.technicalIssueMessage);j._oObject=null;}}});}};c.prototype._onDataReceived=function(d){if(!d||!d.results||!d.results.length){this.applyOverlay(this.noDataIssueMessage);return;}F.prototype._onDataReceived.call(this,d.results);this.getModel('__alp_chartJSONModel').setData(d.results);this._chart.setModel(this.getModel('__alp_chartJSONModel'));var e=this.getFixedCount(),f={path:'/',template:new a(this._getChartAggregationSettings()),startIndex:0,length:e};this._chart.bindBars(f);this._chart.setBusy(false);};return c;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroDonut')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroDonut');jQuery.sap.require('sap.suite.ui.microchart.InteractiveDonutChart');jQuery.sap.require('sap.suite.ui.microchart.InteractiveDonutChartSegment');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemMicroDonut",["sap/suite/ui/microchart/InteractiveDonutChart","sap/suite/ui/microchart/InteractiveDonutChartSegment","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemMicroChart","sap/suite/ui/generic/template/AnalyticalListPage/util/CriticalityUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil"],function(I,a,J,F,C,b){"use strict";var c="__IS_OTHER__";var d=F.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroDonut",{metadata:{properties:{labelWidthPercent:{type:"float",group:"Misc",defaultValue:1/2}},aggregations:{control:{type:"sap.suite.ui.microchart.InteractiveDonutChart",multiple:false}}},renderer:{}});d.prototype.init=function(){this._chart=new sap.suite.ui.microchart.InteractiveDonutChart({selectionEnabled:true,segments:[]});this.setControl(this._chart);this.setModel(new J(),'__alp_chartJSONModel');this._otherField="__IS_OTHER__";this._sorters=[];F.prototype.init.apply(this,arguments);};d.prototype._applyDonutChartSelections=function(o,D){var s=this._chart.getSegments(),p=this.getParentProperty(),S=[],e,r;if(o.dimValue===c){s.forEach(function(f){e=f.getCustomData()[0].getValue();if(e!==c){if(f.getSelected()){S.push(e);}r={"exclude":true,"operation":"EQ"};r.keyField=p;r.value1=e;D.ranges.push(r);}});if(S.length>0){D.items=D.items.filter(function(f){return S.indexOf(f.key)===-1;});D.ranges=D.ranges.filter(function(r){return!(r.exclude===false&&r.operation==="EQ"&&r.keyField===p&&S.indexOf(r.value1)>-1);});}}else{D.items.push({key:o.dimValue,text:o.dimValueDisplay});var i=false;s.forEach(function(f){e=f.getCustomData()[0].getValue();if(e===c&&f.getSelected()){i=true;}if(e!==c){S.push(e);}});if(i){D.ranges=D.ranges.filter(function(r){return!(r.exclude===true&&r.operation==="EQ"&&r.keyField===p&&S.indexOf(r.value1)>-1);});}}return D;};d.prototype._updateBinding=function(){this.applyOverlay();this._chart.setBusyIndicatorDelay(0);this._chart.setBusy(true);this._chart.unbindSegments();var e=this.getEntitySet(),f=this.getDimensionField(),g=this.getDimensionFieldDisplay(),m=this.getMeasureField(),u=this.getUnitField(),h=this.getDimensionFilterExternal(),s=[],S=[],s=this.getSortOrder(),o=F._getSorter(s);this._sorters=o.sorter;S=o.sortFields;if(!e||!m||!f||!g){return;}var i=[m,f,S];if(f!=g){i.push(g);}if(u){i.push(u);}var j=[];if(h&&h.aFilters&&h.aFilters.length){j=[h];}var k=this;var M=this.getModel();var B="/"+e;if(M){var D=C.getDataPoint(M,this);if(D){(D.ValueFormat&&D.ValueFormat.ScaleFactor)?this.setScaleFactor(b.getPrimitiveValue(D.ValueFormat.ScaleFactor)):this.setScaleFactor(null);(D.ValueFormat&&D.ValueFormat.NumberOfFractionalDigits)?this.setNumberOfFractionalDigits(b.getPrimitiveValue(D.ValueFormat.NumberOfFractionalDigits)):this.setNumberOfFractionalDigits(null);var r=C.getCriticalityRefProperties(D);}if(this.getSmartFilterId()){var l=sap.ui.getCore().byId(this.getSmartFilterId());if(l&&l.getEntitySet()===e){var t=this.getModel("_templPriv"),n=t.getProperty('/alp/searchable');if(n){B=this.considerAnalyticBinding(B,l);}else{this.applyOverlay(this.requiredFilterMessage);return;}}}if(this._oTop4ReadObject){this._oTop4ReadObject.abort();}if(this._oTotalReadObject){this._oTotalReadObject.abort();}var T=this._fetchData(M,B,j,i,false,r,D),p=this._fetchData(M,B,j,[m],true);jQuery.when(T,p).then(function(q,v){if(!q[1]){k.applyOverlay(k.noDataIssueMessage);}else if(q[1]<=3){k._onDataReceived(q[0]);}else if(q[1]>3){if(v[1]){k._onDataReceived(q[0],v[0]);}else{k.applyOverlay(k.noDataIssueMessage);}}},function(E,q){if(!E||(E.statusCode!==0&&E.statusText!=="abort")){if(q===true){k._oTotalReadObject=null;}else{k._oTop4ReadObject=null;}k.applyOverlay(k.technicalIssueMessage);}});}};d.prototype._fetchData=function(m,B,f,s,t,r,D){var e=this;var o=new jQuery.Deferred();if(!m&&!B){o.reject(null,t);}else{var g={async:true,filters:f,urlParameters:{"$select":r?[r].concat(s).join(","):s.join(","),"$top":(t)?1:4},success:function(h,i){if(t===true){e._oTotalReadObject=null;}else{e._oTop4ReadObject=null;}h=D?C.CalculateCriticality(D,h,e.getMeasureField()):h;var j=(h&&h.results&&h.results.length)?h.results.length:0;o.resolve(h,j);},error:function(h,t){o.reject(h,t);}};if(!t){g.sorters=this._sorters;}if(t){this._oTotalReadObject=m.read(B,g);}else{this._oTop4ReadObject=m.read(B,g);}}return o.promise();};d.prototype._onDataReceived=function(t,T){var r=[],D=this.getDimensionFieldDisplay(),m=this.getMeasureField(),s=this.getDimensionField();if(!T){t.results.forEach(function(h,i){h['dimensionValue']=h[s];r.push(h);});}else{var f=0,o=0;t.results.forEach(function(h,i){if(i<2){h['dimensionValue']=h[s];r.push(h);f+=parseFloat(h[m]);}});if(T){T.results.forEach(function(h){var i=this.getModel("i18n"),j=jQuery.extend(true,{},h);j['dimensionValue']=this._otherField;j[s]=this._otherField;j[D]=i?i.getResourceBundle().getText("VIS_FILTER_DONUT_OTHER"):"";if(f<0){o=parseFloat(h[m])+f;}else{o=parseFloat(h[m])-f;}j[m]=o;r.push(j);}.bind(this));}}F.prototype._onDataReceived.call(this,r);this.getModel('__alp_chartJSONModel').setData(r);this._chart.setModel(this.getModel('__alp_chartJSONModel'));var e=3,g={path:'/',template:new a(this._getChartAggregationSettings(true)),startIndex:0,length:e};this._chart.bindSegments(g);this._chart.setBusy(false);};return d;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroLine')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroLine');jQuery.sap.require('sap.suite.ui.microchart.InteractiveLineChart');jQuery.sap.require('sap.suite.ui.microchart.InteractiveLineChartPoint');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemMicroLine",["sap/suite/ui/microchart/InteractiveLineChart","sap/suite/ui/microchart/InteractiveLineChartPoint","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/FilterItemMicroChart","sap/suite/ui/generic/template/AnalyticalListPage/util/CriticalityUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil"],function(I,a,J,F,C,b){"use strict";var c=F.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroLine",{metadata:{properties:{labelWidthPercent:{type:"float",group:"Misc",defaultValue:1/3},fixedCount:{type:"int",defaultValue:6}},aggregations:{control:{type:"sap.suite.ui.microchart.InteractiveLineChart",multiple:false}}},renderer:{}});c.prototype.init=function(){this._chart=new sap.suite.ui.microchart.InteractiveLineChart({maxDisplayedPoints:6,selectionEnabled:true,points:[]});this.setControl(this._chart);this.setModel(new J(),'__alp_chartJSONModel');this._sorters=[];F.prototype.init.apply(this,arguments);};c.prototype._updateBinding=function(){this.applyOverlay();this._chart.setBusyIndicatorDelay(0);this._chart.setBusy(true);this._chart.unbindPoints();var e=this.getEntitySet(),d=this.getDimensionField(),f=this.getDimensionFieldDisplay(),m=this.getMeasureField(),u=this.getUnitField(),g=this.getDimensionFilterExternal(),s=[],S=this.getSortOrder(),o=F._getSorter(S);this._sorters=o.sorter;s=o.sortFields;if(!e||!m||!d||!f){return;}var h=[m,d,s];if(d!=f){h.push(f);}if(u){h.push(u);}var i=[];if(g&&g.aFilters&&g.aFilters.length>0){i=[g];}var j=this;var k=this.getFixedCount();var M=this.getModel();var B="/"+e;if(M){var D=C.getDataPoint(M,this);if(D){(D.ValueFormat&&D.ValueFormat.ScaleFactor)?this.setScaleFactor(b.getPrimitiveValue(D.ValueFormat.ScaleFactor)):this.setScaleFactor(null);(D.ValueFormat&&D.ValueFormat.NumberOfFractionalDigits)?this.setNumberOfFractionalDigits(b.getPrimitiveValue(D.ValueFormat.NumberOfFractionalDigits)):this.setNumberOfFractionalDigits(null);var r=C.getCriticalityRefProperties(D);}if(this.getSmartFilterId()){var l=sap.ui.getCore().byId(this.getSmartFilterId());if(l&&l.getEntitySet()===e){var t=this.getModel("_templPriv"),n=t.getProperty('/alp/searchable');if(n){B=this.considerAnalyticBinding(B,l);}else{this.applyOverlay(this.requiredFilterMessage);return;}}}if(this._oObject){this._oObject.abort();}this._oObject=M.read(B,{async:true,filters:i,sorters:this._sorters,urlParameters:{"$select":r?[r].concat(h).join(","):h.join(","),"$top":k},success:function(p,q){j._oObject=null;p=D?C.CalculateCriticality(D,p,j.getMeasureField()):p;j._onDataReceived(p);},error:function(E){jQuery.sap.log.error("Error reading URL:"+E);if(E&&E.statusCode!==0&&E.statusText!=="abort"){j.applyOverlay(j.technicalIssueMessage);j._oObject=null;}}});}};c.prototype._onDataReceived=function(d){if(!d||!d.results||!d.results.length){this.applyOverlay(this.noDataIssueMessage);return;}var D=this.getDimensionFieldIsDateTime()?d.results.slice().reverse():d.results;F.prototype._onDataReceived.call(this,d.results);this.getModel('__alp_chartJSONModel').setData(D);this._chart.setModel(this.getModel('__alp_chartJSONModel'));var e=this.getFixedCount(),f={path:'/',template:new a(this._getChartAggregationSettings()),startIndex:0,length:e};this._chart.bindPoints(f);this._chart.setBusy(false);};return c;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.SmartVisualFilterBar')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.SmartVisualFilterBar');jQuery.sap.require('sap.m.HeaderContainer');jQuery.sap.require('sap.m.Label');jQuery.sap.require('sap.ui.comp.odata.ODataModelUtil');jQuery.sap.require('sap.ui.comp.smartfilterbar.FilterProvider');jQuery.sap.require('sap.ui.comp.smartvariants.PersonalizableInfo');jQuery.sap.require('sap.ui.comp.smartvariants.SmartVariantManagement');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.ui.comp.odata.MetadataAnalyser');jQuery.sap.require('sap.m.VBox');jQuery.sap.require('sap.m.Button');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/SmartVisualFilterBar",["sap/m/HeaderContainer","sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterDialogController","sap/m/Label","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/smartfilterbar/FilterProvider","sap/suite/ui/generic/template/AnalyticalListPage/control/visualfilterbar/VisualFilterProvider","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/model/Filter","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/ui/comp/odata/MetadataAnalyser","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/V4Terms","sap/m/VBox","sap/m/Button","sap/suite/ui/generic/template/AnalyticalListPage/controller/DropDownController"],function(H,V,L,O,F,a,P,S,b,c,T,M,d,f,g,B,D){"use strict";var o=sap.ui.model.SimpleType.extend("sap.ui.model.DimensionFilterType",{formatValue:function(v){return v;},parseValue:function(v){return v;},validateValue:function(v){}});var h=H.extend("sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.SmartVisualFilterBar",{metadata:{designTime:true,properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},config:{type:"object",group:"Misc",defaultValue:null},persistencyKey:{type:"string",group:"Misc",defaultValue:null},displayCurrency:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null}},associations:{smartVariant:{type:"sap.ui.core.Control",multiple:false}},events:{filterChange:{}}},renderer:{}});h.prototype.init=function(){if(H.prototype.init){H.prototype.init.apply(this,arguments);}var i=jQuery(document.body).hasClass("sapUiSizeCozy");this._cellItemHeightNorth="2.0rem";this._cellItemHeightSouth=i?"9.9rem":"7.9rem";this._cellHeight=i?"12rem":"10.9rem";this._cellWidth="20rem";this.labelHeight=2.0;this.compHeight=i?9.9:7.9;this.cellHeightPadding=1;this.cellHeight=(this.labelHeight+this.compHeight+this.cellHeightPadding)+"rem";this.cellWidth=320;this._dialogFilters={};this._compactFilters={};this._oVariantConfig={};this._smartFilterContext;this._oMetadataAnalyser;this.setModel(new sap.ui.model.json.JSONModel(),'_visualFilterConfigModel');if(i){if(sap.ui.Device.system.phone){this.setOrientation("Vertical");this.addStyleClass("sapSmartTemplatesAnalyticalListPageVisualFilterBarCozyPhone");}else{this.addStyleClass("sapSmartTemplatesAnalyticalListPageVisualFilterBarCozy");}}else{this.addStyleClass("sapSmartTemplatesAnalyticalListPageVisualFilterBar");}};h.prototype.propagateProperties=function(){H.prototype.propagateProperties.apply(this,arguments);this._initMetadata();};h.prototype._initMetadata=function(){if(!this.bIsInitialised){O.handleModelInit(this,this._onMetadataInit);}};h.prototype._onMetadataInit=function(){if(this.bIsInitialised){return;}this._annoProvider=this._createVisualFilterProvider();if(!this._annoProvider){return;}this._oMetadataAnalyser=this._annoProvider.getMetadataAnalyser();this.bIsInitialised=true;this._updateFilterBar();};h.prototype._createVisualFilterProvider=function(){var m=this.getModel();var e=this.getEntitySet();if(!m||!e){return null;}return new a(this);};h.prototype._getBasicGroupTitle=function(){return this.getModel("i18n").getResourceBundle().getText("VIS_FILTER_GRP_BASIC_TITLE");};h.prototype._getFieldGroupForProperty=function(e,C){return this._annoProvider?this._annoProvider._getFieldGroupForProperty(e,C):undefined;};h.prototype._getGroupList=function(){return this._annoProvider?this._annoProvider.getGroupList():[];};h.prototype._getGroupMap=function(){return this._annoProvider?this._annoProvider.getGroupMap():{};};h.prototype._getMeasureMap=function(){return this._annoProvider?this._annoProvider.getMeasureMap():{};};h.prototype._getDimensionMap=function(){return this._annoProvider?this._annoProvider.getDimensionMap():{};};h.prototype.setSmartFilterContext=function(C){this._smartFilterContext=C;};h.prototype._updateFilterBar=function(){var e=this._getAnnotationSettings();if(e&&e.filterList){var i=this._convertSettingsToConfig(e);}else{i={filterCompList:[]};this.getModel('_visualFilterConfigModel').setData(i);return;}var v=this._getVariantConfig();if(v&&v.config){i.filterCompList.forEach(function(j){if(v.config[j.component.properties.parentProperty]){jQuery.extend(true,j,v.config[j.component.properties.parentProperty]);}});this._oVariantConfig=i;}this.unbindAggregation('content',true);this.getModel('_visualFilterConfigModel').setData(i);this.bindAggregation('content',{path:"_visualFilterConfigModel>/filterCompList",factory:function(I,C){var j=C.getProperty('component'),p=j?j.properties:undefined,s=this._resolveChartType(j?j.type:undefined);return this._createHeaderItems(C.sPath,s,p);}.bind(this),filters:new sap.ui.model.Filter("shownInFilterBar",sap.ui.model.FilterOperator.EQ,true)});return;};h.prototype._createHeaderItems=function(p,t,i){var j=this._createFilterItemOfType(t,i),I=j.getInParameters(),k=[],m=this;if(I&&I.length>0){I.forEach(function(e){k.push({path:'_filter>/'+e.localDataProperty});});}j.addCustomData(new sap.ui.core.CustomData({key:'sPath',value:p}));if(m.getEntitySet()===j.getEntitySet()){var l=m._smartFilterContext.determineMandatoryFilterItems();if(l&&l.length>0){l.forEach(function(e){if(!e.data("isCustomField")){k.push({path:'_filter>/'+e.getName()});}});}}j.bindProperty('dimensionFilter',{path:'_filter>/'+j.getParentProperty(),type:new o()});j.bindProperty('measureField',{path:'_visualFilterConfigModel>'+p+'/component/properties/measureField'});j.bindProperty('sortOrder',{path:'_visualFilterConfigModel>'+p+'/component/properties/sortOrder'});j.bindProperty('unitField',{path:'_visualFilterConfigModel>'+p+'/component/properties/measureField',formatter:function(){var e=m._getMeasureMap();var u=e[this.getEntitySet()][this.getMeasureField()];return u?u.fieldInfo.unit:"";}});if(k&&k.length>0){j.bindProperty('dimensionFilterExternal',{parts:k,formatter:function(){var I=this.getInParameters(),u=this.getParentProperty();var v,w;if(m.getEntitySet()===this.getEntitySet()){var l=m._smartFilterContext.determineMandatoryFilterItems();l.forEach(function(Y){var Z=Y.getName();var $=I&&I.some(function(e){return e.localDataProperty===Z;});if(Z.indexOf("$Parameter")===-1&&!$){I.push({localDataProperty:Z,valueListProperty:Z});}});}if(!(m.getEntitySet()===this.getEntitySet()&&m._smartFilterContext.getAnalyticBindingPath()!=="")&&(m._smartFilterContext.getAnalyticBindingPath()===""||m._smartFilterContext.getAnalyticBindingPath().indexOf("P_DisplayCurrency")!=-1)){var x=this.getMeasureField();var y=m.getModel();var z=y.getMetaModel();var E=z.getODataEntityType(m._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.getEntitySet()));var A=z.getODataEntitySet(this.getEntitySet());var G=z.getODataProperty(E,x);var J=m.getProperty("displayCurrency");var K=G&&G[f.ISOCurrency];if(J&&K){var N=K.Path;for(var Q=(I.length-1);Q>-1;Q--){var R=I[Q].valueListProperty;var U=I[Q].localDataProperty;if(R===N){var W=m._smartFilterContext.getFilterData();if(!W[U]){w=z.getODataProperty(E,N);var X=w&&d.isPropertyNonFilterable(A,w.name);if(!X){v=new b({aFilters:[new b({path:N,operator:"EQ",value1:J,value2:undefined})],and:false});}}break;}}}}return m._getFiltersForFilterItem(I,u,v,N);}});}if(j.attachFilterChange){j.attachFilterChange(this._onFilterChange,this);}if(j.attachTitleChange){j.attachTitleChange(this._onTitleChange,this);}var n=this._createTitleToolbar(i,j),q=new g({height:this._cellItemHeightNorth,items:[n]});var r=new g({width:"100%",height:this._cellItemHeightSouth,items:[new sap.m.Text({width:this.cellWidth+"px",textAlign:sap.ui.core.TextAlign.Center,text:{path:'_visualFilterConfigModel>'+p+'/overlayMessage',formatter:function(e){return this.getModel("i18n").getResourceBundle().getText(e);}}})],visible:{path:'_visualFilterConfigModel>'+p+'/showChartOverlay',formatter:function(v){return v;}}});r.addStyleClass("sapUiOverlay");r.addStyleClass("sapSmartTemplatesAnalyticalListPageVFOverflow");r.addStyleClass("sapSmartTemplatesAnalyticalListPageVFOverflowCozy");var s=new g({height:this._cellItemHeightSouth,items:[j],visible:{path:"_visualFilterConfigModel>"+p+"/showChartOverlay",formatter:function(v){return!v;}}});var C=new g({fieldGroupIds:["headerBar"],height:this._cellHeight,width:this.cellWidth+"px",items:[q,r,s]});return C;};h.prototype._getAnnotationSettings=function(){return this._annoProvider?this._annoProvider.getVisualFilterConfig():null;};h.prototype._convertSettingsToConfig=function(s,I){var e={filterCompList:[]};var k=this._getGroupList();var l={};for(var i=0;i<k.length;i++){var m=k[i];for(var j=0;j<m.fieldList.length;j++){var n=m.fieldList[j];l[n.name]={name:m.name,label:m.label};}}var p=this._getGroupMap();var q=p["_BASIC"];var r=[];if(q&&q.fieldList){for(var i=0;i<q.fieldList.length;i++){r.push(q.fieldList[i].name);}}var t=this._getMeasureMap(),u=s.filterList,v={};for(var i=0;i<u.length;i++){var w=u[i];var x=w.dimension.field;var y=t[w.collectionPath][w.measure.field];var z=false;if(y.fieldInfo[f.ISOCurrency]){z=true;}var C={shownInFilterBar:w.selected,component:{type:w.type,properties:{sortOrder:w.sortOrder,measureField:w.measure.field,parentProperty:w.parentProperty?w.parentProperty:undefined}}};if(!I){var A={shownInFilterDialog:w.selected||r.indexOf(x)!=-1,group:l[w.parentProperty],component:{properties:{scaleFactor:w.scaleFactor,numberOfFractionalDigits:w.numberOfFractionalDigits,filterRestriction:w.filterRestriction,width:this.cellWidth+"px",height:this.compHeight+"rem",entitySet:w.collectionPath?w.collectionPath:this.getEntitySet(),dimensionField:x,dimensionFieldDisplay:w.dimension.fieldDisplay,dimensionFilter:w.dimensionFilter,unitField:y?y.fieldInfo.unit:"",isCurrency:z,isDropDown:w.isDropDown,isMandatory:w.isMandatory,outParameter:w.outParameter?w.outParameter:undefined,inParameters:w.inParameters?w.inParameters:undefined,textArrangement:w.displayBehaviour,chartQualifier:w.chartQualifier?w.chartQualifier:undefined,dimensionFieldIsDateTime:w.dimensionFieldIsDateTime}}};jQuery.extend(true,C,A);e.filterCompList.push(C);}else{v[w.parentProperty]=C;}}return I?v:e;};h.prototype._setVariantModified=function(){if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true);}};h.prototype._onFilterChange=function(e){this._setVariantModified();this.fireFilterChange();};h.prototype._getFiltersForFilterItem=function(i,p,e,j){var k={},m=[],l=new sap.ui.model.Filter({aFilters:[],and:true});if(i){var r=function(s){s.sPath=v;};for(var n=(i.length-1);n>-1;n--){var q=i[n].localDataProperty,v=i[n].valueListProperty;if(q!==p&&m.indexOf(q)===-1){k=this._smartFilterContext.getFilters([q]);if(k&&k.length>0){if(k[0].aFilters){k[0].aFilters.forEach(r.bind(this));}else{r(k[0]);}m.push(q);l.aFilters.push(k[0]);}}}if(e){l.aFilters.push(e);}}return l;};h.prototype._createTitleToolbar=function(p,e){var t=new L({text:{path:"i18n>VIS_FILTER_TITLE_MD",formatter:function(){return e.getTitle();}}});if(e.getProperty("isMandatory")){t.addStyleClass("sapMLabelRequired");}var i=this._smartFilterContext.getControlByKey(p.parentProperty);this._smartFilterContext.ensureLoadedValueHelp(p.parentProperty);if(i){var j=d.getPropertyNameDisplay(this.getModel(),e.getEntitySet(),e.getDimensionField()),r=this.getModel("i18n").getResourceBundle(),I=i.getShowValueHelp&&i.getShowValueHelp(),s=(p.isDropDown)?"sap-icon://slim-arrow-down":"",k=I?"sap-icon://value-help":s,l,m=new B({text:{path:"_filter>/"+e.getParentProperty(),formatter:function(C){var q=e.getFilterRestriction();l=0;if(C){if(q==='single'){l=1;}else{if(typeof C==="object"){if(C.value){l++;}if(C.items&&C.items.length){l+=C.items.length;}if(C.ranges&&C.ranges.length){l+=C.ranges.length;}}else{l++;}}}return l?"("+l+")":"";}},icon:(I||p.isDropDown)?k:"",visible:{path:"_filter>/"+e.getParentProperty(),formatter:function(C){if(I||p.isDropDown){return true;}else{if(!C){return false;}if(typeof C==="object"){return(C.value||(C.items&&C.items.length)||(C.ranges&&C.ranges.length))?true:false;}return true;}}},press:function(E){if(I){i.fireValueHelpRequest.call(i);}else if(p.isDropDown){D.createDropdown(E.getSource(),e,this.getModel(),j,p);}else{V.launchAllFiltersPopup(m,e,E.getSource().getModel('i18n'));}},layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow}),tooltip:{path:"_filter>/"+e.getParentProperty(),formatter:function(){return d.getTooltipForValueHelp(I,j,r,l);}}});}var n=new c({design:sap.m.ToolbarDesign.Transparent,width:this.cellWidth+"px",content:[t,new T(),m]});n.addStyleClass("sapSmartTemplatesAnalyticalListPageVisualFilterTitleToolbar");return n;};h.prototype.getTitleByFilterItemConfig=function(e,u,s){var p=e.component.properties;var i=p.entitySet;var m=this.getModel();if(!m){return"";}var j=d.getPropertyNameDisplay(m,i,p.measureField);var k=d.getPropertyNameDisplay(m,i,p.dimensionField);if(!u){u="";}if(!s){s="";}var t="";var r=this.getModel("i18n").getResourceBundle();if(s&&u){t=r.getText("VIS_FILTER_TITLE_MD_UNIT_CURR",[j,k,s,u]);}else if(u){t=r.getText("VIS_FILTER_TITLE_MD_UNIT",[j,k,u]);}else if(s){t=r.getText("VIS_FILTER_TITLE_MD_UNIT",[j,k,s]);}else{t=r.getText("VIS_FILTER_TITLE_MD",[j,k]);}return t;};h.prototype._onTitleChange=function(e){var C=e.getSource().getParent().getParent();var l=C.getItems()[0].getItems()[0].getContent()[0];if(e.getSource().getProperty("isMandatory")){l.addStyleClass("sapMLabelRequired");}l.setText(e.getSource().getTitle());l.setTooltip(e.getSource().getTitle());};h.prototype._getSupportedFilterItemList=function(){if(!this._supportedFilterItemList){this._supportedFilterItemList=[{type:"Bar",className:"sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroBar",iconLink:"sap-icon://horizontal-bar-chart",textKey:"VISUAL_FILTER_CHART_TYPE_BAR"},{type:"Donut",className:"sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroDonut",iconLink:"sap-icon://donut-chart",textKey:"VISUAL_FILTER_CHART_TYPE_Donut"},{type:"Line",className:"sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.FilterItemMicroLine",iconLink:"sap-icon://line-charts",textKey:"VISUAL_FILTER_CHART_TYPE_Line"}];}return this._supportedFilterItemList;};h.prototype._getSupportedFilterItemMap=function(){if(!this._supportedFilterItemMap){this._supportedFilterItemMap={};var e=this._getSupportedFilterItemList();for(var i=0;i<e.length;i++){var j=e[i];this._supportedFilterItemMap[j.type]=j;}}return this._supportedFilterItemMap;};h.prototype._resolveChartType=function(t){var e=this._getSupportedFilterItemMap();var i=e[t];if(!i){var j;for(j in e){i=e[j];break;}jQuery.sap.log.error("Could not resolve the filter component type: \""+t+"\", falling back to "+j);t=j;}return t;};h.prototype._createFilterItemOfType=function(t,p){var e=this._getSupportedFilterItemMap();var i=e[t];var j=i.className;jQuery.sap.require(j);var k=jQuery.sap.getObject(j);var l=new k(p);l.setSmartFilterId(this.getSmartFilterId());l.setModel(this.getModel('_filter'),'_filter');l.setModel(this.getModel('i18n'),'i18n');l.setModel(this.getModel("_templPriv"),"_templPriv");l.setModel(this.getModel('_visualFilterConfigModel'),"_visualFilterConfigModel");l.setModel(this.getModel());return l;};h.prototype.getConfig=function(I){var e=this.getModel('_visualFilterConfigModel').getData(),v={};if(!e){return{filterCompList:[]};}var j=0;var k=sap.ui.getCore().byFieldGroupId("headerBar");for(var i=0;i<e.filterCompList.length;i++){var l=e.filterCompList[i];if(I){v[l.component.properties.parentProperty]={shownInFilterBar:l.shownInFilterBar,component:{type:l.component.type,properties:{measureField:l.component.properties.measureField,sortOrder:l.component.properties.sortOrder,parentProperty:l.component.properties.parentProperty}}};}else{if(!l.shownInFilterBar){continue;}var m=k[j];if(!m){jQuery.sap.log.error("The configured selected filter bar items do not correspond to the actual filter bar items.  Could be an error during initialization, e.g. a chart class not found");return{filterCompList:[]};}j++;if(m._chart){var n=m;l.component.properties=n.getP13NConfig();}}}return I?v:e;};h.prototype.setSmartVariant=function(s){this.setAssociation("smartVariant",s);if(s){var p=new P({type:"sap.suite.ui.generic.template.AnalyticalListPage.control.visualfilterbar.SmartVisualFilterBar",keyName:"persistencyKey"});p.setControl(this);}this._oVariantManagement=this._getVariantManagementControl(s);if(this._oVariantManagement){this._oVariantManagement.addPersonalizableControl(p);this._oVariantManagement.initialise(this._variantInitialised,this);this._oVariantManagement.attachSave(this._onVariantSave,this);}else if(s){if(typeof s==="string"){jQuery.sap.log.error("Variant with id="+s+" cannot be found");}else if(s instanceof sap.ui.core.Control){jQuery.sap.log.error("Variant with id="+s.getId()+" cannot be found");}}else{jQuery.sap.log.error("Missing SmartVariant");}};h.prototype._getVariantManagementControl=function(s){var e=null;if(s){e=typeof s=="string"?sap.ui.getCore().byId(s):s;if(e&&!(e instanceof S)){jQuery.sap.log.error("Control with the id="+s.getId?s.getId():s+" not of expected type");return null;}}return e;};h.prototype._variantInitialised=function(){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD";}};h.prototype._onVariantSave=function(){if(this._oCurrentVariant=="STANDARD"){this._oCurrentVariant={config:this.getConfig(true)};}};h.prototype.applyVariant=function(v,C){this._oCurrentVariant=v;if(this._oCurrentVariant=="STANDARD"){this._oCurrentVariant=null;}if(this._oCurrentVariant&&this._oCurrentVariant.config&&this._oCurrentVariant.config.filterCompList){this._oCurrentVariant.config=null;}if(this._oCurrentVariant&&this._oCurrentVariant.config==null){var e=this._getAnnotationSettings();if(e&&e.filterList){this._oCurrentVariant.config=this._convertSettingsToConfig(e,true);}}this._updateFilterBar();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false);}};h.prototype._getVariantConfig=function(){return this._oCurrentVariant;};h.prototype.fetchVariant=function(){if(!this._oCurrentVariant||this._oCurrentVariant=="STANDARD"){var e=this._getAnnotationSettings();if(e&&e.filterList){this._oCurrentVariant={config:this._convertSettingsToConfig(e,true)};return this._oCurrentVariant;}else{return{config:null};}}return{config:this.getConfig(true)};};h.prototype.updateVisualFilterBindings=function(A){var e=sap.ui.getCore().byFieldGroupId("headerBar");for(var i=0;i<e.length;i++){if(e[i]._chart){e[i]._updateBinding();e[i]._bAllowBindingUpdateOnPropertyChange=A===true;}}};h.prototype.addVisualFiltersToBasicArea=function(p){var e=jQuery.extend(true,{},this.getModel('_visualFilterConfigModel').getData()),j=(p&&p.constructor===Array&&p.length)?p.length:0,C=0;if(!e){jQuery.sap.log.error("Could not add filter to basic area. No config found!");return false;}else if(!j){jQuery.sap.log.error("Improper parameter passed. Pass an array of properties.");return false;}else{for(var i=0;i<e.filterCompList.length;i++){var k=e.filterCompList[i];if(p.indexOf(d.readProperty(k.component.properties.parentProperty))!==-1&&!k.shownInFilterBar){k.shownInFilterBar=true;k.shownInFilterDialog=true;C++;}}if(C){this.getModel('_visualFilterConfigModel').setData(e);return true;}else{jQuery.sap.log.info("Filters already present in visual filter basic area");return false;}}};return h;},true);};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.ContentAreaController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.ContentAreaController');jQuery.sap.require('sap.m.OverflowToolbar');jQuery.sap.require('sap.m.ToolbarSpacer');jQuery.sap.require('sap.m.FlexItemData');jQuery.sap.require('sap.m.ToolbarDesign');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/ContentAreaController",["sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/FlexItemData","sap/m/ToolbarDesign","sap/ui/core/mvc/Controller","sap/suite/ui/generic/template/AnalyticalListPage/controller/SmartChartController","sap/suite/ui/generic/template/AnalyticalListPage/controller/DetailController"],function(O,T,F,a,C,S,D){"use strict";var c=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.ContentAreaController",{setState:function(s){if(s.oSmartChart){s.chartController=new S();s.chartController.setState(s);}if(s.oSmartTable){s.detailController=new D();s.detailController.setState(s);}this.oState=s;s.bCustomViewExist=(s.oController.byId("template::contentViewExtensionToolbar")!==undefined);s.toolbarController.setState(s);},enableToolbar:function(){if(this.oState.oSmartChart){this.oState.oSmartChart.getToolbar().setEnabled(true);}if(this.oState.oSmartTable){this.oState.oSmartTable.getCustomToolbar().setEnabled(true);}},createAndSetCustomModel:function(s){var o=new sap.ui.model.json.JSONModel();o.setData({required:{master:true},icon:{master:"sap-icon://vertical-bar-chart-2",hybrid:"sap-icon://chart-table-view",customview:"sap-icon://grid"},tooltip:{master:"{i18n>CONTAINER_VIEW_CHART}",hybrid:"{i18n>CONTAINER_VIEW_CHARTTABLE}",customview:"Custom View"}});s.oController.onAfterCustomModelCreation(o);s.oController.oView.setModel(o,"alpCustomModel");}});return c;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.FilterBarController')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.FilterBarController');jQuery.sap.require('sap.m.SegmentedButtonItem');jQuery.sap.require('sap.m.Button');jQuery.sap.require('sap.m.ButtonType');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.m.Dialog');jQuery.sap.require('sap.m.SegmentedButton');jQuery.sap.require('sap.ui.core.mvc.Controller');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/FilterBarController",["sap/m/SegmentedButtonItem","sap/m/Button","sap/m/ButtonType","sap/m/Text","sap/m/Dialog","sap/m/SegmentedButton","sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterDialogController","sap/ui/core/mvc/Controller","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil"],function(S,B,a,T,D,b,V,C,F){"use strict";var c="visual";var f=C.extend("sap.suite.ui.generic.template.AnalyticalListPage.controller.FilterBarController",{init:function(s){this.compactFilterData={};var m=this;m.oState=s;var d;if(sap.ui.Device.system.phone){d=true;}else{d=m.oState.oController.getOwnerComponent().getShowGoButtonOnFilterBar()?true:false;}s.oSmartFilterbar.setShowGoOnFB(d);s.oSmartFilterbar.setLiveMode(!d);s.oSmartFilterbar.setShowMessages(d);if(s.oSmartTable){s.oSmartTable.setEnableAutoBinding(!d);}if(!d){m.oState.oSmartFilterbar._oFiltersButton.setVisible(false);}s.oHeader=s.oPage.getHeader();s.oTitle=s.oPage.getTitle();if(s.oKpiTagContainer){s.alr_filterContainer.removeContent(s.oKpiTagContainer);s.oKpiTagContainer.addStyleClass("sapSmartTemplatesAnalyticalListPageKpiTagContainer");}if(s.alr_visualFilterBar){s.alr_visualFilterBar.setSmartFilterContext(this.oState.oSmartFilterbar);s.alr_visualFilterBar.attachFilterChange(this._onVisualFilterChange.bind(this));}s.oSmartFilterbar.attachAfterVariantLoad(this._afterVariantLoad.bind(this));},_updateFilterLink:function(){var o=this.oState.oSmartFilterbar.getFilterData(),t=this.oState.oController.getOwnerComponent().getModel("_templPriv");t.setProperty('/alp/filtersLink',o);},_afterVariantLoad:function(e){if(this.oState.alr_visualFilterBar){this.oState.alr_visualFilterBar.updateVisualFilterBindings(true);}if(this.oState.oSmartFilterbar.isLiveMode()&&e.mParameters.context!="INIT"){this.oState.oSmartFilterbar.search();}},_onVisualFilterChange:function(e){var o=this.oState.oController.getOwnerComponent().getModel("_filter"),d=o.getData();if(e.getParameter('propertyName')&&e.getParameter('bVisible')!==undefined){var g=this.oState.oSmartFilterbar.determineFilterItemByName(e.getParameter('propertyName'));if(e.getParameter('bVisible')){if(!g.getPartOfCurrentVariant()){g.setPartOfCurrentVariant(true);g.setVisibleInFilterBar(true);}}else{g.setPartOfCurrentVariant(false);g.setVisibleInFilterBar(false);}}this.oState.oSmartFilterbar.setFilterData(d,true);if(this.oState.oSmartFilterbar.isLiveMode()){this.oState.oSmartFilterbar.search();}},onGoFilter:function(){this.oState.oSmartFilterbar.search();},setDefaultFilter:function(m){var t=this.oState.oController.getOwnerComponent().getModel("_templPriv");t.setProperty('/alp/filterMode',m);this.handleFilterSwitch(m);},handleFilterSwitch:function(m,A){var t=this.oState.oController.getOwnerComponent().getModel("_templPriv");if(t.getProperty('/alp/filterMode')===c){this.fnCheckMandatory();}},fnCheckMandatory:function(){this.oState.oSmartFilterbar.checkSearchAllowed(this.oState);var t=this.oState.oController.getOwnerComponent().getModel("_templPriv");if(!t.getProperty('/alp/searchable')){this.oState.oSmartFilterbar.showFilterDialog();}},showDialog:function(){this.oState.oSmartFilterbar.showFilterDialog();},clearFilters:function(){var o=this.oState.oSmartFilterbar.getFilterData();for(var p in o){if(o.hasOwnProperty(p)){delete o[p];}}this.oState.oSmartFilterbar.setFilterData(o,true);if(this.oState.chartController){this.oState.chartController._updateTable();}},changeVisibility:function(e){var o=e.getParameters().filterItem.filterItem,v=e.getParameters().added?true:false,d=this.oState.alr_visualFilterBar.getModel('_visualFilterConfigModel').getData().filterCompList,g=this.oState.visualFilterDialogContainer;for(var i=0;i<d.length;i++){if(o&&o.getName()===d[i].component.properties.parentProperty){g.oConfig.filterCompList[i].shownInFilterDialog=v;g.oConfig.filterCompList[i].shownInFilterBar=v;g._updateVisualFilterConfigModel(i,'/shownInFilterDialog',v);g.selectCheckBox(i,v);break;}}g._reloadForm();}});return f;});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.Canvas.controller.ControllerImplementation')){jQuery.sap.declare('sap.suite.ui.generic.template.Canvas.controller.ControllerImplementation');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/suite/ui/generic/template/Canvas/controller/ControllerImplementation",["jquery.sap.global","sap/suite/ui/generic/template/detailTemplates/detailUtils","sap/suite/ui/generic/template/Canvas/extensionAPI/ExtensionAPI"],function(q,d,E){"use strict";return{getMethods:function(v,t,c){var b=d.getControllerBase(v,t,c);var C={onInit:function(){var o=c.getOwnerComponent();var r=o.getRequiredControls();b.onInit(r);},handlers:{},extensionAPI:new E(t,c,b)};C.handlers=q.extend(b.handlers,C.handlers);v.onComponentActivate=b.onComponentActivate;return C;}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.controller.ControllerImplementation')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.controller.ControllerImplementation');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.ObjectIdentifier');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.ui.comp.smartfield.SmartField');jQuery.sap.require('sap.ui.generic.app.navigation.service.SelectionVariant');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.comp.navpopover.LinkData');sap.ui.define("sap/suite/ui/generic/template/ListReport/controller/ControllerImplementation",["jquery.sap.global","sap/ui/model/json/JSONModel","sap/m/ObjectIdentifier","sap/m/Table","sap/m/Text","sap/ui/comp/smartfield/SmartField","sap/ui/generic/app/navigation/service/SelectionVariant","sap/suite/ui/generic/template/ListReport/extensionAPI/ExtensionAPI","sap/m/MessageBox","sap/suite/ui/generic/template/js/AnnotationHelper","sap/suite/ui/generic/template/lib/MessageUtils","sap/suite/ui/generic/template/ListReport/controller/IappStateHandler","sap/suite/ui/generic/template/ListReport/controller/MultipleViewsHandler","sap/ui/model/Filter","sap/ui/comp/navpopover/LinkData"],function(q,J,O,T,a,S,b,E,M,A,c,I,d,F,L){"use strict";return{getMethods:function(v,t,C){var s={};var e=true;var f;var w=null;function g(){var i=C.getOwnerComponent();var r=t.oComponentUtils.getTemplatePrivateModel();r.setProperty("/listReport/isLeaf",i.getIsLeaf());}function h(){var G=q.sap.getObject("sap.ushell.Container.getUser");var i=C.getOwnerComponent().getAppComponent().getMetadata().getManifestEntry("sap.ui");var B=(i&&i.icons&&i.icons.icon)||"";var r={bookmarkIcon:B,bookmarkCustomUrl:function(){var H=hasher.getHash();return H?("#"+H):window.location.href;},bookmarkServiceUrl:function(){var y=s.oSmartTable.getTable();var z=y.getBinding("rows")||y.getBinding("items");return z?z.getDownloadUrl()+"&$top=0&$inlinecount=allpages":"";},isShareInJamActive:!!G&&G().isJamActive()};var x=t.oComponentUtils.getTemplatePrivateModel();x.setProperty("/listReport/share",r);}function o(i){C.onInitSmartFilterBarExtension(i);s.oIappStateHandler.onSmartFilterBarInitialise();}function j(){var i=s.oIappStateHandler.parseUrlAndApplyAppState();i.then(function(){e=false;},function(r){if(r instanceof Error){r.showMessageBox();}});}function k(){if(!e){s.oIappStateHandler.changeIappState(true,false);}}function u(i){var r=C.getOwnerComponent().getModel(),x=t.oComponentUtils.getTemplatePrivateModel();var y=r.getMetaModel(),z=y.getODataEntitySet(C.getOwnerComponent().getEntitySet()),D=z["Org.OData.Capabilities.V1.DeleteRestrictions"];var B=false;if(sap.suite.ui.generic.template.js.AnnotationHelper.areDeleteRestrictionsValid(y,z.entityType,D)){var G=D&&D.Deletable&&D.Deletable.Path;var H=t.oCommonUtils.getSelectedContexts(i);B=H.some(function(K){var N=r.getObject(K.getPath()+"/DraftAdministrativeData");var P=!(N&&N.InProcessByUser&&!N.DraftIsProcessedByMe);return P&&!(G&&!r.getProperty(G,K));});}x.setProperty("/listReport/deleteEnabled",B);t.oCommonUtils.setEnabledToolbarButtons(i);if(!t.oCommonUtils.isSmartChart(i)){t.oCommonUtils.setEnabledFooterButtons(i);}}function l(i){var r=i.getParameters();var x=i.getSource();t.oCommonEventHandlers.onSemanticObjectLinkNavigationPressed(x,r);}function m(i){var r,x;r=i.getParameters();x=i.getSource();t.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(x,r,s,undefined,undefined);}function n(i){var r,x,y,D,z,B;r=i.getParameters().mainNavigation;z=i.getParameters();B=i.getSource();if(r){x=B.getText&&B.getText();y=t.oCommonUtils.getCustomData(i);if(y&&y["LinkDescr"]){D=y["LinkDescr"];r.setDescription(D);}}B=B.getParent().getParent().getParent().getParent();t.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(B,z,s,x,r);}function p(r){var x=v.getItems();for(var i=0;i<x.length;i++){if(!r||x[i].getBindingContextPath()===r){return x[i];}}}return{onInit:function(){var i=C.getOwnerComponent().getAppComponent();var r=i.getConfig();s.bWorkListEnabled=!!r.pages[0].component.settings&&r.pages[0].component.settings.isWorklist||false;s.oSmartFilterbar=C.byId("listReportFilter");s.oSmartTable=C.byId("listReport");s.updateControlOnSelectionChange=u;f=t.oServices.oApplication.getFclProxyForView(0);s.bLoadListAndFirstEntryOnStartup=f&&f.isListAndFirstEntryLoadedOnStartup&&f.isListAndFirstEntryLoadedOnStartup();s.oMultipleViewsHandler=new d(s,C,t);s.oIappStateHandler=new I(s,C,t.oCommonUtils.getNavigationHandler());t.oServices.oApplication.registerStateChanger({isStateChange:s.oIappStateHandler.isStateChange});v.getUrlParameterInfo=s.oIappStateHandler.getUrlParameterInfo;v.getItems=function(){var y=s.oSmartTable.getTable();if(t.oCommonUtils.isUiTable(y)){return y.getRows();}return y.getItems();};v.displayNextObject=function(y){return new Promise(function(z,B){w={aWaitingObjects:y,resolve:z,reject:B};});};v.onComponentActivate=function(){if(!e){s.oIappStateHandler.parseUrlAndApplyAppState();}};v.refreshBinding=function(){if(s.oIappStateHandler.areDataShownInTable()){if(s.oMultipleViewsHandler.getMode()==="multi"){var y=s.oMultipleViewsHandler.getImplementingHelper();var z=s.oSmartTable.getModel("_templPrivGlobal");var B=z.getProperty("/generic/multipleViews/objectPage/currentEntitySet");y.setTablesToDirtyByEntitySet(B,true);z.setProperty("/generic/multipleViews/objectPage/currentEntitySet",null);}t.oCommonUtils.refreshSmartTable(s.oSmartTable);}};g();h();C.byId("template::FilterText").attachBrowserEvent("click",function(){C.byId("page").setHeaderExpanded(true);});var x=t.oComponentUtils.getTemplatePrivateModel();x.setProperty("/listReport/isHeaderExpanded",true);x.setProperty("/listReport/deleteEnabled",false);if(s.bWorkListEnabled){s.oSmartFilterbar.setSuppressSelection(false);s.oSmartFilterbar.search();}},handlers:{addEntry:function(i){var r=i.getSource();t.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){t.oCommonEventHandlers.addEntry(r,false,s.oSmartFilterbar);},q.noop,s);},deleteEntries:function(i){t.oCommonEventHandlers.deleteEntries(i);},updateTableTabCounts:function(){s.oMultipleViewsHandler.fnUpdateTableTabCounts();},onSelectionChange:function(i){var r=i.getSource();u(r);},onChange:function(i){t.oCommonEventHandlers.onChange(i);},onSmartFieldUrlPressed:function(i){t.oCommonEventHandlers.onSmartFieldUrlPressed(i,s);},onBreadCrumbUrlPressed:function(i){t.oCommonEventHandlers.onBreadCrumbUrlPressed(i,s);},onContactDetails:function(i){t.oCommonEventHandlers.onContactDetails(i);},onSmartFilterBarInitialise:o,onSmartFilterBarInitialized:j,onBeforeSFBVariantFetch:function(){s.oIappStateHandler.onBeforeSFBVariantFetch();},onAfterSFBVariantSave:function(){s.oIappStateHandler.onAfterSFBVariantSave();},onAfterSFBVariantLoad:function(i){s.oIappStateHandler.onAfterSFBVariantLoad(i);},onDataRequested:function(){s.oMultipleViewsHandler.onDataRequested();},onDataReceived:function(r){t.oCommonEventHandlers.onDataReceived(r);var x=s.oMultipleViewsHandler.getImplementingHelper();if(x&&typeof x.setTableDirty==='function'){x.setTableDirty(s.oSmartTable,false);}if(w){var y;var z=false;for(var i=0;i<w.aWaitingObjects.length&&!z;i++){y=p(w.aWaitingObjects[i]);if(y){t.oCommonEventHandlers.onListNavigate(y,s);w.resolve();z=true;}}if(!z){y=p();if(y){t.oCommonEventHandlers.onListNavigate(y,s);w.resolve();}else{w.reject();}}w=null;return;}var B=r.getSource().getTable();f.handleDataReceived(B,s,t);},onSmartChartDataReceived:function(){s.oMultipleViewsHandler.onDataRequested();},onBeforeRebindTable:function(i){t.oCommonEventHandlers.onBeforeRebindTable(i,{determineSortOrder:s.oMultipleViewsHandler.determineSortOrder});C.onBeforeRebindTableExtension(i);s.oMultipleViewsHandler.onRebindContentControl(i);},onShowDetails:function(i){t.oCommonEventHandlers.onShowDetails(i.getSource(),s);},onListNavigate:function(i){if(!C.onListNavigationExtension(i)){t.oCommonEventHandlers.onListNavigate(i.getSource(),s);}},onCallActionFromToolBar:function(i){t.oCommonEventHandlers.onCallActionFromToolBar(i,s);},onDataFieldForIntentBasedNavigation:function(i){t.oCommonEventHandlers.onDataFieldForIntentBasedNavigation(i,s);},onDataFieldWithIntentBasedNavigation:function(i){t.oCommonEventHandlers.onDataFieldWithIntentBasedNavigation(i,s);},onBeforeSemanticObjectLinkPopoverOpens:function(i){var r=i.getParameters();t.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var x=JSON.stringify(s.oSmartFilterbar.getUiState().getSelectionVariant());t.oCommonUtils.semanticObjectLinkNavigation(r,x,C);},q.noop,s,q.noop);},onSemanticObjectLinkNavigationPressed:l,onSemanticObjectLinkNavigationTargetObtained:m,onSemanticObjectLinkNavigationTargetObtainedSmartLink:n,onDraftLinkPressed:function(i){var B=i.getSource();var r=B.getBindingContext();t.oCommonUtils.showDraftPopover(r,B);},onAssignedFiltersChanged:function(i){if(i.getSource()){C.byId("template::FilterText").setText(i.getSource().retrieveFiltersWithValuesAsText());}},onFilterChange:k,onToggleFiltersPressed:function(){var i=t.oComponentUtils.getTemplatePrivateModel();i.setProperty("/listReport/isHeaderExpanded",!i.getProperty("/listReport/isHeaderExpanded"));},onSearchButtonPressed:function(){t.oCommonUtils.refreshModel(s.oSmartTable);s.oIappStateHandler.changeIappState(false,true);},onSemanticObjectLinkPopoverLinkPressed:function(i){t.oCommonEventHandlers.onSemanticObjectLinkPopoverLinkPressed(i,s);},onAfterTableVariantSave:function(){s.oIappStateHandler.onAfterTableVariantSave();},onAfterApplyTableVariant:function(){if(!e){s.oIappStateHandler.onAfterApplyTableVariant();}},onAfterChartVariantSave:function(i){s.oIappStateHandler.onAfterTableVariantSave();},onAfterApplyChartVariant:function(i){if(!e){s.oIappStateHandler.onAfterApplyTableVariant();}},onBeforeRebindChart:function(i){t.oCommonEventHandlers.onBeforeRebindChart(i);C.onBeforeRebindChartExtension(i);s.oMultipleViewsHandler.onRebindContentControl(i);},onChartInitialise:function(i){s.oMultipleViewsHandler.fnRegisterToChartEvents(i);s.oMultipleViewsHandler.init(i);t.oCommonUtils.checkToolbarIntentsSupported(i.getSource());},onSelectionDetailsActionPress:function(i){s.oMultipleViewsHandler.onDetailsActionPress(i);},onShareListReportActionButtonPress:function(i){var r=t.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.fragments.lists.ShareSheet",{shareEmailPressed:function(){sap.m.URLHelper.triggerEmail(null,t.oCommonUtils.getText("EMAIL_HEADER",[t.oServices.oApplication.getAppTitle()]),document.URL);},shareJamPressed:function(){var y=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:document.URL,share:t.oServices.oApplication.getAppTitle()}}});y.open();}},"share",function(y,z){var R=sap.ui.getCore().getLibraryResourceBundle("sap.m");z.setProperty("/emailButtonText",R.getText("SEMANTIC_CONTROL_SEND_EMAIL"));z.setProperty("/jamButtonText",R.getText("SEMANTIC_CONTROL_SHARE_IN_JAM"));z.setProperty("/bookmarkButtonText",R.getText("SEMANTIC_CONTROL_SAVE_AS_TILE"));var G=q.sap.getObject("sap.ushell.Container.getUser");z.setProperty("/jamVisible",!!G&&G().isJamActive());});r.openBy(i.getSource());var x=this.getView().byId("template::Share");var B=this.getView().byId("bookmarkButton");B.setBeforePressHandler(function(){x.focus();});},onInlineDataFieldForAction:function(i){t.oCommonEventHandlers.onInlineDataFieldForAction(i,s);},onInlineDataFieldForIntentBasedNavigation:function(i){t.oCommonEventHandlers.onInlineDataFieldForIntentBasedNavigation(i.getSource(),s);},onDeterminingDataFieldForAction:function(i){t.oCommonEventHandlers.onDeterminingDataFieldForAction(i,s.oSmartTable);},onDeterminingDataFieldForIntentBasedNavigation:function(i){var B=i.getSource();t.oCommonEventHandlers.onDeterminingDataFieldForIntentBasedNavigation(B,s.oSmartTable.getTable(),s);},onTableInit:function(i){var r=i.getSource();t.oCommonUtils.checkToolbarIntentsSupported(r);s.oMultipleViewsHandler.init(i);},onSearchWorkListLight:function(i){var r=s.oSmartTable;r.data("searchString",i.getSource().getValue());r.data("allowSearchWorkListLight",true);r.rebindTable();var x=C.getOwnerComponent().getModel();var R=function(i){c.handleError("getCollection",C,t.oServices,i.getParameters());s.oSmartTable.getTable().setBusy(false);c.handleTransientMessages(t.oServices.oApplication.getDialogFragmentForView.bind(null,C.getView()));};x.attachEvent('requestFailed',R);x.attachEventOnce('requestCompleted',function(){x.detachEvent('requestFailed',R);});},onWorkListLightTableSort:function(i){var r=s.oSmartTable;if(r){r.openPersonalisationDialog("Sort");}},onWorkListLightTableFilter:function(){var i=s.oSmartTable;if(i){i.openPersonalisationDialog("Filter");}},onWorkListLightTableGroup:function(){var i=s.oSmartTable;if(i){i.openPersonalisationDialog("Group");}},onWorkListLightTableColumns:function(){var i=s.oSmartTable;if(i){i.openPersonalisationDialog("Columns");}}},formatters:{formatDraftType:function(D,i,H){if(D&&D.DraftUUID){if(!i){return sap.m.ObjectMarkerType.Draft;}else if(H){return D.InProcessByUser?sap.m.ObjectMarkerType.Locked:sap.m.ObjectMarkerType.Unsaved;}}return sap.m.ObjectMarkerType.Flagged;},formatDraftVisibility:function(D,i){if(D&&D.DraftUUID){if(!i){return sap.m.ObjectMarkerVisibility.TextOnly;}}return sap.m.ObjectMarkerVisibility.IconAndText;},formatDraftLineItemVisible:function(D){if(D&&D.DraftUUID){return true;}return false;},formatDraftOwner:function(D,H){var i="";if(D&&D.DraftUUID&&H){var U=D.InProcessByUserDescription||D.InProcessByUser||D.LastChangedByUserDescription||D.LastChangedByUser;if(U){i=t.oCommonUtils.getText("ST_DRAFT_OWNER",[U]);}else{i=t.oCommonUtils.getText("ST_DRAFT_ANOTHER_USER");}}return i;},formatItemTextForMultipleView:function(i){return s.oMultipleViewsHandler?s.oMultipleViewsHandler.formatItemTextForMultipleView(i):"";}},extensionAPI:new E(t,C,s)};}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.controller.ControllerImplementation');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.format.DateFormat');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.m.MessageToast');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.Sorter');jQuery.sap.require('sap.ui.comp.smarttable.SmartTable');jQuery.sap.require('sap.ui.generic.app.navigation.service.SelectionVariant');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.core.mvc.ViewType');jQuery.sap.require('sap.m.Table');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/controller/ControllerImplementation",["jquery.sap.global","sap/ui/core/format/DateFormat","sap/m/MessageBox","sap/m/MessageToast","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/comp/smarttable/SmartTable","sap/ui/generic/app/navigation/service/SelectionVariant","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/detailTemplates/detailUtils","sap/suite/ui/generic/template/ObjectPage/extensionAPI/ExtensionAPI","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/js/AnnotationHelper","sap/ui/core/mvc/ViewType","sap/m/Table"],function(q,D,M,a,F,S,b,c,t,d,E,J,A,V,R){"use strict";function I(s){return s.data("inlineCreate")==="true";}return{getMethods:function(v,T,C){var B=d.getControllerBase(v,T,C);B.state.aUnsavedDataCheckFunctions=[];var f;var o;function g(){var e=C.getOwnerComponent().getAppComponent().getConfig();if(T.oServices.oApplication.getBusyHelper().isBusy()){q.sap.log.info("Activation of object suppressed, since App is currently busy");return;}q.sap.log.info("Activate object");var i=T.oServices.oCRUDManager.activateDraftEntity();i.then(function(k){T.oServices.oApplication.showMessageToast(T.oCommonUtils.getText("OBJECT_SAVED"));if(k&&k.context){T.oServices.oViewDependencyHelper.setAllPagesDirty([C.getOwnerComponent().getId()]);T.oServices.oViewDependencyHelper.unbindChildren(C.getOwnerComponent());var x=e&&e.pages&&e.pages[0]&&e.pages[0].pages&&e.pages[0].pages[0]&&e.pages[0].pages[0].component&&e.pages[0].pages[0].component.settings&&e.pages[0].pages[0].component.settings.navToListOnSave;if(x){T.oServices.oNavigationController.navigateToRoot(true);}else{T.oServices.oNavigationController.navigateToContext(k.context,undefined,true);}}});var j={activationPromise:i};T.oComponentUtils.fire(C,"AfterActivate",j);}function O(e,i,j){var k=new sap.m.MessageItem({type:'{type}',title:'{title}'});var x=new J();var b1=e;x.setData(i);e._oMessageView=new sap.m.MessageView({showDetailsPageHeader:false,itemSelect:function(){b1._oBackButton.setVisible(true);},items:{path:"/",template:k}});e._oBackButton=new sap.m.Button({icon:sap.ui.core.IconPool.getIconURI("nav-back"),visible:false,press:function(){b1._oMessageView.navigateBack();e.setVisible(false);}});e._oMessageView.setModel(x);var c1=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.ShowConfirmationOnDraftActivate",{onCancel:function(){c1.close();},onSave:function(){c1.close();T.oServices.oApplication.performAfterSideEffectExecution(g);}});c1.removeAllContent();c1.addContent(e._oMessageView);c1.setContentHeight("300px");c1.setContentWidth("500px");c1.setVerticalScrolling(false);c1.aCustomStyleClasses=["sapMNavItem"];c1.setState(j);c1.open();}function h(){var e=C.getOwnerComponent().getAppComponent().getConfig();if(e&&e.pages&&e.pages[0]&&e.pages[0].pages&&e.pages[0].pages[0]&&e.pages[0].pages[0].component&&e.pages[0].pages[0].component.settings&&e.pages[0].pages[0].component.settings.showConfirmationOnDraftActivate){var j=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.fragments.MessagePopover");var k=j.getBinding("items").aIndices;var x=[];var b1=0;var c1="Warning";for(var i in k){var d1=j.getBinding("items").oList[k[i]].type;if(d1=="Warning"){b1++;}else if(d1=="Error"){c1="Error";}var e1=j.getBinding("items").oList[k[i]].message;x.push({type:d1,title:e1});}if(b1){O(this,x,c1);}else{T.oServices.oApplication.performAfterSideEffectExecution(g);}}else{T.oServices.oApplication.performAfterSideEffectExecution(g);}}function l(e){if(I(e.getSource())){var i=e.getParameter("bindingParams");if(i.filters&&i.filters.length){var j=new F(i.filters);i.filters=new F({filters:[new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:true}),j],and:true}),new F({filters:[new F({path:"IsActiveEntity",operator:"EQ",value1:false}),new F({filters:[j,new F({path:"HasActiveEntity",operator:"EQ",value1:false})],and:false})],and:true})],and:false});}var k=i.sorter[0]&&i.sorter[0].getGroupFunction();var x=k&&function(b1){var c1=b1.getObject();if(c1.IsActiveEntity||c1.HasActiveEntity){var d1=q.extend({},k(b1));d1.key=d1.key.charAt(0)==="§"?"§"+d1.key:d1.key;return d1;}return{key:"§",text:T.oCommonUtils.getText("NEW_ENTRY_GROUP")};};i.sorter.unshift(new S("HasActiveEntity",false,x));}}function m(e,i){var j=e;if(i){j=j+" - "+i;}var k=document.URL;if((k.indexOf("(")==0)){k="%28"+k.slice(1,k.length);}if((k.lastIndexOf(")")==(k.length-1))){k=k.slice(0,(k.length-1))+"%29";}sap.m.URLHelper.triggerEmail(null,j,k);}function n(e,i){var j=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:document.URL,share:e+" "+i}}});j.open();}function p(){return o.getHeaderTitle();}function r(e){var i=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.fragments.ShareSheet",{shareEmailPressed:function(){var j=i.getModel("share");m(j.getProperty("/objectTitle"),j.getProperty("/objectSubtitle"));},shareJamPressed:function(){var j=i.getModel("share");n(j.getProperty("/objectTitle"),j.getProperty("/objectSubtitle"));}},"share",function(x,j){var b1=sap.ui.getCore().getLibraryResourceBundle("sap.m");j.setProperty("/emailButtonText",b1.getText("SEMANTIC_CONTROL_SEND_EMAIL"));j.setProperty("/jamButtonText",b1.getText("SEMANTIC_CONTROL_SHARE_IN_JAM"));j.setProperty("/bookmarkButtonText",b1.getText("SEMANTIC_CONTROL_SAVE_AS_TILE"));var c1=q.sap.getObject("sap.ushell.Container.getUser");j.setProperty("/jamVisible",!!c1&&c1().isJamActive());});var j=i.getModel("share");var k=p();j.setProperty("/objectTitle",k.getProperty("objectTitle"));j.setProperty("/objectSubtitle",k.getProperty("objectSubtitle"));j.setProperty("/bookmarkCustomUrl",document.URL);i.openBy(e.getSource());}function s(){var e=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.RelatedAppsSheet",{buttonPressed:function(i){var j=i.getSource();var k=j.getBindingContext("buttons");var x=k.getProperty("link");var b1=k.getProperty("param");var c1=x.intent;var d1=c1.split('#')[1].split('-')[0];var e1=c1.split('-')[1].split('?')[0].split('~')[0];var f1={target:{semanticObject:d1,action:e1},params:b1};sap.ushell.Container.getService("CrossApplicationNavigation").toExternal(f1);}},"buttons");return e;}function u(){var e=T.oServices.oApplication.getBusyHelper();if(e.isBusy()){return;}var i=C.getOwnerComponent();var j=i.getNavigationProperty();var k=T.oCommonUtils;var x=C.byId("objectPageHeader");var b1,c1;if(x.getProperty("objectTitle")!==""){if(x.getProperty("objectSubtitle")!==""){c1=[" ",x.getProperty("objectTitle").trim(),x.getProperty("objectSubtitle")];b1=k.getText("DELETE_WITH_OBJECTINFO",c1);}else{c1=[x.getProperty("objectTitle").trim()];b1=k.getText("DELETE_WITH_OBJECTTITLE",c1);}}else{b1=k.getText("ST_GENERIC_DELETE_SELECTED");}M.show(b1,{icon:M.Icon.WARNING,styleClass:T.oCommonUtils.getContentDensityClass(),title:k.getText("DELETE"),actions:[M.Action.DELETE,M.Action.CANCEL],onClose:function(d1){if(d1===M.Action.DELETE){var e1=i.getModel("_templPrivGlobal");var f1={objectPage:{currentEntitySet:i.getProperty("entitySet")}};e1.setProperty("/generic/multipleViews",f1);var g1=T.oServices.oCRUDManager.deleteEntity();var h1=i.getBindingContext()&&i.getBindingContext().getPath();var i1=Object.create(null);i1[h1]=g1;T.oServices.oApplication.prepareDeletion(i1);g1.then(function(){T.oServices.oViewDependencyHelper.setParentToDirty(i,j,1);T.oServices.oViewDependencyHelper.unbindChildren(i,true);});var j1={deleteEntityPromise:g1};e.setBusy(g1);T.oComponentUtils.fire(C,"AfterDelete",j1);}}});}function w(e){T.oServices.oApplication.performAfterSideEffectExecution(u);}function y(e){var i,j;if(e){j=e.context||e;if(T.oServices.oDraftController.getDraftContext().hasDraft(j)){T.oServices.oViewDependencyHelper.setRootPageToDirty();i=e.context&&e.context.context||e.context||e;}}if(i){if(B.fclInfo.navigateToDraft){B.fclInfo.navigateToDraft(i);}else{T.oServices.oNavigationController.navigateToContext(i,undefined,true,2);}}else{var k=T.oComponentUtils.getTemplatePrivateModel();k.setProperty("/objectPage/displayMode",2);}v.setEditable(true);}var z;function G(e){T.oServices.oCRUDManager.editEntity(e).then(function(i){if(i.draftAdministrativeData){z(i.draftAdministrativeData.CreatedByUserDescription||i.draftAdministrativeData.CreatedByUser);}else{y(i.context);}});}z=function(e){var i=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.UnsavedChangesDialog",{onEdit:function(){i.close();G(true);},onCancel:function(){i.close();}},"Dialog");var j=i.getModel("Dialog");var k=T.oCommonUtils.getText("DRAFT_LOCK_EXPIRED",[e]);j.setProperty("/unsavedChangesQuestion",k);i.open();};var H;function K(){H=H||T.oCommonUtils.getText("NEW_OBJECT");return H;}function L(e,i,j){if(!j.getContent){return;}j.getContent().forEach(function(k){if(k instanceof b){if(i||e[k.getTableBindingPath()]){if(k.isInitialised()){T.oCommonUtils.refreshSmartTable(k);}else{k.attachInitialise(function(){T.oCommonUtils.refreshSmartTable(k);});}if(!i){T.oServices.oApplicationController.executeSideEffects(C.getOwnerComponent().getBindingContext(),[],[k.getTableBindingPath()]);}}}});}function N(e){var i=sap.ui.getCore().byId(p().getId()+"-lock");i.setVisible(e);}function P(){var j="{\"SelectionVariantID\":\"\"}";var k=C.getOwnerComponent();var b1=k.getEntitySet();var c1=k.getModel();var d1=c1.getMetaModel();var e1=d1.getODataEntitySet(b1);var f1=d1.getODataEntityType(e1.entityType);var g1=f1.property;var h1=[];for(var x in g1){var i1=g1[x]["com.sap.vocabularies.Common.v1.FieldControl"]&&g1[x]["com.sap.vocabularies.Common.v1.FieldControl"].Path;if(i1&&h1.indexOf(i1)<0){h1.push(i1);}}var j1=C.getView().getBindingContext();var k1=j1.getObject();var l1=new c();for(var i in g1){var m1=g1[i].type;var n1=g1[i].name;var o1=k1[g1[i].name];if(h1.indexOf(n1)>-1){continue;}if(n1&&(o1||m1==="Edm.Boolean")){if(m1==="Edm.Time"&&o1.ms!==undefined){o1=o1.ms;}if(typeof o1!=="string"){try{o1=o1.toString();}catch(e){o1=o1+"";}}l1.addParameter(n1,o1);}}j=l1.toJSONString();return j;}function Q(e,i){var j=true;var k=i.getModel();var x=T.oCommonUtils.getDeleteRestrictions(i);var b1=x&&x.Deletable&&x.Deletable.Path;if(b1){j=k.getProperty(b1,e);}return j;}function U(e){var j=T.oServices.oApplication.getBusyHelper();if(j.isBusy()){return;}var k=e.getSource();var x=T.oCommonUtils.getOwnerControl(k);var b1=T.oCommonUtils.getSelectedContexts(x);if(b1.length===0){M.error(T.oCommonUtils.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:T.oCommonUtils.getContentDensityClass()});return;}var c1=[];var d1=[];for(var i=0;i<b1.length;i++){if(Q(b1[i],x)){c1.push(b1[i].getPath());}else{d1.push(b1[i]);}}if(d1.length>0){M.error(T.oCommonUtils.getText("ST_GENERIC_DELETE_UNDELETABLE_SUBITEMS",[d1.length,b1.length]),{styleClass:T.oCommonUtils.getContentDensityClass()});}var e1=T.oServices.oCRUDManager.deleteEntities(c1);j.setBusy(e1);T.oServices.oApplicationController.executeSideEffects(x.getBindingContext(),[],[x.getTableBindingPath()]);var f1=k.getParent().getParent().getId();e1.then(function(){T.oServices.oViewDependencyHelper.unbindChildren(C.getOwnerComponent());T.oCommonUtils.refreshSmartTable(x);});var g1={deleteEntitiesPromise:e1,sUiElementId:f1,aContexts:b1};T.oComponentUtils.fire(C,"AfterLineItemDelete",g1);}function W(){var i=C.byId("imageDialog")||T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.ImageDialog",{onImageDialogClose:function(){i.close();}},"headerImage");return i;}v.refreshFacets=function(e,i){var j=L.bind(null,e,i);var k=function(x){x.getBlocks().forEach(j);x.getMoreBlocks().forEach(j);};o.getSections().forEach(function(x){x.getSubSections().forEach(k);});};v.getHeaderInfoTitleForNavigationMenue=function(){var e=C.byId("objectPageHeader");var i=e.getProperty("objectTitle");var j=T.oComponentUtils.getTemplatePrivateModel();var k=j.getProperty("/generic/viewLevel");T.oServices.oApplication.subTitleForViewLevelChanged(k,i);};v.onComponentActivate=B.onComponentActivate;v.draftResume=function(e,j,k){var x=e.getObject();if(!x||!x.hasOwnProperty("IsActiveEntity")||x.IsActiveEntity!==false){return;}var b1=C.getView().getModel();var c1=b1.getMetaModel();var d1=c1.getODataEntitySet(C.getOwnerComponent().getEntitySet());var e1=c1.getODataEntityType(d1.entityType);var f1="";var g1="";var h1=e1["com.sap.vocabularies.Common.v1.SemanticKey"];for(var i in h1){var i1=h1[i];if(g1===""){g1=j[i1.PropertyPath];}else{g1=g1+"-"+j[i1.PropertyPath];}}var j1="-";if(k&&k.LastChangeDateTime!==null){var k1=D.getDateTimeInstance({pattern:"MMMM d, yyyy HH:mm",style:"long"});j1=k1.format(k.LastChangeDateTime);}var l1=[f1,g1,j1];var m1=T.oCommonUtils.getText("DRAFT_FOUND_RESUME",l1);var n1;var o1=T.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.ObjectPage.view.fragments.DraftResumeDialog",{onDraftResume:function(){o1.close();T.oServices.oNavigationController.navigateToContext(n1.getProperty("/siblingContext"),null,true);},onDraftDiscard:function(){o1.close();C.getView().getModel("ui").setProperty("/enabled",true);T.oServices.oCRUDManager.deleteEntity(true);N(false);n1.getProperty("/activeEntity").HasDraftEntity=false;T.oServices.oViewDependencyHelper.setAllPagesDirty();},onResumeDialogClosed:function(){n1.setProperty("/siblingContext",null);n1.setProperty("/activeEntity",null);}},"Dialog");n1=o1.getModel("Dialog");n1.setProperty("/draftResumeText",m1);n1.setProperty("/siblingContext",e);n1.setProperty("/activeEntity",j);o1.open();};var X={lazyLoading:function(i,e){e.setBindingContext(i?undefined:null);},reuseComponent:function(i,e){var j=e.getBlocks()[0];T.oComponentUtils.onVisibilityChangeOfReuseComponent(i,j);}};function Y(e){var j=e.getCustomData();for(var i=0;i<j.length;i++){var k=j[i];if(k.getProperty("key")==="strategyForVisibilityChange"){return X[k.getProperty("value")];}}}function Z(i,e){var j=Y(e);if(j){if(i){var k=T.oComponentUtils.getHeaderDataAvailablePromise()||Promise.resolve();k.then(function(){j(true,e);});}else{j(false,e);}}}function $(e){Z(false,e);}function _(e){e.getSubSections().forEach($);}v.beforeRebind=function(){o.getSections().forEach(_);};v.afterRebind=function(){o._triggerVisibleSubSectionsEvents();};var G=t.testable(G,"editEntity");var Q=t.testable(Q,"isEntryDeletable");var g=t.testable(g,"onActivateImpl");var h=t.testable(h,"onActivate");var O=t.testable(O,"fnOpenConfirmationDialog");var a1={onInit:function(){o=C.byId("objectPage");var e=p();v.aBreadCrumbs=e&&e.getBreadCrumbsLinks();B.onInit();T.oCommonUtils.executeGlobalSideEffect();o.attachEvent("subSectionEnteredViewPort",function(i){var j=i.getParameter("subSection");Z(true,j);});},handlers:{addEntry:function(e){var i=e.getSource();var j=T.oCommonUtils.getOwnerControl(i);var k=I(j);if(!i.data("CrossNavigation")&&k){T.oCommonEventHandlers.addEntry(i,true);return;}T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){T.oCommonEventHandlers.addEntry(i,false);},q.noop,B.state);},deleteEntries:U,onSelectionChange:function(e){T.oCommonUtils.setEnabledToolbarButtons(e.getSource());},onCancel:function(e){var i="Proceed";var j;if(T.oComponentUtils.isNonDraftCreate()||!f){i="LeavePage";}T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var k=T.oComponentUtils.getTemplatePrivateModel();k.setProperty("/objectPage/displayMode",1);if(T.oComponentUtils.isNonDraftCreate()){v.setEditable(false);}else if(f){v.setEditable(false);}if(T.oComponentUtils.isNonDraftCreate()||!f){T.oServices.oNavigationController.navigateBack();}},q.noop,B.state,i,j,e);},onContactDetails:function(e){T.oCommonEventHandlers.onContactDetails(e);},onPressDraftInfo:function(e){var i=C.getView().getBindingContext();var j=sap.ui.getCore().byId(e.getSource().getId()+(e.getId()==="markChangesPress"?"-changes":"-lock"));T.oCommonUtils.showDraftPopover(i,j);},onShareObjectPageActionButtonPress:r,onRelatedApps:function(e){var x,b1,c1,d1,e1,f1,g1;var h1,i1,j1,k1,l1;x=e.getSource();j1=sap.ushell&&sap.ushell.Container;b1=j1&&j1.getService("URLParsing");c1=b1.parseShellHash(document.location.hash);k1=c1.semanticObject;l1=c1.action;d1=C.getView&&C.getView().getBindingContext();var m1=C.getOwnerComponent().getModel().getMetaModel();var n1=d1.getObject();var o1=n1.__metadata.type;var p1=m1.getODataEntityType(o1);var q1=p1["com.sap.vocabularies.Common.v1.SemanticKey"];var r1={};if(q1&&q1.length>0){for(var j=0;j<q1.length;j++){var s1=q1[j].PropertyPath;if(!r1[s1]){r1[s1]=[];r1[s1].push(n1[s1]);}}}else{for(var k in p1.key.propertyRef){var t1=p1.key.propertyRef[k].name;if(!r1[t1]){r1[t1]=[];r1[t1].push(n1[t1]);}}}e1=C.getOwnerComponent().getAppComponent();f1=j1&&j1.getService("CrossApplicationNavigation");g1=f1.getLinks({semanticObject:k1,params:r1,ui5Component:e1});h1=s();i1=h1.getModel("buttons");i1.setProperty("/buttons",[]);h1.openBy(x);g1.done(function(u1){var v1=[];u1.sort(function(z1,A1){if(z1.text<A1.text){return-1;}if(z1.text>A1.text){return 1;}return 0;});for(var i=0;i<u1.length;i++){var w1=u1[i];var x1=w1.intent;var y1=x1.split("-")[1].split("?")[0];if(y1!==l1){v1.push({enabled:true,text:w1.text,link:w1,param:r1});}}if(v1.length===0){v1.push({enabled:false,text:T.oCommonUtils.getText("NO_RELATED_APPS")});}i1.setProperty("/buttons",v1);});},onSemanticObjectLinkPopoverLinkPressed:function(e){T.oCommonEventHandlers.onSemanticObjectLinkPopoverLinkPressed(e,B.state);},onEdit:function(e){var i=e.getSource();if(i.data("CrossNavigation")){T.oCommonEventHandlers.onEditNavigateIntent(i);return;}f=true;G();},onSave:function(){if(T.oServices.oApplication.getBusyHelper().isBusy()){return;}var e=C.getView().getBindingContext();var i=C.getView().getModel().getPendingChanges();i=i&&i[e.getPath().replace("/","")]||{};var j=Object.keys(i)||[];var k=T.oComponentUtils.isNonDraftCreate();var x=j.indexOf("__metadata");if(x>-1){j.splice(x,1);}var b1=T.oServices.oCRUDManager.saveEntity();b1.then(function(d1){var e1=T.oComponentUtils.getTemplatePrivateModel();e1.setProperty("/objectPage/displayMode",1);v.setEditable(false);if(k){if(d1&&d1.getPath()!=="/undefined"){T.oServices.oNavigationController.navigateToContext(d1,undefined,true);}else{T.oServices.oNavigationController.navigateBack();}T.oServices.oApplication.showMessageToast(T.oCommonUtils.getText("OBJECT_CREATED"));}else{T.oServices.oApplication.showMessageToast(T.oCommonUtils.getText("OBJECT_SAVED"));if(!T.oComponentUtils.isDraftEnabled()&&!f){T.oServices.oNavigationController.navigateBack();}}if(j.length>0){T.oServices.oApplicationController.executeSideEffects(e,j);}});var c1={saveEntityPromise:b1};T.oComponentUtils.fire(C,"AfterSave",c1);},onActivate:h,onSmartFieldUrlPressed:function(e){T.oCommonEventHandlers.onSmartFieldUrlPressed(e,B.state);},onBreadCrumbUrlPressed:function(e){T.oCommonEventHandlers.onBreadCrumbUrlPressed(e,B.state);},onDiscardDraft:function(e){T.oCommonEventHandlers.onDiscardDraft(e);},onDelete:w,onCallActionFromToolBar:function(e){T.oCommonEventHandlers.onCallActionFromToolBar(e,B.state);},onCallAction:function(e){var i=C.getOwnerComponent();var j=i.getNavigationProperty();var k=T.oCommonUtils.getCustomData(e);var x=[];x.push(C.getView().getBindingContext());if(x[0]&&k.Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"){T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var b1={functionImportPath:k.Action,contexts:x,sourceControl:"",label:k.Label,operationGrouping:k.InvocationGrouping,navigationProperty:C.getOwnerComponent().getNavigationProperty()};T.oServices.oCRUDManager.callAction(b1).then(function(c1){var d1=c1&&c1[0];if(d1&&d1.response&&d1.response.context&&(!d1.actionContext||d1.actionContext&&d1.response.context.getPath()!==d1.actionContext.getPath())){T.oServices.oViewDependencyHelper.setParentToDirty(i,j,1);}});},q.noop,B.state,"Proceed");}},onDataFieldForIntentBasedNavigation:function(e){T.oCommonEventHandlers.onDataFieldForIntentBasedNavigation(e,B.state);},onDataFieldWithIntentBasedNavigation:function(e){T.oCommonEventHandlers.onDataFieldWithIntentBasedNavigation(e,B.state);},onDataFieldWithNavigationPath:function(e){T.oCommonEventHandlers.onDataFieldWithNavigationPath(e);},onChartInit:function(e){var i=e.getSource().getChart();var j=C._templateEventHandlers.onSelectionChange;i.attachSelectData(j).attachDeselectData(j);var k=i.getParent();T.oCommonUtils.checkToolbarIntentsSupported(k);},onDataReceived:function(e){T.oCommonEventHandlers.onDataReceived(e);},onBeforeRebindDetailTable:function(e){T.oCommonEventHandlers.onBeforeRebindTable(e);C.onBeforeRebindTableExtension(e);l(e);if(T.oCommonUtils.isAnalyticalTable(e.getSource().getTable())){var i=e.getParameter("bindingParams");i.parameters.entitySet=e.getSource().getEntitySet();}},onShowDetails:function(e){T.oCommonEventHandlers.onShowDetails(e.getSource(),B.state);},onListNavigate:function(e){if(!C.onListNavigationExtension(e)){T.oCommonEventHandlers.onListNavigate(e.getSource(),B.state);}},onBeforeSemanticObjectLinkPopoverOpens:function(e){var i=e.getParameters();T.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var j=P();T.oCommonUtils.semanticObjectLinkNavigation(i,j,C);},q.noop,B.state,q.noop);},onSemanticObjectLinkNavigationPressed:function(e){var i=e.getParameters();var j=e.getSource();T.oCommonEventHandlers.onSemanticObjectLinkNavigationPressed(j,i);},onSemanticObjectLinkNavigationTargetObtained:function(e){var i=e.getParameters();var j=e.getSource();T.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(j,i,B.state);},onSemanticObjectLinkNavigationTargetObtainedSmartLink:function(e){var i,j;i=e.getParameters();j=e.getSource();j=j.getParent().getParent().getParent().getParent();T.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(j,i,B.state);},onHeaderImagePress:function(e){var i=W();var j=e.getSource().getId();i.addAriaLabelledBy(j);var k=i.getModel("headerImage");k.setProperty("/src",e.getSource().getSrc());if(sap.ui.Device.system.phone){i.setProperty("stretch",true);}i.open();},onInlineDataFieldForAction:function(e){T.oCommonEventHandlers.onInlineDataFieldForAction(e,B.state);},onInlineDataFieldForIntentBasedNavigation:function(e){T.oCommonEventHandlers.onInlineDataFieldForIntentBasedNavigation(e.getSource(),B.state);},onDeterminingDataFieldForAction:function(e){T.oCommonEventHandlers.onDeterminingDataFieldForAction(e);},onBeforeRebindChart:function(e){var i=e.getSource();i.oModels=i.getChart().oPropagatedProperties.oModels;},onTableInit:function(e){var j=e.getSource();var k=j.getTable();T.oCommonUtils.checkToolbarIntentsSupported(j);j.attachModelContextChange(function(){if(j.getCustomToolbar&&j.getCustomToolbar().getContent){var x=j.getCustomToolbar().getContent();for(var i in x){if(x[i].getShowSearchButton&&x[i].getValue()){x[i].setValue("");j.rebindTable();break;}}}});if(I(j)&&!j.data("CrossNavigation")){k.addEventDelegate({onkeyup:function(e){if(e.ctrlKey&&e.keyCode==q.sap.KeyCodes.ENTER&&j.getEditable()){T.oCommonEventHandlers.addEntry(j,true);e.preventDefault();e.setMarked();}}});}},onSearchObjectPage:function(e){var i=(e.getSource().getParent()).getParent();i.data("searchString",e.getSource().getValue());i.data("allowSearch",true);i.data("tableId",i.getId());i.data("objectPath",i.getBindingContext().getPath());i.rebindTable();}},formatters:{formatDefaultObjectTitle:function(e,i){if(i||!e){return;}var j=C.getView().getBindingContext();var k=j&&j.getObject();if(e&&k&&(k.IsActiveEntity===undefined||k.IsActiveEntity===false||k.HasActiveEntity===false)){return K();}},setNoDataTextForSmartTable:function(){var e=C.getOwnerComponent()&&C.getOwnerComponent().getModel("i18n")&&C.getOwnerComponent().getModel("i18n").getResourceBundle();if(e&&e.getText("NOITEMS_SMARTTABLE")!=="NOITEMS_SMARTTABLE"){return e.getText("NOITEMS_SMARTTABLE");}else{var i=C.getOwnerComponent().getAppComponent();e=i&&i.getModel("i18n")&&i.getModel("i18n").getResourceBundle();if(e&&e.hasText("NOITEMS_SMARTTABLE")){return e.getText("NOITEMS_SMARTTABLE");}else{return"";}}}},extensionAPI:new E(T,C,B)};a1.handlers=q.extend(B.handlers,a1.handlers);return a1;}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.extensionAPI.extensionAPI')){jQuery.sap.declare('sap.suite.ui.generic.template.extensionAPI.extensionAPI');sap.ui.define("sap/suite/ui/generic/template/extensionAPI/extensionAPI",["sap/suite/ui/generic/template/lib/TemplateAssembler"],function(T){"use strict";return{getExtensionAPI:function(c){return T.getExtensionAPI(c);},getExtensionAPIPromise:function(c){return T.getExtensionAPIPromise(c);}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.lib.AppComponent')){jQuery.sap.declare('sap.suite.ui.generic.template.lib.AppComponent');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.m.NavContainer');jQuery.sap.require('sap.f.FlexibleColumnLayout');jQuery.sap.require('sap.ui.model.Filter');jQuery.sap.require('sap.ui.model.FilterOperator');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.ui.model.resource.ResourceModel');jQuery.sap.require('sap.ui.generic.app.ApplicationController');sap.ui.define("sap/suite/ui/generic/template/lib/AppComponent",["jquery.sap.global","sap/ui/core/UIComponent","sap/m/NavContainer","sap/f/FlexibleColumnLayout","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/generic/app/ApplicationController","sap/suite/ui/generic/template/lib/Application","sap/suite/ui/generic/template/lib/BusyHelper","sap/suite/ui/generic/template/lib/NavigationController","sap/suite/ui/generic/template/lib/ProcessObserver","sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/lib/CRUDHelper","sap/suite/ui/generic/template/lib/ViewDependencyHelper","sap/suite/ui/generic/template/lib/testableHelper","sap/suite/ui/generic/template/support/lib/CommonMethods","sap/suite/ui/generic/template/library"],function(q,U,N,F,a,b,J,R,A,c,B,d,P,T,C,V,t,e){"use strict";A=t.observableConstructor(A);var D=sap.m.DraftIndicatorState;var r=T.getRegisterAppComponent();var o;function g(){o=o||new R({bundleName:"sap/suite/ui/generic/template/lib/i18n/i18n"}).getResourceBundle();return o.getText.apply(o,arguments);}function f(){return new P({processObservers:[]});}var m=sap.ui.getCore().getMessageManager().getMessageModel();var v=new a({path:"validation",operator:b.EQ,value1:true});function h(j,k){var l={oAppComponent:j,componentRegistry:Object.create(null),aRunningSideEffectExecutions:[],getText:g,mRouteToTemplateComponentPromise:Object.create(null),oTemplatePrivateGlobalModel:(new J()).setDefaultBindingMode("TwoWay"),aStateChangers:[],oPaginatorInfo:Object.create(null),oValidationMessageBinding:m.bindList("/",null,null,v)};l.oValidationMessageBinding.attachChange(q.noop);var n;var p;var s;function u(){var i=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("URLParsing");l.oTemplatePrivateGlobalModel.setProperty("/generic",{crossAppNavSupport:!!i&&i.isIntentUrl(document.URL),draftIndicatorState:D.Clear,shellServiceUnavailable:false,forceFullscreenCreate:false});j.setModel(l.oTemplatePrivateGlobalModel,"_templPrivGlobal");l.oShellServicePromise.catch(function(){l.oTemplatePrivateGlobalModel.setProperty("/generic/shellServiceUnavailable",true);});}function w(){l.fnAddSideEffectPromise=function(S){var i=0;for(;l.aRunningSideEffectExecutions[i];){i++;}l.aRunningSideEffectExecutions[i]=S;var W=function(){l.aRunningSideEffectExecutions[i]=null;};S.then(W,W);};n.attachEvent("beforeSideEffectExecution",function(i){if(i.getParameter("valueChange")||i.getParameter("fieldControl")){var S=i.getParameter("promise");l.oBusyHelper.setBusy(S);l.fnAddSideEffectPromise(S);}});var O=j.getModel("_templPrivGlobal");var Q="/generic/draftIndicatorState";n.attachBeforeQueueItemProcess(function(i){if(i.draftSave){O.setProperty(Q,D.Saving);}});n.attachOnQueueCompleted(function(){if(O.getProperty(Q)===D.Saving){O.setProperty(Q,D.Saved);}});n.attachOnQueueFailed(function(){if(O.getProperty(Q)===D.Saving){O.setProperty(Q,D.Clear);}});O.setProperty("/generic/appComponentName",j.getMetadata().getComponentName());}function x(){var i={appComponent:j,oTemplateContract:l,application:new c(l),oViewDependencyHelper:new V(l)};l.oViewDependencyHelper=i.oViewDependencyHelper;var S=sap.ui.core.service.ServiceFactoryRegistry.get("sap.ushell.ui5service.ShellUIService");l.oShellServicePromise=(S&&S.createInstance())||Promise.reject();l.oShellServicePromise.catch(function(){q.sap.log.warning("No ShellService available");});(U.prototype.init||q.noop).apply(j,arguments);l.oBusyHelper.setBusy(l.oShellServicePromise);s=r(i);var O=j.getModel();n=new A(O);u();p=new d(l);w();C.enableAutomaticDraftSaving(l);if((!O.oMetadata||!O.oMetadata.isLoaded())||O.oMetadata.isFailed()){O.attachMetadataFailed(function(){p.navigateToMessagePage({title:g("ST_GENERIC_ERROR_TITLE"),text:g("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE"),icon:"sap-icon://message-error",description:g("ST_GENERIC_ERROR_SYSTEM_UNAVAILABLE_DESC")});for(var Q in l.componentRegistry){l.componentRegistry[Q].fnViewRegisteredResolve(true);}});}if(j&&j.getMetadata()&&j.getMetadata().getManifest()){e.setAppComponent(j);}e.setApplicationStatus(e.mApplicationStatus.LOADING);e.publishEvent("elements","ViewRenderingStarted",{});l.oBusyHelper.setBusyReason("initAppComponent",false);}function y(){if(l.oNavigationHost){return"";}if(l.sRoutingType==="f"){var i=new F();l.oNavigationHost=i;l.aNavigationObservers=[new P({processName:"BeginColumnNavigation",eventHandlers:{attachProcessStart:i.attachBeginColumnNavigate.bind(i),attachProcessStop:i.attachAfterBeginColumnNavigate.bind(i)}}),new P({processName:"MidColumnNavigation",eventHandlers:{attachProcessStart:i.attachMidColumnNavigate.bind(i),attachProcessStop:i.attachAfterMidColumnNavigate.bind(i)}}),new P({processName:"EndColumnNavigation",eventHandlers:{attachProcessStart:i.attachEndColumnNavigate.bind(i),attachProcessStop:i.attachAfterEndColumnNavigate.bind(i)}})];l.oNavigationObserver=new P({processObservers:l.aNavigationObservers});l.aHeaderLoadingObservers=[f(),f(),f()];}else{var O=new N({id:j.getId()+"-appContent"});l.oNavigationHost=O;l.oNavigationObserver=new P({processName:"Navigation",eventHandlers:{attachProcessStart:O.attachNavigate.bind(O),attachProcessStop:O.attachAfterNavigate.bind(O)}});}l.oHeaderLoadingObserver=new P({processObservers:l.aHeaderLoadingObservers||[]});l.oPagesDataLoadedObserver=new P({processObservers:[l.oHeaderLoadingObserver,l.oNavigationObserver]});l.oNavigationHost.addStyleClass(l.oApplicationProxy.getContentDensityClass());l.oBusyHelper=new B(l);l.oBusyHelper.setBusyReason("initAppComponent",true,true);return l.oNavigationHost;}function z(){if(l.oNavigationHost){l.oNavigationHost.destroy();}if(n){n.destroy();}if(p){p.destroy();}if(l.oValidationMessageBinding){l.oValidationMessageBinding.destroy();}(U.prototype.exit||q.noop).apply(j,arguments);s();t.endApp(k);}function E(i){var O=Object.keys(i).map(function(Q){var S=i[Q];if(S.pages){S.pages=E(S.pages);}return i[Q];});return O;}function G(O){if(!O){return;}for(var i=0;i<O.length;i++){var Q=O[i];if(Q.routingSpec&&Q.routingSpec.noOData){Q.entitySet=Q.routingSpec.routeName;Q.navigationProperty=Q.routingSpec.routeName;}G(Q.pages);if(Q.embeddedComponents){for(var S in Q.embeddedComponents){var W=Q.embeddedComponents[S];G(W.pages);}}G(Q.implementingComponent&&Q.implementingComponent.pages);}}var H;function I(){if(!H){var i=j.getMetadata();H=i.getManifestEntry("sap.ui.generic.app");if(H._version==="1.3.0"&&H.pages&&q.isPlainObject(H.pages)){H.pages=E(H.pages);}G(H.pages);}return H;}var K;function L(){if(!K){K=q.extend({},j.getMetadata().getManifest());K["sap.ui.generic.app"]=I();}return K;}function M(){var i=j.getManifestObject();var S=i.getEntry("sap.ui.generic.app").settings;l.sRoutingType=(S&&S.flexibleColumnLayout)?"f":"m";return"sap."+l.sRoutingType+".routing.Router";}return{init:x,createContent:y,exit:z,_getRouterClassName:M,getConfig:I,getInternalManifest:L,getTransactionController:function(){return n.getTransactionController();},getApplicationController:function(){return n;},getNavigationController:function(){return p;}};}return U.extend("sap.suite.ui.generic.template.lib.AppComponent",{metadata:{config:{title:"SAP UI Application Component",fullWidth:true},properties:{forceGlobalRefresh:{type:"boolean",defaultValue:true}},events:{pageDataLoaded:{}},routing:{config:{async:true,viewType:"XML",viewPath:"",clearTarget:false},routes:[],targets:[]},library:"sap.suite.ui.generic.template"},constructor:function(){var i=t.startApp();q.extend(this,h(this,i));(U.prototype.constructor||q.noop).apply(this,arguments);}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.controller.ControllerImplementation')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.controller.ControllerImplementation');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.base.Object');jQuery.sap.require('sap.ui.model.json.JSONModel');jQuery.sap.require('sap.m.ObjectIdentifier');jQuery.sap.require('sap.m.Table');jQuery.sap.require('sap.m.Text');jQuery.sap.require('sap.ui.comp.smartfield.SmartField');jQuery.sap.require('sap.ui.generic.app.navigation.service.SelectionVariant');jQuery.sap.require('sap.ui.base.EventProvider');jQuery.sap.require('sap.ui.core.ResizeHandler');jQuery.sap.require('sap.m.MessageBox');jQuery.sap.require('sap.ui.table.AnalyticalTable');jQuery.sap.require('sap.ui.model.odata.AnnotationHelper');jQuery.sap.require('sap.ui.model.analytics.odata4analytics');jQuery.sap.require('sap.ui.Device');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/controller/ControllerImplementation",["jquery.sap.global","sap/ui/base/Object","sap/ui/model/json/JSONModel","sap/m/ObjectIdentifier","sap/m/Table","sap/m/Text","sap/ui/comp/smartfield/SmartField","sap/ui/generic/app/navigation/service/SelectionVariant","sap/ui/base/EventProvider","sap/suite/ui/generic/template/AnalyticalListPage/extensionAPI/ExtensionAPI","sap/ui/core/ResizeHandler","sap/suite/ui/generic/template/AnalyticalListPage/controller/FilterBarController","sap/suite/ui/generic/template/AnalyticalListPage/controller/ToolbarController","sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterBarController","sap/suite/ui/generic/template/AnalyticalListPage/controller/VisualFilterDialogController","sap/suite/ui/generic/template/lib/MessageUtils","sap/m/MessageBox","sap/ui/table/AnalyticalTable","sap/ui/model/odata/AnnotationHelper","sap/ui/model/analytics/odata4analytics","sap/suite/ui/generic/template/AnalyticalListPage/controller/ContentAreaController","sap/suite/ui/generic/template/AnalyticalListPage/controller/IappStateHandler","sap/suite/ui/generic/template/AnalyticalListPage/util/CommonUtil","sap/suite/ui/generic/template/AnalyticalListPage/util/FilterUtil","sap/ui/Device"],function(q,B,J,O,T,a,S,b,E,c,R,F,d,V,f,M,g,A,h,j,C,I,k,l,D){"use strict";var m="sap.suite.ui.generic.template.customData",n="sap.suite.ui.generic.template.genericData",o="chart",p="visual",r="compact";return{getMethods:function(v,t,s){var u={};var w=false;var x=false;var y=false;var z=true;function G(){var e=s.getOwnerComponent();var i=e.getModel("_templPriv");i.setProperty("/listReport/isLeaf",e.getIsLeaf());}function H(){var e=q.sap.getObject("sap.ushell.Container.getUser");var i=s.getOwnerComponent().getAppComponent().getMetadata().getManifestEntry("sap.ui");var W=(i&&i.icons&&i.icons.icon)||"";var X={bookmarkIcon:W,bookmarkCustomUrl:function(){u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();return hasher.getHash()?("#"+hasher.getHash()):window.location.href;},bookmarkServiceUrl:function(){var Z=u.oSmartTable.getTable();var $;if(Z){$=Z.getBinding("rows")||Z.getBinding("items");}else{$="";}return $?$.getDownloadUrl()+"&$top=0&$inlinecount=allpages":"";},isShareInJamActive:!!e&&e().isJamActive()};var Y=s.getOwnerComponent().getModel("_templPriv");Y.setProperty("/listReport/share",X);}function K(e,i){var W=e&&e.property;return W.filter(function(X){return typeof X[i]!=="undefined";});}function L(i){var W=i.getModel(),X=W&&W.getMetaModel(),Y=X&&X.getODataEntityType(i.getEntityType()),Z=X&&X.getODataEntityType(i.getEntityType(),true),$=Y&&K(Y,"com.sap.vocabularies.Common.v1.FilterDefaultValue"),_,a1,b1,c1,d1,e1,f1=[];try{a1=new j.Model(new j.Model.ReferenceByModel(W));e1=a1&&a1.findQueryResultByName(i.getEntitySet());b1=e1&&e1.getParameterization();c1=b1&&X.getODataEntitySet(b1.getEntitySet().getQName());d1=c1&&X.getODataEntityType(c1.entityType);f1=d1?K(d1,"defaultValue"):[];}catch(e){q.sap.log.Error(e);}if($.length>0||f1.length>0){_={"SelectOptions":[],"Parameters":[]};$.forEach(function(g1){var h1=X.createBindingContext(Z+"/property/[${path:'name'}===\'"+g1.name+"']/com.sap.vocabularies.Common.v1.FilterDefaultValue"),i1={"PropertyName":g1.name,"Ranges":[{"Sign":"I","Option":"EQ","Low":h.format(h1),"High":null}]};_.SelectOptions.push(i1);});f1.forEach(function(g1){var h1={"PropertyName":"$Parameter."+g1.name,"PropertyValue":g1.defaultValue};_.Parameters.push(h1);});}return _;}function N(e){var i=e.getSource(),W=L(i);if(W){i.setDataSuiteFormat(JSON.stringify(W),true);}u.oIappStateHandler.onSmartFilterBarInitialise();s.onInitSmartFilterBarExtension(e);}function P(){u.oIappStateHandler.onSmartFilterBarInitialized();}function Q(e){var i=e.getParameters();var W=e.getSource();t.oCommonEventHandlers.onSemanticObjectLinkNavigationPressed(W,i);}function U(e){var i,W;i=e.getParameters();W=e.getSource();t.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(W,i,u,undefined,undefined);}return{onInit:function(){var e=s.getOwnerComponent();var W=e.getModel("_templPriv");W.setProperty("/alp",{filterMode:e.getHideVisualFilter()?r:e.getDefaultFilterMode(),contentView:e.getDefaultContentView(),autoHide:e.getAutoHide(),visibility:{hybridView:(D.system.phone||D.system.tablet&&!D.system.desktop)?false:true}});u.hideVisualFilter=e.getHideVisualFilter();u.hideVisualFilter=(u.hideVisualFilter===undefined||u.hideVisualFilter!==true)?false:true;u.oSmartFilterbar=s.byId("template::SmartFilterBar");u.oSmartTable=s.byId("table");u.oPage=s.byId("template::Page");u.oSmartChart=s.byId("chart");u.alr_compactFilterContainer=s.byId("template::CompactFilterContainer");u.alr_visualFilterContainer=s.byId("template::VisualFilterContainer");u.alr_filterContainer=s.byId("template::FilterContainer");u.alr_visualFilterBar=s.byId("template::VisualFilterBar");if(u.alr_visualFilterBar){u.alr_visualFilterBar.setSmartFilterId(u.oSmartFilterbar.getId());}u.oKpiTagContainer=s.byId("template::KpiTagContainer");if(u.oKpiTagContainer){q.sap.require("sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiTagController");sap.suite.ui.generic.template.AnalyticalListPage.controller.KpiTagController.init(u);}u.oContentArea=new C();u.oTemplateUtils=t;u.toolbarController=new d();u.oController=s;u.filterBarController=new F();u.filterBarController.init(u);u.oContentArea.createAndSetCustomModel(u);u.oContentArea.setState(u);if(!u.hideVisualFilter){u.visualFilterBarContainer=new V();u.visualFilterBarContainer.init(u);}u.oIappStateHandler=new I(u,s,t.oCommonUtils.getNavigationHandler());G();H();s.byId("template::FilterText").attachBrowserEvent("click",function(){s.byId("template::Page").setHeaderExpanded(true);});W.setProperty("/listReport/isHeaderExpanded",true);if(u.oSmartTable){var X=u.oSmartTable.getTable();}var Y="sapUiSizeCozy",Z="sapUiSizeCompact",$="sapUiSizeCondensed";if(t.oCommonUtils.isUiTable(X)||X instanceof A){var _=s.getView();var a1=q(document.body);if(a1.hasClass(Y)||_.hasStyleClass(Y)){u.oSmartTable.addStyleClass(Y);}else if(a1.hasClass(Z)||_.hasStyleClass(Z)){var b1=e.getComponentContainer().getSettings().condensedTableLayout;if(b1===false){u.oSmartTable.addStyleClass(Z);}else{u.oSmartTable.addStyleClass($);}}}v.getUrlParameterInfo=function(){return u.oIappStateHandler.getUrlParameterInfo();};v.onComponentActivate=function(){};v.refreshBinding=function(){if(u.alr_visualFilterBar&&u.alr_visualFilterBar.updateVisualFilterBindings){u.alr_visualFilterBar.updateVisualFilterBindings();}if(u.oSmartChart&&u.oSmartChart.rebindChart){u.oSmartChart.rebindChart();}if(u.oSmartTable){t.oCommonUtils.refreshSmartTable(u.oSmartTable);}if(u.oKpiTagContainer){var c1=u.oKpiTagContainer.mAggregations.content;for(var i in c1){if(c1[i].getModelName&&c1[i].getModelName()==="kpi"){c1[i]._firstTime=true;c1[i].onBeforeRendering();}}}};u.oSmartFilterbar.attachFilterChange(function(i){var c1=u.oSmartChart&&u.oSmartChart.getChart()&&u.oSmartChart.getDrillStackFilters();if(c1&&c1.length){u.oController.getOwnerComponent().getModel("_templPriv").setProperty('/alp/_ignoreChartSelections',false);}else{u.oController.getOwnerComponent().getModel("_templPriv").setProperty('/alp/_ignoreChartSelections',true);}u.oIappStateHandler.fnCheckMandatory();var d1=i.getSource(),e1=q.extend(true,{},d1.getFilterData(true)),f1=u.oController.getOwnerComponent().getModel("_filter");f1.setData(e1);if(i.getParameters().filterItem){if(!u.hideVisualFilter){u.filterBarController.changeVisibility(i);}u.oController.getOwnerComponent().getModel("_templPriv").setProperty('/alp/_ignoreChartSelections',false);}u.filterBarController._updateFilterLink();});},handlers:{onBack:function(){t.oServices.oNavigationController.navigateBack();},addEntry:function(e){var i=e.getSource();t.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){t.oCommonEventHandlers.addEntry(i,false,u.oSmartFilterbar);},q.noop,u);},deleteEntries:function(e){t.oCommonEventHandlers.deleteEntries(e);},onSelectionChange:function(e){var W=e.getSource(),X=W.getModel(),Y=W.getModel("_templPriv");var Z=X.getMetaModel(),$=Z.getODataEntitySet(this.getOwnerComponent().getEntitySet()),_=$["Org.OData.Capabilities.V1.DeleteRestrictions"];var a1=(_&&_.Deletable&&_.Deletable.Path)?_.Deletable.Path:"";var b1=false;var c1=true;var d1=(a1&&a1!=="");var e1=t.oCommonUtils.getSelectedContexts(W);if(e1.length>0){for(var i=0;i<e1.length;i++){var f1=X.getObject(e1[i].getPath());if(!(f1.IsActiveEntity&&f1.HasDraftEntity&&f1.DraftAdministrativeData&&f1.DraftAdministrativeData.InProcessByUser)){c1=false;}if(d1){if(X.getProperty(a1,e1[i])){d1=false;}}if(!c1&&!d1){b1=true;break;}}}Y.setProperty("/listReport/deleteEnabled",b1);},onChange:function(e){t.oCommonEventHandlers.onChange(e);},onSmartFieldUrlPressed:function(e){t.oCommonEventHandlers.onSmartFieldUrlPressed(e,u);},onContactDetails:function(e){t.oCommonEventHandlers.onContactDetails(e);},onSmartFilterBarInitialise:N,onSmartFilterBarInitialized:P,onEditStateFilterChanged:function(e){e.getSource().fireChange();},onFilterPress:function(e){u.filterBarController.showDialog.call(u.filterBarController);},onClearPress:function(e){u.filterBarController.clearFilters();s.onClearFilterExtension(e);},onGoPress:function(e){u.filterBarController.onGoFilter();},onBeforeSFBVariantSave:function(){var e=u.oIappStateHandler.getCurrentAppState();if(!this.getOwnerComponent().getProperty('smartVariantManagement')){delete e.customData["sap.suite.ui.generic.template.genericData"].contentView;}u.oSmartFilterbar.setFilterData({_CUSTOM:e.customData});},onAfterSFBVariantLoad:function(){var e=u.oSmartFilterbar.getFilterData();if(e._CUSTOM!==undefined){u.oIappStateHandler.fnRestoreFilterState(e._CUSTOM);}else{var i=u.oIappStateHandler.getFilterState();k.nullify(i[m]);k.nullify(i[n]);u.oIappStateHandler.fnRestoreFilterState(i);}if(!y&&l.isDefaultVariantSelected(u)){y=true;return;}else if(!y&&!l.isDefaultVariantSelected(u)){y=true;}u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();},onBeforeRebindTable:function(e){t.oCommonEventHandlers.onBeforeRebindTable(e);s.onBeforeRebindTableExtension(e);},onBeforeRebindChart:function(e){},onShowDetails:function(e){t.oCommonEventHandlers.onShowDetails(e.getSource(),u);},onListNavigate:function(e){t.oCommonEventHandlers.onListNavigate(e.getSource(),u);},onCallActionFromToolBar:function(e){var i=t.oCommonUtils.getParentTable;t.oCommonUtils.getParentTable=function(){return u.oSmartTable;};t.oCommonEventHandlers.onCallActionFromToolBar(e,u);t.oCommonUtils.getParentTable=i;i=null;},onShowDetailsIntent:function(e){t.oCommonEventHandlers.onShowDetailsIntent(e,u.oSmartFilterbar);},onCallActionFromList:function(e){},onDataFieldForIntentBasedNavigation:function(e){t.oCommonEventHandlers.onDataFieldForIntentBasedNavigation(e,u);},onDataFieldWithIntentBasedNavigation:function(e){t.oCommonEventHandlers.onDataFieldWithIntentBasedNavigation(e,u);},onBeforeSemanticObjectLinkPopoverOpens:function(e){var i=e.getParameters();t.oCommonUtils.processDataLossConfirmationIfNonDraft(function(){var W=u.oSmartFilterbar.getDataSuiteFormat();t.oCommonUtils.semanticObjectLinkNavigation(i,W,s);},q.noop,u,q.noop);},onAssignedFiltersChanged:function(e){if(e&&e.getSource()){if(u&&u.oSmartFilterbar&&u.filterBarController){s.byId("template::FilterText").setText(u.oSmartFilterbar.retrieveFiltersWithValuesAsText());}}},onToggleFiltersPressed:function(){var e=s.getOwnerComponent();var i=e.getModel("_templPriv");i.setProperty("/listReport/isHeaderExpanded",(i.getProperty("/listReport/isHeaderExpanded")===true)?false:true);},onSearchButtonPressed:function(){if(D.system.phone&&u.oPage.getHeaderExpanded()){u.oPage.setHeaderExpanded(false);}var e=s.getOwnerComponent().getModel();e.attachEventOnce("requestSent",function(){if(u.oSmartFilterbar.isLiveMode()&&z){z=false;}else{u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();}});var i=function(W){M.handleError("getCollection",this,t.oServices,W.getParameters());var X=this.getView().byId("table");X.getTable().setBusy(false);M.handleTransientMessages(t.oServices.oApplication.getDialogFragmentForView.bind(null,null));}.bind(this);e.attachEventOnce("requestFailed",i);e.attachEventOnce("requestCompleted",function(W){if(W.getParameter("success")){e.detachEvent("requestFailed",i);}});},onSemanticObjectLinkPopoverLinkPressed:function(e){u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();t.oCommonEventHandlers.onSemanticObjectLinkPopoverLinkPressed(e,u);},onSemanticObjectLinkNavigationPressed:Q,onSemanticObjectLinkNavigationTargetObtained:U,onAfterTableVariantSave:function(){u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();},onAfterApplyTableVariant:function(){if(!w&&l.isDefaultVariantSelected(u)){w=true;return;}else if(!w&&!l.isDefaultVariantSelected(u)){w=true;}u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();},onAfterChartVariantSave:function(e){u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();t.oCommonUtils.setEnabledToolbarButtons(e.getSource());},onAfterApplyChartVariant:function(){if(!x&&l.isDefaultVariantSelected(u)){x=true;return;}else if(!x&&!l.isDefaultVariantSelected(u)){x=true;}u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();},onFilterModeSegmentedButtonChange:function(e){u.filterBarController.handleFilterSwitch(e.getParameter("key"),e.oSource._bApplyingVariant);u.oController._templateEventHandlers.onSegmentButtonPressed();},onContentViewSegmentButtonPressed:function(){u.oController._templateEventHandlers.onSegmentButtonPressed(!u.oController.getOwnerComponent().getProperty('smartVariantManagement'));},onSegmentButtonPressed:function(i){if(!i){u.oController.byId('template::PageVariant').currentVariantSetModified(true);u.oSmartFilterbar.setFilterData({_CUSTOM:u.oIappStateHandler.getFilterState()});}u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();},onShareListReportActionButtonPress:function(e){if(!u.oShareActionSheet){u.oShareActionSheet=t.oCommonUtils.getDialogFragment("sap.suite.ui.generic.template.fragments.lists.ShareSheet",{shareEmailPressed:function(){u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();sap.m.URLHelper.triggerEmail(null,t.oCommonUtils.getText("EMAIL_HEADER",[t.oServices.oApplication.getAppTitle()]),document.URL);},shareJamPressed:function(){u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();var i=sap.ui.getCore().createComponent({name:"sap.collaboration.components.fiori.sharing.dialog",settings:{object:{id:document.URL,share:t.oServices.oApplication.getAppTitle()}}});i.open();}},"share",function(i,W){var X=sap.ui.getCore().getLibraryResourceBundle("sap.m");W.setProperty("/emailButtonText",X.getText("SEMANTIC_CONTROL_SEND_EMAIL"));W.setProperty("/jamButtonText",X.getText("SEMANTIC_CONTROL_SHARE_IN_JAM"));W.setProperty("/bookmarkButtonText",X.getText("SEMANTIC_CONTROL_SAVE_AS_TILE"));var Y=q.sap.getObject("sap.ushell.Container.getUser");W.setProperty("/jamVisible",!!Y&&Y().isJamActive());i.openBy(e.getSource());});}else{u.oShareActionSheet.openBy(e.getSource());}},onDeterminingDataFieldForAction:function(e){var i=u.oController.getOwnerComponent().getModel("_templPriv");var W=i.getProperty('/alp/contentView');var X=(W===o)?u.oSmartChart:u.oSmartTable;t.oCommonEventHandlers.onDeterminingDataFieldForAction(e,X);},onDeterminingDataFieldForIntentBasedNavigation:function(e){var i=e.getSource();var W=u.oController.getOwnerComponent().getModel("_templPriv");var X=W.getProperty('/alp/contentView');var Y=(X===o)?u.oSmartChart:u.oSmartTable.getTable();t.oCommonEventHandlers.onDeterminingDataFieldForIntentBasedNavigation(i,Y,u);},onInlineDataFieldForAction:function(e){t.oCommonEventHandlers.onInlineDataFieldForAction(e,u);},onInlineDataFieldForIntentBasedNavigation:function(e){t.oCommonEventHandlers.onInlineDataFieldForIntentBasedNavigation(e.getSource(),u);},onAutoHideToggle:function(){u.chartController._updateTable();u.oIappStateHandler.fnStoreCurrentAppStateAndAdjustURL();},onFullScreenToggled:function(e){var i=e.getParameter("fullScreen");var W=e.getSource().getModel("_templPriv");W.setProperty("/alp/fullScreen",i);},onDialogOpened:function(e){var i=u.oSmartFilterbar.getFilterDialogContent();if(!u.visualFilterDialogContainer){u.visualFilterDialogContainer=new f();u.visualFilterDialogContainer.init(u);}if(i.length<2){var W=[new sap.m.SegmentedButtonItem({icon:"sap-icon://filter-fields",width:"inherit",key:r,tooltip:"{i18n>FILTER_COMPACT}"}),new sap.m.SegmentedButtonItem({icon:"sap-icon://filter-analytics",width:"inherit",key:p,tooltip:"{i18n>FILTER_VISUAL}",enabled:"{_templPriv>/alp/searchable}"})];var X=new sap.m.SegmentedButton({width:"inherit",selectedKey:r,items:W,select:function(e){var _=e.getSource();_.setSelectedKey(r);u.visualFilterDialogContainer._toggle.call(u.visualFilterDialogContainer);}}).addEventDelegate({onAfterRendering:function(e){if(e.srcControl.getCustomData()[0]&&e.srcControl.getCustomData()[0].getValue()){e.srcControl.focus();e.srcControl.removeAllCustomData();}}});var Y=u.visualFilterDialogContainer._createForm();u.oSmartFilterbar.addFilterDialogContent(Y);var Z=new sap.m.OverflowToolbar({design:sap.m.ToolbarDesign.Transparent,content:[new sap.m.ToolbarSpacer(),X]}).addStyleClass("sapSmartTemplatesAnalyticalListPageFilterDialogToolbar");i[0].setToolbar(Z);X.setModel(u.oController.getView().getModel("_templPriv"),"_templPriv");}var $=u.oController.getView().getModel("_templPriv");if($.getProperty("/alp/searchable")){if($.getProperty("/alp/filterMode")===p){u.oSmartFilterbar.addFilterDialogContent(i[1]);if(D.system.desktop&&(!D.system.phone||!D.system.tablet)){u.oSmartFilterbar.setContentWidth(790);u.oSmartFilterbar.setContentHeight(685);}else if(D.system.tablet){if(D.orientation.portrait){u.oSmartFilterbar.setContentWidth(400);u.oSmartFilterbar.setContentHeight(720);}else if(D.orientation.landscape){u.oSmartFilterbar.setContentWidth(512);u.oSmartFilterbar.setContentHeight(861);}}}else{u.oSmartFilterbar.addFilterDialogContent(i[0]);}}else{u.oSmartFilterbar.addFilterDialogContent(i[0]);}},onSearchForFilters:function(e){u.visualFilterDialogContainer._triggerSearchInFilterDialog.call(u.visualFilterDialogContainer,e);},onDialogSearch:function(e){u.visualFilterDialogContainer._searchDialog.call(u.visualFilterDialogContainer);},onDialogCancel:function(e){u.visualFilterDialogContainer._cancelDialog.call(u.visualFilterDialogContainer);},onDialogClear:function(e){s.onClearFilterExtension(e);},onRestore:function(e){u.visualFilterDialogContainer._restoreDialog.call(u.visualFilterDialogContainer);},onDataReceived:function(e){u.oContentArea.enableToolbar();t.oCommonEventHandlers.onDataReceived(e);},onRowSelectionChange:function(e){var i=e.getSource();t.oCommonUtils.setEnabledToolbarButtons(i);}},extensionAPI:new c(t,s,u)};}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.Canvas.Component')){jQuery.sap.declare('sap.suite.ui.generic.template.Canvas.Component');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/suite/ui/generic/template/Canvas/Component",["jquery.sap.global","sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/lib/TemplateComponent","sap/suite/ui/generic/template/detailTemplates/detailUtils","sap/suite/ui/generic/template/Canvas/controller/ControllerImplementation"],function(q,T,a,d,C){"use strict";function g(c,o){var v={};var b=d.getComponentBase(c,o,v);var s={oControllerSpecification:{getMethods:C.getMethods.bind(null,v),oControllerDefinition:{}}};return q.extend(b,s);}return T.getTemplateComponent(g,"sap.suite.ui.generic.template.Canvas",{metadata:{library:"sap.suite.ui.generic.template",properties:{"templateName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.Canvas.view.Canvas"},"requiredControls":"object"},"manifest":"json"}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ListReport.Component')){jQuery.sap.declare('sap.suite.ui.generic.template.ListReport.Component');sap.ui.define("sap/suite/ui/generic/template/ListReport/Component",["sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/ListReport/controller/ControllerImplementation"],function(T,C){"use strict";function g(c,o){var v={};return{oControllerSpecification:{getMethods:C.getMethods.bind(null,v),oControllerDefinition:{getVisibleSelectionsWithDefaults:function(){var V=[];return V;},onInitSmartFilterBarExtension:function(e){},getCustomAppStateDataExtension:function(a){},restoreCustomAppStateDataExtension:function(a){},onBeforeRebindTableExtension:function(e){},onBeforeRebindChartExtension:function(e){},adaptNavigationParameterExtension:function(s,O){},onListNavigationExtension:function(e){},getPredefinedValuesForCreateExtension:function(s){}}},init:function(){var t=c.getModel("_templPriv");t.setProperty("/listReport",{});},onActivate:function(){o.setBackNavigation(undefined);v.onComponentActivate();},refreshBinding:function(u){v.refreshBinding();},getUrlParameterInfo:function(){return v.getUrlParameterInfo();},getItems:function(){return v.getItems();},displayNextObject:function(O){return v.displayNextObject(O);}};}return T.getTemplateComponent(g,"sap.suite.ui.generic.template.ListReport",{metadata:{library:"sap.suite.ui.generic.template",properties:{"templateName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.ListReport.view.ListReport"},"hideChevronForUnauthorizedExtNav":{"type":"boolean","defaultValue":"false"},"treeTable":"boolean","tableType":"string","gridTable":"boolean","condensedTableLayout":"boolean","multiSelect":"boolean","smartVariantManagement":"boolean","hideTableVariantManagement":"boolean","variantManagementHidden":"boolean","creationEntitySet":"string","isWorklist":"boolean"},"manifest":"json"}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.ObjectPage.Component')){jQuery.sap.declare('sap.suite.ui.generic.template.ObjectPage.Component');jQuery.sap.require('jquery.sap.global');sap.ui.define("sap/suite/ui/generic/template/ObjectPage/Component",["jquery.sap.global","sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/lib/TemplateComponent","sap/suite/ui/generic/template/detailTemplates/detailUtils","sap/suite/ui/generic/template/ObjectPage/controller/ControllerImplementation"],function(q,T,a,d,C){"use strict";function g(c,o){var v={};var b=d.getComponentBase(c,o,v);var s={oControllerSpecification:{getMethods:C.getMethods.bind(null,v),oControllerDefinition:{adaptNavigationParameterExtension:function(S,O){},onBeforeRebindTableExtension:function(e){},onListNavigationExtension:function(e){}}},getTemplateSpecificParameters:function(){return{breadCrumb:o.getBreadCrumbInfo()};},refreshBinding:function(u,r){if(u){o.refreshBindingUnconditional();}else{v.refreshFacets(r);}},presetDisplayMode:function(D,i){if(i){return;}var t=o.getTemplatePrivateModel();t.setProperty("/objectPage/displayMode",D);},beforeRebind:function(){v.beforeRebind();},afterRebind:function(){v.afterRebind();},enhanceExtensionAPI4Reuse:function(e,E){e.setSectionHidden=function(h){var t=o.getTemplatePrivateModel();t.setProperty("/generic/embeddedComponents/"+E.embeddedKey+"/hidden",h);};}};return q.extend(b,s);}return T.getTemplateComponent(g,"sap.suite.ui.generic.template.ObjectPage",{metadata:{library:"sap.suite.ui.generic.template",properties:{"templateName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.ObjectPage.view.Details"},"showRelatedApps":{"type":"boolean","defaultValue":"false"},"showConfirmationOnDraftActivate":{"type":"boolean","defaultValue":"false"},"hideChevronForUnauthorizedExtNav":{"type":"boolean","defaultValue":"false"},"editableHeaderContent":{"type":"boolean","defaultValue":"false"},"gridTable":"boolean","tableType":"string","sections":"object","simpleHeaderFacets":{"type":"boolean","defaultValue":"false"},"allowDeepLinking":"boolean","navToListOnSave":"boolean"},"manifest":"json"}});});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.extensionAPI.ReuseComponentSupport')){
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
jQuery.sap.declare('sap.suite.ui.generic.template.extensionAPI.ReuseComponentSupport');jQuery.sap.require('jquery.sap.global');jQuery.sap.require('sap.ui.core.UIComponent');jQuery.sap.require('sap.ui.model.json.JSONModel');sap.ui.define("sap/suite/ui/generic/template/extensionAPI/ReuseComponentSupport",["jquery.sap.global","sap/ui/core/UIComponent","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/extensionAPI/extensionAPI"],function(q,U,J,e){"use strict";var j="sap.suite.ui.generic.template.extensionAPI.ReuseComponentSupport";function h(c,u){if(!c.extensionAPI){return;}var d=c.component.getBindingContext();var D=d&&d.getPath();if(!u&&(!d||D===c.currentContextPath)){return;}c.currentContextPath=D;var M=c.component.getModel();var C=(c.firstTime&&c.component.stStart)||c.component.stRefresh;c.firstTime=false;if(C){C.call(c.component,M,d,c.extensionAPI);}}function m(c,C,t){var o={component:c,firstTime:true,currentContextPath:null};var H=h.bind(null,o);var r={pathUnchangedCallBack:H};o.proxy=r;if(c.stRefresh||c.stStart){c.attachEvent("modelContextChange",H.bind(null,false));}var O=c.onBeforeRendering;c.onBeforeRendering=function(){c.onBeforeRendering=O;c._stProxy=r;var E=e.getExtensionAPIPromise(c.oContainer);E.then(function(d){o.extensionAPI=d;delete c._stProxy;H();});if(O){O.apply(c,arguments);}};if(C){var p=c.getMetadata().getProperties();var M={};for(var P in p){M[P]=c.getProperty(P);}var a=new J(M);c.setModel(a,C);var s=c.setProperty||q.noop;c.setProperty=function(n,v){s.apply(c,arguments);a.setProperty("/"+n,v);q.sap.log.debug(c.getId()+":"+c.getMetadata().getName()+": setProperty "+n+"="+v,j);};c.getComponentModel=c.getComponentModel||function(){return a;};if(t){var u=function(d,b){var v=b.getValue();if(v!==c.getProperty(d)){s.call(c,d,v);}};for(P in p){var b=a.bindProperty("/"+P);b.attachChange(u.bind(null,P,b));}}}}return{mixInto:function(c,C,t){if(!(c instanceof U)){throw new Error("Reuse component must be an instance of sap.ui.core.UIComponent");}m(c,C,t);}};});};if(!jQuery.sap.isDeclared('sap.suite.ui.generic.template.AnalyticalListPage.Component')){jQuery.sap.declare('sap.suite.ui.generic.template.AnalyticalListPage.Component');sap.ui.define("sap/suite/ui/generic/template/AnalyticalListPage/Component",["sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/AnalyticalListPage/controller/ControllerImplementation"],function(T,C){"use strict";function g(c,o){var v={};return{oControllerSpecification:{getMethods:C.getMethods.bind(null,v),oControllerDefinition:{getVisibleSelectionsWithDefaults:function(){var V=[];return V;},onInitSmartFilterBarExtension:function(e){},getCustomAppStateDataExtension:function(a){},restoreCustomAppStateDataExtension:function(a){},onBeforeRebindTableExtension:function(e){},onBeforeRebindChartExtension:function(e){},onClearFilterExtension:function(e){},adaptNavigationParameterExtension:function(s,O){},onAfterCustomModelCreation:function(a){},getPredefinedValuesForCreateExtension:function(s){}}},init:function(){var t=c.getModel("_templPriv");t.setProperty("/listReport",{});t.setProperty("/alp",{visualFilter:{}});var f=new sap.ui.model.json.JSONModel();c.setModel(f,"_filter");},onActivate:function(){o.setBackNavigation(undefined);v.onComponentActivate();},refreshBinding:function(){v.refreshBinding();},getUrlParameterInfo:function(){return v.getUrlParameterInfo();},overwrite:{updateBindingContext:function(){sap.suite.ui.generic.template.lib.TemplateComponent.prototype.updateBindingContext.apply(c,arguments);}}};}return T.getTemplateComponent(g,"sap.suite.ui.generic.template.AnalyticalListPage",{metadata:{library:"sap.suite.ui.generic.template",properties:{"templateName":{"type":"string","defaultValue":"sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"},"qualifier":{"type":"string","defaultValue":""},"chartPresentationQualifier":{"type":"string","defaultValue":""},"gridTable":{"type":"boolean","defaultValue":false},"multiSelect":{"type":"boolean","defaultValue":false},"smartVariantManagement":{"type":"boolean","defaultValue":true},"defaultContentView":{"type":"string","defaultValue":"charttable"},"defaultFilterMode":{"type":"string","defaultValue":"visual"},"keyPerformanceIndicators":"array","autoHide":{"type":"boolean","defaultValue":true},"showAutoHide":{"type":"boolean","defaultValue":true},"hideVisualFilter":{"type":"boolean","defaultValue":false},"showGoButtonOnFilterBar":{"type":"boolean","defaultValue":false},"tableType":{"type":"string","defaultValue":""},"showItemNavigationOnChart":{"type":"boolean","defaultValue":false},"condensedTableLayout":{"type":"boolean","defaultValue":true}},"manifest":"json"}});});};
